\chapter{Measure Theory}\label{cha:measure_theorey}

\section{Set Systems and Measures}

\subsection{Set systems}

In this chapter, we denote $E$ as a set. Then we have the following definitions.

\begin{definition}
Let $\sA$ be a set of subsets of $E$. Say that $\sA$ is an algebra\index{algebra} on $E$ if for all $A,B\in \sA$ 
\be
\text{(i)}\ \emptyset\in \sA \quad\quad \text{(ii)}\ A^c=E\bs A\in\sA \quad\quad \text{(iii)}\ A\cup B\in \sA .
\ee 
\end{definition}

\begin{definition}[$\sigma$-algebra]\label{def:sigma_algebra}
Let $\sE$ be a set of subsets of $E$. Say that $\sE$ is a $\sigma$-algebra\index{sigma-algebra@$\sigma$-algebra} on $E$ if for all countable sequences $(A_n:n\in \N)\in \sE$ and $A\in \sE$,
\be
\text{(i)}\ \emptyset\in \sE \quad\quad \text{(ii)}\ A^c=E\bs A\in\sE \quad\quad \text{(iii)}\ \bigcup_nA_n\in \sE .
\ee 
\end{definition}

\begin{remark}
$\bigcap_{i\in I} \sF_i$ is still a $\sigma$-albebra, but $\bigcup_{i\in I} \sF_i$ is not in general. Note $I$ can be uncountable.
\end{remark}

\begin{definition}[measurable space\index{measurable space}]\label{def:measurable_space}
The pair $(E,\sE)$ is called a measurable space. Given $(E,\sE)$, each $A\in \sE$ is called a measurable set\index{measurable set}.
\end{definition}

\begin{definition}\label{def:separable_sigma_algebra}
A separable\index{separable!$\sigma$-algebra} (or countably generated\index{countably generated!$\sigma$-algebra}) $\sigma$-algebra (or separable $\sigma$-field) is a $\sigma$-algebra that can be generated by a countable collection of sets, i.e. for the separable $\sigma$-algebra $\sF$, there are countable sets $A_1,A_2,\dots$ such that $\sF = \sigma\bb{A_1,A_2,\dots}$.
\end{definition}

\begin{definition}[$\pi$-system]\label{def:pi_system}
Let $\sA$ be a set of subsets of $E$. Say that $\sA$ is a $\pi$-system\index{pi-system@$\pi$-system} on $E$ if for all $A,B\in \sA$
\be
\text{(i)}\ \emptyset\in \sA \quad\quad \text{(ii)}\ A\cap B\in \sA .
\ee 
\end{definition}

\begin{remark}
$\bigcup_{i\in I} \sF_i$ is a $\pi$-system. Note $I$ can be uncountable.
\end{remark}

\begin{definition}[$d$-system]\label{def:d_system}
Let $\sA$ be a set of subsets of $E$. Say that $\sA$ is a $d$-system\index{d-system@$d$-system} on $E$ if for all $A,B\in \sA$ with $A\subseteq B$ and all increasing sequences\index{increasing!set sequence} $(A_n)_{n\in \N}$ in $\sA$, i.e., $\forall A_1,A_2,\dots,\in \sA: A_1\subseteq A_2\subseteq \dots$
\be
\text{(i)}\ E\in \sA \quad\quad \text{(ii)}\ B \bs A\in\sA \quad\quad \text{(iii)}\ \bigcup_n A_n\in \sA.
\ee 
\end{definition}

\begin{lemma}\label{lem:pi_d_sigma_algebra}
If $\sE$ is both a $\pi$-system and a $d$-system, then $\sE$ is a $\sigma$-algebra.
\end{lemma}

\begin{proof}[\bf Proof]
($\la$) If $\sE$ is a $\sigma$-algebra, $\forall A,B\in \sA$, $\forall A_1,A_2,\dots,\in \sA: A_1\subseteq A_2\subseteq \dots$ (increasing sequence). Thus, by definition of $\sigma$-algebra (Definition \ref{def:sigma_algebra}).
\be
E\in \sE,\ A^c \in \sE,\ B^c \in \sE, \ A^c \cup B^c \in \sE,\ \bigcup_n A_n\in \sE.
\ee

Thus,
\be
\text{(i)}\ \emptyset \in \sE,\quad \text{(ii)}\ A\cap B = \bb{A^c \cup B^c}^c \in \sE,\quad\quad \ra\quad \sE \text{ is $\pi$-system.}
\ee

Also, if $A\subseteq B$, 
\be
\text{(i)}\ E \in \sE,\quad \text{(ii)}\ B\bs A = B\cap A^c = \bb{A \cup B^c}^c \in \sE,\quad \text{(iii)}\ \bigcup_n A_n\in \sE \quad\quad\ra\quad \sE \text{ is $d$-system.}
\ee


($\ra$) Suppose that $\sE$ is both a $\pi$-system and a $d$-system on a set $E$. Then, we know that
\ben
\item [(i)] $\emptyset = E\backslash E \in \sE$ (since $\sE$ is a $d$-system $\ra$ for $A=B=E\in \sE$, $A\subseteq B$, $B\backslash A \in \sE$)
\item [(ii)] $A\in \sE$ $\ra$ $A^c\in\sE$ (since $\sE$ is a $d$-system $\ra$ for $B=E\in \sE$, $\forall A\subseteq B$, $B\backslash A = A^c\in \sE$)
\item [(iii)] $\forall (A_n:n\in\N)\in \sE$, we set 
\be
B_n = \bigcup_{m\leq n} A_m = \lob \bigcap_{m\leq n}A_m^c\rob^c
\ee
Since $\sE$ is a $d$-system, we have that $A_m^c\in \sE$. Also, $\bigcap_{m\leq n}A_m^c\in \sE$ since $\sE$ is $\pi$-system. Consequently, $B_n = \lob \bigcap_{m\leq n}A_m^c\rob^c\in\sE$. We know that $\bigcup\limits_n A_n = \bigcup\limits_n B_n$ and $B_n$ is an increasing sequence. Since $\sE$ is a $d$-system, for the increasing sequence $B_n\in\sE$, we have 
\be
\bigcup\limits_nB_n \in\sE \ \ra \ \bigcup\limits_n A_n \in \sE 
\ee
\een
Thus, (i), (ii) and (iii) imply that $\sE$ is a $\sigma$-algebra.
\end{proof}

\begin{definition}
Let $\sA$ be a set of subsets of $E$. Define 
\be
\sigma(\sA) = \{A\subseteq E: A \in \sE \ \text{for all $\sigma$-algebra $\sE$ containing $\sA$}\}.
\ee 
Then $\sigma(\sA)$ is a $\sigma$-algebra, which is called the $\sigma$-algebra generated\index{generated $\sigma$-algebra} by $\sA$. It is the smallest $\sigma$-algebra containing $\sA$.
\end{definition}

\begin{proposition}\label{pro:intersection_d_system}
The intersection of $d$-systems containing a set of subsets $\sA$, is also a $d$-system.
\end{proposition}

\begin{proof}[\bf Proof]
For the set $E$, we have $\sD$, the intersection of all $d$-system.
\ben
\item[(i)] $E\in \sD'$ for any $d$-system $\sD'$, then $E\in \sD$.
\item[(ii)] For all $A,B\in \sD$ with $A\subseteq B$, we have for any $d$-system $\sD'$, $\sD\subseteq \sD'$. Then
\be
A,B\in \sD' \ \ra \ B\bs A\in \sD'\ \ra \ B\bs A\in \sD.
\ee
\item[(iii)] For all increasing sequences $(A_n:n\in\N)\in \sD$, we have for any $d$-system $\sD'$, $\sD\subseteq \sD'$. Then
\be
(A_n:n\in\N) \in \sD' \ \ra \ \bigcup_n A_n \in \sD'\ \ra \ \bigcup_n A_n \in \sD.
\ee
\een
Thus, we have $\sD$ is also a $d$-system.
\end{proof}

\begin{lemma}[Dynkin's Lemma\index{Dynkin's Lemma}]\label{lem:dynkin_lemma}
Let $\sA$ be a $\pi$-system. Then any $d$-system containing $\sA$ also contains the $\sigma$-algebra generated by $\sA$.
\end{lemma}

\begin{proof}[\bf Proof]
Denote by $\sD$ the intersection of all $d$-systems containing $\sA$, then $\sD$ itself is a $d$-system (by proposition \ref{pro:intersection_d_system}). 

We shall show that $\sD$ is also a $\pi$-system and hence a $\sigma$-algebra, thus proving the lemma. Consider 
\be
\sD' = \{B\in \sD: A\cap B\in \sD \text{ for all }A\in \sA\}.\quad\quad\quad(\sD'\subseteq \sD)
\ee
Then $\sA\subseteq \sD'$ because $\sA$ is a $\pi$-system ($\forall B\in \sA\subseteq \sD$, for all $A\in \sA$, $A\cap B\in \sA \subseteq \sD$). Let us check that $\sD'$ is a $d$-system,
\ben
\item[(i)] $E\in \sD$ since $\sD$ is a $d$-system and $E\cap A = A \in \sA \subseteq \sD$ for all $A\in \sA$. Thus, $E\in \sD'$.
\item[(ii)] Suppose $B_1,B_2\in \sD'$ with $B_1\subseteq B_2$, then $B_1,B_2\in \sD \ \ra \ B_2\bs B_1\in \sD$ since $\sD'\subseteq \sD$ and $\sD$ is a $d$-system. Also for all $A\in \sA$,
\be
A \cap (B_2\bs B_1) = (\underbrace{A\cap B_2}_{\in \sD})\bs (\underbrace{A\cap B_1}_{\in \sD}) \in \sD
\ee
since $\sD$ is a $d$-system, so $B_2\bs B_1 \in \sD'$.
\item[(iii)] If $B_n\in \sD'$, $n\in \N$ and $B_n\uparrow B$, then for all $A\in \sA$ we have $A\cap B_n\uparrow A\cap B$. Thus, $B\in \sD$ and $A\cap B\in \sD$ and hence $B\in \sD'$.
\een
Combine the fact that $\sD'$ is a $d$-system, $\sD$ is a intersection of all $d$-system and $\sD'\subseteq \sD$, we have $\sD = \sD'$.

Now we consider 
\be
\sD'' = \{B\in \sD: A\cap B\in \sD \text{ for all }A\in \sD\}.\quad\quad\quad(\sD''\subseteq \sD)
\ee

Then $\sA\subseteq \sD''$ by definition of $\sD'$ and $\sD''$ ($\forall B\in \sA\subseteq \sD$, for all $A\in \sD'(=\sD)$, $A\cap B\in \sD$). Let us check that $\sD''$ is also a $d$-system,
\ben
\item[(i)] $E\in \sD$ since $\sD$ is a $d$-system and $E\cap A = A \in \sD$ for all $A\in \sD$. Thus, $E\in \sD''$.
\item[(ii)] Suppose $B_1,B_2\in \sD''$ with $B_1\subseteq B_2$, then $B_1,B_2\in \sD \ \ra \ B_2\bs B_1\in \sD$ since $\sD''\subseteq \sD$ and $\sD$ is a $d$-system. Also for all $A\in \sD$,
\be
A \cap (B_2\bs B_1) = (\underbrace{A\cap B_2}_{\in \sD})\bs (\underbrace{A\cap B_1}_{\in \sD}) \in \sD
\ee
since $\sD$ is a $d$-system, so $B_2\bs B_1 \in \sD''$.
\item[(iii)] If $B_n\in \sD''$, $n\in \N$ and $B_n\uparrow B$, then for all $A\in \sD$ we have $A\cap B_n\uparrow A\cap B$. Thus, $B\in \sD$ and $A\cap B\in \sD$ and hence $B\in \sD''$.
\een
Combine the fact that $\sD''$ is a $d$-system, $\sD$ is a intersection of all $d$-system and $\sD''\subseteq \sD$, we have $\sD = \sD''$. That is,
\be
\sD = \{B\in \sD: A\cap B\in \sD \text{ for all }A\in \sD\}.
\ee
This result shows that $\emptyset\in \sD$ and for all $A,B\in \sD$, $A\cap B \in \sD$. Thus $\sD$ is a $\pi$-system as promised.
\end{proof}

\begin{definition}[ring\index{ring!set}]\label{def:ring_set}
Let $\sA$ be a set of subsets of $E$. Say that $\sA$ is a ring on $E$ if for all $A,B\in \sA$
\be
\text{(i)}\ \emptyset\in \sA \quad\quad \text{(ii)}\ B\bs A \in\sA \quad\quad \text{(iii)}\ A\cup B\in \sA .
\ee 
\end{definition}

\begin{remark}
If $\sA$ is a ring on $E$, for all $A,B\in\sA$, recalling Definition \ref{def:symmetric_difference}, we have $A\triangle B \in \sA$. Thus
\be
A\cap B = (A\cup B)\bs (A \triangle B) \in \sA,
\ee
so any ring is also stable by intersection. Thus, any ring is also a $\pi$-system.
\end{remark}

\begin{definition}\label{def:borel_measurable_space}
Let $(E,\sT)$ be a topological space. The $\sigma$-algebra generated by the set of open sets in $E$ is called the Borel $\sigma$-algebra\index{Borel $\sigma$-algebra} of $E$ and is denoted $\sB(E)$, which is the smallest $\sigma$-algebra contains all the open sets. 

$(E,\sB(E))$ is called Borel measurable space\index{Borel measurable space}.
\end{definition}
\begin{remark}
Obviously, $\sT\subseteq \sB(E)$. The Borel $\sigma$-algebra of $\R$ is denoted by $\sB(\R)$. 
\end{remark}
\begin{lemma} 
The following sets of subsets of $\R$ all generate the same $\sigma$-algebra:
\be
\text{(i)}\ \{(a,b):a<b\},\quad \quad\text{(ii)}\ \{(a,b]:a<b\},\quad\quad \text{(iii)} \{(-\infty,b]:b\in \R\}.
\ee
\end{lemma}
\begin{proof}[\bf Proof]
Let $\sA_1,\sA_2,\sA_3$ be the set systems in (i), (ii) and (iii) respectively. So it is sufficient to show that 
\be
\left\{\ba{l}
\sA_2 \subseteq \sigma(\sA_1)\\
\sA_3 \subseteq \sigma(\sA_2)\\
\sA_1 \subseteq \sigma(\sA_3)
\ea\right.\ \ra \
\left\{\ba{l}
\sigma(\sA_2) \subseteq \sigma(\sA_1)\\
\sigma(\sA_3) \subseteq \sigma(\sA_2)\\
\sigma(\sA_1) \subseteq \sigma(\sA_3)
\ea\right. \ \ra \ \sigma(\sA_1) = \sigma(\sA_2) =\sigma(\sA_3)
\ee
since $\sigma(\sA_i)$ is the smallest $\sigma$-algebra contains $\sA_i$. Then we can check that
\vspace{2mm}

$\qquad\underbrace{(a,b]}_{\in\sA_2} = \underbrace{\bigcap_{n\in \N}\lob a,b+\frac 1n\rob}_{\in \sigma(\sA_1)},\quad\quad \underbrace{(-\infty,b]}_{\in\sA_3} = \underbrace{\bigcup_{n\in \N}( a-n,b]}_{\in \sigma(\sA_2)},\quad\quad \underbrace{(a,b)}_{\in\sA_1} = \underbrace{\left.\lob\bigcup_{n\in \N}\left(-\infty,b-\frac 1n\right]\rob \right\backslash (-\infty, a]}_{\in \sigma(\sA_3)}$.
\end{proof}

\begin{proposition}
Let $(E_1,d_1)$ and $(E_2,d_2)$ be metric spaces and let $f:E_1\to E_2$ be an arbitrary map. Denote the set of points of discontinuity of $f$, $U_f = \bra{x\in E_1:f \text{ is discontinuous at }x}$. Then $U_f \in \sB(E_1)$.
\end{proposition}

\begin{proof}[\bf Proof]
For any $\ve,\delta >0$, the set%see \cite{Klenke_2008}.$P_{11}$.
\be
U^{\delta,\ve}_f := \bra{x\in E_1: \text{there are }y,z\in B_\ve(x),\ d_2(f(y),f(z))\geq \delta} 
\ee
where $B_\ve(x) = \bra{y\in \E_1:d_1(x,y)<\ve}$. Then
\be
U^{\delta,\ve}_f = \bigcup_{\substack{y,z\in E_1\\ d_2(f(y),f(z))\geq\delta }} \bigcup_{x\in E_1} \bra{x:d_1(x,y)<\ve}\cap \bra{x:d_1(x,z)<\ve}
\ee

We see that $\bra{x:d_1(x,y)<\ve}$ and $\bra{x:d_1(x,z)<\ve}$ are open. then by Theorem \ref{thm:properties_metric_open}, we have $U^{\delta,\ve}_f$ is open. Thus, by Theorem \ref{thm:properties_metric_open} again, $U_f = \bigcup_{\ve >0} \bigcup_{\delta>0}U^{\delta,\ve}_f$ is open. Hence $U_f\in \sB(E_1)$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Measures}

\begin{definition}\label{def:set_function}
Let $\sA$ be any set of subsets of $E$ containing the empty set $\emptyset$. A set function\index{set function} is a function $\mu:\sA \to [0,\infty]$ with $\mu(\emptyset)=0$.
\end{definition}

\begin{definition}\label{def:increasing_set_function}
Let $\mu$ be a set function. Say that $\mu$ is increasing\index{increasing!set function} (decreasing\index{decreasing!set function}) if, for all $A,B\in \sA$ with $A\subseteq B$,
\be
\mu(A)\leq \mu(B)\quad \bb{\mu(A)\geq \mu(B)}.
\ee
\end{definition}

\begin{definition}\label{def:additive_set_function}
Let $\mu$ be a set function. Say that $\mu$ is additive\index{additive} if, for all disjoint\index{disjoint} sets $A,B\in \sA$ with $A\cap B = \emptyset$, $A\cup B\in \sA$,
\be
\mu(A\cup B) = \mu(A) + \mu(B).
\ee
\end{definition}

\begin{definition}[countable additivity\index{countable additivity}]\label{def:countably_additive_set_function}
Let $\mu$ be a set function. Say that $\mu$ is countably additive if, for all sequences of disjoint sets $(A_n:n\in\N) \in \sA$ with $\bigcup_n A_n \in \sA$,
\be
\mu\bb{\bigcup_n A_n} = \sum_n \mu(A_n).
\ee
\end{definition}

\begin{definition}[countable subadditivity]
Let $\mu$ be a set function. Say that $\mu$ is countably subadditive\index{countably subadditive} if, for all sequences $(A_n:n\in\N) \in \sA$ with $\bigcup_n A_n \in \sA$,
\be
\mu\bb{\bigcup_n A_n} \leq \sum_n \mu(A_n).
\ee
\end{definition}

\begin{lemma}\label{lem:countably_subadditive_increasing}
Let $\mu$ be a countably additive set function on a ring $\sA$. Then $\mu$ is increasing and countably subadditive.
\end{lemma}

\begin{proof}[\bf Proof]
$\mu$ is increasing since $\mu$ is countably additive and $\sA$ is a ring. Suppose that $A,B\in \sA$ with $A\subseteq B$,
\be
\mu(A) \leq \mu(A) + \mu(\underbrace{B\bs A}_{\in \sA}) = \mu \bb{A \cup (B\bs A)} = \mu(B) \ \ra \ \mu \text{ is increasing}.
\ee

Now assume that $A_n\in \sA$ and $\bigcup_n A_n\in \sA$. Let $B_1 = A_1,\ B_2 = A_2\bs B_1,\ \dots,\ B_n= A_n\left\bs \bigcup\limits^{n-1}_{i=1}B_i\right.$. By induction, $B_n\in\sA$ since $\sA$ is a ring. Moreover, $B_n$ are disjoint, and $\bigcup^n_{i=1}B_i = \bigcup^n_{i=1}A_i$. Thus by countable additivity, we get
\be
\mu\bb{\bigcup_n A_n} = \mu\bb{\bigcup_n B_n} = \mu\bb{\bigcup^\infty_{i=1} B_i} = \sum^\infty_{i=1}\mu(B_i) \leq \sum^\infty_{i=1}\mu(A_i),
\ee
since $\mu$ is increasing ($\mu(B_i)\leq \mu(A_i)$).
\end{proof}

\begin{lemma}\label{lem:decreasing_set}
Let $\mu$ be a finite-valued additive set function on a ring $\sA$. Show that $\mu$ is countably additive iff 
\be
A_n\supseteq A_{n+1}\in \sA,\ n\in \N,\quad \bigcap_nA_n= \emptyset \ \ra \ \mu(A_n)\to 0.
\ee
\end{lemma} 

\begin{proof}[\bf Proof]
($\ra$) Assume $\mu$ is countably additive and let $B_n = A_n\backslash A_{n+1}$. We have $B_n$ are disjoint and $B_n \in \sA$ since $\sA$ is a ring. Then we have
\be
\bigcup_{m\leq n} B_m = \bigcup_{m\leq n} \lob A_m\backslash A_{m+1} \rob = A_1\backslash A_{n+1}\in \sA.
\ee
\be
\bigcup_n B_n =\bigcup_n\bigcup_{m\leq n} B_m = \bigcup_n \lob A_1\backslash A_{n+1}\rob = A_1 \left\backslash \lob \bigcap_n A_{n+1} \rob \right. = A_1 \left\backslash \underbrace{\lob \bigcap_n A_{n}\rob}_{=\emptyset}\right. = A_1\in \sA.
\ee

Since $\mu$ is countably additive we have
\be
\sum_{m\leq n} \mu(B_m) = \mu\lob \bigcup_{m\leq n} B_m \rob = \mu\lob A_1\backslash A_{n+1}\rob = \mu(A_1) - \mu(A_{n+1}),\quad \quad \sum_{n} \mu(B_n) = \mu(A_1)<\infty.
\ee

Thus we have $\lim\limits_{n\to\infty}\sum\limits_{m\geq n}\mu(B_m) = 0$ and then from the above two equations
\be
\mu(A_{n+1}) =\sum_{m>n}\mu(B_m) \ \ra \ \lim_{n\to\infty} \mu(A_n) = \lim_{n\to\infty} \sum\limits_{m\geq n}\mu(B_m) = 0.
\ee

($\la$) Suppose that $B_n$ is a sequence of disjoint sets with $\bigcup\limits_nB_n\in\sA$, we define
\be
A_1 = \bigcup_nB_n,\quad A_n = \bigcup_{m\geq n}B_m = \bigcup_mB_m \left\backslash \lob \bigcup_{m< n}B_m\rob\right. \in \sA \ \ra \ A_n\supseteq A_{n+1},
\ee
\be
\bigcap_nA_n = \bigcap_n \lob \bigcup_{m\geq n}B_m\rob = \bigcap_n \lob \bigcup_mB_m \left\backslash \lob \bigcup_{m< n}B_m\rob\right. \rob = \bigcup_mB_m \left\backslash \lob \bigcup_n\bigcup_{m< n}B_m\rob\right. = \bigcup_mB_m \left\backslash \bigcup_nB_n\right. = \emptyset
\ee

Since $\mu$ is finite and additive. we have
\beast
\mu(A_n) & = & \mu\lob \bigcup_mB_m \left\backslash \lob \bigcup_{m< n}B_m\rob\right. \rob = \mu\lob A_1\left\backslash \lob \bigcup_{m< n}B_m\rob\right. \rob = \mu(A_1) - \mu\lob \bigcup_{m< n}B_m\rob \\
& = & \mu(A_1) - \sum_{m< n}\mu(B_m) = \mu\lob \bigcup_nB_n\rob - \sum_{m< n}\mu(B_m)
\eeast

Thus, we have
\be
\mu(A_n)\to 0 \ \ra \ \mu\lob \bigcup_nB_n\rob - \sum_{n}\mu(B_n) = 0 \ \ra \ \mu\lob \bigcup_nB_n\rob = \sum_{n}\mu(B_n)
\ee
which implies that $\mu$ is countably additive.
\end{proof}


\begin{definition}[measure]\label{def:measure}
A measure\index{measure} $\mu$ on measurable space $(E,\sE)$ is a set function $\mu:\sE\to [0,\infty]$, such that, for any sequence $(A_n:n\in\N)$ of disjoint elements of $\sE$,
\be
\mu\bb{\bigcup_n A_n} = \sum_n \mu(A_n)\quad\quad (\text{countably additive})
\ee
The triple $(E,\sE,\mu)$ is called a measure space\index{measure space}.
\end{definition}

\begin{remark}
Note that the set function is defined on $\sA$, a set of subsets of $E$ and the measure is defined on a $\sigma$-algebra $\sE$ on $E$.
\end{remark}

\begin{definition}[finite measure]\label{def:inite_measure}
Let $(E,\sE,\mu)$ be a measure space. If $\mu(E) <\infty$, then $\mu$ is a finite measure\index{finite measure}.
\end{definition}

\begin{definition}[$\sigma$-finite Measure]\label{def:sigma_finite_measure}
Let $(E,\sE,\mu)$ be a measure space. The measure $\mu$ is called $\sigma$-finite\index{sigma-finite measure@$\sigma$-finite measure} if $E$ is the countable union of measurable sets of finite measure, i.e., there exists $A_n$ with $\bigcup_n A_n= E$, $\mu(A_n) <\infty$ $\forall n$.
\end{definition}

Now we give some basic properties of measure:

\begin{proposition}\label{pro:measure_property}
Let $(E,\sE,\mu)$ be a measure space, then for $A,B,A_n\in \sE$, $n\in \N$,
\vspace{2mm}

$\qquad\text{(i)}\ \mu(A\cup B) \leq \mu(A)+\mu(B), \quad\quad \text{(ii)}\ \mu\bb{\bigcup\limits^n_{i=1}A_i} \leq \sum\limits_i^n \mu(A_i),\quad\quad \text{(iii)}\ \mu\bb{\bigcup_n A_n} \leq \sum_n \mu(A_n),$

If $\mu(E)<\infty$, 
\vspace{2mm}

$\quad\ \ \text{(iv)}\ \mu(A\cup B) = \mu(A)+\mu(B) - \mu(A\cap B)$,
\beast
\qquad\quad \text{(v)}\ \mu\bb{\bigcup^n_{i=1}A_i} = \sum^n_{i=1} \mu(A_i) - \sum_{1\leq i_1<i_2 \leq n} \mu(A_{i_1} \cap A_{i_2}) + \sum_{1\leq i_1<i_2<i_3\leq n} \mu(A_{i_1} \cap A_{i_2} \cap A_{i_3}) - \dots + (-1)^{n-1} \mu\bb{\bigcap^n_{i=1} A_i}.
\eeast
\end{proposition}

\begin{remark}
(v) is called inclusion-exclusion formula\index{inclusion-exclusion formula!measure theory}.
\end{remark}

\begin{proof}[\bf Proof]
(i), (ii) and (iii) are implied by Lemma \ref{lem:countably_subadditive_increasing}.

For (iv), we have disjoint sets $A\cap B$, $B\bs A$, $A\bs B$, by definition of measure (Definition \ref{def:measure}),
\be
\mu\bb{A \cup B} = \mu \bb{\bb{A\cap B}\cup \bb{A\bs B}\cup\bb{B\bs A}} = \mu\bb{A\cap B} + \mu\bb{A\bs B} + \mu\bb{B\bs A}.
\ee

Also, $\mu(A) = \mu(A\bs B) + \mu(A\cap B)$, $\mu(B) = \mu(B\bs A) + \mu(A\cap B)$. Since $\mu(A\cap B)$ is finite,
\be
\mu\bb{A \cup B} = \mu\bb{A\cap B} + \mu(A) - \mu\bb{A\cap B} + \mu(B) - \mu\bb{A\cap B} = \mu(A)+\mu(B) - \mu(A\cap B).
\ee

The proof of (v) is by the induction on (iv). The case $n = 2$ is just (iv). Now assume the result holds for any $n$ events and consider $A_1,\dots,A_{n+1}$. Now see from (iv) again that
\be\label{equ:inclusion_exclusion_measure}
\mu\bb{\bigcup^{n+1}_{i=1} A_i} = \mu\bb{\bigcup^{n}_{i=1} A_i} + \mu(A_{n+1}) - \mu\bb{\bb{\bigcup^{n}_{i=1} A_i}\cap A_{n+1}}\nonumber = \mu\bb{\bigcup^{n}_{i=1} A_i} + \mu(A_{n+1}) - \mu\bb{\bigcup^{n}_{i=1} (A_i\cap A_{n+1})}.
\ee
and then apply the inductive hypothesis to the first and the third terms to complete the induction and obtain the conclusion.
\end{proof}

\begin{definition}[null set\index{null set!measure}]
Let $(E,\sE,\mu)$ be a measure space. Call a subset $N\subseteq E$ $\mu$-null set if 
\be
N\subseteq B \text{ for some }B\in\sE \text{ with }\mu(B)=0.
\ee
\end{definition}

\begin{definition}[complete measure space\index{complete!measure space}]\label{def:complete_measure_space}
A measure space $(E,\sE,\mu)$ is said to be complete if every subset of a set of measure 0 is measurable (and consequently, has measure 0), i.e. if for all $A\in \sE$ such that $\mu(A)=0$ and then for all $B\subseteq A$ we have $\mu(B)=0$.
\end{definition}

\begin{proposition}\label{pro:completion}
The set of subsets $\sE^\mu = \{A\cup N: A\in \sE, N \text{ is $\mu$-null set}\}$ is a $\sigma$-algebra and $\mu$ has a well-defined and countably additive extension to $\sE^\mu$ given by 
\be
\mu(A\cup N) = \mu(A).
\ee

We call $\sE^\mu$ the completion\index{completion} of $\sE$ with respect to $\mu$.
\end{proposition} 

\begin{proof}[\bf Proof]
First, we prove that $\sE^\mu$ is a $\sigma$-algebra. Suppose $A_n\cup N_n\in \sE^\mu$ with $A_n\in\sE$ and $N_n \subseteq B_n$, $B_n\in \sE$ and $\mu(B_n)=0$. Then
\ben
\item [(i)] It is obvious that $\emptyset \in \sE^\mu$.
\item [(ii)] For $A\cup N\in \sE^\mu$, we have $N\subseteq B\in\sE$ and $\mu(B)= 0$.
\be
\lob A \cup N\rob^c = A^c\cap N^c = A^c\bs N = \underbrace{\lob A^c \bs B\rob}_{\in\sE}  \cup \underbrace{\lob \lob A^c\cap B \rob \bs N\rob }_{\subseteq B\in \sE} \in \sE^\mu.
\ee
\item [(iii)]Suppose $(A_n\cup N_n:n\in\N)\in\sE^\mu$. Then
\be
\bigcup_n\lob A_n\cup N_n\rob = \underbrace{\lob \bigcup_n A_n \rob }_{\in\sE}\cup \underbrace{\lob\bigcup_n N_n \rob }_{\subseteq \bigcup\limits_n B_n \in\sE} \in \sE^\mu \quad \lob \text{since }\mu\lob \bigcup\limits_n B_n\rob \leq \sum_n \mu(B_n)= 0\rob
\ee
\een
Thus, $\sE^\mu$ is a $\sigma$-algebra. Now suppose $A_1\cup N_1=A_2\cup N_2$, then
\be
\mu(A_1) = \mu(A_1) + \mu(B_1) \geq \mu\lob A_1\cup B_1\rob \geq \mu\lob A_1\cup N_1\rob = \mu\lob A_2\cup N_2\rob \geq \mu(A_2)
\ee
Similarly,
\be
\mu(A_2) \geq \mu(A_1) \ \ra \ \mu(A_1) = \mu(A_2) = \mu(A_1\cup N_1)\ \ra \ \mu \text{ is well defined on }\sE^\mu.
\ee

Now we check countable additivity. Suppose that $\lob A_n \cup N_n\rob$ are sequences of disjoint sets
\vspace{2mm}

$\qquad\qquad\quad\quad\mu\lob \bigcup\limits_n \lob A_n \cup N_n\rob \rob = \mu\lob\lob \bigcup\limits_n A_n\rob \cup \lob\bigcup\limits_n N_n\rob \rob = \mu\lob \bigcup\limits_n A_n\rob = \sum\limits_n\mu (A_n)=\sum\limits_n\mu (A_n\cup N_n)$.
\end{proof}

\begin{remark}
If a measure space is not complete, there exists a completion of it, which is a complete measure space $(E,\sE^\mu,\ol{\mu})$ such that $\sE \subset\sE^\mu$ and $ \ol{\mu}|_\sE = \mu$ (i.e., $\forall A\in \sE$, $\ol{\mu}(A) = \mu (A)$), where $\sE^\mu$ is the smallest $\sigma$-algebra containing both $\sE$ and all subsets of elements of zero measure of $\sE$ .
\end{remark}


Now we give the monotone convergece properties of measure.

\begin{lemma}[fundamental property of measure\index{fundamental property of measure}]\label{lem:measure_increasing_sequence}
Let $(E,\sE,\mu)$ be a measure space. $A_n$ is an increasing sequence of $\sE$, and let $A=\bigcup_n A_n$. Then $\mu(A) = \lim_n\mu(A_n)$.
\end{lemma}

\begin{proof}[\bf Proof]
Let $B_1=A_1,B_2 = A_2\bs A_1, \dots, B_n = A_n\bs A_{n-1}\in \sE$. Moreover, the $B_n$ are disjoint, and $\bigcup^n_{i=1}B_i = \bigcup^n_{i=1}A_i$ for all $n\geq 1$. Thus by countable additivity, we get
\vspace{2mm}

$\quad\quad\quad\quad\mu(A) = \mu\bb{\bigcup\limits_n A_n} = \mu\bb{\bigcup\limits_n B_n} = \sum\limits_n \mu(B_n) = \lim\limits_n\sum\limits^n_{i=1}\mu(B_i) = \lim\limits_n \mu(A_n)$.
\end{proof}

\begin{corollary}\label{cor:measure_decreasing_sequence}
Let $(E,\sE,\mu)$ be a measure space. $A_n$ is a decreasing sequence of $\sE$ and $A=\bigcap_n A_n$. Also, $\mu(A_n) <\infty$ for some $n$. Then $\mu(A) = \lim_n\mu(A_n)$.
\end{corollary}
\begin{proof}[\bf Proof]
For $m\in \N$, $\mu(A_m) <\infty$ and let $B_n :=A_m\bs A_{m+n}$ and $B_n$ is an increasing sequence. Applying fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}), we have 
\beast
\mu(B) = \lim_n \mu(B_n) & \ra & \mu\bb{A_m\bs A} = \lim_n \mu\bb{A_m \bs A_{m+n}} \ \ra \ \mu\bb{A_m} - \mu\bb{A} = \lim_n \mu\bb{A_m} - \lim_n\mu\bb{A_{m+n}}\\
& \ra & \mu\bb{A} = \lim_n\mu\bb{A_{m+n}} \quad \ra \quad \mu\bb{A} = \lim_n\mu\bb{A_n}
\eeast
\end{proof}

\begin{corollary}\label{cor:countable_null_set}
Let $(E,\sE,\mu)$ be a measure space. The union of a countable number of $\mu$-null sets is $\mu$-null.
\end{corollary}
\begin{proof}[\bf Proof]
For the $\mu$-null sets $N_n\subseteq B_n$, $n\in \N$, with $\mu(B_n) = 0$, $\bigcup_n N_n \subseteq \bigcup_n B_n$, we know that $\bigcup^n_{m=1}N_m \ua \bigcup_n N_n$ and apply fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}), 
\vspace{2mm}

$\quad\quad\quad\quad\mu\bb{\bigcup\limits_n B_n} = \underbrace{\lim_n \mu\bb{\bigcup\limits^n_{m=1}B_m} \leq \lim\limits_n \sum\limits^n_{m=1}\mu\bb{B_m}}_{\text{by countable subadditivity}} = \sum\limits_n 0 = 0 \quad \ra \quad \text{$\bigcup\limits_n N_n$ is $\mu$-null set}$.
\end{proof}

\begin{definition}
Given a sequence of events $(A_n:n\in\N)$, we may ask for the probability that infinitely many occur. Set
\be
\limsup A_n = \bigcap_n \bigcup_{m\geq n}A_m,\quad\quad \liminf A_n = \bigcup_n \bigcap_{m\geq n}A_m.
\ee
We write $\{A_n \text{ infinitely often\index{infinitely often}}\}$ as an alternative for $\limsup A_n$, because $\omega \in \limsup A_n$ if and only if $\omega\in A_n$ for infinitely many $n$. Similarly, we write $\{A_n \text{ eventually\index{eventually}}\}$ for $\liminf A_n$. The abbreviations i.o. and ev. are often used. 
\end{definition}

Note that $\{A_n \text{ i.o.}\}^c = \{A^c_n\text{ ev.}\}$.

\begin{lemma}[First Borel-Cantelli Lemma\index{Borel-Cantelli Lemma!measure}]\label{lem:borel_cantelli_1_measure}
Let $(E,\sE,\mu)$ be a measure space. For sequence $A_n \subseteq E$, if $\sum\limits_n \mu(A_n) < \infty$, then $\mu(A_n\text{ i.o.}) = 0$. (That is almost surely, $A_n^c$ occurs eventually.)
\end{lemma}

\begin{proof}[\bf Proof]
As $n\to \infty$, we have $\mu(A_n \text{ i.o.})\leq \mu\bb{\bigcup\limits_{m\geq n}A_m} \leq \sum\limits_{m\geq n}\mu(A_m) \to 0$.
\end{proof}

\begin{lemma}[Fatou's Lemma\index{Fatou's Lemma!set}]\label{lem:fatou_set}
Let $(E,\sE,\mu)$ be a measure space. For any sequence of sets $(A_n:n\in \N)\in\sE$, 
\be
\mu(\lim \inf A_n)\leq \lim \inf \mu(A_n).
\ee
(Inverse Fatou's Lemma). If $\mu$ is finite, then also
\be
\mu(\lim \sup A_n)\geq \lim \sup \mu(A_n)
\ee
\end{lemma}
\begin{proof}[\bf Proof]
Set $B_n = \bigcap_{m\geq n}A_m$, then $B_n\subseteq B_{n+1}$
\be
\mu(B_n)\leq \inf_{m\geq n}\mu(A_m) \ \ra \ \lim_{n\to\infty}\mu(B_n)\leq \lim_{n\to\infty} \inf_{m\geq n}\mu(A_m)
\ee
We know that $B_n\uparrow \bigcup\limits_n B_n = \bigcup\limits_n \bigcap\limits_{m\geq n}A_m = \lim\inf A_n\ \ra \ \lim\limits_{n\to \infty}\mu(B_n)= \mu\lob \liminf A_n\rob \ \ra \ \mu(\liminf A_n)\leq \liminf \mu(A_n)$.

Now we have $E\backslash \limsup A_n = \liminf (E\backslash A_n)$, then
\be
\mu(E\backslash \lim\sup A_n) = \mu(\lim\inf (E\backslash A_n)) \leq \lim \inf \mu(E\backslash A_n) 
%= \lim \inf \mu(A_n^c)  = \lim \sup \mu(A_n)
\ee

If $\mu(E)<\infty$, $\mu(E)- \mu(\lim\sup A_n) \leq \mu(E) + \lim \inf (-\mu(A_n)) = \mu(E) - \lim \sup \mu(A_n)$. 

Then, we have $\mu(\lim \sup A_n)\geq \lim \sup \mu(A_n)$.
\end{proof}

\begin{example}
The second inequality of Fatou's Lemma may fail if $\mu$ is not finite. If $\mu$ is counting measure on $E=\N$, $A_n = \{n,n+1,\dots\}$, then $\mu(A_n)=\infty$,
\beast
\mu\bb{\limsup_n A_n} & = & \mu\lob \bigcap_n\bigcup_{m\geq n} A_m \rob = \mu\lob \lob \bigcup_n\bigcap_{m\geq n}A_m^c\rob^c\rob = \mu\lob \lob \bigcup_n\bigcap_{m\geq n}\{1,\dots,m-1\}\rob^c\rob \\
& = & \mu\lob \lob \bigcup_n\{1,\dots,n-1\}\rob^c\rob =  \mu\lob \{1,2,\dots\} ^c\rob = \mu(E^c) = \mu(\emptyset) = 0.
\eeast
Also, $\lim \sup \mu(A_n) = \lim \sup \infty = \infty \ \ra \ \mu(\lim \sup A_n) < \lim \sup \mu(A_n)$.
\end{example}

\begin{definition}
Let $E$ be a countable set and let $\sE=\sP(E)$. A mass function\index{mass function} is any function $m:E\to [0,\infty]$.
\end{definition}

If $\mu$ is a measure on $(E,\sE)$, then, by countable additivity
\be
\mu(A) = \sum_{x\in A}\mu(\{x\}),\quad A\subseteq E.
\ee

So there is a one-to-one correspondence between measures and mass functions, given by 
\be
m(x) = \mu(\{x\}),\quad\quad \mu(A) = \sum_{x\in A}m(x).
\ee

This sort of measure space provides a 'toy' version of the general theory, where each of the results we prove for general measure spaces reduces to some straightforward fact about the convergence of series. This is all one needs to do elementary discrete probability and discrete-time Markov chains, so these topics are usually introduced without discussing measure theory.

Discrete measure theory is essentially the only context where one can define a measure explicitly, because, in general, $\sigma$-algebras are not amenable to an explicit presentation which allow us to make such a definition. Instead one specifies the values to be taken on some smaller set of subsets, which generates the $\sigma$-algebra. 

This gives rise to two problems: first to know that there is a measure extending the given set function, second to know that there is not more than one. The first problem, which is one of construction, is often dealt with by Carath\'eodory's extension theorem. The second problem, that of uniqueness, is often dealt with by Dynkin's $\pi$-system lemma.

\subsection{Existence and Uniqueness}

\begin{definition}\label{def:outer_measure}
Let $\sA$ be a ring of subsets of $E$ and let $\mu:\sA\to[0,\infty]$ be a countably additive set function. For any $B\subseteq E$, define outer measure\index{outer measure} $\mu^*$,
\be
\mu^*(B) = \inf_{A_n}\sum_n \mu(A_n)
\ee
where the infimum is taken over all sequences $(A_n:n\in\N)$ in $\sA$ such that $B\subseteq \bigcup_n A_n$ and is taken to be $\infty$ if there is no such sequence. 
\end{definition}

\begin{proposition}
Let $\sA$ be a ring of subsets of $E$ and $\mu:\sA\to[0,\infty]$ be a countably additive set function. If $\mu^*$ is an outer measure, then $\mu^*$ is increasing and $\mu^*(\emptyset)=0$.
\end{proposition}

\begin{proof}[\bf Proof]
For $\mu^*(\emptyset)=0$, we simply let $A_n=\emptyset$ for all $n$. Now we prove $\mu^*$ is increasing. For $B,B'\in \sA$ with $B\subseteq B'$, 
\ben
\item [(i)] If we can not find a sequence $A_n$ such that $B\subseteq \bigcup_n A_n$, then we can not find a sequence $A_n'$ such that $B'\subseteq \bigcup_n A_n'$ either, otherwise $B\subseteq \bigcup_n A_n'$. Thus, $\mu^*(B)=\mu^*(B') = \infty$.

\item [(ii)] If we can find a sequence $A_n$ such that $B\subseteq \bigcup_n A_n$ but we can not find a sequence $A_n'$ such that $B'\subseteq \bigcup_n A_n'$, $\mu^*(B') = \infty$, which gives $\mu^*(B)\leq \mu^*(B')$.

\item [(iii)] If we can find a sequence $A_n'$ such that $B'\subseteq \bigcup_n A_n'$, then we can find a sequence $A_n$ such that $B\subseteq \bigcup_n A_n$. For any sequence $A_n'$, we have $B\subseteq \bigcup_n A_n'$, thus $\{A_n',n\in\N\} \subseteq \{A_n,n\in\N\}$. Then we have
\be
\mu^*(B) = \inf_{A_n}\sum_n \mu(A_n) \leq \inf_{A_n'}\sum_n \mu(A_n') = \mu^*(B').	
\ee
Thus $\mu^*$ is increasing for any case.
\een
\end{proof}

\begin{theorem}[Carath\'eodory's Extension Theorem\index{Carath\'eodory's Extension Theorem}]\label{thm:caratheodory_extension}
Let $\sA$ be a ring of subsets of $E$ and let $\mu:\sA\to[0,\infty]$ be a countably additive set function. Then $\mu$ extends to a measure on the $\sigma$-algebra generated by $\sA$.
\end{theorem}

\begin{proof}[\bf Proof]
Let $\mu^*$ be a outer measure defined in Definition \ref{def:outer_measure} and we say that $A\subseteq E$ is $\mu^*$-measurable if, for all $B\subseteq E$, 
\be
\mu^*(B) = \mu^*(B\cap A) + \mu^*(B\cap A^c).
\ee

Write $\sM$ for the set of all $\mu^*$-measurable sets. We shall show that $\sM$ is a $\sigma$-algebra containing $\sA$ and that $\mu^*$ is a measure on $\sM$, extending $\mu$. This will prove the theorem.

\hspace{-5.5mm}{\bf Step I. We show that $\mu^*$ is countably subadditive.} Suppose that $B\in E$, $B_n\in E$ and $B\subseteq \bigcup_n B_n$. If $\mu^*(B_n) = \infty$ for some $n$, 
\be
\mu^*\bb{\bigcup_n B_n} \leq \infty = \sum_n \mu^*(B_n).
\ee

If $\mu^*(B_n)< \infty$ for all $n$, then given $\ve>0$, there exist sequences $(A_{nm}:m\in \N)$ in $\sA$, with
\be
\underbrace{B_n\subseteq \bigcup_m A_{nm}}_{\text{definition of $\mu^*$}}, \quad\quad \underbrace{\mu^*(B_n) + \ve/2^n \geq \sum_m \mu(A_{nm})}_{\text{definition of infimum}}.
\ee

Then $B \subseteq \bigcup_n B_n \subseteq \bigcup_n \bigcup_m A_{nm}$ implies that

\be
\mu^*(B) = \underbrace{\inf \sum_n \mu(A_n) = \inf \sum_n\sum_m \mu(A_{nm})}_{\N\times \N \text{ is countable}}\leq \sum_n\sum_m \mu(A_{nm}) \leq \sum_n \bb{\mu^*(B_n) + \ve/2^n} = \sum_n \mu^*(B_n) + \ve.
\ee

Hence, in any case,
\be
\mu^*(B) \leq \sum_n \mu^*(B_n) \ \ra \ \mu^*\bb{\bigcup_n B_n}\leq \sum_n \mu^*(B_n).
\ee

\hspace{-5.5mm}{\bf Step II. We show that $\mu^*$ extends $\mu$.} Since $\sA$ is a ring and $\mu$ is countably additive,  we have $\mu$ is countably subadditive and increasing by using Lemma \ref{lem:countably_subadditive_increasing}. Hence, for $A\in \sA$ and any sequence $(A_n:n\in\N)\in \sA$ with $A\subseteq \bigcup_nA_n$, 

\be
\mu(A)\underbrace{\leq}_{\mu \text{ is increasing}} \mu\bb{\bigcup_nA_n} \underbrace{\leq}_{\mu \text{ is countably subadditive}} \sum_n \mu(A_n)
\ee

On taking the infimum over all such sequences, we see that $\mu(A) \leq \mu^*(A)$. On the other hand, Set the sequence to be $B_1=A,B_2=\emptyset,B_3=\emptyset,\dots$, we have $A\subseteq \bigcup_n B_n$
\be
\mu^*(A) = \inf_{A_n}\sum_n \mu(A_n) \leq \sum_n \mu(B_n) = \mu(A).
\ee

Thus, $\mu(A) = \mu^*(A)$ for all $A\in\sA$.

\hspace{-5.5mm}{\bf Step III. We show that $\sM$ contains $\sA$.} To show $\sA\subseteq \sM$, we have to show that $\forall A\in\sA$, $B\subseteq E$, $\mu^*(B) = \mu^*(B\cap A) + \mu^*(B\cap A^c)$. By countable subadditivity of $\mu^*$,
\be
\mu^*(B) = \mu^*\bb{(B\cap A)\cup (B\cap A^c)} \leq \mu^*(B\cap A) + \mu^*(B\cap A^c).
\ee
so it is enough to show that 
\be
\mu^*(B) \geq \mu^*(B\cap A) + \mu^*(B\cap A^c).
\ee

If $\mu^*(B)=\infty$, this is clearly true, so let us assume that $\mu^*(B)<\infty$. Then given $\ve>0$, we can find a sequence $(A_n:n\in\N)\in \sA$ such that
\be
\underbrace{B \subseteq \bigcup_n A_n}_{\text{definition of $\mu^*$}},\quad\quad \underbrace{\mu^*(B)+\ve \geq \sum_n \mu(A_n)s}_{\text{definition of infimum}}\quad\ra\quad 
B\cap A \subseteq \bigcup_n (A_n \cap A),\quad\quad B\cap A^c \subseteq \bigcup_n (A_n \cap A^c).
\ee

Since $A_n \cap A \in \sA$ and $A_n \cap A^c = A_n \bs A \in \sA$,
\beast
\mu^*(B\cap A) + \mu^*(B\cap A^c) & = & \inf_{A_n\cap A} \sum_n \mu\bb{A_n \cap A} + \inf_{A_n\cap A^c} \sum_n \mu\bb{A_n \cap A^c}\\
& \leq & \sum_n \bb{\underbrace{\mu\bb{A_n \cap A} + \mu\bb{A_n \cap A^c}}_{\text{two disjoint sets}}}= \underbrace{\sum_n \mu\bb{A_n}}_{\text{countably additive}} \leq \mu^*(B)+\ve.
\eeast

Since $\ve>0$ was arbitrary, we are done.

\hspace{-5.5mm}{\bf Step VI. We show that $\sM$ is an algebra.} Clearly $E\in \sM$ and $A^c\in \sM$ whenever $A\in \sM$. Suppose that $A_1,A_2\in \sM$ and $B\subseteq E$. Then
\beast
\mu^*(B) & \stackrel{A_1\in \sM}{=} & \mu^*(B\cap A_1) + \mu^*(B\cap A_1^c) \stackrel{A_2\in \sM}{=} \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap A_1 \cap A_2^c) + \mu^*(B\cap A_1^c)\\
& = & \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap \bb{\emptyset \cup \bb{A_2^c\cap A_1}}) + \mu^*(B\cap \bb{A_1^c \cup (A_1^c \cap A_2^c)})\\
& = & \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap \bb{\bb{A_1^c\cap A_1}  \cup \bb{A_2^c\cap A_1}}) + \mu^*(B\cap \bb{(A_1^c \cup A_1^c) \cap (A_1^c \cup A_2^c)})\\
& = & \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap \bb{A_1^c\cup A_2^c}\cap A_1) + \mu^*(B\cap A_1^c \cap (A_1^c \cup A_2^c))\\
& = & \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap \bb{A_1\cap A_2}^c \cap A_1) + \mu^*(B \cap \bb{A_1\cap A_2}^c \cap A_1^c )\\
& \stackrel{A_1\in \sM}{=} & \mu^*(B\cap A_1\cap A_2) + \mu^*(B\cap \bb{A_1\cap A_2}^c) 
\eeast
Hence, $A_1 \cap A_2 \in \sM$. Then we can have $A_1\cup A_2 \in \sM$, thus $\sM$ is an algebra.

\hspace{-5.5mm}{\bf Step V. We show that $\sM$ is a $\sigma$-algebra and that $\mu^*$ is a measure on $\sM$.} We already know that $\sM$ is an algebra, so it suffices to show that, for any sequence of disjoint sets $(A_n:n\in \N)$ in $\sM$, for $A=\bigcup_n A_n$ we have
\be
A \in \sM,\quad\quad \mu^*\bb{\bigcup_n A_n} = \mu^*(A) = \sum_n \mu^*(A_n).
\ee

So take any $B\subseteq E$, then
\beast
\mu^*(B) & \stackrel{A_1\in \sM}{=} & \mu^*(B\cap A_1) + \mu^*(B\cap A_1^c) \stackrel{A_2\in \sM}{=} \mu^*(B\cap A_1) + \mu^*(B\cap A_1^c \cap A_2) + \mu^*(B\cap A_1^c \cap A_2^c) \\
& = & \mu^*(B\cap A_1) + \mu^*(B\cap A_2) + \mu^*(B\cap A_1^c \cap A_2^c) \quad\quad\quad\quad(A_1, A_2\text{ are disjoint})\\
& = & \dots = \sum^n_{i=1} \mu^*(B\cap A_i) + \mu^*(B\cap A_1^c \cap A_2^c \cap \dots \cap A_n^c) = \sum^n_{i=1} \mu^*(B\cap A_i) + \mu^*\bb{B\cap \bb{\bigcap^n_{i=1}A_i^c}}.
\eeast

Since $A = \bigcup_n A_n$, 
\be
A^c = \bigcap_n A_n^c \ \ra \ B\cap A^c = B\cap \bb{\bigcap_n A_n^c} \subseteq B\cap \bb{\bigcap^n_{i=1}A_i^c} \ \ra \ \mu^*\bb{B\cap A^c} \leq \mu^*\bb{B\cap \bb{\bigcap^n_{i=1}A_i^c}},
\ee
for all $n$ since $\mu^*$ is increasing. Hence, we get
\beast
\mu^*(B) & = & \sum^n_{i=1} \mu^*(B\cap A_i) + \mu^*\bb{B\cap \bb{\bigcap^n_{i=1}A_i^c}}\\
& \geq & \sum^n_{i=1} \mu^*(B\cap A_i) + \mu^*\bb{B\cap A^c} = \sum_n \mu^*(B\cap A_n) + \mu^*\bb{B\cap A^c} \quad\quad \text{as }n\to\infty\\
& \geq & \mu^*\bb{\bigcup_n (B\cap A_n)} + \mu^*\bb{B\cap A^c} \quad\quad\quad\quad(\mu^*\text{ is countably additive})\\
& = & \mu^*\bb{B\cap \bb{\bigcup_n A_n}} + \mu^*\bb{B\cap A^c} = \mu^*\bb{B\cap A} + \mu^*\bb{B\cap A^c}.
\eeast

Also, using countable subadditivity, we have
\be
\mu^*(B) \leq \mu^*\bb{B\cap A} + \mu^*\bb{B\cap A^c} \ \ra \ \mu^*(B) = \mu^*\bb{B\cap A} + \mu^*\bb{B\cap A^c}
\ee

Thus, $A\in \sM$. Then setting $B=A$, we get
\beast
\mu^*(B) & = & \sum^n_{i=1} \mu^*(B\cap A_i) + \mu^*\bb{B\cap \bb{\bigcap^n_{i=1}A_i^c}}\\
\mu^*(A) & = & \sum^n_{i=1} \mu^*(A\cap A_i) + \mu^*\bb{A\cap \bb{\bigcap^n_{i=1}A_i^c}} = \sum_n \mu^*(A\cap A_n) + \mu^*\bb{A\cap \bb{\bigcup_nA_n}^c}\quad\quad \text{as }n\to\infty\\
& = & \sum_n \mu^*(A_n) + \mu^*\bb{A\cap A^c} = \sum_n \mu^*(A_n) + \mu^*\bb{\emptyset} = \sum_n \mu^*(A_n),
\eeast
as $\mu^*\bb{\emptyset}=0$. 
\end{proof}

\begin{theorem}[uniqueness of extension\index{uniqueness of extension!measure}]\label{thm:uniqueness_of_extension_measure}
Let $\mu_1$, $\mu_2$ be measures on $(E,\sE)$ with $\mu_1(E)=\mu_2(E)<\infty$. Suppose $\mu_1=\mu_2$ on $\sA$, for some $\pi$-system $\sA$ generating $\sE$. Then $\mu_1=\mu_2$ on $\sE$.
\end{theorem}

\begin{proof}[\bf Proof]
Consider $\sD = \{A\in\sE:\mu_1(A) = \mu_2(A)\}$, which gives $\sA \subseteq \sD$ and $\sD\subseteq \sE$. By hypothesis, $E\in \sD$. For $A,B\in\sD$ with $A\subseteq B$, we have $A,B\in \sE$ and $B\bs A\in \sE$. Then we have
\be
\mu_1(A) + \mu_1(B\bs A)= \mu_1(B) < \infty,\quad \mu_2(A) + \mu_2(B\bs A)= \mu_2(B) < \infty \ \ra \ \mu_1(B\bs A) = \mu_2(B\bs A)\ \ra \ B\bs A\in\sD. 
\ee

Now suppose that $A_n\in \sD, n\in\N$ with $A_n \uparrow A$, thus $A_n \in\sE \ \ra \ \bigcup_n A_n \in \sE$. Then by Lemma \ref{lem:measure_increasing_sequence},
\be
\mu_1(A) = \lim_n \mu_1(A_n) \underbrace{=}_{A_n \in \sD} \lim_n \mu_2(A_n) = \mu_2(A) \ \ra \ A\in \sD.
\ee

Thus $\sD$ is a $d$-system containing the $\pi$-system $\sA$. We apply Dynkin's Lemma (Lemma \ref{lem:dynkin_lemma}) and get that $\sD$ is a $\sigma$-algebra containing $\sA$. Since $\sD \subseteq \sE$ and $\sE$ is the smallest $\sigma$-algebra (by definition of $\sE$) containing $\sA$, we have $\sD = \sE$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Measure notations}

\begin{definition}\label{def:borel_measure}
A measure $\mu$ on $(E,\sB(E))$ is called Borel measure\index{Borel measure} on $(E,\sB(E))$.
\end{definition}

Recall $\sigma$-finite measure and Borel measurable space (Definition \ref{def:sigma_finite_measure}, \ref{def:borel_measurable_space}), we have following definitions with respect to topology:

\begin{definition}\label{def:locally_finite_measure}
Let $\mu$ be $\sigma$-finite measure on $(E,\sE)$. It is called locally finite\index{locally finite!measure} if for any $x\in E$, there exists an open neighourhood $U$, such that $x\in U$ and $\mu(U) < \infty$.
\end{definition}

\begin{definition}\label{def:inner_regular_measure}
Let $\mu$ be $\sigma$-finite measure on $(E,\sE)$. It is called inner regular\index{inner regular measure} if
\be
\mu(A) = \sup\bra{\mu(K):K\subseteq A\text{ is compact}},\quad \forall A\in \sE.
\ee
\end{definition}

\begin{definition}\label{def:outer_regular_measure}
Let $\mu$ be $\sigma$-finite measure on $(E,\sE)$. It is called outer regular\index{outer regular measure} if
\be
\mu(A) = \inf\bra{\mu(U):U\text{ is open}, A\subseteq U},\quad \forall A\in \sE.
\ee
\end{definition}

\begin{definition}\label{def:regular_measure}
Let $\mu$ be $\sigma$-finite measure on $(E,\sE)$. It is called regular measure\index{regular measure} if it is inner regular and outer regular.
\end{definition}

\begin{definition}
Let $\mu$ be $\sigma$-finite measure on $(E,\sE)$. It is called a Radon measure\index{Radon measure} if it is inner regular, locally finite Borel measure.
\end{definition}

\begin{definition}
We introduce the following spaces of measures\index{spaces of measures} on $E$ (in \cite{Klenke_2008}): 
\beast
\sM_R(E) := \bra{\text{Radon measures on }(E,\sB(E))}, & \quad\quad&  \sM_f(E) := \bra{\text{finite Borel measures on }(E,\sB(E))}.%\sM_1(E) := \bra{\mu \in \sM_f(E):\mu(E)=1}, \quad & \quad\quad & \sM_{\leq 1}(E) := \bra{\mu \in \sM_f(E):\mu(E)\leq 1}.
\eeast%The element of $\sM_1(E)$ are called probability measures (see Definition \ref{def:probability_space}) and $\sM_{\leq 1}(E)$ are called sub-probability measures\index{sub-probability measure} on $E$.
\end{definition}

\begin{definition}
Furthermore, we agree on the following notations for spaces of continuous functions:
\beast
& C(E) := \bra{f:E\to \R \text{ is continuous}},\quad\quad C_b(E) := \bra{f\in C(E) \text{ is bounded}},\\
&\qquad\qquad C_c(E) := \bra{f\in C(E) \text{ has compact support}}\subseteq C_b(E).
\eeast
\end{definition}

\begin{remark}
Recall that the support of a real function $f$ is $\ol{f^{-1}(\R\bs\bra{0})}$.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Lebesgue measure}

Recall Definition \ref{def:borel_measure}, we have

\begin{theorem}\label{thm:lebesgue_measure}
There exists a unique Borel measure $\mu$ on $\R$ such that, for all $a,b\in \R$ with $a<b$,
\be
\mu((a,b]) = b-a.
\ee
The measure $\mu$ is called Lebesgue measure\index{Lebesgue measure} on $\R$.\footnote{For $\R^n$ case, $\mu(A)$}
\end{theorem}

\begin{proof}[\bf Proof]
(Existence.) Consider the ring $\sA$ of finite unions of disjoint intervals of the form $A = (a_1, b_1] \cup \dots\cup (a_n, b_n]$. 

We note that $\sA$ generates $\sB$. Define for such $A \in \sA$, the set function
\be
\mu(A) = \sum^n_{i=1} (b_i - a_i).
\ee

Note that the presentation of $A$ is not unique, as $(a, b] \cup (b, c] = (a, c]$ whenever $a < b < c$. Nevertheless, it is easy to check that $\mu$ is well-defined and additive. We aim to show that $\mu$ is countably additive on $\sA$, which then proves existence by Carath\'eodory's extension theorem.

By additivity, it suffices to show that, if $A \in \sA$ and if $(A_n : n \in \N)$ is an increasing sequence in $\sA$ with $A_n \ua A$, then $\mu(A_n) \to \mu(A)$ (by fundamental property of measure, Lemma \ref{lem:measure_increasing_sequence}). Set $B_n = A \bs A_n$ then $B_n \in \sA$ and $B_n \da \emptyset$. By additivity again, it suffices to show that $\mu(B_n) \to 0$. Suppose, in fact,
that for some $\ve > 0$, we have $\mu(B_n) \geq 2\ve$ for all $n$. For each $n$ we can find $C_n \in \sA$ with $\ol{C}_n \subseteq B_n$ and $\mu(B_n \bs C_n) \leq \ve 2^{-n}$ (since $B_n\bs C_n\in \sA$), where $\ol{C}_i$ is the closure of $C_i$. That is, for 
\be
B_n = (a_1,b_1] \cup \dots \cup (a_m,b_m]
\ee
where $m$ is finite by definition, we can find $m'\leq m$ (for case that $a_i + \frac{\ve 2^{-n}}m \geq b_i $) and choose 
\be
C_n = \left(a_1 + \frac{\ve 2^{-n}}m, b_1\right]\bigcup \dots \bigcup \left(a_{m'} + \frac{\ve 2^{-n}}m, b_{m'}\right].
\ee

Thus, $\mu(B_n \bs C_n) = \underbrace{\mu(B_n) - \mu(C_n)}_{\text{by additivity of }\mu} = \underbrace{\sum^m_{i=1} (b_i - a_i) - \sum^{m'}_{i=1} \bb{b_i - a_i - \frac{\ve 2^{-n}}m}}_{\text{definition of }\mu} \leq \sum\limits^m_{i=1} \frac{\ve 2^{-n}}m = \ve 2^{-n}$. Then
\be
\mu(B_n \bs (C_1 \cap \dots\cap C_n)) \leq \mu((B_1 \bs C_1) \cup \dots\cup (B_n \bs C_n)) \leq \sum_{n \in\N} \ve 2^{-n} = \ve.
\ee

Since $\mu(B_n) \geq 2\ve$, we must have $\mu(C_1 \cap \dots\cap C_n) \geq \ve$, so $C_1 \cap \dots\cap C_n \neq \emptyset$ (definition of the set function), and so $K_n = \ol{C}_1 \cap \dots \cap \ol{C}_n \neq \emptyset$. Now $(K_n : n \in \N)$ is a decreasing sequence of bounded non-empty closed sets in $\R$ (since the intersect of closed sets is closed), so $\emptyset\neq \bigcap_nK_n \subseteq \bigcap_n B_n$, which is a contradiction.

(Uniqueness.) Let $\mu$, $\lm$ be two measures on $\sB(\R)$ with 
\be
\mu((a, b]) = b - a,\quad\quad \lm((a, b]) = b - a,\quad\quad
\ee
for all $a < b$. Fix $n$ and consider $A\in \sA$
\be
\mu_n(A) = \mu((n, n + 1] \cap A), \quad\quad \lm_n(A) = \lm((n, n + 1] \cap A).
\ee

Then we have $\mu_n$ and $\lm_n$ are measures on $\sB$ with $\mu_n(\R)=\lm_n(\R) = 1<\infty$ since with disjoint sets $A_n$,
\beast
\mu_n \bb{\bigcup_m A_m} & = & \mu\bb{(n,n+1] \cap \bigcup_m A_m} = \mu\bb{ \bigcup_m (n,n+1] \cap A_m} = \mu\bb{ \bigcup_m B_m} \\
& = & \sum_m \mu(B_m) = \sum_m \mu\bb{(n,n+1] \cap A_m} = \sum_m \mu_n\bb{A_m}
\eeast
where $B_m := (n,n+1] \cap A_m$ are disjoint. So $\mu_n = \lm_n$ on the $\pi$-system of intervals of the form $(a, b]$, which generates $\sB$. So, by Theorem \ref{thm:uniqueness_of_extension_measure} (Uniqueness of extension), $\mu_n = \lm_n$ on $\sB$. Hence, for all $A \in \sB$, we have
\be
\mu(A) = \underbrace{\mu(\R\cap A) = \sum\limits_n \mu\bb{(n, n + 1] \cap A}}_{\text{countable additivity of }\mu} = \sum\limits_n \mu_n(A) = \sum\limits_n \lm_n(A) = \underbrace{\sum\limits_n \lm\bb{(n, n + 1] \cap A} = \lm(\R\cap A) }_{\text{countable additivity of }\lm} = \lm(A).
\ee

Note that you cannot apply uniqueness of extension (Theorem \ref{thm:uniqueness_of_extension_measure}) directly to $\mu$ since $\mu(\R)$ is not finite.
\end{proof}

\begin{proposition}\label{pro:singleton_point_measure}
For Lebesgue measure space $(E,\sE,\mu)$ and singleton point $x$, $\mu(\{x\}) = 0$. 
\end{proposition}
\begin{proof}[\bf Proof]
For Lebesgue measure $\mu$, we have for any $a<b$, $\mu((a,b]) = b-a$. Now fix $b$ and let $a<b-1$ and define 
\be
A_n := \left(a,b-\frac 1n\right] \quad\ra\quad A_n \ua \bb{a,b} := A.
\ee
By fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}),
\beast
\lim_n\mu\bb{A_n} = \mu\bb{A} \quad \ra \quad \lim_n \mu\bb{\left(a,b-\frac 1n\right]} & = & \mu\bb{(a,b)} = \mu\bb{(a,b]} - \mu(\{b\})\\
\lim_n \bb{b-\frac 1n - a} & = & b-a - \mu(\{b\}) \quad\ra\quad \mu(\{b\}) = \lim_n \frac 1n = 0. 
\eeast
\end{proof}

\begin{remark}[Existence of a non-Lebesgue-measurable subset of $\R$]
For $x, y \in [0, 1)$, let us write $x \sim y$ if $x-y \in \Q$. Then $\sim$ is an equivalence relation. Using the Axiom of Choice, we can find a subset $S$ of $[0, 1)$ containing exactly one representative of each equivalence class. Set $Q = \Q \cap [0, 1)$ and, for each $q \in Q$, define $S_q = S + q = \{s + q (\bmod 1): s \in S\}$. It is an easy exercise to check that the sets $S_q$ are all disjoint and their union is $[0, 1)$.

Now, Lebesgue measure $\mu$ on $\sB = \sB([0, 1))$ is translation invariant. That is to say, $\mu(B) = \mu(B + x)$ for all $B \in \sB$ and all $x \in [0, 1)$. If $S$ were a Borel set, then we would have
\be
1 = \mu([0, 1)) = \sum_{q\in Q} \mu(S + q) = \sum_{q\in Q} \mu(S)
\ee
which is impossible. Hence $S\notin \sB$.

A Lebesgue measurable set in $\R$ is any set of the form $A \cup N$, with A Borel and $N \subseteq B$ for some Borel set $B$ with $\mu(B) = 0$. Thus the set of Lebesgue measurable sets is the completion of the Borel $\sigma$-algebra with respect to $\mu$. 
\end{remark}

\begin{proposition}\label{pro:borel_set_symmetric_difference}
For every Borel set $B\subseteq\R$ of finite Lebesgue measure and every $\ve>0$, there exists a finite union of disjoint intervals $A=(a_1,b_1]\cup\dots\cup(a_n,b_n]$ such that the Lebesgue measure of symmetric difference $A\triangle B (=(A^c\cap B)\cup(A\cap B^c))$ is less than $\ve$.
\end{proposition} 

\begin{proof}[\bf Proof]
First let $\mu$ be Lebesgue measure on $(\R,\sB)$ and let
\be
\sA_n = \left\{\lob (a_1,b_1]\cup \dots \cup (a_m,b_m]\rob \cap [-n,n]:\ a_1,\dots,a_m,b_1,\dots,b_m \in \R, m \text{ is finite} \right\}
\ee
Then it is obvious that $\sA_n$ is a $\pi$-system (also a ring) with $\sigma(\sA_n)=\sB([-n,n])$ (the Borel $\sigma$-algebra on $[-n,n]$). Let
\be
\sD_n = \left\{B\in \sB([-n,n]): \forall \ve>0,\ \exists A\in \sA_n,\ \mu(A\triangle B)<\ve \right\}.
\ee
It is clear that $\sA_n\subseteq\sD_n\subseteq \sB([-n,n])$. We shall show that $\sD_n$ is a $d$-system on $[-n,n]$. Then by Dynkin's lemma we will have that $\sB([-n,n]) \subseteq\sD_n $. Thus, $\sD_n = \sB([-n,n])$. Thus,

\ben
\item [(i)] For $A=B=[-n,n]$, $\mu\lob A\triangle B \rob = \mu\lob (A^c\cap B)\cup(A\cap B^c) \rob = \mu\lob \emptyset \cup \emptyset \rob = 0<\ve$.
\item [(ii)] Suppose $A_1,A_2\in \sD_n$ with $A_1\subseteq A_2$. We know that $\forall \ve$, $\exists A_1',A_2'\in \sA_n$
\be
\mu\lob A_1'\triangle A_1)\rob<\frac{\ve}2,\quad \mu\lob A_2'\triangle A_2)\rob<\frac{\ve}2 
\ee
then $A_2'\backslash A_1'\in \sA_n$ since $\sA_n$ is a ring. Thus, $\exists A = A_2'\backslash A_1'\in \sA_n$
\beast
A\triangle \lob A_2\backslash A_1\rob & = & \lob A_2'\backslash A_1' \rob \triangle \lob A_2\backslash A_1\rob \subseteq \lob A_2'\triangle A_1' \rob \triangle \lob A_2\triangle A_1\rob \\
& = & \lob A_1'\triangle A_1 \rob \triangle \lob A_2'\triangle A_2\rob \quad \quad(\text{$\triangle$ is commutative and associative})\\
& \subseteq & \lob A_1'\triangle A_1 \rob \cup \lob A_2'\triangle A_2\rob
\eeast
Thus, we have $\mu \lob A\triangle \lob A_2\backslash A_1\rob\rob \leq \mu\lob \lob A_1'\triangle A_1 \rob \cup \lob A_2'\triangle A_2\rob \rob \leq \mu\lob A_1'\triangle A_1)\rob + \mu\lob A_2'\triangle A_2)\rob < \ve \ \ra \ A_2\backslash A_1 \in \sD_n$.

\item [(iii)] Suppose $\{A_m:m\in \N\}$ is an increasing sequence in $\sD_n$ with $A_m\uparrow \bigcup\limits_nA_n = A$. Then $A\backslash A_m\downarrow \emptyset$. Since $\mu$ is finite on $[-n,n]$ and countably additive. From the previous question (4), we have
\be
\bigcap_n\lob A\backslash A_n\rob = A \left\backslash\lob \bigcup_nA_n\rob\right. = A\backslash A = \emptyset \ \ra \ \mu\lob A\backslash A_n \rob \to 0.
\ee
Thus, $\forall \ve$, $\exists N$ s.t. $A_N\in \sD_n,\ \mu\lob A\backslash A_N \rob < \frac {\ve}2$. Since $A_N\in\sD_n$, $\exists A_N'\in \sA_n$ s.t. $\mu\lob A_N'\triangle A_N \rob < \frac {\ve}2$.

Thus, we have $A\triangle A_N' = A\triangle A_N \triangle A_N\triangle A_N' = \lob A\triangle A_N \rob \triangle \lob A_N\triangle A_N'\rob = \underbrace{\lob A\backslash A_N \rob \triangle \lob A_N\triangle A_N'\rob }_{\text{since $A_N\subseteq A$}} \subseteq \lob A\backslash A_N \rob \cup \lob A_N\triangle A_N'\rob$.

Then, we have $\mu \lob A\triangle A_N'\rob \leq \mu \lob A\backslash A_N \rob \cup \lob A_N\triangle A_N'\rob \leq \mu\lob A\backslash A_N \rob + \mu\lob A_N\triangle A_N' \rob < \ve \ \ra \ A=\bigcup_n A_n \in \sD_n$.
\een

Thus, we say that $\sD_n$ is a $d$-system and $\sD_n=\sB([-n,n])$. Now, for any $B\in \sB$ with $\mu(B)<\infty$, set $B_n=B\cap[-n,n]$. Then $B_n\uparrow B$ and $B\backslash B_n\downarrow \emptyset$. So $\mu\lob B\backslash B_n\rob\to 0$. Then $\forall \ve$, $\exists N$ s.t. $\mu\lob B\backslash B_N\rob < \frac {\ve}2$. Also, we have $B_N\in \sD_N$, so $\exists A_N\in \sA_N$ s.t. 
\be
\mu\lob A_N\triangle B_N\rob < \frac {\ve}2.
\ee

Hence, $A_N\triangle B = \lob A_N\triangle B_N\rob \triangle \lob B_N\triangle B\rob = \lob A_N\triangle B_N\rob \triangle \lob B\backslash B_N\rob\subseteq \lob A_N\triangle B_N\rob \cup \lob B\backslash B_N\rob$, and 
\vspace{2mm}

$\quad\quad\quad\quad\mu\lob A_N\triangle B \rob \leq \mu\lob \lob A_N\triangle B_N\rob \cup \lob B\backslash B_N \rob\rob \leq \mu \lob A_N\triangle B_N \rob + \mu\lob B\backslash B_N\rob <\ve$.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Measurable Functions}

\subsection{Measurable functions}

\begin{definition}[measurable function\index{measurable function}, Borel function\index{Borel function}]\label{def:measurable_function}
Let $(E, \sE)$ and $(G, \sG)$ be measurable spaces. A function $f : E \to G$ is $\sE$-measurable (or $\sE$-$\sG$-measurable) if $f^{-1}(A) \in\sE$ whenever $A \in \sG$. Here $f^{-1}(A)$ denotes the inverse image\index{inverse image!measure} of $A$ by $f$
\be
f^{-1}(A) = \{x \in E : f(x) \in A\}.
\ee
\end{definition}

Usually $G = \R$ or $G = \RC = [-\infty,\infty]$, in which case $\sG$ is always taken to be the Borel $\sigma$-algebra. If $(E,\sT)$ is a topological space and $\sE = \sB(E)$, then a measurable function on $E$ is called a Borel function. 


\begin{proposition}\label{pro:pi_system_measurable}
In particular, if $\sG = \sigma(\sA)$ and $f^{-1}(A) \in \sE$ whenever $A \in \sA$ ($A$ is in a $\pi$-system $\sA$), then $\{A : f^{-1}(A) \in \sE\}$ is a $\sigma$-algebra containing $\sA$ and hence $\sG$, so $f$ is measurable. 
\end{proposition}

\begin{proposition}[inverse image preserves set operation]\label{pro:inverse_image_preserves_set_operation_measure}
The set $\{f^{-1}(A) : A \in \sG\}$ is a $\sigma$-algebra on $E$ and $\{A \subseteq G : f^{-1}(A) \in \sE\}$ is a $\sigma$-algebra on $G$.\footnote{should be in topology}
\end{proposition}

\begin{proof}[\bf Proof]
For any function $f : E \to G$ and $A_i,A\subseteq B\in \sG$, we have $f^{-1}\bb{A^c} = E\left\bs f^{-1}\bb{A}\right. = \bb{f^{-1}\bb{A}}^c$, $f^{-1}\bb{A} \subseteq f^{-1}\bb{B}$. Also, by Proposition \ref{pro:inverse_image_preserves_set_operation} we have,
\be
f^{-1} \bb{\bigcup_i A_i} = \bigcup_i f^{-1}(A_i),\quad\quad f^{-1}(B \bs A) = f^{-1}(B) \left\bs f^{-1}(A)\right..
\ee

Therefore, for $\sE = \{f^{-1}(A) : A \in \sG\}$ and $A\subseteq B,A_i\in \sG$, we have $f^{-1}(A) \subseteq f^{-1}(B) \in \sE$, $f^{-1}\bb{A_i} \in \sE$ and 
\beast
B\bs A\in \sG,\quad \bigcup_i A_i\in \sG & \ra & f^{-1}\bb{B\bs A}\in \sE,\quad f^{-1}\bb{\bigcup_i A_i} \in \sE\\
& \ra & f^{-1}(B) \left\bs f^{-1}(A)\right. \in \sE,\quad  \bigcup_i f^{-1}(A_i) \in \sE
\eeast
Thus, $\{f^{-1}(A) : A \in \sG\}$ is a $\sigma$-algebra on $E$ and similar for $\{A \subseteq G : f^{-1}(A) \in \sE\}$.
\end{proof}

\begin{proof}[\bf Proof]
This is the direct result from Proposition \ref{pro:inverse_image_preserves_set_operation_measure} as $\sA$ is also a $d$-system.
\end{proof}

In the case $G = \R$, the Borel $\sigma$-algebra is generated by intervals of the form $(-\infty, y], y \in \R$, so, to show that $f : E \to \R$ is Borel measurable, it suffices to show that $\{x \in E : f(x) \leq y\} \in \sE$ for all $y$.\footnote{this should be a proposition. see Rogers-Williams\cite{Rogers_1994} I P89.}

\begin{proposition}\label{pro:continuous_measurable}
For topological space $(E,\sT)$, any continuous function $f : E \to \R$ is $\sB(E)$-measurable.
\end{proposition}

\begin{proof}[\bf Proof]
If $(E,\sB(E))$ is Borel measurable space and $f : E \to \R$ is continuous, then $f^{-1}(U)$ is open in $E$, whenever $U$ is open in $\R$ (Definition \ref{def:continuous_topological_space}). Thus, $f^{-1}(U)\in \sB(E)$ since $\sB(E)$ is generated by all the open sets in $E$ and hence any continuous function is measurable\footnote{see Rogers \& Williams I P90.}.
\end{proof}

\begin{definition}\label{def:sigma_algebra_generated_by_measurable_function}
Given any family of functions $f_i : E \to G, i \in I$, we can make them all measurable by taking
\be
\sE = \sigma\bb{f^{-1}_i (A) : A \in \sG, i \in I}.
\ee

Then $\sE$ is the $\sigma$-algebra generated by $(f_i : i \in I)$, and is often denoted by $\sigma(f_i, i \in I)$.
\end{definition}

\begin{definition}[indicator function]\label{def:indicator_function}
For $A \subseteq E$, the indicator function\index{indicator function} $\ind_A$ of $A$ is the function $\ind_A : E \to \{0, 1\}$ which takes the value 1 on $A$ and 0 otherwise, i.e.,
\be
\ind_A(x) = \left\{ \ba{ll}
1 \quad\quad & x \in A,\\
0 & x \notin A,
\ea\right.
\ee
\end{definition}

\begin{proposition}\label{pro:indicator_function}
Let $A$ and $B$ be two sets in $E$. Then%\beI_A(\omega) = \eeand $\ind_A$ is 1 or 0 according as the event $A$ occurs or does not occur. The following properties of indicator random variables should be noted for events $A$ and $B$:
\ben
\item [(i)] $\ind_{A^c} = 1 - \ind_A$.
\item [(ii)] $\ind_{A\cap B} = \ind_A\ind_B$.
\item [(iii)] $\ind_{A\cup B} = 1- (1 - \ind_A) (1 - \ind_B)$.
\item [(iv)] For sets $A_1,A_2,\dots,A_n$, (ii) and (iii) generalize to $\ind_{A_1\cap A_2\cap \dots\cap A_n} = \prod^n_{i=1} \ind_{A_i}$, and
\beast
\ind_{A_1\cup A_2\cup \dots \cup A_n} = 1 - \prod^n_{i=1} (1 - \ind_{A_i}) & = & \sum_i \ind_{A_i} - \sum_{i_1<i_2} \ind_{A_{i_1}} \ind_{A_{i_2}} + \sum_{i_1<i_2<i_3} \ind_{A_{i_1}} \ind_{A_{i_2}}\ind_{A_{i_3}} - \dots + (-1)^{n-1} \ind_{A_1}\dots \ind_{A_n} \\
& = & \sum_i \ind_{A_i} - \sum_{i_1<i_2} \ind_{A_{i_1}\cap A_{i_2}} + \sum_{i_1<i_2<i_3} \ind_{A_{i_1}\cap A_{i_2}\cap A_{i_3}} - \dots + (-1)^{n-1} \ind_{A_1 \cap \dots \cap A_n}.
\eeast
\een
\end{proposition}
%In the next section we see how this last relation 

\begin{proof}[\bf Proof]
Direct results from Definition \ref{def:indicator_function}.
\end{proof}

\begin{remark}
(iv) provides an alternate proof of the inclusion-exclusion formula (see Proposition \ref{pro:probability_property}).
\end{remark}



\begin{proposition}\label{pro:indicator_measurable}
The indicator function of any measurable set is a measurable function.
\end{proposition}
\begin{proof}[\bf Proof]
For any measurable set $A\in \sE$, we have $A^c\in\sE$,

{\bf Case 1}. If $y\geq 1$, we have $\{x \in E : \ind_A(x) \leq y\} = E \in \sE$,

{\bf Case 2}. If $y < 0$, we have $\{x \in E : \ind_A(x) \leq y\} = \{x \in E : \ind_A(x) > y\}^c = E \in \sE \ \ra \ \{x \in E : \ind_A(x) \leq y\} = \emptyset \in \sE$,

{\bf Case 3}. If $y \in [0,1)$, we have $\{x \in E : \ind_A(x) \leq y\} = A^c \in \sE$.
\end{proof}

\begin{proposition}\label{pro:composition_measurable}
The composition of measurable functions is measurable.
\end{proposition}
\begin{proof}[\bf Proof]
For the measurable spaces $(E,\sE)$, $(G,\sG)$, $(H,\sH)$ and the functions $f : E \to G$ and $g : G \to H$  are measurable if $f^{-1}(A) \in\sE$ whenever $A \in \sG$, $f^{-1}(B) \in\sG$ whenever $B \in \sH$ respectively. Thus, given $A = f^{-1}(B)$, $f^{-1}(A) \in\sE$ whenever $B \in \sH$, for the composition function $f\circ g : E\to H$ and hence it is measurable.
\end{proof}

In the following theorem, we agree that $\frac x0 := 0$ for all $x\in \R$.

\begin{theorem}\label{thm:measurable_function_property}
Let $f,g : E \to \R$, $n \in \N$ be $\sB(\R)$-measurable functions and $\lm \in \R$. Then so are $f^+$, $f^-$, $f+g$\footnote{what about countably many $f$?}, $fg$, $\lm f$ and $f/g$.
\end{theorem}

\begin{proof}[\bf Proof]
\ben
\item [(i)] $f^+ = \max\{f,0\} \geq 0$. We have for any $y\in \R$, if $y<0$, $\{x\in E: f^+(x) \leq y\} = \emptyset \in \sE$. For the case $y\geq 0$,
\be
\{x\in E: f^+(x) \leq y \} = \{x\in E: f^+(x) > y \}^c = \{x\in E: f(x)>y\}^c = \{x\in E: f(x)\leq y\} \in \sE
\ee
as $f$ is measurable. Thus, $f^+$ is measurable. Similarly, $f^-$ is measurable.

\item [(ii)] Note that
\be
\{f+g > y\} = \bigcup_{q\in\Q}\{f > q\}\cap \{g>y-q\} \ \ra \ f+g \text{ is measurable.}
\ee

\item [(iii)] Using the identity $ab = \frac 14\lob(a+b)^2 - (a-b)^2\rob$, it suffices to prove that $f^2$ is measurable whenever $f$ is. So
\beast
& & \{f^2 > y\} = E\ind_{\{y<0\}}\cup \{-\sqrt{y}<f<\sqrt{y}\}\ind_{\{y\geq 0\}} \\
& = & E\ind_{\{y<0\}}\cup \lob \{f<\sqrt{y}\}\cap \{f>-\sqrt{y}\}\rob\ind_{\{y\geq 0\}}\\
& = & E\ind_{\{y<0\}}\cup \lob \lob \bigcup_n \{f\leq \sqrt{y}-1/n\}\rob\cap \{f>-\sqrt{y}\}\rob\ind_{\{y\geq 0\}}\quad\ra\quad \text{$fg$ is measurable}. 
\eeast

\item [(iv)] For $\lm \in\R$,
\beast
\{\lm f> y\} & = & \{f>y/\lm\}\ind_{\{\lm >0\}} \cup \{f < y/\lm\}\ind_{\{\lm <0\}} \cup \{0>y\}\ind_{\{\lm =0\}}\\
& = & \{f>y/\lm\}\ind_{\{\lm >0\}} \cup \lob \bigcup_n \{f \leq y/\lm-1/n\}\ind_{\{\lm <0\}} \rob\cup \{0>y\}\ind_{\{\lm =0\}}\quad\ra\quad\text{$\lm f_1$ is measurable}.
\eeast

\item [(v)] From (iv), we only need to check that $1/g$ is measurable. Therefore, for any $y\in \R$
\be
\bra{1/g > y} = \bra{\bra{\bra{g>0}\cup \bra{g<1/y}\cup \bra{g=0}}\cap \bra{y<0}} \cup \bra{\bra{g>0}\cap \bra{y=0}} \cup \bra{\bra{g>1/y}\cap \bra{y>0}}
\ee

Thus, $1/g$ is measurable and we get the required result.
\een
\end{proof}

\begin{theorem}\label{thm:measurable_function_property_infinity}
Let $f,g : E \to \ol{\R}$, $n \in \N$ be $\sB\bb{\ol{\R}}$-measurable functions (see Klenke\cite{Klenke_2008}.$P_{39}$). Then the following function are measurable:
\be
\inf_n f_n,\quad \sup_n f_n,\quad \liminf_n f_n,\quad  \limsup_n f_n.
\ee

Also, for any sequence $(f_n:n\in\N)$ of measurable functions on $(E,\sE)$,
\be
\bra{x\in E: f_n(x) \text{ converges as }n\to \infty}\in \sE.
\ee
\end{theorem}

\begin{proof}[\bf Proof]
\ben
\item [(i)] $\forall a\in \R$, $\left\{x\in E: \inf_n f_n(x)>a\right\} = \bigcap_n f_n^{-1}((a,\infty))$, so $\inf_n f_n$ is measurable.

\item [(ii)] If $f$ is measurable, $-f$ is also measurable. Thus $\sup_n f_n = - \inf_n (-f_n)$ is measurable. 

\item [(iii)] Since $\inf_n f_n$ and $\sup_n f_n$ are measurable,
\be
{\lim\inf}_nf_n = \sup_n\lob \inf_{m\geq n}f_m \rob \quad\text{ and }\quad {\lim\sup}_nf_n = \inf_n\lob \sup_{m\geq n}f_m \rob \text{ are measurable.}
\ee
\item [(iv)] Let $g=\lim\inf_n f_n$ and $h=\lim \sup_n f_n$, we have
\be
\{x\in E: f_n(x) \text{ converges as }n\to \infty\} = g^{-1}((-\infty,\infty))\cap h^{-1}((-\infty,\infty)) \cap (h-g)^{-1}(\{0\}) \in \sE.
\ee
Thus, $\{x\in E: f_n(x) \text{ converges as }n\to \infty\}\in \sE$.
\een
\end{proof}

\begin{theorem}[monotone class Theorem\index{monotone class Theorem}]\label{thm:monotone_class}
Let $(E, \sE)$ be a measurable space and let $\sA$ be a $\pi$-system generating $\sE$. Let $\sV$ be a vector space of bounded functions (satisfying some conditions) $f : E \to \R$ such that:
\ben
\item [(i)] $\ind_E \in \sV$ and $\ind_A \in \sV$ for all $A \in \sA$;
\item [(ii)] if $f_n \in \sV$ for all $n$ and $f$ is bounded with $0 \leq f_n \ua f$, then $f \in \sV$.
\een
Then $\sV$ contains every bounded measurable function.
\end{theorem}
\begin{remark}
The monotone class theorem says that the smallest monotone class containing an algebra $\sA$ is precisely the smallest $\sigma$-algebra containing $\sA$.
\end{remark}
\begin{proof}[\bf Proof]
Consider $\sD = \{A \in \sE : \ind_A \in \sV\}$. Clearly, $\sA \subseteq \sD\subseteq \sE$. Now we show that $\sD$ is a $d$-system containing $\sA$, 
\ben
\item[(i)] $E\in \sD$ since $E\in \sE$ and $\ind_E \in \sV$ by definition (i) of $\sV$, then $E\in \sD$.
\item[(ii)] For all $A,B\in \sD$ with $A\subseteq B$, we have $\ind_A = \{0,1\}\ \ra \ \ind_{\{A\cap B\}} = \ind_A \ind_B = \ind_B \cdot (0 \text{ or }1) \in \sV$ by definition of vector space.
\be
\left\{\ba{l}
A,B\in \sE \ \ra \ B\bs A \in \sE, \quad (\text{definition of $\sE$}) \\
\ind_A \in \sV,\ \ind_B \in \sV\ \ra \ \ind_{\{B\bs A\}} = \underbrace{\ind_B - \ind_{\{A\cap B\}} \in \sV }_{\text{definition of vector space}}
\ea\right\}\ \ra \ B\bs A\in \sD.
\ee
\item[(iii)] For all increasing sequences $(A_n:n\in\N)\in \sD$, then let $A = \bigcup_n A_n$,
\be
\left\{\ba{l}
A_n \in \sE \ \ra \ \bigcup_n A_n \in \sE, \quad (\text{definition of $\sE$}) \\
\ind_{A_n} \in \sV \ \ra \ \ind_A \in \sV \quad (\text{definition (ii) of $\sV$}) \ \ra \ \ind_{\{\bigcup_n A_n \}} \in \sV
\ea\right\} \ \ra \ \bigcup_n A_n \in \sD.
\ee
\een
Hence, we have $\sD$ is also a $d$-system containing $\sA$, thus $\sD$ also contains $\sigma$-algebra generated by $\sA$, $\sE$ (by Dynkin's Lemma (Lemma \ref{lem:dynkin_lemma})). Thus, $\sE \subseteq \sD \ \ra \ \sD = \sE$. 

Since $\sV$ is a vector space, it thus contains all finite linear combinations of indicator functions of measurable sets. 

For any bounded and non-negative measurable function $f$, the functions 
\be
f_n = 2^{-n}\floor{2^nf}\land n,\quad n \in\N \quad\text{are measurable as}\quad \floor{2^nf} = \sum^\infty_{k=1} \ind_{\{2^nf\geq k\}} = \sum^\infty_{k=1} \ind_{\{f\geq k2^{-n}\}}
\ee
is measurable (since $f$ is measurable). Hence $f_n$ belong to $\sV$ and $0 \leq f_n \ua f$, so $f \in \sV$ (by definition (ii) of $\sV$). 

Finally, any bounded measurable function $f$ is the difference of two non-negative such functions, $f^+$ and $f^-$,
\be
f= f^+ - f^-,\quad\quad \text{where}\quad f^+ = \max\{f,0\}, \quad f^- = \max\{-f,0\}.
\ee
From proposition \ref{thm:measurable_function_property}, we know that both of $f^+$ and $f^-$ are measurable. Also, 
\be
\abs{f^+} = \abs{\max\{f,0\}} \leq \abs{f} < \infty, \quad\quad \abs{f^-} = \abs{\max\{-f,0\}} \leq \abs{f} < \infty.
\ee
Thus $f^+$ and $f^-$ are bounded and therefore $f^+,f^-\in \sV$. So $f \in \sV$ by the definition of vector space.
\end{proof}

\subsection{Image measures}

\begin{definition}
Let $(E, \sE)$ and $(G, \sG)$ be measurable spaces and let $\mu$ be a measure on $\sE$. Then any measurable function $f : E\to G$ induces an image measure\index{image measure} $\nu = \mu \circ f^{-1}$ on $\sG$\footnote{should prove that $\nu$ is a measure}, given by
\be
\nu(A) = \mu(f^{-1}(A)).
\ee
\end{definition}

We shall construct some new measures from Lebesgue measure in this way.

\begin{lemma}\label{lem:right_continuous}
Let $g : \R \to \R$ be non-constant, right-continuous and non-decreasing. Let $I = (g(-\infty), g(\infty))$ and define $f : I \to \R$ by $f(x) = \inf\{y\in \R : x \leq g(y)\}$. Then $f$ is left-continuous and non-decreasing. Moreover, for $x \in I$ and $y \in\R$,
\be
f(x) \leq y\quad \text{if and only if}\quad x \leq g(y).
\ee
\end{lemma}

\begin{proof}[\bf Proof]
Fix $x \in I$ and consider the set $J_x = \{y \in \R : x \leq g(y)\}$. Note that $J_x$ is non-empty and is not the whole of $\R$. 

Since $g$ is non-decreasing, if $y \in J_x$ and $y' \geq y$, then $y' \in J_x$. Since $g$ is right-continuous, if $y_n \in J_x$ and $y_n \da y$, then $y \in J_x$. Thus, $J_x$ is closed. Hence $J_x = [f(x),\infty)$ and $x \leq g(y)$ if and only if $f(x) \leq y$. 

For $x \leq x'$, we have $J_x \supseteq J_{x'}$ and so $f(x) \leq f(x')$, thus $f$ is non-dereasing. For $x_n \ua x$, we have $J_x = \cap_nJ_{x_n}$. Since $f$ is bounded and non-decreasing, $\ell = \lim f(x_n)$ exists by monotonicity, then 
\be
[f(x),\infty) = J_x = \bigcap_nJ_{x_n} = \bigcap_n[f(x_n),\infty) = [\ell,\infty) \ \ra \ f(x) = \ell = \lim f(x_n).
\ee
Thus, $f(x_n) \to f(x)$. So $f$ is left-continuous and non-decreasing.
\end{proof}

\begin{theorem}\label{thm:existence_radon}
Let $g : \R \to \R$ be non-constant, right-continuous and non-decreasing. Then there exists a unique Borel measure $dg$ on $\R$ such that, for all $a, b \in \R$ with $a < b$,
\be
dg((a, b]) = g(b) - g(a).
\ee

Moreover, we obtain in this way all non-zero Radon measures on $\R$. 

The measure $dg$ is called the Lebesgue-Stieltjes measure\index{Lebesgue-Stieltjes measure} associated with $g$.
\end{theorem}
\begin{proof}[\bf Proof]
Define $I$ and $f$ as in Lemma \ref{lem:right_continuous} and let $\mu$ denote Lebesgue measure on $I$. Then $f$ is Borel measurable, since for all $y \in \R$,
\be
\{x \in I : f(x) \leq y\} = \{x \in I : x \leq g(y)\} = I \cap (-\infty, g(y)].
\ee

The induced Borel measure $dg = \mu\circ f^{-1}$ on $\R$ satisfies
\be
dg((a, b]) = \mu(f^{-1}((a,b])) = \underbrace{\mu\bb{\{x : f(x) > a \text{ and }f(x) \leq b\}} = \mu\bb{(g(a), g(b)]} }_{f(x) \leq y \text{ if and only if }x \leq g(y)} = g(b) - g(a).
\ee
The argument used for uniqueness of Lebesgue measure (Theorem \ref{thm:lebesgue_measure}) shows that there is a unique (Lebesgue measure) $\mu$ with this property and therefore there is a unique Borel measure $dg$ with this property. 

Finally, if $\nu$ is any non-zero Radon measure on $\R$, we can define $g : \R \to \R$, by
\be
g(y) = \left\{\ba{ll}
\nu((0, y]) & y \geq 0,\\
-\nu((y, 0]) \quad\quad & y < 0.
\ea\right.
\ee
Then $g$ is nondecreasing and nonconstant, since $\nu$ is not the zero measure. Moreover, $\nu$ is finite-valued for compact set $[0,y]$ or $[y,0]$, thus $\nu((0,y])$ or $\nu((y,0])$ are finite (due to the additivity of measure). 

If $y\geq 0$, let $y_n \da y \geq 0$. Then $\bigcap_n(y,y_n] = \emptyset$, $\nu((y,y_n])$ are finite and $\nu((y,y_n]) \to 0$ by \ref{lem:decreasing_set}. Thus
\be
g(y) = \nu((0,y]) = \nu((0,y_n]) - \nu((y,y_n]) \to \lim_{n\to \infty}\nu((0,y_n])
\ee
since the limit exists as $\nu((0,y_n])$ is monotone and bounded (Fundamental Axiom of Real Numbers, Axiom \ref{axm:fundamental_axiom_of_analysis}).

If $y<0$, let $0 >y_n\da y$. Then similarly, $\bigcap_n(y,y_n] = \emptyset$, $\nu((y,y_n])$ are finite and $\nu((y,y_n]) \to 0$ by \ref{lem:decreasing_set}.
\be
g(y) = -\nu((y,0]) = -\bb{\nu((y,y_n])+ \nu((y_n,0])} \to - \lim\nu((y_n,0]).
\ee

Again, the limit exists as $\nu((0,y_n])$ is monotone and bounded (fundamental axiom of real numbers, Axiom \ref{axm:fundamental_axiom_of_analysis}). So $g$ is right-continuous. Then $\nu((a, b]) = g(b)-g(a)$ whenever $a < b$, so $\nu = dg$ by uniqueness.
\end{proof}

\begin{example}
Let $\alpha > 0$, and let $g(x) = \alpha x$. Then $g$ satisfies the conditions of Theorem \ref{thm:existence_radon}, and the Lebesgue-Stieltjes measure associated with it is $dg = \alpha\mu$, where $\mu$ is Lebesgue measure.
\end{example}

\begin{example}
Dirac mass. Let $x \in \R$, and $k > 0$. The Dirac mass at the point $x$, with mass $k$ is the Borel measure on $\R$ defined by 
\be
\mu(A) = k \quad \text{if }x \in A
\ee
and $\mu(A) = 0$ else, for all Borel set $A$. Then $\mu$ is a Radon measure. Moreover, it is the Radon measure $dg$ associated with the function:
\be
g(t) = k\ind_{[x,\infty)}(t).
\ee
If $k = 1$, then $\mu$ is simply denoted by $\delta_{\{x\}}$, and hence in general $\mu$ is written $k\delta_{\{x\}}$. We thus have
\be
\delta_{\{x\}} = dg,
\ee
where $g$ is the Heavyside function at $x$.
\end{example}

\subsection{Convergence in measure and convergence almost everywhere}

\begin{definition}\label{def:convergence_almost_everywhere}
Let $(E, \sE, \mu)$ be a measure space. A set $A \in \sE$ is sometimes defined by a property shared by its elements. If $\mu(A^c) = 0$, then we say that property holds almost everywhere\index{almost everywhere!set} (or a.e.). Thus, for a sequence of measurable functions $(f_n : n \in \N)$, we say $f_n$ converges to $f$ a.e.\index{convergence!almost everywhere} to mean that
\be
\mu(\{x \in E : f_n(x) \nrightarrow f(x)\}) = 0,\quad\quad \text{denoted as $f_n \to f$ a.e..}
\ee
\end{definition}

\begin{definition}\label{def:convergence_in_measure}
Let $(E, \sE, \mu)$ be a measure space. For a sequence of measurable functions $(f_n)_{n \in \N}$ and a measurable function $f$, we have that
\be
\mu(\{x \in E : |f_n(x) - f(x)| > \ve\}) \to 0,\quad \text{ for all }\ve > 0,
\ee
then we say $f_n$ converges to $f$ in measure\index{convergence!in measure}, denoted as $f_n \stackrel{\mu}{\longrightarrow} f$.
\end{definition}

\begin{theorem}\label{thm:convergence_in_measure}
Let $(f_n)_{n \in \N}$ be a sequence of measurable functions.
\ben
\item [(i)] Assume that $\mu(E) < \infty$. If $f_n \to 0$ a.e. then $f_n \to 0$ in measure.
\item [(ii)] If $f_n \to 0$ in measure then $f_{n_k}\to 0$ a.e. for some subsequence ($n_k$).
\een
\end{theorem}

\begin{proof}[\bf Proof]
\ben
\item [(i)] Suppose $f_n \to 0$ a.e.. For each $\ve > 0$,
\be
\mu(|f_n| \leq \ve) \geq \underbrace{\mu \bb{\bigcap_{m\geq n} \{|f_m| \leq \ve\}} \ua \mu(|f_n| \leq \ve \text{ ev.})}_{\text{Lemma }\ref{lem:measure_increasing_sequence}} \geq \mu(f_n \to 0),
\ee
\be
\mu(|f_n| > \ve) = \mu(E) - \mu(|f_n| \leq \ve) \leq \mu(E) - \mu(f_n \to 0) = \mu(f_n \nrightarrow 0) = 0.
\ee
Hence $\mu(|f_n| > \ve) \to 0$ and $f_n \to 0$ in measure.

\item [(ii)] Suppose $f_n \to 0$ in measure, then $\forall \ve>0$, $\mu(\{|f_n| > \ve\}) \to 0$ i.e.
\be
\forall \ve>0,\ \delta >0, \ \exists N,\ \forall n\geq N,\quad \mu(\{|f_n| > \ve\}) < \delta.
\ee
so we can find a subsequence ($n_k$) such that $\ve_k = 1/k$ and $\delta_k = 2^{-k}$,
\be
\mu\bb{\{\abs{f_{n_k}} > 1/k\}} < 2^{-k} \ \ra \ \sum_k \mu(\{|f_{n_k} | > 1/k\}) < \sum_k 2^{-k} = 1 < \infty.
\ee
So, by the first Borel-Cantelli lemma (Lemma \ref{lem:borel_cantelli_1_measure}),
\be
0 = \mu(\{|f_{n_k} | > 1/k \text{ i.o.}\}) = \mu\bb{\bra{|f_{n_k} | \leq 1/k \text{ ev.}}^c} = \mu\bb{\bra{f_{n_k} \to 0}^c} \ \ra\ f_{n_k} \to 0\text{ a.e.}.
\ee
\een
\end{proof}

\begin{proposition}[uniqueness of limit of convergence in measure]\label{pro:uniqueness_limit_convergence_in_measure}
Let $(f_n)_{n \in \N}$ be a sequence of measurable functions and $f,g$ be measurable functions. If $f_n \to f$ in measure and $f_n \to g$ in measure,
\be
f = g \text{\ a.e.}\quad \text{ i.e., } \mu\bb{x:f(x)\neq g(x)} = 0.
\ee
\end{proposition}

\begin{proof}[\bf Proof]
If $f_n \to f$ in measure and $f_n \to g$ in measure, we have for any $\ve$,
\be
\mu\bb{\abs{f_n - f} > \ve} \to 0,\quad \mu\bb{\abs{f_n - g} > \ve} \to 0
\ee
as $n\to \infty$. Thus, 
\be
\mu\bb{\abs{f-g} > \ve} \leq \mu\bb{\abs{f_n -f} + \abs{f_n -g} > \ve} \leq \mu\bb{\abs{f_n -f} > \ve/2} + \mu\bb{\abs{f_n -g} > \ve/2} \to 0.
\ee

Thus, $\mu\bb{\abs{f-g} > \ve} = 0$ which imples that $f=g$ a.e..
\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Integration and Basic Theorems}

\subsection{Definition of integral and basic properties}

\begin{definition}
For measure space $(E,\sE,\mu)$, a simple function\index{simple function} is a non-negative one may be written as a finite sum
\be
f = \sum^m_{i=1} a_i\ind_{A_i}
\ee
where $a_i \in [0,\infty]$ and $A_i \in \sE$ for all $i$, and where $m \in \N$. 
\end{definition}

\begin{definition}\label{def:integral_simple_function}
For measure space $(E,\sE,\mu)$ and simple functions $f = \sum^m_{i=1} a_i\ind_{A_i}$ and measure space $(E,\sE,\mu)$, we define
\be
\mu(f) = \sum^m_{i=1} a_i\mu(A_i),
\ee
where we adopt the convention $0\cdot\infty = 0$. 
\end{definition}

Although the representation of $f$ is not unique, it is straightforward to check that $\mu(f)$ is well defined and ensure that they yield the same value. 

\begin{definition}
For measure space $(E,\sE,\mu)$ and a simple function $f$ with the form of $f=\sum^m_{i=1} a_i\ind_{A_i}$, if $A_1,\dots,A_m \in \sE$ are disjoint sets, then the form is called a normal representation\index{normal representation} of $f$.
\end{definition}

\begin{lemma} 
A simple function $f$ has two normal representations:
\be
f= \sum^m_{i=1}a_i \ind_{A_i}=\sum^n_{j=1}b_j \ind_{B_j} \quad\ra \quad \mu(f) = \sum^m_{i=1}a_i \mu(A_i) = \sum^n_{j=1}b_j \mu(B_j).
\ee
\end{lemma}
\begin{proof}[\bf Proof]
If $\mu(A_i\cap B_j) > 0$ for some $i$ and $j$, then $A_i \cap B_j \neq \emptyset$, and for any $x\in A_i \cap B_j$
\be
f(x) = \sum^m_{i=1} a_i \ind_{A_i} = a_i = b_j = \sum^n_{j=1}b_j \ind_{B_j},
\ee
for the disjoint sets $A_i$ and disjoint sets $B_j$. Furthermore, clearly $A_i \subseteq \bigcup^n_{j=1}B_j$ if $a_i \neq 0$, and $B_j \subseteq \bigcup^m_{i=1}A_i$ if $b_j \neq 0$. We conclude that

$\quad\quad\quad\quad\quad\quad\quad\quad \sum\limits^m_{i=1} a_i \mu(A_i) = \sum\limits^m_{i=1}\sum\limits^n_{j=1} a_i \mu(A_i\cap B_j) = \sum\limits^n_{j=1} \sum\limits^m_{i=1} b_j \mu(A_i\cap B_j) = \sum\limits^n_{j=1} b_j \mu(B_j)$.
\end{proof}

\begin{lemma} 
A simple function $f$ has two representations:
\be
f= \sum^m_{i=1}a_i \ind_{A_i}=\sum^n_{j=1}b_j \ind_{B_j} \quad\ra\quad \mu(f) = \sum^m_{i=1}a_i\mu(A_i) = \sum^n_{j=1}b_j\mu(B_j).
\ee
\end{lemma} 
\begin{proof}[\bf Proof]

For $\ve\in\{0,1\}^m$ define $A_\ve = A_1^{\ve_1}\cap\dots\cap A_m^{\ve_m}$ where $A^0_i = A_i^c$, $A^1_i = A_i$. 

For $\delta\in\{0,1\}^n$ define $B_\delta = B_1^{\delta_1}\cap\dots\cap B_n^{\delta_n}$ where $B^0_j = B_j^c$, $B^1_j = B_j$. Then set
\be
f_{\ve,\delta} = \left\{\ba{ll}
\sum\limits^m_{i=1} a_i\ve_i \quad\quad & \text{if }A_\ve \cap B_\delta \neq \emptyset\\
\infty & \text{otherwise.}
\ea\right.
\ee

We note that the sets $A_\ve$ are disjoint and $A_k = \bigcup\limits_{\ve:\ve_k=1}A_\ve$. Thus, for any measure $\mu$,
\be
\mu(A_k) = \sum_{\ve}\ve_k \mu(A_\ve) = \sum_\delta \sum_\ve \ve_k \mu(A_\ve\cap B_\delta)
\ee

Then $\sum\limits^m_{i=1}a_i\mu(A_i) = \sum\limits^m_{i=1}a_i  \sum\limits_\delta \sum\limits_\ve \ve_i \mu(A_\ve\cap B_\delta) =  \sum\limits_\delta \sum\limits_\ve \mu(A_\ve\cap B_\delta)\sum\limits^m_{i=1}a_i \ve_i = \sum\limits_{\ve,\delta}\mu(A_\ve \cap B_\delta)f_{\ve,\delta}$. If $A_\ve \cap B_\delta \neq \emptyset$, for any point $x\in A_\ve \cap B_\delta$, $f(x) = \sum^m_{i=1}a_i \ve_i = \sum^n_{j=1}b_j\delta_j = f_{\ve,\delta}$. Then by symmetry, we have 
\be
\sum_{\ve,\delta}\mu(A_\ve \cap B_\delta)f_{\ve,\delta} = \sum_\delta \sum_\ve \mu(A_\ve\cap B_\delta)\sum^n_{j=1}b_j \delta_j = \sum^n_{j=1}b_j  \sum_\delta \sum_\ve \delta_j \mu(A_\ve\cap B_\delta) = \sum^n_{j=1}b_j\mu(B_j).
\ee

Hence $\mu(f)$ is well-defined.
\end{proof}

\begin{proposition}\label{pro:simple_normal}
Every simple function has normal representation.
\end{proposition}
\begin{proof}[\bf Proof]
Assume $f = \sum^m_{i=1}a_i \ind_{A_i}$ and let 
\be
B_1 = A_i,\quad\quad b_1 = a_1 + \sum^m_{i=2}a_i\ind_{A_1\cap A_i},
\ee
and then we have $A_j' = A_{j+1}\bs A_1$, $a_j' = a_{j+1}$, $j = 1,\dots,m-1$. Repeating the above steps for $A'_j$, we get disjoint set $B_i$ such that
\be
f = \sum^m_{i=1}a_i \ind_{A_i} = \sum^m_{j=1}b_j \ind_{B_j},
\ee
which is normal representation.
\end{proof}

\begin{proposition}\label{pro:simple_function_property}
For simple functions $f$, $g$ and constants $\alpha, \beta \in [0,\infty]$, we have
\ben
\item [(i)] $\mu(\alpha f + \beta g) = \alpha\mu(f) + \beta\mu(g)$,
\item [(ii)] $f \leq g$ a.e. implies $\mu(f) \leq \mu(g)$, $f=g$ a.e. implies $\mu(f) = \mu(g)$,
\item [(iii)] $f = 0$ a.e. if and only if $\mu(f) = 0$.
\een
\end{proposition}
\begin{proof}[\bf Proof]
Let $f = \sum^m_{i=1}a_i \ind_{A_i}$ and $g = \sum^n_{j=1}b_j \ind_{B_i}$, $a_i,b_i \in [0,\infty]$, where $A_i$ and $B_j$ are disjoint (by Proposition \ref{pro:simple_normal}).
\ben
\item [(i)] We have $\mu(\alpha f + \beta g) = \mu \bb{\alpha \sum\limits^m_{i=1}a_i \ind_{A_i} + \beta \sum\limits^n_{j=1}b_j \ind_{B_i}} = \mu\bb{ \sum\limits^m_{i=1}\alpha a_i \ind_{A_i} + \sum\limits^n_{j=1} \beta b_j \ind_{B_i}}$, then
\beast
\mu(\alpha f + \beta g)& = & \sum^m_{i=1}\alpha a_i \mu(A_i) + \sum^n_{j=1}\beta b_j \mu(B_i) = \alpha \sum^m_{i=1} a_i \mu(A_i) + \beta\sum^n_{j=1} b_j \mu(B_i) = \alpha\mu(f) + \beta\mu(g).
\eeast
\item [(ii)] We have $g = \sum\limits^m_{i=1}\bb{\sum\limits^n_{j=1} b_j\ind_{A_i\cap B_j}}\ind_{A_i} + \sum\limits^n_{j=1} b_j\ind_{B_j\bs \bigcup^n_{i=1} A_i}$ where $A_i$ and $B_j\bs \bigcup^n_{i=1} A_i$ are $m+n$ disjoint sets. $\forall A_i$, $\forall x \in A_i$, $a_i = f(x) \leq g(x) = \sum^n_{j=1} b_j\ind_{A_i\cap B_j}$. Hence,
\beast
\mu(f) & = & \mu\bb{\sum^m_{i=1}a_i \ind_{A_i}} = \sum^m_{i=1}a_i \mu\bb{A_i} \leq \sum^m_{i=1}\bb{\sum^n_{j=1} b_j\ind_{A_i\cap B_j}} \mu\bb{A_i} \\
& \leq & \sum^m_{i=1}\bb{\sum^n_{j=1} b_j\ind_{A_i\cap B_j}} \mu\bb{A_i} + \sum^n_{j=1} b_j\mu\bb{B_j\left\bs \bigcup^n_{i=1} A_i\right.} = \mu(g).
\eeast

If $f\leq g$ a.e., we have simple functions $f\ind_{\{f\leq g\}}$ and $f\ind_{\{f > g\}}$,
\be
\mu(f) = \mu\bb{f\ind_{\{f\leq g\}} + f\ind_{\{f > g\}}} = \mu\bb{f\ind_{\{f \leq g\}}} + \mu\bb{f\ind_{\{f > g\}}}.\quad\quad \text{by (i)}
\ee

Then we have $f\ind_{\{f\leq g\}} \leq g \ \ra \ \mu\bb{f\ind_{\{f\leq g\}}} \leq \mu(g)$, and simple functions 

\be
f\ind_{\{f > g\}} \leq \bb{\sup_{x\in E}f(x)}\ind_{\{f > g\}} \quad \ra \quad \mu\bb{f\ind_{\{f > g\}}} \leq \mu\bb{\bb{\sup_{x\in E}f(x)}\ind_{\{f > g\}} }.
\ee
\beast
\ra\quad \mu(f) & = & \mu\bb{f\ind_{\{f \leq g\}}} + \mu\bb{f\ind_{\{f > g\}}} \leq \mu(g) + \mu\bb{f\ind_{\{f > g\}}} \leq \mu(g) + \mu\bb{\bb{\sup_{x\in E}f(x)}\ind_{\{f > g\}}} \\
& = & \mu(g) + \bb{\sup_{x\in E}f(x)}\mu\bb{\ind_{\{f > g\}}} \leq \mu(g) + \infty\cdot\mu\bb{\{f > g\}} = \mu(g) + \infty \cdot 0 = \mu(g) + 0 = \mu(g).
\eeast

Furthermore, if $f=g$ a.e., $f\leq g$ a.e. and $g\leq f$ a.e. gives that $\mu(f) \leq \mu(g),\  \mu(g)\leq \mu(f) \ \ra \ \mu(f) = \mu(g)$.

\item [(iii)] $(\ra)$ If $f=0$ a.e., $\mu(\{f\neq 0\}) = 0$,
\beast
\mu(f) & = & \mu\bb{f\ind_{\{f=0\}} + f\ind_{\{f\neq 0\}}} = \mu\bb{f\ind_{\{f\neq 0\}}} = \mu\bb{\bb{\sum^m_{i=1}a_i \ind_{A_i}}\ind_{\{f\neq 0\}}} = \sum^m_{i=1}a_i \mu\bb{{A_i}\cap \{f\neq 0\}}\\
& \leq & \sum^m_{i=1}a_i \mu\bb{\{f\neq 0\}} = 0 \quad \ra \quad \mu(f) = 0.
\eeast

$(\la)$ If $\mu(f) = 0$, let $\ve_n = \frac 1n > 0$, by (ii), we have
\be
\ve_n \ind_{\{f\geq \ve_n\}} \leq f \quad \ra \quad \mu\bb{\ve_n \ind_{\{f\geq \ve_n\}}} \leq \mu\bb{f} \quad \ra \quad \ve_n \mu\bb{\ind_{\{f\geq \ve_n\}}} \leq \mu\bb{f}
\ee
(by definition of $\mu(f)$ (Definition \ref{def:integral_simple_function})) since $\ve_n\ind_{\{f\geq \ve_n\}}$ and $f$ are simple functions. Then we have
\be
\mu\bb{\{f\geq \ve_n\}} = \mu\bb{\ind_{\{f\geq \ve_n\}}} \leq \frac 1{\ve_n} \mu(f).
\ee

As $\ind_{\{f\geq \ve_n\}} \ua \ind_{\{f\neq 0\}}$, $\{f\geq \ve_n\} \subseteq \{f\neq 0\}$ we have 
\be
\mu\bb{\{f\geq \ve_n\}} \ua \mu \bb{\{f\neq 0\}}. \quad\quad (\text{by fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence})})
\ee

Thus, $\mu \bb{\{f\neq 0\}} \leq \infty \cdot \mu(f) = \infty \cdot 0 = 0 \quad \ra \quad f = 0 \text{ a.e.}$.
\een
\end{proof}

\begin{definition}\label{def:non_negative_measurable_integral}
The integral\index{integral!non-negative measurable function} $\mu(f)$ of a non-negative measurable function $f$ by
\be
\mu(f) = \sup\left\{\mu(g) : g \text{ is simple},\ g \leq f\right\}.
\ee
\end{definition}

\begin{definition}\label{def:integral_measurable_function}
Let $(E,\sE,\mu)$ be a measure space. For any measurable function $f$, set $f^+ = \max\{f, 0\}$ and $f^- = \max\{-f,0\}$. Then $f = f^+ - f^-$ and $|f| = f^+ + f^-$. Unless both $\mu(f^+)$ and $\mu(f^-)$ are $\infty$, we define
\be
\mu(f) = \mu(f^+) - \mu(f^-).
\ee
\end{definition}

\begin{definition}\label{def:mu_integral}
Let $(E, \sE, \mu)$ be a measure space. We shall define, where possible, for a measurable function $f : E \to [-\infty,\infty]$, the integral\index{integral!measurable function} of $f$, to be denoted
\be
\mu(f) = \int_E fd\mu = \int_E f(x)\mu(dx).
\ee
\end{definition}

Here is the key result for the theory of integration. 

\begin{theorem}[monotone convergence theorem\index{monotone convergence theorem!pointwise}]\label{thm:monotone_convergence_pointwise}
Let $(E,\sE,\mu)$ be a measure space. Let $f$ be a non-negative measurable function and let $(f_n : n \in \N)$ be a sequence of such functions. Suppose that $f_n \ua f$. Then $\mu(f_n) \ua \mu(f)$.
\end{theorem}
\begin{proof}[\bf Proof] We discuss in following cases:
\begin{description}
\item [Case 1]: If $A_n \ua A$, $f_n = \ind_{A_n}$, $f = \ind_A$ and $f_n \ua f$. By fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}),

\be
\mu\bb{f_n} = \mu\bb{\ind_{A_n}} = \underbrace{\mu\bb{A_n} \ua \mu\bb{A} }_{\text{Lemma \ref{lem:measure_increasing_sequence}}}= \mu\bb{\ind_{A}} = \mu\bb{f} 
\ee

\item [Case 2]: $f_n$ is simple, $f = \ind_A$. Fix $\ve > 0$ and set $A_n = \{f_n > 1 - \ve\}$. Then $A_n \ua A$ and 
\be
(1 - \ve)\ind_{A_n} \leq f_n \leq \ind_A \quad\ra \quad (1 -\ve)\mu(A_n) \leq \mu(f_n) \leq \mu(A).
\ee
by Proposition \ref{pro:simple_function_property} (ii). But $\mu(A_n) \ua \mu(A)$ by Case 1 and $\ve > 0$ was arbitrary, so the result follows.

\item [Case 3]: $f_n$ simple, $f$ simple. We can write $f$ in the form $f = \sum^m_{k=1} a_k\ind_{A_k}$ with $a_k > 0$ for all $k$ and the sets $A_k$ disjoint. Then $f_n \ua f$ implies
\be
\ind_{A_k} f_n \ua \bb{\sum^m_{k=1} a_k\ind_{A_k}}\ind_{A_k} \quad\ra \quad \ind_{A_k} f_n \ua a_k\ind_{A_k} \quad\ra \quad a^{-1}_k \ind_{A_k} f_n \ua \ind_{A_k} 
\ee
so, by Case 2,
\be
\mu(f_n) = \sum_k \mu\bb{\ind_{A_k}f_n} \ua \sum_k a_k\mu(A_k) = \mu(f).
\ee

\item [Case 4]: $f_n$ simple, $f \geq 0$ measurable. Let $g$ be simple with $g \leq f$. Then $f_n \ua f$ implies $f_n \land g \ua g$ so, by Case 3,
\be
\mu(f_n) \geq \mu(f_n \land g) \ua \mu(g).
\ee
Since $g$ was arbitrary, we have $\lim_n \mu(f_n) \geq \mu(f)$. However, we know that $\mu(f_n) \leq \mu(f)$ (by definition of $\mu(f)$, Definition \ref{def:non_negative_measurable_integral}) as $f_n$ is simple function. Thus, $\lim_n \mu(f_n) = \mu(f)$. With Proposition \ref{pro:simple_function_property} (ii), we have $\mu(f_n)$ is increasing, thus $\mu(f_n)\ua \mu(f)$.

\item [Case 5]: $f_n \geq 0$ measurable, $f \geq 0$ measurable. Set $g_n = (2^{-n}\floor{2^nf_n}) \land n$ then $g_n$ is simple and $g_n \leq f_n \leq f$, so by Theorem \ref{thm:non_negative_measurable_property} (ii),
\be
\mu(g_n) \leq \mu(f_n) \leq \mu(f).
\ee
But $f_n \ua f$ forces $g_n \ua f$, so $\mu(g_n) \ua \mu(f)$, by Case 4, and so $\mu(f_n) \ua \mu(f)$.
\end{description}
\end{proof}


\begin{proposition} 
Let $\mu$ and $\nu$ be finite Lebesgue measures. Let $f: \R\to \R$ be a continuous bounded function on $\R$. Show that $f$ is Lebesgue-integrable with respect to $\mu$ and $\nu$. If $\mu(f)=\nu(f)$ for all such $f$, then $\mu=\nu$.
\end{proposition} 

\begin{proof}[\bf Proof]
Suppose that $\abs{f} \leq M < \infty$. The function $f$ is measurable as it is continuous (Proposition \ref{pro:continuous_measurable}), and $\mu(f)\leq M \mu(\R)<\infty$, so $f$ is moreover integrable. 

Suppose that $\mu(f)=\nu(f)$ for all continuous bounded functions $f$. For any interval $A$, we can find continuous bounded functions $f_n$ with $0\leq f_n\uparrow \ind_A$ as $n\to \infty$. By monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we deduce that $\mu(A)=\nu(A)$. Hence $\mu=\nu$ by uniqueness of extension (Theorem \ref{thm:uniqueness_of_extension_measure}).
\end{proof}


\begin{theorem}\label{thm:non_negative_measurable_property}
For all non-negative measurable functions $f$, $g$ and all constants $\alpha, \beta \in [0,\infty]$,
\ben
\item [(i)] $\mu(\alpha f + \beta g) = \alpha\mu(f) + \beta\mu(g)$,
\item [(ii)] $f \leq g$ a.e. implies $\mu(f) \leq \mu(g)$, $f=g$ a.e. implies $\mu(f) = \mu(g)$,
\item [(iii)] $f = 0$ a.e. if and only if $\mu(f) = 0$.
\een
\end{theorem}
\begin{proof}[\bf Proof]
Define simple functions $f_n$, $g_n$ by
\be
f_n = (2^{-n}\floor{2^nf}) \land n,\quad\quad  g_n = (2^{-n}\floor{2^ng}) \land n.
\ee

Then $f_n \ua f$ and $g_n \ua g$, so $\alpha f_n+\beta g_n \ua \alpha f +\beta g$. 
\ben
\item [(i)] Hence, by monotone convergence theorem,
\be
\mu(f_n) \ua \mu(f),\quad \mu(g_n) \ua \mu(g),\quad \mu(\alpha f_n + \beta g_n) \ua \mu(\alpha f + \beta g).
\ee

We know that $\mu(\alpha f_n + \beta g_n) = \alpha\mu(f_n) + \beta\mu(g_n)$ by Proposition \ref{pro:simple_function_property} (i), so we have
\be
\mu(\alpha f + \beta g) = \alpha\mu(f) + \beta\mu(g)
\ee
\item [(ii)] If $f\leq g$ a.e., then $f_n \leq g_n$ a.e. and $\mu(f_n) \leq \mu(g_n)$ by Proposition \ref{pro:simple_function_property} (ii). Also, we have
\be
\mu(f_n) \ua \mu(f),\quad \mu(g_n) \ua \mu(g) \quad\ra\quad \mu(f)\leq \mu(g).
\ee

\item [(iii)] $(\ra)$ If $f = 0$ a.e., then $f_n = 0$ a.e., for all $n$, so by Proposition \ref{pro:simple_function_property} (iii), $\mu(f_n) = 0$ for all $n$ and $\mu(f_n)\ua \mu(f)$ by monotone convergence theorem. Thus $\mu(f) = 0$. 

$(\la)$ If $\mu(f) = 0$, we have $f_n \leq f$, by (ii), we have $\mu(f_n) \leq \mu(f) = 0$ and thus $\mu(f_n) = 0$ for all $n$, so $f_n = 0$ a.e. for all $n$ by Proposition \ref{pro:simple_function_property} (iii) i.e., $\mu\{f_n \neq 0\}) = 0$. Then
\be
\{f_n \neq 0\} = \{f \geq 2^{-n}\} \ua \{f\neq 0\} \quad \ra \quad \mu(\{f_n \neq 0\} ) \ua \mu(\{f\neq 0\}) 
\ee
by fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}), then
\een

$\qquad\qquad\qquad\qquad \mu(\{f\neq 0\}) = \lim_n\mu(\{f_n \neq 0\} ) = 0 \quad \ra \quad f = 0 \text{ a.e.}$.
\end{proof}

Here are some minor variants on the monotone convergence theorem.

\begin{theorem}[monotone convergence theorem\index{monotone convergence theorem!almost everywhere}]\label{thm:monotone_convergence_almost_everywhere}
Let $(E,\sE,\mu)$ be a measure space. Let $f$ be a non-negative measurable function and $(f_n : n \in \N)$ be a sequence of measurable functions, with $f_n \geq 0$ a.e.. Then
\be
f_n \ua f \text{ a.e.} \ \ra \ \mu(f_n) \ua \mu(f).
\ee
\end{theorem}

\begin{remark}
Thus the pointwise hypotheses of non-negativity and monotone convergence can be relaxed to hold almost everywhere.
\end{remark}
\begin{proof}[\bf Proof]
Consider $\bra{x:0\leq f_n(x) \ua f(x)} \subseteq \bra{x:f_n(x) \ua f(x) }^c \bigcup \bb{ \bra{x:f_n(x) \ua f(x) }\bigcap \bb{\bigcup_n \bra{x:f_n(x)<0}}}$. Then we have
\beast
\mu\bb{\bra{x:0\leq f_n(x) \ua f(x)}} & \leq & \mu\bb{\bra{x:f_n(x) \ua f(x) }^c \bigcup \bb{ \bra{x:f_n(x) \ua f(x) }\bigcap \bb{\bigcup_n \bra{x:f_n(x)<0}}} }\\
& \leq & \mu\bb{\bra{x:f_n(x) \ua f(x) }^c \bigcup \bb{ \bigcup_n \bra{x:f_n(x)<0}}} \\
& \leq & \mu\bb{\bra{x:f_n(x) \ua f(x) }^c} + \sum_n \mu\bb{\bra{x:f_n(x)<0}} =  0 + 0\cdot \infty = 0.
\eeast

So we have $0\leq f_n(x) \ua f(x)$ a.e.. Define 
\be
A = \bra{x:0\leq f_n(x) \ua f(x)} \quad\ra \quad f_n \ind_A \ua f \ind_A
\ee
where $f_n\ind_A$ and $f \ind_A$ are non-negative measurable functions. Applying monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have
\be
\mu\bb{f_n \ind_A} \ua \mu\bb{f\ind_A}
\ee

We have $f_n\geq 0$ a.s. thus $\mu\bb{f_n^-} = 0$, thus we can have non-negative measurable functions $f_n \ind_{\{f_n\geq 0\}} \geq f_n \ind_A$,
\be
\mu(f_n) = \mu\bb{f_n^+} - \mu\bb{f_n^-} = \mu(f_n^+) = \underbrace{\mu \bb{f_n \ind_{\{f_n\geq 0\}}} \geq \mu\bb{f_n \ind_A}}_{\text{Theorem \ref{thm:non_negative_measurable_property} (ii)}} \quad\ra \quad \mu(f_n)  \ua \mu\bb{f\ind_A}.
\ee

Also, $f\ind_A = f$ a.e. implies $\mu\bb{f\ind_A} = \mu\bb{f}$ by Theorem \ref{thm:non_negative_measurable_property} (ii). Hence, $\mu(f_n)  \ua \mu\bb{f}$.
\end{proof}
\begin{remark}
There are other versions of monotone convergence theorem, i.e. Chung\cite{Chung_2000}, the condition $f_n \geq 0$ a.e. may be weakened to $\mu(f_n) > -\infty$ for some $n$.
\end{remark}

\begin{proposition}
Let $(f_n : n \in \N)$ be a sequence of non-negative measurable functions. Then
\be
\sum^\infty_{n=1} \mu(f_n) = \mu\bb{\sum^\infty_{n=1} f_n}.
\ee
\end{proposition}
\begin{remark}
This reformulation of monotone convergence makes it clear that it is the counterpart for the integration of functions of the countable additivity property of the measure on sets.
\end{remark}
\begin{proof}[\bf Proof]
Let $g_n = \sum^n_{k=1} f_k$, then $g_n \leq g_{n+1}$ and $g_n$ is non-negative measurable $\forall n$, thus $g_n \ua \sum^\infty_{k=1}f_k$ with $\sum^\infty_{k=1}f_k $ is non-negative measurable function. Thus, applying monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have
\vspace{2mm}

$\quad\quad\quad\quad\mu\bb{g_n} \ua \mu\bb{\sum\limits^\infty_{k=1}f_k}  \quad\ra\quad \mu\bb{\sum\limits^\infty_{k=1} f_k} = \sum\limits^\infty_{k=1}\mu\bb{f_k}$.
\end{proof}

\begin{definition}\label{def:integrable_measurable_function}
For any measurable function $f$ and $|f| = f^+ + f^-$. If $\mu(|f|) < \infty$, then we say that $f$ is Lebesgue-integrable\index{integrable!Lebesgue} and define
\be
\mu(f) = \mu(f^+) - \mu(f^-).
\ee
\end{definition}
\begin{remark}\label{rem:integral_either_finite}
Note that $|\mu(f)| \leq \mu(|f|)$ for all integrable functions $f$. We sometimes define the integral $\mu(f)$ by the same formula, even when $f$ is not integrable, but when either $\mu(f^-)$ or $\mu(f^+)$ is finite. In such cases the integral take the value $\infty$ or $-\infty$.
\end{remark}
\begin{theorem}\label{thm:lebesgue_integrable_function_property}
For all integrable functions $f$, $g$ and all constants $\alpha, \beta \in \R$,
\ben
\item [(i)] $\mu(\alpha f + \beta g) = \alpha\mu(f) + \beta\mu(g)$,
\item [(ii)] $f \leq g$ a.e. implies $\mu(f) \leq \mu(g)$, $f=g$ a.e. implies $\mu(f) = \mu(g)$,
\item [(iii)] $f = 0$ a.e. implies $\mu(f) = 0$,
\item [(iv)] $\abs{\mu(f)}\leq \mu\abs{f}$.
\een
\end{theorem}

\begin{proof}[\bf Proof]
We note that $\mu(-f) = -\mu(f)$ (by Definition \ref{def:integrable_measurable_function}). 
\ben
\item [(i)] For $\alpha \geq 0$, we have 
\be
\mu(\alpha f) = \underbrace{\mu\bb{\bb{\alpha f}^+} - \mu\bb{\bb{\alpha f}^-} = \alpha\mu(f^+) - \alpha\mu(f^-)}_{\text{by Theorem \ref{thm:non_negative_measurable_property} (i) since $f^+$ and $f^-$ are non-negative measurable}} = \alpha\mu(f).
\ee

For $\alpha \geq 0$, we set $\beta = -\alpha >0$
\be
\mu(\alpha f) = \mu\bb{-\beta f} = \underbrace{- \mu\bb{\beta f} \ = \ -\bb{\beta \mu(f)}}_{\text{use the result from the above case}} = \alpha \mu(f).
\ee

If $h = f + g$ then $h^+ + f^- + g^- = h^- + f^+ + g^+$, so
\be
\mu(h^+) + \mu(f^-) + \mu(g^-) = \mu(h^-) + \mu(f^+) + \mu(g^+)\quad\quad (\text{by Theorem \ref{thm:non_negative_measurable_property} (i)})
\ee
and so $\mu(h) = \mu(f)+\mu(g)$ (by definition of $\mu$ for integrable functions). 

\item [(ii)] If $f \leq g$ a.e., then $f^+ \geq g^+$ a.e. and $g^-\leq f^-$ a.e.. By Theorem \ref{thm:non_negative_measurable_property} (ii),
\be
\left\{\ba{l}
\mu(f^+) \leq \mu(g^+) \\
\mu(g^-) \leq \mu(f^-) 
\ea\right. \quad\ra\quad \mu(f^+) + \mu(g^-) \leq \mu(g^+) + \mu(f^-) \quad\ra\quad \mu(f) \leq \mu(g)
\ee
by definition of integral. Thus, we have $f=g$ a.e. implies $\mu(f) = \mu(g)$.

\item [(iii)] If $f = 0$ a.e., then $f^\pm = 0$ a.e., so $\mu(f^\pm) = 0$ and thus $\mu(f) = 0$.

\item [(iv)] Finally, by (i), $\abs{\mu(f)} = \abs{\mu(f^+)-\mu(f^-)} \leq \abs{\mu\bb{f^+}} + \abs{\mu\bb{f^-}} = \mu(f^++f^-) = \mu(\abs{f})$.
\een
\end{proof}

\subsection{Integrals and limits}

In the monotone convergence theorem, the hypothesis that the given sequence of functions is non-decreasing is essential. In this section we obtain some results on the integrals of limits of functions without such a hypothesis.

\begin{lemma}[Fatou's Lemma\index{Fatou's Lemma!function}]\label{lem:fatou_function}
Let $(f_n:E\to [0,\infty], n \in \N)$ be a sequence of non-negative measurable functions. Then
\be
\mu\bb{\liminf_n f_n} \leq \liminf_n\mu(f_n).
\ee
(Inverse Fatou's Lemma). Additionally, if there exists a non-negative integrable function $g$ (measurable and $\mu(g) <\infty$) such that $f_n\leq g$ for all $n$, then
\be
\mu\bb{\limsup_n f_n} \geq \limsup_n \mu(f_n).
\ee
\end{lemma}
\begin{proof}[\bf Proof]
For $k \geq n$, we have 
\be
\underbrace{\inf_{m\geq n} f_m \leq f_k \quad\ra \quad \mu\bb{\inf_{m\geq n} f_m} \leq \mu(f_k)}_{\text{by Theorem \ref{thm:non_negative_measurable_property} (ii) since $f_n$ and $\inf f_n$ are non-negative measurable}} \quad \ra \quad \mu\bb{\inf_{m\geq n} f_m} \leq \inf_{k\geq n}\mu(f_k) .
\ee

Then we have
\be
\quad \mu\bb{\inf_{m\geq n} f_m} \leq \inf_{k\geq n} \mu(f_k) \leq \sup_n \inf_{k\geq n} \mu(f_k) = \liminf_n \mu(f_n).
\ee

But, as $n \to \infty$,
\be
\inf_{m\geq n} f_m \ua \sup_n\bb{\inf_{m\geq n} f_m} = \liminf f_n \quad\ra \quad \mu\bb{\inf_{m\geq n} f_m} \ua \mu(\liminf f_n)
\ee
by monotone convergence theorem. Thus, $\mu(\liminf f_n) \leq \liminf \mu(f_n)$.

For the second inequality, clearly we see that $f_n$ and $\limsup f_n$ are integrable and apply Fatou's lemma to the sequence $g-f_n$, 
\beast
\mu\bb{\liminf (g-f_n)} & \leq & \liminf \mu\bb{ g-f_n}\\
\mu\bb{g - \limsup f_n} & \leq & \liminf \mu(g)- \mu(f_n)\quad\quad (\text{by Theorem \ref{thm:lebesgue_integrable_function_property} (i)})\\
\mu\bb{g} - \mu\bb{\limsup f_n} & \leq & \mu(g) - \limsup \mu(f_n)\quad\quad (\text{by Theorem \ref{thm:lebesgue_integrable_function_property} (i)})\\
\limsup \mu(f_n) & \leq & \mu(\limsup f_n). \quad\quad \quad\quad(\text{as }\mu(g) <\infty)
\eeast
\end{proof}

\begin{theorem}[dominated convergence theorem\index{dominated convergence theorem!measure}]\label{thm:dominated_convergence_measure}
Let $(E,\sE,\mu)$ be a measure space. Let $f$ be a measurable function and let $(f_n : n \in \N)$ be a sequence of such functions. Suppose that $f_n(x) \to f(x)$ a.e.. and that $|f_n| \leq g$ a.e. for all $n$, for some integrable function $g$. Then $f_n$ and $f$ are integrable, for all $n$ and $\mu(f_n) \to \mu(f)$.
\end{theorem}
\begin{proof}[\bf Proof]
Clearly, $f_n$ is integrable. The limit $f$ is measurable and $|f| \leq g$ a.e., 
\be
\underbrace{\abs{f} \leq g \text{ a.e.}\quad\ra\quad \mu(\abs{f}) \leq \mu(g)}_{\text{by Theorem \ref{thm:non_negative_measurable_property} (ii)}} \underbrace{<\quad\infty}_{g \text{ is integrable}}\quad\ra\quad f \text{ is integrable}.
\ee

We have $0 \leq g \pm f_n \to g \pm f$ a.e. so certainly $\liminf(g \pm f_n) = g \pm f$ a.e.. By Theorem \ref{thm:lebesgue_integrable_function_property} (i), (ii) and Fatou's Lemma,
\beast
\mu(g) + \mu(f) & = & \mu(\liminf(g + f_n)) \leq \liminf \mu(g + f_n) = \mu(g) + \liminf \mu(f_n),\\
\mu(g) - \mu(f) & = & \mu(\liminf(g - f_n)) \leq \liminf \mu(g - f_n) = \mu(g) - \limsup \mu(f_n).
\eeast

Since $\mu(g) < \infty$, we can deduce that
\be
\mu(f) \leq \liminf \mu(f_n) \leq \limsup \mu(f_n) \leq \mu(f).
\ee

This proves that $\mu(f_n) \to \mu(f)$ as $n \to \infty$ (from Definition \ref{def:number_limsup_liminf} (iii)).
\end{proof}

\begin{remark}
\ben
\item [(i)] The convergence of the sequence and domination by $g$ is relaxed to hold only $\mu$-almost everywhere provided the measure space $(E, \sE, \mu)$ is complete or $f$ is chosen as a measurable function which agrees with the $\mu$-almost everywhere existing pointwise limit. Sometimes it is called merely in measure (Chung\cite{Chung_2000}). (These precautions are necessary, because otherwise there might exist a non-measurable subset of a $\mu$-null set $N \in \sE$, hence $f$ might not be measurable.)
\item [(ii)] Actually, dominated convergence theorem also implies that $X_n \to X$ in $\sL^1(E,\sE,\mu)$ by Lemma \ref{lem:scheffe}.
\item [(iii)] The condition that there is a dominating integrable function $g$ can be relaxed to uniform integrability of the sequence $\{f_n\}$, see Vitali convergence theorem (Theorem \ref{thm:vitali_convergence}).
\een 
\end{remark}

\begin{example} 
\be
\text{(i) } \int^\infty_0 \sin(e^x)/(1+nx^2)dx \to 0\quad \text{as }\ n\to\infty, \quad\quad \text{(ii) } \int^1_0 (n\cos x)/(1+n^2x^{\frac 32})dx\to 0\quad \text{as }\ n\to \infty.
\ee
\end{example} 

\begin{solution} \ben
\item [(i)] Let $f_n(x) = \sin(e^x)/(1+nx^2)\to 0$ and $g(x)=1/(1+x^2)$. It is easy to check that $g$ is measurable and integrable and $|f_n|\leq g$. Applying dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), we have
\be
\int^\infty_0 \sin(e^x)/(1+nx^2)dx \to \int^\infty_0 0\ dx = 0 \quad\text{as }n\to\infty.
\ee
\item [(ii)] \emph{Approach 1}. Let $f_n(x) = (n\cos x)/(1+n^2x^{\frac 32})\to 0$ and $g(x)=x^{-3/4}$. It is easy to check that $g$ is measurable and integrable on $(0,1]$ and 
\be
|f_n| \leq \frac n{1+n^2x^{\frac 32}} = \frac 1{\frac1n+nx^{\frac 32}} \leq \frac1{2\sqrt{\frac1n \ nx^{\frac 32}}} = \frac 12 x^{-\frac34}\leq g.
\ee
Applying dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), we have
\be
\int^1_0 (n\cos x)/(1+n^2x^{\frac 32})dx\to 0 \text{ as }n\to \infty.
\ee

\emph{Approach 2}. Clearly the integral is at most
\[
 \int_0 ^1 \frac{n}{1+ n^2 x^{\frac{3}{2}}} dx
\]
Now we can substitute $x \mapsto y/n$ to get
\be
\int_0 ^n \frac{1}{1+n^{\frac{1}{2}} y^\frac{3}{2}} dy \leq \int_0 ^1 \frac{1}{1+ (yn^\frac{1}{4})^2} dy + \int _1 ^n \frac{1}{1 + \sqrt{n} y} dy \leq \frac{\tan ^{-1}(1)}{n^\frac{1}{4}} + \frac{\log(n)}{\sqrt{n}} \to 0.
\ee
\een
\end{solution}

Note that in Theorem \ref{thm:lebesgue_integrable_function_property} (iii) we lose the reverse implication. The following result is sometimes useful:

\begin{proposition}
Let $\sA$ be a $\pi$-system containing $E$ and generating $\sE$. Then, for any integrable function $f$,
\be
\mu(f\ind_A) = 0 \quad \text{for all }A \in \sA \ \ra\  f = 0 \text{ a.e.}.
\ee
\end{proposition}
\begin{proof}[\bf Proof]
Consider $\sD=\left\{A\in\sE:\mu(f\ind_A)=0\right\}$. Obviously, $\sA\subseteq \sD$ and $\sD\subseteq \sE$. Now we want to prove that $\sD=\sE$. It suffices to show that $\sE\subseteq \sD$ and $\sD$ is $d$-system (then $\sD$ is a $\sigma$-algebra by Dynkin's Lemma (Lemma \ref{lem:dynkin_lemma})).
\ben
\item [(i)] We know that $\sA$ contains $E$, thus $E\in\sD$.
\item [(ii)] $\forall A,B\in\sD$ with $A\subseteq B$, we have $\mu(f\ind_A)= 0,\  \mu(f\ind_B)= 0$
\be
\underbrace{\mu\bb{ f\ind_{\{B\bs A\}}} = \mu(f\ind_B) - \mu\lob f\ind_{\{A\cap B\}}\rob}_{f\text{ is integrable}} = \mu(f\ind_B) - \mu\lob f\ind_A\rob =0 \ \ra \ B\bs A \in\sD.
\ee
\item [(iii)] For increasing sequence $A_n\in \sD$ with $A_n\subseteq A_{n+1}$, we have $\mu(f\ind_{A_n})= 0$. Also we have
\be
f\ind_{A_n} \to f\ind_{\left\{\bigcup\limits_nA_n\right\}}
\ee
Since $f$ is integrable function, we have that $f_n = f\ind_{A_n}$ is bounded by $f$, ($|f\ind_{A_n}|\leq |f|$). Then apply dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), we have
\be
\mu\lob f\ind_{A_n} \rob \to \mu\lob f\ind_{\left\{\bigcup\limits_nA_n\right\}}\rob \ \ra \ \mu\lob f\ind_{\left\{\bigcup\limits_nA_n\right\}}\rob =0 \ \ra \ \bigcup\limits_nA_n \in \sD.
\ee
\een
Then we can say that $\sD=\sE$ and for all $A\in \sE$, we have $\mu(f\ind_A)=0$. Thus,
\be
\mu(f^+) = \mu \lob f\ind_{\{f>0\}}\rob = 0\ \ra \ f^+ = 0 \text{ a.e.}. \quad\quad (\text{Theorem \ref{thm:non_negative_measurable_property} (iii)})
\ee
Similarly, we have $f^-=0$ a.e. and 
\beast
\mu\bb{\{f\neq 0\}} & = & \mu\bb{\{f>0\} \text{ or } \{f<0\}} = \mu\bb{\{f>0\}} + \mu\bb{\{f<0\}} \\
& = & \mu\bb{\{f^+ \neq 0\}} + \mu\bb{\{f^-\neq 0\}} = 0 + 0 = 0 \quad\ra\quad f=0 \text{ a.e.}.
\eeast
\end{proof}



\begin{corollary}[bounded convergence theorem\index{bounded convergence theorem!measurable function}]\label{thm:bounded_convergence_measure}
Let $(E,\sE,\mu)$ be a measure space. Let $f$ be a measurable function and let $(f_n : n \in \N)$ be a sequence of such functions. Suppose that $f_n(x) \to f(x)$ a.e.. and that $|f_n| \leq M$ a.e. for all $n$, for a constant $M$. Then for all $n$ and $\mu(f_n) \to \mu(f)$.
\end{corollary}
\begin{proof}[\bf Proof]
Let $g = M$ (since the constant $M$ is integrable) and apply dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure})
\end{proof}
\begin{remark}
If we release the condition to $f_n(x) \to f(x)$ in measure with additional condition that $\mu$ is finite, we can have another version of Bounded Convergence Theorem (Durrett\cite{Durrett_2004}).
\end{remark}

\begin{theorem}[bounded convergence theorem\index{bounded convergence theorem!finite measure}]\label{thm:bounded_convergence_finite_measure}
Let $(E,\sE,\mu)$ be a measure space with $\mu(E) <\infty$. Let $f$ be a measurable function and let $(f_n : n \in \N)$ be a sequence of such functions. Suppose $f_n \to f$ in measure and $|f_n| \leq M$ for all $n$, for some constant $M < \infty$. Then $\mu\bb{\abs{f_n - f}}\to 0$, which implies that $\mu(f_n)\to \mu(f)$.
\end{theorem}

\begin{proof}[\bf Proof]
Let $\mu(E) = C$. By Theorem \ref{thm:convergence_in_measure} (ii), $f$ is the almost everywhere limit of a subsequence, so 
\be
|f| = \abs{f_{n_k} - f_{n_k} + f} \leq \abs{f_{n_k}-f} + \abs{f_{n_k}} \leq \abs{f_{n_k}-f} + M \to M \text{ \ a.e.}\quad\ra\quad f \text{ is integrable}.
\ee

For $\ve > 0$, there exists $N$ such that $n \geq N$ implies (by definition of convergence in measure (Definition \ref{def:convergence_in_measure}))
\be
\mu\bb{\{\abs{f_n - f} > \ve/(2C)\}} \leq \ve/(4M).
\ee

Then $\mu\bb{|f_n-f|} = \mu\bb{|f_n-f|\ind_{\{|f_n-f|>\ve/(2C)\}}}+\mu\bb{|f_n-f|\ind_{\{|f_n-f|\leq \ve/(2C)\}}}  \leq 2M(\ve/4M)+\ve/2 = \ve$ implies that 
\be
\mu(\abs{f_n-f})\to 0.
\ee 

Also, by Theorem \ref{thm:lebesgue_integrable_function_property} (i), (iv), $\abs{\mu(f_n) - \mu(f)} = \abs{\mu(f_n - f)} \leq \mu(\abs{f_n-f})\to 0\ \ra\  \mu(f_n)\to \mu(f)$.
\end{proof}

\begin{theorem} 
Let $(f_n:n\in\N)$ be a sequence of integrable functions and suppose that $f_n\to f$ a.e. for some integrable function $f$. Show that, if $\mu\bb{\abs{f_n}} \to \mu\bb{\abs{f}}$, then $\mu\bb{\abs{f_n - f}} \to 0$.
\end{theorem} 

\begin{proof}[\bf Proof]
We have $\liminf_{n \to \infty} \abs{f_n} = \abs{f} \; \mathrm{a.e.}$, and $\liminf_{n \to \infty} \abs{f_n-f} = 0 \; \mathrm{a.e.}$, so by Theorem \ref{thm:non_negative_measurable_property},
\[
 \mu(\liminf_{n \to \infty} \abs{f_n}) = \mu(\abs{f}) \quad \text{and} \quad  \mu(\liminf_{n \to \infty} \abs{f_n-f}) = 0.
\]

Thus, by Fatou's lemma (Lemma \ref{lem:fatou_function}) (as $\abs{f} + \abs{f_n} - \abs{f_n-f}\geq 0$) and the fact that $\mu\bb{\abs{f_n}} \to \mu\bb{\abs{f}}$, we have that
\beast
 \mu(\liminf_{n \to \infty} (\abs{f} + \abs{f_n} - \abs{f_n-f})) & \leq & \liminf_{n \to \infty} \mu(\abs{f}+\abs{f_n}-\abs{f_n-f})\\
 \mu\bb{\liminf_{n \to \infty} \abs{f}} + \mu\bb{\liminf_{n \to \infty} \abs{f_n}} - \mu\bb{\liminf_{n \to \infty} \abs{f_n-f}} & \leq & \liminf_{n \to \infty} \mu\bb{\abs{f}}+\liminf_{n \to \infty} \mu\bb{\abs{f_n}}-\limsup_{n \to \infty} \mu\bb{\abs{f_n-f}}\\
2\mu\bb{\abs{f}}  & \leq & 2\mu\bb{\abs{f}} -\limsup_{n \to \infty} \mu\bb{\abs{f_n-f}}\\
\limsup_{n \to \infty} \mu\bb{\abs{f_n-f}} & \leq & 0.
\eeast

But of course, $0 \leq \liminf_{n \to \infty} \mu\bb{\abs{f_n -f}} \leq \limsup_{n \to \infty}\mu\bb{\abs{f_n-f}}$, whence $\mu\bb{\abs{f_n - f}} \to 0$.
\end{proof}

The above theorems give us Scheff\'e's Lemma. A different proof is given in Williams\cite{Williams_1991}.$P_{55}$.

\begin{lemma}[Scheff\'e's Lemma\index{Scheff\'e's Lemma!measure}]\label{lem:scheffe}
let $(f_n : n \in \N)$ and $f$ be a sequence of integrable functions. Suppose that $f_n(x) \to f(x)$ a.e..
\ben
\item [(i)] If $f_n$ and $f$ are non-negative, then $\mu\bb{\abs{f_n -f}} \to 0$ if and only if $\mu(f_n) \to \mu(f)$.
\item [(ii)] $\mu\bb{\abs{f_n -f}} \to 0$ if and only if $\mu(\abs{f_n}) \to \mu(\abs{f})$.
\een
\end{lemma}

\begin{proof}[\bf Proof]
The 'only if' part of (i) and (ii) is in Theorem \ref{thm:bounded_convergence_finite_measure}.

($\la$) (i) Now suppose $\mu\bb{f_n}\to \mu(f)$. Since $(f-f_n)^+ = (f_n -f)^- \leq f$, by dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), $\mu((f_n - f)^-) \to 0$. By Theorem \ref{thm:lebesgue_integrable_function_property},
\be
\abs{\mu\bb{(f_n -f)\ind_{f_n < f}}} = \abs{\mu\bb{(f_n-f)^-}} \leq \mu\bb{\abs{(f_n-f)^-}} \to 0
\ee

Thus, 
\be
\abs{\mu((f_n -f)^+)} = \abs{\mu\bb{(f_n -f)\ind_{f_n \geq f}} } = \abs{\mu(f_n) - \mu(f) - \mu\bb{(f_n -f)\ind_{f_n < f}}}\leq \abs{\mu(f_n) - \mu(f)} +\abs{\mu\bb{(f_n -f)\ind_{f_n < f}}} \to 0.
\ee
\be
\ra\quad\quad \mu\bb{f_n - f} = \mu((f_n -f)^+) - \mu((f_n -f)^-) \to 0 \quad \ra\quad \mu(f_n) \to \mu(f).
\ee

(ii) Since $f_n \to f$ a.e., $f_n^+ \to f^+$ a.e. and $f_n^- \to f^-$ a.e.. Then apply (i) to get the required result.
\end{proof}


\subsection{Transformations of integrals}

\begin{proposition}\label{pro:sub_measure}
Let $(E, \sE, \mu)$ be a measure space and let $A \in \sE$. Then the set $\sE_A$ of measurable subsets of $A$ is a $\sigma$-algebra and the restriction $\mu_A$ of $\mu$ to $\sE_A$ is a measure. Moreover, for any non-negative measurable function $f$ on $E$, we have
\be
\mu(f\ind_A) = \mu_A(f|_{\{x\in A\}}).
\ee
\end{proposition}
\begin{proof}[\bf Proof]
For any measurable set $A\in \sE$, we define $\sE = \{B\in \sE: B\subseteq A\}$ and we prove that $\sE_A$ is a $\sigma$-algebra.
\ben
\item [(i)] We have $\emptyset \in \sE$ and $\emptyset \subseteq A$ imply $\emptyset \in \sE_A$. Also, $A\in \sE$ and $\emptyset \subseteq A$ imply $A \in \sE_A$.

\item [(ii)] If $B\in \sE_A$, then $B\in \sE$ and $B\subseteq A$. So $B^c_A = A\bs B\subseteq A$ and $B^c_A = A\bs B \in \sE$ as $A\in \sE,\ B\in \sE \ \ra\ B^c_A \in \sE_A$.

\item [(iii)] For $A_n \in \sE_A$, $n\in\N$, $A_n \subseteq A$ and $A_n \in \sE$. Then
\be
\left\{\ba{l}
A_n \in \sE \ \ra \ \bigcup_n A_n \in \sE\\
A_n \subseteq A, \ n\in \N \ \ra \ \bigcup_n A_n \subseteq A 
\ea\right. \quad\ra \quad \bigcup_n A_n \in \sE_A.
\ee
\een

Second, we prove $\mu_A$, the measure $\mu$ to $\sE_A$ is a measure on $(A,\sE_A)$. Then $\mu_A(\underbrace{\emptyset}_{\in \sE_A}) = \mu(\emptyset) = 0$ as $\mu$ is a measure.

For disjoint sets $B_n \in \sE_A$, $n\in\N$,
\be
\mu_A\underbrace{\bb{\bigcup_n B_n}}_{\in \sE_A} = \mu\bb{\bigcup_n B_n} = \sum_n \mu\bb{B_n} = \sum_n \mu_A\bb{B_n} \quad\ra \quad \mu_A \text{ is a measure.}
\ee

Now if $f$ is indicator function $\ind_B$, $B\in \sE$, we have
\be
\mu\bb{f\ind_A} = \mu\bb{\ind_B \ind_A} = \mu\underbrace{\bb{\ind_{B\cap A}}}_{\in \sE_A} = \mu_A \bb{\ind_{B\cap A}} = \mu_A\bb{\ind_B|_{\{x\in A\}}} = \mu_A\bb{f|_{\{x\in A\}}}.
\ee

By linearity, the result also hold for simple function. For non-negative measurable function $f$, set $f_n = 2^{-n}\floor{2^nf}\land n$ and $f_n$ are simple. Then $f_n \ind_A \ua f \ind_A$ and $f_n|_{\{x\in A\}} \ua f|_{\{x\in A\}}$. By monotone convergence (Theorem \ref{thm:monotone_convergence_pointwise}),
\be
 \mu(f_n \ind_A) \ua \mu(f\ind_A) \quad \text{ and } \quad \mu_A (f_n |_{\{x\in A\}}) \ua \mu_A (f|_{\{x\in A\}}).
\ee
Since $\mu(f_n \ind_A)=\mu_A (f_n |_{\{x\in A\}})$ , the result follows.
\end{proof}

\begin{example}
In the case of Lebesgue measure on $\R$, we write, for any interval $I$ with inf $I = a$ and $\sup I = b$, 
\be
\underbrace{\int_{\R} f(x)\ind_I(x)\mu(dx) = \int_I f(x)\mu(dx)}_{\text{Proposition \ref{pro:sub_measure}}}= \underbrace{\int_I f(x)dx}_{\text{Lebesgue measure}} = \int^b_a f(x)dx.
\ee
Note that the sets $\{a\}$ and $\{b\}$ have measure zero (by Proposition \ref{pro:singleton_point_measure}), so we do not need to specify whether they are included in $I$ or not.
\end{example}

\begin{proposition}\label{pro:image_measure_function}
Let $(E, \sE)$ and $(G, \sG)$ be measurable spaces and let $f : E \to G$ be a measurable function. Given a measure $\mu$ on $(E, \sE)$, define $\nu = \mu \circ f^{-1}$, the image measure on $(G, \sG)$. Then, for all non-negative measurable functions $g:G\to [0,\infty]$,
\be
\nu(g) = \mu(g \circ f).
\ee
\end{proposition}
\begin{proof}[\bf Proof]
If $g = \ind_A$, $A\in \sG$, $\nu(g) = \nu\bb{\ind_A} = \nu\bb{A} = \mu\bb{f^{-1}(A)} = \mu \bb{\ind_{\{x:f(x)\in A\}}} = \mu\bb{\ind_A \circ f} = \mu\bb{g \circ f}$.

By linearity, the result also hold for simple function, $g = \sum^n_{k=1} a_k \ind_{A_k}$, $a_k\in [0,\infty]$, with $A_k$ disjoint,
\be
\nu\bb{\sum^n_{k=1}a_k\ind_{A_k}} = a_k \sum^n_{k=1} \nu\bb{\ind_{A_k}} = a_k \sum^n_{k=1} \mu\bb{\ind_{A_k} \circ f} = \mu\bb{\sum^n_{k=1} \bb{a_k \ind_{A_k} \circ f}} = \underbrace{\mu\bb{\bb{\sum^n_{k=1} a_k \ind_{A_k}} \circ f}}_{A_k \text{ is disjoint}} = \mu\bb{g \circ f}
\ee
by Theorem \ref{thm:non_negative_measurable_property} as $\{f(x):x\in E\}$ is measurable and hence $\ind_{A_k} \circ f = \ind_{A_k \cap \{f(x):x\in E\}} = \ind_{\{x:f(x)\in A\}}$ is non-negative measurable function. For non-negative measurable function $g$, set 
\be
g_n = 2^{-n}\floor{2^ng}\land n
\ee
and thus $g_n$ are simple. Then $g_n \ua g$ and $g_n \circ f \ua g \circ f$. By monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}),
\be
\nu(g_n) \ua \nu(g) ,\quad\quad \mu\bb{g_n \circ f} \ua \mu\bb{g \circ f}.
\ee
Since $\nu(g_n) = \mu\bb{g_n \circ f}$, $\nu(g) = \mu\bb{g \circ f}$.
\end{proof}


\begin{proposition}\label{pro:density_function_measure}
Let $(E, \sE, \mu)$ be a measure space and let $f:E\to [0,\infty]$ be a non-negative measurable function on $E$. Define $\nu(A) = \mu(f\ind_A)$, $A \in \sE$. Then $\nu$ is a measure on $E$ and, for all non-negative measurable functions $g:E\to [0,\infty]$,
\be
\nu(g) = \mu(fg).
\ee
We say that $\nu$ has density $f$ (with respect to Lebesgue measure). $f$ is called the density function\index{density function!measure} of $\nu$ with respect to $\mu$.
\end{proposition}

\begin{proof}[\bf Proof]
If $g = \ind_A$, $A\in \sE$, $\nu\bb{g} = \nu\bb{\ind_A} = \nu\bb{A} = \mu\bb{f\ind_A} = \mu\bb{fg}$.

By linearity, the result also hold for simple function, $g = \sum^n_{k=1} a_k \ind_{A_k}$, $a_k\in [0,\infty]$, with $A_k$ disjoint,
\be
\nu\bb{\sum^n_{k=1}a_k\ind_{A_k}} = a_k \sum^n_{k=1} \nu\bb{\ind_{A_k}} = a_k \sum^n_{k=1} \mu\bb{f\ind_{A_k}} = \mu\bb{f \sum^n_{k=1} a_k \ind_{A_k} } = \mu\bb{fg}
\ee
by Theorem \ref{thm:non_negative_measurable_property}. For non-negative measurable function $g$, set $g_n = 2^{-n}\floor{2^ng}\land n$ and thus $g_n$ are simple. Then $g_n \ua g$ and $fg_n \ua fg$. By monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}),
\be
\nu(g_n) \ua \nu(g) ,\quad\quad \mu\bb{fg_n} \ua \mu\bb{fg}.
\ee

Since $\nu(g_n) = \mu\bb{fg_n}$, $\nu(g) = \mu\bb{fg}$.
\end{proof}

\begin{remark}
$\mu$ and $\nu$ are measures on $(E,\sE)$.

In particular, to each non-negative Borel function $f$ on $\R$, there corresponds a Borel measure $\nu$ on $\R$ given by 
\be
\nu(A) = \int_A f(x)\mu(dx).
\ee

Then, for all non-negative Borel functions $g$,

\be
\nu(g) = \int_{\R} g(x)f(x)\mu(dx) = \int_{\R} g(x)f(x)dx.
\ee
\end{remark}


\begin{theorem}[uniqueness of the density function]\label{thm:uniqueness_density_function}%$\nu(E)<\infty$,
Let $\mu$ and $\nu$ be two measures on $(E,\sE)$. If $f$, $g$ are two density functions of $\nu$ with respect to $\mu$ and $\nu$ is $\sigma$-finite, then $f = g$, $\mu$-a.e., $\nu$-a.e. as well.
\end{theorem}

\begin{proof}[\bf Proof]
Assume $f,g$ are two densities of $\nu$ with respect to $\mu$. Let $A_n \ua E$ with $A_n \in \sE$ and 
\be
B_n = A_n \cap \{f>g\}\in \sE\quad \text{as $f$, $g$ is measurable.}
\ee

Then $(f-g)\ind_{B_n}$ is non-negative measurable, by Theorem \ref{thm:non_negative_measurable_property} (i), 
\beast
\mu\bb{(f-g)\ind_{B_n}} + \mu\bb{g\ind_{B_n}} & = & \mu\bb{f\ind_{B_n}}\\
\mu\bb{(f-g)\ind_{B_n}} + \nu\bb{B_n} & = & \nu\bb{B_n}\\
\mu\bb{(f-g)\ind_{B_n}} & = & 0.\quad\quad (\text{as }\nu(B_n) < \infty)
\eeast

By Theorem \ref{thm:non_negative_measurable_property} (iii), $(f-g)\ind_{B_n} = 0 \ \mu\text{-a.e.}$, thus,
\be
0 = \mu\bb{\bra{f\neq g}\cap B_n} = \mu\bb{B_n} \ \ra\  \ind_{B_n} = 0 \ \mu\text{-a.e.} \ \ra \ \mu\bb{B_n} = 0.
\ee

As $\ind_{B_n}\ua \{f>g\}$, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_almost_everywhere}),
\be
\mu\bb{B_n} \ua \mu\bb{\{f>g\}} \quad\ra\quad 0 = \mu\bb{\{f>g\}} .
\ee
Similarly, for the case $f<g$, we have $\mu\bb{\{f<g\}} = 0$, and hence
\be
\mu\bb{\{f\neq g\}} = \mu\bb{\{f>g\}} + \mu\bb{\{f<g\}} = 0 + 0 = 0 \quad\ra\quad f=g  \ \ \mu\text{-a.e.}
\ee

With the same setting, 
\beast
\nu\bb{(f-g)\ind_{B_n}} + \nu\bb{g\ind_{B_n}} & = & \nu\bb{f\ind_{B_n}}\\
\nu\bb{(f-g)\ind_{B_n}} + \mu\bb{fg\ind_{B_n}} & = & \mu\bb{fg\ind_{B_n}}\\
\nu\bb{(f-g)\ind_{B_n}} & = & 0. \quad\quad (\text{as } fg\ind_{B_n} = 0 \text{ $\mu$-a.e.})%\mu\bb{fg\ind_{B_n}} \leq \bb{\sup fg}\mu(B_n) = 0)
\eeast

Then we have $f=g$ $\nu$-a.e., with the same argument for $\mu$.
\end{proof}


\subsection{Relation to Riemann integral}

\begin{theorem}[Riemann-Lebesgue Integral]\label{thm:riemann_lebesgue_integral}
Let $I = [a, b]$ and $f : I \to \R$. Let $\mu$ denote the Lebesgue measure. Then $f$ is Lebesgue-integrable on $I$ with integral
\be
\int_I fd\mu = \int^b_a f(x)dx.
\ee
\end{theorem}
\begin{proof}[\bf Proof]
Recall that $f$ is said Riemann-integrable\index{integrable!Riemann} with integral $R$ if for all $\ve > 0$, there exists $\delta > 0$ such that for all finite partitions of $I$ into subintervals $I_1= (a_1,b_1],\ \dots,\ I_k = (a_k,b_k]$ of mesh $\max_{1\leq j\leq k} \mu(I_j) = \max_{1\leq j\leq k} (b_j -a_j) \leq \delta$,
\be\label{equ:relation_to_riemann}
\abs{R - \sum^k_{j=1} f(x_j)\mu(I_j)} < \ve,\quad\quad R = \int^b_a f(x)dx \quad \quad \text{whenever }x_j \in I_j, \ 1 \leq j \leq k. 
\ee

We may assume without loss of generality that $I = [0, 1]$. Consider the dyadic subdivision of $I$, that is, for $n \geq 1$ and $0 \leq k \leq 2^n - 1$, let $I_{k,n} = [k2^{-n}, (k + 1)2^{-n}]$. Consider the function
\be
F^+ = \lim_{n\to\infty} \sum^{2^n-1}_{k=0} 2^{-n} \sup_{I_{k,n}} f, \quad\quad F^- =\lim_{n\to\infty} \sum^{2^n-1}_{k=0} 2^{-n} \inf_{I_{k,n}} f,
\ee

\be
\ol{f}_n(x) = \sum^{2^n-1}_{k=0} \sup_{I_{k,n}} f \ind_{I_{k,n}}(x),\quad\quad \ul{f}_n(x) = \sum^{2^n-1}_{k=0} \inf_{I_{k,n}} f\ind_{I_{k,n}}(x)
\ee

Then note that 
\be
\ol{f}_n = \sum^{2^n-1}_{k=0} \sup_{I_{k,n}} (f^+ - f^-) \ind_{I_{k,n}}(x) = \sum^{2^n-1}_{k=0} \bb{\sup_{I_{k,n}} f^+ - \inf_{I_{k,n}}f^-} \ind_{I_{k,n}}(x)
\ee
is a linear combination of simple functions and is a decreasing sequence of functions, while $\ul{f}_n$ is non-decreasing. Moreover
\be
\ul{f}_n \leq f \leq \ol{f}_n.
\ee

Since $f$ is Riemann integrable, we know that $F^+ = F^-$ and therefore $f$ is bounded (i.e. $\abs{f} <M$ for some $M$, from Definition \ref{def:riemann_integrable}). Thus 
\be
\mu\bb{\bb{\sup_{I_{k,n}} f^+ - \inf_{I_{k,n}}f^-} \ind_{I_{k,n}}(x)} = \mu\bb{\sup_{I_{k,n}} f^+\ind_{I_{k,n}}(x)} - \mu\bb{\inf_{I_{k,n}}f^- \ind_{I_{k,n}}(x)}
\ee
by boundedness. Then, we have
\beast
R & = & \lim_{n\to\infty} \mu\bb{\ol{f}_n} = \lim_{n\to\infty} \int_I \ol{f}_n d\mu = \lim_{n\to\infty} \sum^{2^n-1}_{k=0} \bb{\sup_{I_{k,n}} f^+ - \inf_{I_{k,n}}f^-} 2^{-n} = \lim_{n\to\infty} \sum^{2^n-1}_{k=0} 2^{-n} \sup_{I_{k,n}} f \\
& = & \lim_{n\to\infty} \mu\bb{\ul{f}_n} = \lim_{n\to\infty} \int_I \ul{f}_n d\mu = \lim_{n\to\infty} \sum^{2^n-1}_{k=0} \bb{\inf_{I_{k,n}} f^+ - \sup_{I_{k,n}}f^-} 2^{-n} = \lim_{n\to\infty} \sum^{2^n-1}_{k=0} 2^{-n} \inf_{I_{k,n}} f  
\eeast
To see this, use (\ref{equ:relation_to_riemann}) with $x_k$ such that $f(x_k)$ is arbitrarily close to $\sup_{I_{k,n}} f$ and $\inf_{I_{k,n}} f$ respectively, $0 \leq k \leq 2^n - 1$ since $f$ is bounded. Since $\ol{f}_n$ and $\ul{f}_n$ are monotone and bounded, by fundamental axiom of real numbers (Axiom \ref{axm:fundamental_axiom_of_analysis}), the limit of $\ol{f}_n$ and $\ul{f}_n$ exist, define
\be
\ol{f}_n \da \lim \ol{f}_n := \ol{f} ,\quad\quad \ul{f}_n \ua \lim \ul{f}_n := \ul{f}.
\ee

Then $\ol{f}$ and $\ul{f}$ are measurable as pointwise limits of simple functions linear combination, and by the dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}, actually bounded convergence theorem Theorem \ref{thm:bounded_convergence_measure}), 
\be
\int_I \ol{f} d\mu = \mu\bb{\lim \ol{f}_n} = \lim_{n\to\infty}\mu\bb{\ol{f}_n} = R = \lim_{n\to\infty}\mu\bb{\ul{f}_n} = \mu\bb{\lim \ul{f}_n} = \int_I \ul{f} d\mu. 
\ee

Since $\ul{f}$ and $\ol{f}$ are measurable and bounded, they are Lebesgue-integrable. With the fact that $\ul{f} \leq \ol{f}$, we have
\be
\underbrace{\mu\bb{\ol{f} - \ul{f}} + \mu\bb{\ul{f}} = \mu\bb{\ol{f}}}_{\text{Theorem \ref{thm:lebesgue_integrable_function_property}}}\quad \ra \quad \mu\bb{\ol{f} - \ul{f}} = 0 \quad \lra \quad \ol{f} = \ul{f} \text{ a.e.}.
\ee

Thus, since $\ul{f} \leq f \leq \ol{f}$, we deduce that $f = \ol{f}$ a.e. and then $\ol{f}_n \to f$ a.e. ($\ol{f}$ is $\sB(I)$-measurable and $f$ is $\sB(I)^\mu$-measurable, where $\sB(I)^\mu$ is Lebesgue completion of $\sB(I)$, from Proposition \ref{pro:completion}, see Klenke\cite{Klenke_2008}). So by bounded convergence theorem Theorem \ref{thm:bounded_convergence_measure}, $f$ is integrable. 
\be
\int_I f d\mu = \mu\bb{f} = \lim_{n\to \infty}\mu\bb{\ol{f}_n} = R,
\ee
which proves the result.
\end{proof}

\begin{example}
The function $\ind_{\{\Q\cap [0,1]\}}$ is Lebesgue-integrable with integral 0 (since $\mu(\Q) = 0$) but is not Riemann-integrable.
\end{example}

\subsection{Fundamental theorem of calculus}

We show that integration with respect to Lebesgue measure on $\R$ acts as an inverse to differentiation. Since we restrict here to the integration of continuous functions, the proof is the same as for the Riemann integral.

\begin{theorem}[fundamental theorem of calculus\index{fundamental theorem of calculus!measure theory}]\label{thm:fundamental_theorem_of_calculus_lebesgue}
\ 

\ben
\item [(i)] Let $f : [a, b] \to \R$ be a continuous function and set 
\be
F_a(t) = \int^t_a f(x)dx.
\ee

Then $F_a$ is differentiable on $(a, b)$, with $F'_a = f$.

\item [(ii)] Let $F : [a, b] \to \R$ be differentiable with continuous derivative $f$. Then 
\be
\int^b_a f(x)dx = F(b) - F(a).
\ee
\een
\end{theorem}
\begin{proof}[\bf Proof]
\ben
\item [(i)] First, $f$ is bounded (from Theorem \ref{thm:continuous_on_bounded_set_is_bounded}) and measurable (from the definition), thus integrable. Fix $t \in [a, b)$. Given $\ve > 0$, there exists $\delta > 0$ such that $|f(x) - f(t)| < \ve$ whenever $|x - t| <\delta$ (definition of continuity). So, for $0 < h \leq \delta$, 
\beast
\abs{\frac{F_a(t + h) - F_a(t)}h - f(t)} & = & \frac 1h \abs{\int^{t+h}_t (f(x) - f(t))dx} = \frac 1h \abs{\int_I (f(x) - f(t))dx}  = \frac 1h \abs{\int (f(x) - f(t))\ind_I dx} \\
& \leq & \frac 1h \int \abs{(f(x) - f(t))\ind_I}dx \quad\quad (\text{Theorem \ref{thm:lebesgue_integrable_function_property} (iv)})\\
& = & \frac 1h \int^{t+h}_t |f(x) - f(t)|dx < \frac {\ve}h \int^{t+h}_t dx = \ve.
\eeast

Hence $F_a$ is differentiable on the right at $t$ with derivative $f(t)$. Similarly, for all $t \in (a, b]$, $F_a$ is differentiable on the left at $t$ with derivative $f(t)$. 

\item [(ii)] We know that $F_a$ is continuous on $[a,b]$ (by Theorem \ref{thm:integral_continuity}) and differentiable on $(a,b)$ (by (i)). Thus, $F-F_a$ is continuous on $[a,b]$ and differentiable on $(a,b)$ (by Proposition \ref{pro:basic_continuous_property} and Proposition \ref{pro:differentiable_property}). Then by the mean value theorem (Theorem \ref{thm:mean_value}), there exists $c\in (a,b)$ such that
\be
(F-F_a)(b) - (F-F_a)(a) = (F-F_a)'(c)(b-a) = (f(c) - f(c))(b-a) = 0.
\ee

Also, $(F -F_a)'(t) = (f-f)(t) = 0$ for all $t \in (a, b)$ so $F -F_a$ is constant on $(a,b)$ (thus on $[a,b]$ by continuity),

\be
F(b) - F(a) = F_a(b) - F_a(a) = \int^b_a f(x)dx.
\ee
\een
\end{proof}

\begin{proposition}
Let $\phi : [a, b] \to \R$ be continuously differentiable and strictly increasing. Then, for all non-negative Borel functions $g$ on $[\phi(a), \phi(b)]$, 
\be
\int^{\phi(b)}_{\phi(a)} g(y)dy = \int^b_a g(\phi(x))\phi'(x)dx. \quad\quad (*)
\ee
\end{proposition}
\begin{proof}[\bf Proof]
First, the case where $g$ is the indicator function of an interval, $\ind_{[\phi(\alpha),\phi(\beta)]}$ 
\beast
\int^b_a g(\phi(x))\phi'(x)dx & = & \int^b_a \ind_{\phi(x) \in [\phi(\alpha),\phi(\beta)]}\phi'(x)dx = \int^\beta_\alpha \phi'(x)dx\\
& = & \phi(\beta) - \phi(\alpha) \quad\quad\quad \text{(fundamental theorem of calculus (Theorem \ref{thm:fundamental_theorem_of_calculus_lebesgue} (ii)))} \\
& = & \int^{\phi(b)}_{\phi(a)} \ind_{[\phi(\alpha),\phi(\beta)]} dy = \int^{\phi(b)}_{\phi(a)} g(y)dy.
\eeast

Let $(E,\sE)$ be a measurable space ($E=[a,b]$) and $\sA$ be a set of all the intervals (thus $\pi$-system generating $\sE$). Let $\sV$ be a set of bounded, measurable (thus Lebesgue-integrable) function for which $(*)$ holds, then $\sV$ is a vector space. We have check that for any interval $A\in \sA$, $(*)$ holds for $\ind_A$, thus, $\ind_A \in \sV$. Obviously, $\ind_E \in \sV$.

Furthermore, if $f_n\in \sV$ for all $n$ and $f$ is bounded with $0\leq f_n \ua f$, then $f$ is measurable (as $f$ is the limit of $f_n$). Since $\phi$ and $\phi'$ are continuous, $\phi$ and $\phi'$ are measurable (by Proposition \ref{pro:continuous_measurable},).

Therefore functions $f_n$, $f$, $(f_n\circ \phi)\phi'$, $(f_n\circ \phi)\phi'$ are measurable as composition of measurable functions is also measurable (Proposition \ref{pro:composition_measurable}). Thus
\be
f_n \ua f,\quad \quad (f_n\circ\phi)\phi' \ua (f\circ\phi)\phi' \quad\quad \text{as\quad $f_n,f\geq 0$, $\phi'>0$ ($\phi$ is strictly increasing).}
\ee

Thus, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise})
\be
\int^{\phi(b)}_{\phi(a)} f_n(y)dy = \int^b_a f_n(\phi(x))\phi'(x)dx \quad\ra\quad \int^{\phi(b)}_{\phi(a)} f(y)dy = \int^b_a f(\phi(x))\phi'(x)dx\quad\ra\quad f \in \sV.
\ee

Then, by monotone class theorem (Theorem \ref{thm:monotone_class}), $\sV$ contains every bounded measurable function. Now consider any non-negative Borel function $g$ (which is measurable). Thus $g_n = g\land n \in \sV$ for all $n$ as $g_n$ is bounded. With $g_n \ua g$ and $(g_n\circ \phi)\phi'\ua(g\circ \phi)\phi'$, we have 
\be
\int^{\phi(b)}_{\phi(a)} g_n(y)dy = \int^b_a g_n(\phi(x))\phi'(x)dx\quad\ra\quad \int^{\phi(b)}_{\phi(a)} g(y)dy = \int^b_a g(\phi(x))\phi'(x)dx.
\ee
\end{proof}

\begin{proposition} \label{pro:integral_by_parts}
Let $u$ and $v$ be differentiable functions on $[a,b]$ with continuous derivatives $u'$ and $v'$. Then
\be
\int^b_a u(x)v'(x)dx = \{u(b)v(b)-u(a)v(a)\} - \int^b_a u'(x)v(x)dx.
\ee
\end{proposition} 

\begin{proof}[\bf Proof]
We know that $(uv)' = uv' + u'v$ and $(uv)'$ is continuous. Thus, apply fundamental theorem of calculus (Theorem \ref{thm:fundamental_theorem_of_calculus_lebesgue} (ii)),
\be
\int^b_a (u(x)v(x))' dx = (u(x)v(x))|^b_a = u(b)v(b)-u(a)v(a).
\ee

Since $(uv)'$, $uv'$ and $u'v$ are continuous and thus bounded on $[a,b]$, they are Lebesgue-integrable, thus we can apply Theorem \ref{thm:lebesgue_integrable_function_property} (i) to get the required result.
\end{proof}



\subsection{Differentiation under integral sign}

Integration in one variable and differentiation in another can be interchanged subject to some regularity conditions.

\begin{theorem}[differentiation under integral sign\index{differentiation under integral sign}]\label{thm:differentiation_under_integral_sign}
Let $U \subseteq \R$ be open and $(E,\sE)$ be a measurable space. Suppose that $f : U \times E \to \R$ satisfies:
\ben
\item [(i)] $x \mapsto f(t, x)$ is integrable for all $t$,
\item [(ii)] $t \mapsto f(t, x)$ is differentiable for all $x$,
\item [(iii)] for some integrable function $g$, for all $x \in E$ and all $t \in U$, $\abs{\fp{f}{t}(t, x)} \leq g(x)$.
\een

Then the function $x \mapsto (\partial f/\partial t)(t, x)$ is integrable for all $t$. Moreover, the function $F : U \to \R$, defined by 
\be
F(t) = \int_E f(t, x)\mu(dx) \quad \text{is differentiable and }\quad \frac{d}{dt} F(t) = \int_E \fp{f}{t} (t, x)\mu(dx).
\ee
\end{theorem}

\begin{proof}[\bf Proof]
Take any sequence $h_n \to 0$ and set
\be
g_n(x) = \frac{f(t + h_n, x) - f(t, x)}{h_n} - \fp{f}{t} (t, x).
\ee
Then $g_n(x) \to 0$ for all $x \in E$ (since $t$ is differentiable) and, by the mean value theorem (Theorem \ref{thm:mean_value}), $\exists c\in (0,h_n)$,
\beast
|g_n| & = & \abs{\frac{f(t + h_n, x) - f(t, x)}{h_n} - \fp{f}{t} (t, x)} \leq \abs{\frac{f(t + h_n, x) - f(t, x)}{h_n}}+ \abs{\fp{f}{t} (t, x)} \\
& \leq & \abs{f'(t+c, x)}  + \abs{\fp{f}{t} (t, x)} \leq g+ g= 2g
\eeast
for all $n$. In particular, for all $t$, the limit of measurable functions $(f(t + h_n, x) - f(t, x))/h_n $, the function $x\mapsto (\partial f/\partial t)(t, x)$ is hence measurable, and hence integrable, by (iii).Then, by dominated convergence,
\be
\frac{F(t + h_n) - F(t)}{h_n} - \int_E \fp{f}{t}(t, x)\mu(dx) = \int_E g_n(x)\mu(dx) \to 0.
\ee
\end{proof}

\subsection{Product measure and Fubini's theorem}

\begin{definition}\label{def:product_sigma_algebra}
Let $(E_1, \sE_1, \mu_1)$ and $(E_2, \sE_2, \mu_2)$ be finite measure spaces. The set 
\be
\sA = \{A_1 \times A_2 : A_1 \in \sE_1,A_2 \in \sE_2\}
\ee
is a $\pi$-system of subsets of $E = E_1 \times E_2$. Define the product $\sigma$-algebra\index{product $\sigma$-algebra} 
\be
\sE := \sE_1 \otimes \sE_2 = \sigma(A).
\ee
\end{definition}

\begin{remark}
To prove a function $f$ is $\sE$-measurable, we usually fix $x_2\in E_2$, then we can see that the function $x_1 \mapsto f(x_1,x_2)$ is $\sE_1$-measurable and thus $\sE_1\otimes \sE_2$-measurable ($\sE$-measurable). Then we can take a union of countable many sets with respect to different $x_2$ and conclude union is $\sE$-measurable. This will imply that $f$ is $\sE$-measurable.
%This means that if for fixed $x_2$, the funtion $f_1:E_1\to \R,x_1 \mapsto f(x_1,x_2)$ is $\sE_1$-measurable and for fixed $x_1$, the funtion $f_2:E_2\to \R,x_2 \mapsto f(x_1,x_2)$ is $\sE_2$-measurable, then $f$ is $\sE$-measurable.
\end{remark}


\begin{lemma}\label{lem:e_2_measurable}
Let $f : E \to \R$ be $\sE$-measurable. Then, for all $x_1 \in E_1$, the function $x_2 \mapsto f(x_1, x_2) : E_2 \to \R$ is $\sE_2$-measurable.
\end{lemma}

\begin{proof}[\bf Proof]
Denote by $\sV$ the set of bounded functions $f$ such that for all $x_1 \in E_1$, the function $x_2 \mapsto f(x_1, x_2) : E_2 \to \R$ is $\sE_2$-measurable. Clearly, $\sV$ is a vector space (Definition \ref{def:vector_space}). 

First, $\ind_E = \ind_{E_1}\ind_{E_2} = 1$, which is bounded. Also, it is $\sE_2$-measurable since it is a constant. For the indicator function $\ind_A$ of any set $A \in \sA$ where $\sA$ is a $\pi$-system generating $\sE$, thus $\ind_A$ is bounded. Then $\ind_A = \ind_{A_1}\ind_{A_2}$, where $\ind_{A_1}$ can be considered as a constant with respect to $\sE_2$. Thus, $A_2$ is $\sE_2$-measurable and so is $\ind_{A_2}$. So the $\ind_A$ is product of $\ind_{A_2}$ and constant, hence $\sE_2$-measurable.

Moreover, if $f_n \in \sV$ for all $n$ and if $f$ is bounded with $0 \leq f_n \ua f$ for any $x_1\in E_1,x_2\in E_2$, we can fix $x_1$ and get that the limit $f$ of $\sE_2$-measurable functions $f_n$ is also $\sE_2$-measurable, thus $f \in \sV$. 

So, by the monotone class theorem (Theorem \ref{thm:monotone_class}), $\sV$ contains all bounded $\sE$-measurable functions $f$. Now consider any $\sE$-measurable function $f$, $f_n := (-n)\lor f \land n$ is bounded and $\sE$-measurable, thus for all $x_1 \in E_1$, the function $x_2 \mapsto f_n(x_1, x_2) : E_2 \to \R$ is $\sE_2$-measurable. For all $x_1\in E_1$, $f_n(x_1,x_2)\ua f(x_1,x_2)$ or $f_n(x_1,x_2)\da f(x_1,x_2)$, $f(x_1,x_2)$ is $\sE_2$-measurable as a limit of $\sE_2$-measurable sequence $f_n$.
\end{proof}

\begin{lemma}\label{lem:e_1_measurable}
For all bounded $\sE$-measurable functions $f$, the function
\be
x_1 \mapsto g(x_1) = \int_{E_2} f(x_1, x_2)\mu_2(dx_2) : E_1 \to \R
\ee
is bounded and $\sE_1$-measurable.
\end{lemma}

\begin{proof}[\bf Proof]
From Lemma \ref{lem:e_2_measurable}, we know that for any bounded $\sE$-measurable $f$, $f(x_1, x_2)$ is $\sE_2$-measurable for any $x_1\in E_1$. Also, as $f$ is bounded, $\abs{f}\leq M$ for some constant $M>0$, we have for any $x_1\in E_1$
\be
\underbrace{\mu_2(\abs{f}) \leq \mu_2(M)}_{\text{Theorem \ref{thm:non_negative_measurable_property}}} \quad\ra \quad \mu_2(\abs{f}) \leq M\mu_2(E_2) < \infty. \quad\quad (\text{by finiteness of $\mu_2$})
\ee
So the integral ($g(x_1)$) is well-defined and bounded, $f$ is Lebesgue-integrable (with respect to $\mu_2$).

If $\mu_2$ is zero measure, the conclusion is obvious as $g(x_1) = 0$ for all $x_1\in E_1$. The following proof is based on the fact that $\mu_2(E_2)>0$. Now let $\sV$ be the set of bounded measurable functions $f$ such that for all $x_1 \in E_1$,
\be
g(x_1) = \int_{E_2} f(x_1, x_2)\mu_2(dx_2)
\ee
which is bounded and $\sE_1$-measurable. Since $f$ is Lebesgue-integrable, $\sV$ is a vector space (Theorem \ref{thm:lebesgue_integrable_function_property} and Definition \ref{def:vector_space}). 

Clearly, if $f(x_1,x_2) = \ind_{E}$ is bounded and $\sE$-measurable, so
\be
g(x_1) = \int_{E_2} \ind_E \mu_2(dx_2) = \int_{E_2} \ind_{E_1\times E_2} \mu_2(dx_2) =  \int_{E_2} \ind_{E_1}\ind_{E_2} \mu_2(dx_2) = \ind_{E_1} \int_{E_2} \ind_{E_2} \mu_2(dx_2) = \ind_{E_1}\mu_2(E_2)
\ee
where $\ind_{E_1}\mu_2(E_2)$ is bounded and $\sE_1$-measurable function (as $\mu_2(E_2)$ is a constant). So $\ind_{E}\in \sV$.

Let $\sA$ be the $\pi$-system generating $\sE$, for any $A \in \sA\subseteq \sE$, we have $\ind_{A}$ is bounded and $\sE$-measurable,
\be
g(x_1) = \int_{E_2} \ind_A \mu_2(dx_2) = \int_{E_2} \ind_{A_1\times A_2} \mu_2(dx_2) =  \int_{E_2} \ind_{A_1}\ind_{A_2} \mu_2(dx_2) = \ind_{A_1} \int_{E_2} \ind_{A_2} \mu_2(dx_2) = \ind_{A_1}\mu_2(A_2)
\ee
where $\ind_{A_1}\mu_2(A_2)$ is bounded and $\sE_1$-measurable function (as $\mu_2(A_2)$ is a constant). So $\ind_{A}\in \sV$.

Moreover, if $f_n \in \sV$ for all $n$ and if $f$ is bounded with $0 \leq f_n \ua f$ for any $x_1\in E_1$, $f_n$ is $\sE$-measurable and thus $f$ is $\sE$-measurable. Then
\be
g_n(x_1) = \int_{E_2} f_n(x_1, x_2)\mu_2(dx_2)
\ee
where $g_n$ is bounded and $\sE_1$-measurable for all $n$. By monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), 
\be
g_n(x_1) = \int_{E_2} f_n(x_1, x_2)\mu_2(dx_2) \ua \int_{E_2} f(x_1, x_2)\mu_2(dx_2) := g(x_1)
\ee

Since $g(x_1)$ is the limit of $\sE_1$-measurable functions $g_n(x_1)$, it is bounded and $\sE_1$-measurable. So $f\in \sV$.

Applying the monotone class theorem (Theorem \ref{thm:monotone_class}), we have $\sV$ contains all bounded $\sE$-measurable functions.
\end{proof}


\begin{theorem}[Product Measure]\label{thm:product_measure}
There exists a unique product measure\index{product measure} $\mu = \mu_1 \otimes \mu_2$ on $\sE$ such that 
\be
\mu(A_1 \times A_2) = \mu_1(A_1)\mu_2(A_2)
\ee
for all $A_1 \in \sE_1$ and $A_2 \in \sE_2$.
\end{theorem}
\begin{proof}[\bf Proof]
Uniqueness holds because $\sA$ is a $\pi$-system generating $\sE$ (by Theorem \ref{thm:uniqueness_of_extension_measure}). 

For existence, by Lemma \ref{lem:e_2_measurable} and \ref{lem:e_1_measurable}, we can define for $A\in \sE$,
\be
\mu(A) = \int_{E_1} \bb{\int_{E_2} \ind_A(x_1, x_2)\mu_2(dx_2)} \mu_1(dx_1)
\ee
which is well-defined as $\int_{E_2} \ind_A(x_1, x_2)\mu_2(dx_2)$ is $\sE_1$-measurable.

Obviously, $\mu$ is a set function as $\mu(\emptyset) = 0$. To check the countable additivity, let $(A_m)$ be disjoint sets and $A = \bigcup_m A_m$. Let $f=\ind_A$ and $f_n = \ind_{\bigcup^n_{m=1}A_m}$, then $f_n \ua f$. So
\beast
\mu\bb{\bigcup_n A_n} = \mu(A) & = & \int_{E_1} \bb{\int_{E_2} \ind_A \mu_2(dx_2)} \mu_1(dx_1) = \int_{E_1} \bb{\int_{E_2} f\mu_2(dx_2)} \mu_1(dx_1)\\
& = & \int_{E_1} \bb{\lim_{n\to\infty}\int_{E_2} f_n \mu_2(dx_2)} \mu_1(dx_1) \quad\quad \text{monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise})}\\
& = & \lim_{n\to\infty} \int_{E_1} \bb{\int_{E_2} f_n \mu_2(dx_2)} \mu_1(dx_1) \quad\quad \text{monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise})}\\
& = & \sum^\infty_{n=1} \mu(A_n).\quad\quad (\text{by definition of }\mu)
\eeast

Thus $\mu$ is a measure on $\sE$.
\end{proof}

\begin{theorem}[Fubini's Theorem\index{Fubini's Theorem}]\label{thm:fubini}
\ben
\item [(i)] Let $f$ be $\sE$-measurable and non-negative. Then 
\be
\mu(f) = \int_{E_1} \bb{\int_{E_2} f(x_1, x_2)\mu_2(dx_2)} \mu_1(dx_1).\quad\quad (*)
\ee
\item [(ii)] Let $f$ be $\mu$-integrable. Then
\ben
\item [(a)] $x_1 \mapsto \int_{E_2} f(x_1, x_2)\mu_2(dx_2)$ is $\mu_1$-integrable,
\item [(b)] $x_2 \mapsto f(x_1, x_2)$ is $\mu_2$-integrable for $\mu_1$-almost all $x_1$,
\item [(c)] the formula for $\mu(f)$ in (i) holds.
\een
\een
\end{theorem}

\begin{proof}[\bf Proof]
\ben
\item [(i)] Denote by $\sV$ the set of all bounded $\sE$-measurable functions $f$ for which the formula ($*$) holds. By boundedness of $f$, we have that $\sV$ is a vector space.

Then $\sV$ contains the indicator function of every $\sE$-measurable set and if $f_n \in \sV$ and bounded $f$ with $0\leq f_n\ua f$, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have $f\in \sV$. So, by the monotone class theorem (Theorem \ref{thm:monotone_class}), $\sV$ contains all bounded $\sE$-measurable functions. Hence, for all $\sE$-measurable functions $f$, we have
\be
\mu(f_n) = \int_{E_1} \bb{\int_{E_2} f_n(x_1, x_2)\mu_2(dx_2) }\mu_1(dx_1) \quad\quad (\dag)
\ee
where $f_n = (-n) \lor f \land n$.

For $f$ non-negative, we have $f_n \ua f$ and can pass to the limit as $n \to \infty$ by monotone convergence to extend the formula to $f$. That proves (i).

\item [(ii)] If $f$ is $\mu$-integrable, then, by (i)
\be
\int_{E_1}\abs{\int_{E_2} f(x_1, x_2)\mu_2(dx_2)}\mu_1(dx_1) \leq \int_{E_1}\bb{\int_{E_2} |f(x_1, x_2)|\mu_2(dx_2)}\mu_1(dx_1) = \mu(|f|) < \infty.
\ee

Hence we obtain $\int_{E_2} f(x_1, x_2)\mu_2(dx_2)$ is $\mu_1$-integrable and $f(x_1, x_2)$ is $\mu_2$-integrable for $\mu_1$-almost all $x_1$. Then, by dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), we can pass to the limit as $n \to \infty$ in the formula ($\dag$) to obtain the desired formula for $\mu(f)$.
\een
\end{proof}

\begin{proposition}\label{pro:product_measure}
Let $\wh{\sE} = \sE_2 \otimes \sE_1$ and $\wh{\mu} = \mu_2 \otimes \mu_1$. For a function $f$ on $E_1 \times E_2$, write $\wh{f}$ for the function on $E_2 \times E_1$ given by $\wh{f}(x_2, x_1) = f(x_1, x_2)$. Suppose that $f$ is $\sE$-measurable. Then $\wh{f}$ is $\wh{\sE}$-measurable, and if $f$ is also non-negative or $\mu$-integrable, then $\wh{\mu}\bb{\wh{f}} = \mu(f)$.
\end{proposition}

\begin{proof}[\bf Proof]
Recall the notation in Fubini's theorem (Theorem \ref{thm:fubini} (i), (ii).(c)), if $f$ is non-negative or $\mu$-integrable,
\be
\mu(f) = \int_{E_1} \bb{\int_{E_2} f(x_1, x_2)\mu_2(dx_2)} \mu_1(dx_1).
\ee

With the similar argument, we have
\be
\wh{\mu}\bb{\wh{f}} = \int_{E_2} \bb{\int_{E_1} \wh{f}(x_2, x_1)\mu_1(dx_1)} \mu_2(dx_2) = \int_{E_2} \bb{\int_{E_1} f(x_1, x_2)\mu_1(dx_1)} \mu_2(dx_2).
\ee

If $f = \ind_A = \ind_{A_1\times A_2}$, $A = A_1\times A_2 \in \sE$, we have 
\beast
\mu(f) & = & \int_{E_1} \bb{\int_{E_2} \ind_{A_1}\ind_{A_2}\mu_2(dx_2)} \mu_1(dx_1) = \int_{E_1}\ind_{A_1} \bb{\int_{E_2} \ind_{A_2}\mu_2(dx_2)} \mu_1(dx_1) = \int_{E_1}\ind_{A_1} \mu_2\bb{A_2} \mu_1(dx_1) \\
& = & \mu_1\bb{A_1} \mu_2\bb{A_2} = \int_{E_2}\ind_{A_2} \mu_1\bb{A_1} \mu_2(dx_2) = \int_{E_2}\ind_{A_2} \bb{\int_{E_1} \ind_{A_1}\mu_1(dx_1)} \mu_2(dx_2)\\
& = & \int_{E_2} \bb{\int_{E_1} \ind_{A_2}\ind_{A_1}\mu_1(dx_1)} \mu_2(dx_2) = \wh{\mu}\bb{\wh{f}} .
\eeast

If $f$ is simple function, we have the same conclusion by Proposition \ref{pro:simple_function_property}. 

If $f$ is non-negative measurable, we define $f_n = \bb{2^{-n}\floor{2^nf}}\land n$. Thus $f_n$ are simple functions and $f_n \to f$. We get the result required by applying monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}).

If $f$ is $\mu$-integrable, we have that $f$ is measurable and thus $f^+,f^-$ are a non-negative measurable functions (Proposition \ref{thm:measurable_function_property}). So $\mu(f^+) = \wh{\mu}\bb{\wh{f^+}} = \wh{\mu}\bb{\wh{f}^+}$ and $\mu(f^-) = \wh{\mu}\bb{\wh{f^-}} = \wh{\mu}\bb{\wh{f}^-}$ and 
\be
\wh{\mu}\bb{\abs{\wh{f}}} = \wh{\mu}\bb{\wh{f}^+} +  \wh{\mu}\bb{\wh{f}^-} = \mu(f^+) + \mu(f^-) = \mu(\abs{f}) < \infty \quad\ra\quad \text{$\wh{f}$ is $\wh{\mu}$-integrable.}
\ee

Thus $\mu(f) = \mu(f^+) - \mu(f^-) = \wh{\mu}\bb{\wh{f}^+} - \wh{\mu}\bb{\wh{f}^-} = \wh{\mu}\bb{\wh{f}}$ as $\wh{\mu}\bb{\wh{f}}$ is well-defined by integrability of $\wh{f}$.
\end{proof}

\begin{remark} Note that the iterated integral in Fubini's theorem (i) (Theorem \ref{thm:fubini}) is well defined, for all bounded or non-negative measurable functions $f$, by Lemmas \ref{lem:e_2_measurable} and \ref{lem:e_1_measurable}. Note also that, in combination wih Proposition \ref{pro:product_measure}, Fubini's theorem (Theorem \ref{thm:fubini}) allows us to interchange the order of integration in multiple integrals, whenever the integrand is non-negative or $\mu$-integrable. 
\end{remark}

\begin{remark}
The existence of product measure and Fubini's theorem extend easily to $\sigma$-finite measure spaces (Definition \ref{def:sigma_finite_measure} as we can break up $\sigma$-finite spaces into countable unions of disjoint finite blocks). More important, it is crucial to have $\sigma$-finite.
\end{remark}

\begin{example}
Let $f_n$ be a sequence of functions on some finite measure space $(E,\sE,\mu)$. Now consider $g(n,x) = f_n(x)$ and a $\sigma$-finite measure space $(\N,\sP(\N),\nu)$ where $\nu(A) = \#A$ (the number of integers in the set $A\subseteq \N$). It is easy to prove that $\nu$ is a measure. Then define on $G = \N \times E$, product $\sigma$-algebra $\sG = \sP(\N)\otimes \sE$, product measure (by Theorem \ref{thm:product_measure})
\be
\lm(A) = \int_{\N} \bb{\int_E \ind_{A}(n,x)\mu(dx)}\nu(dn) = \sum^\infty_{n=1} \bb{\int_E \ind_{A}(n,x)\mu(dx)}
\ee

Assume that 
\be
\lm(\abs{f}) = \sum^\infty_{n=1} \bb{\int_E \abs{f(n,x)}\mu(dx)} = \sum^\infty_{n=1}\int \abs{f_n}d\mu < \infty,
\ee
then $f$ is $\lm$-integrable. Thus, by Fubini's theorem (Theorem \ref{thm:fubini} (ii)), we have
\be
\lm(f) = \sum^\infty_{n=1} \bb{\int_E f(n,x)\mu(dx)}\quad\ra\quad \sum^\infty_{n=1}\int f_n d\mu = \int \bb{\sum^\infty_{n=1} f_n} d\mu.\quad \quad (\text{Proposition \ref{pro:product_measure}})
\ee
\end{example}

\begin{example}
Take $(E_1,\sE_1) = (E_2,\sE_2) = ([0,1],\sB([0,1]))$ and let $\mu_1$ be Lebesgue measure and $\mu_2 (A) = \#A$ (number of real numbers in $A$) for $A\in \sB$. Note that $\mu_2$ is not $\sigma$-finite. Consider the $\sE$-measurable function 
\be
f(x,y) = \ind_{y=x} = \underbrace{\ind_{E_1}}_{\in \sE_1}\underbrace{\ind_{y=x}}_{\text{ for fixed }x,\{y=x\} \in \sE_2 },
\ee
\be
\int_{E_1} \bb{\int_{E_2} f(x, y)\mu_2(dy)} \mu_1(dx) = \int_{E_1} \bb{\int_{E_2} \ind_{y=x}\mu_2(dy)} \mu_1(dx) = \int_{E_1} 1 \mu_1(dx) = \mu_1(E_1) = 1,
\ee
since there is only a point to make $\ind_{y=x} = 1$. On the other hand,
\be
\int_{E_2} \bb{\int_{E_1} f(x, y)\mu_1(dx)} \mu_2(dy) = \int_{E_2} \underbrace{\bb{\int_{E_1} \ind_{y=x}\mu_1(dx)}}_{\ind_{y=x} = 0 \text{ a.e. for fixed y}} \mu_2(dy) = \int_{E_2} \underbrace{0}_{\text{Theorem \ref{thm:non_negative_measurable_property} (iii)}} \mu_2(dy) = 0 \cdot \infty = 0.
\ee
Thus, we can see $\sigma$-finiteness is essential for Fubini's theorem.
\end{example}

\begin{remark}
The operation of taking the product of two measure spaces is associative, 
\be
\mu_1 \otimes \bb{\mu_2 \otimes \mu_3} = \bb{ \mu_1 \otimes \mu_2} \otimes \mu_3
\ee
by a $\pi$-system uniqueness argument as 
\be
\mu(A) = \mu(A_1)\mu(A_2)\mu(A_3),\quad\quad A = A_1 \times A_2 \times A_3 \text{ is a $\pi$-system}.
\ee
So we can, by induction, take the product of a finite number, without specifying the order. Again, $\sigma$-finite is essential for the argument. In particular, the $n$-fold product of Lebesgue measure on $\R$ is called Lebesgue measure on $\R^n$. The corresponding integral is written \be
\int_{\R^n} f(x)dx = \int_\R \dots \int_\R f(x_1,\dots,x_n)dx_n \dots dx_1.
\ee
\end{remark}


\begin{proposition}
Let $\sB(\R^n)$ be the Borel set of $\R^n$ and $\sE = \sB(\R)^n = \sB(\R)\otimes \dots\otimes \sB(\R)$. Then $\sE = \sB(\R^n)$.
\end{proposition}
\begin{proof}[\bf Proof]
To prove $\sE\subseteq \sB(\R^n)$, we have two approaches:
\begin{description}
\item [Approach 1.] $\sB(\R^n)$ is constructed from the topological space $(\R^n,\sT)$. Now, if $f_i:\R^n\to \R$ is the $i$th coordinate map:
\be
f_i(x_1,x_2,\dots,x_n) = x_i,
\ee
then $f_i$ is continuous\footnote{need checking}, and hence $\sB(\R^n)$-measurable (Proposition \ref{pro:continuous_measurable}). Thus,
\be
\sB(\R)^n = \sigma\bb{f_i:1\leq i\leq n} \subseteq \sB(\R^n)
\ee
\item [Approach 2.] Assume $n=2$ and let $A_1\in \sB(\R)$, $A_2 \in \sB(\R)$, we want to show that $A_1\times A_2 \in \sB(\R^2)$.

Let $C$ be an open interval in $\R$, then $\{B :C\times B \in \sB(\R^2)\}$ is a $d$-system\footnote{need checking} containing finite unions of open intervals. Hence it contains $\sB(\R)$, so it contains $A_2$.

As a consequence, $\{A :A\times A_2\in \sB(\R^2)\}$ is a $d$-system containing open intervals (and hence finite unions), so contains $\sB(\R)$. Thus, we have $A_1\times A_2 \in \sB(\R^2)$ and $\sA \subseteq \sB(\R^2)$, $\sA$ is $\pi$-system, so by Dynkin's lemma (Lemma \ref{lem:dynkin_lemma}), $\sE \in \sB(\R^2)$. Then we have the conclusion by induction.
\end{description}

On the other hand, $\sB(\R^n)$ is generated by the open subsets of $\R^n$, and every such open subsets is a countable union of open 'hypercubes' of the form
\be
\prod_{1\leq i\leq n}(a_i,b_i)
\ee
and such products are in $\sB(\R)^n$. Hence, $\sB(\R^n) \subseteq \sB(\R)^n$ by Dynkin's lemma (Lemma \ref{lem:dynkin_lemma}). Thus, $\sB(\R^n) = \sB(\R)^n$\footnote{need proof}.
\end{proof}

\begin{remark}
$\sB\bb{\R^n}$ is not a topology. Let $A\subseteq \R^n$ such that $A \notin \sB(\R^n)$. If $\sB(\R^n)$ were a topology, then it would be closed under arbitrary unions. As $\{x\}\in \sB(\R^n)$ for all $x\in \R^n$, we would get the contradiction $A = \bigcup_{x\in A}\{x\}\in \sB(\R^n)$ since $A$ is an uncountable union (Klenke\cite{Klenke_2008}.$P_9$).
\end{remark}

\begin{proposition}\label{pro:measure_change_integral}
Let $(E,\sE)$ be measurable space and $\mu$ be a $\sigma$-finite measure, then for any non-negative measurable function $f:E\to \R$,
\be
\mu(f) = \int^\infty_0 \mu(f\geq t)dt.
\ee
\end{proposition}

\begin{proof}[\bf Proof]
With Fubini theorem (Theorem \ref{thm:fubini}),
\be
\int^\infty_0 \mu(f\geq t)dt = \int^\infty_0 \mu\bb{\ind_{\bra{f\geq t}}}dt = \int^\infty_0 \int_E \ind_{\bra{f\geq t}}d \mu dt = \int_E \int^\infty_0  \ind_{\bra{f\geq t}} dtd \mu = \int_E \int^f_0 dt d\mu = \int_E f d\mu = \mu(f),
\ee
as required.
\end{proof}

\subsection{Applications}

\begin{example}\label{exa:integral_sinx_over_x} 
The function $f(x) = \sin x/x$ is not Lebesgue-integrable over $[1,\infty)$ but that the following limit does exist:
\be
\lim_{N\to \infty} \int^N_1 \frac{\sin x}x dx.
\ee
\end{example} 

\begin{solution} \emph{Approach 1}. Set $a_n=\int^{(n+1)\pi}_{n\pi}\frac{\sin x}xdx$. Then $\text{sgn}(a_n)=(-1)^n$ and 
\be
|a_n|\geq \frac 1{(n+1)\pi}\left|\int^{(n+1)\pi}_{n\pi}\sin xdx\right| = \frac 1{(n+1)\pi},\quad  |a_n|\leq \int^{(n+1)\pi}_{n\pi}\frac1xdx \leq \frac1{n\pi}\int^{(n+1)\pi}_{n\pi}dx = \frac 1n\quad\quad (*)
\ee

Thus,
\be
\lim_{N\to \infty} \int^N_1 \left|\frac{\sin x}x\right| dx = \int^\pi_1 \left|\frac{\sin x}x\right| dx + \sum^\infty_{n=1}|a_n| \geq \int^\pi_1 \left|\frac{\sin x}x\right| dx + \frac1{\pi} \sum^\infty_{n=2}\frac 1n = \infty.
\ee

Also, we can see that $\text{sgn}(a_n)=(-1)^n$ and $|a_n|$ is a decreasing sequence. Thus, with alternatiing series theorem, we have 
\be
\lim_{N\to \infty} \int^N_1 \frac{\sin x}x dx = \int^\pi_1 \frac{\sin x}x dx + \sum^\infty_{n=1}a_n \quad \text{converges.} 
\ee

\emph{Approach 2}. We need to show that the integral of $ \abs{\frac{\sin x}{x}}$ over $[1, \infty)$ is infinite. But by considering $n$ triangles with vertices $(j\pi,0)$, $\left(\frac{(2j+1)\pi}{2},\frac{2}{(2j+1)\pi}\right)$, $((j+1)\pi,0)$, $j=1,\ldots,n$ (draw a picture), we see that
\[
 \int_{1} ^{(n+1)\pi} \abs{\frac{\sin x}{x}} dx > \sum_{j=1} ^n \frac{1}{2j+1}
\]
Since the RHS tends to $\infty$ as $n \to \infty$, the LHS must also tend to $\infty$. Then by monotone convergence, we see that
\[
 \int_{1} ^{\infty} \abs{\frac{\sin x}{x}} dx = \infty.
\]
For the second part of the question, note that
\[
 \int_{j\pi} ^{(j+1)\pi} \frac{\sin x}{x} dx
\]
changes sign as $j$ is odd or even, and then use the alternating series test.
\end{solution}

\begin{example} 
The Lebesgue integral $\int^\infty_0 \bb{\sin x/x} dx$ does not exist. However, 
\be
\lim_{N\to \infty} \int^N_0 \frac{\sin x}x dx = \frac {\pi}2.
\ee
\end{example} 

\begin{solution}
From Example \ref{exa:integral_sinx_over_x}, we know that (from $(*)$)
\be
\int^\infty_0 \bb{\frac{\sin x}x}^+ dx > \sum^\infty_{n=1} \frac 1{2n} = \infty,\quad\quad \int^\infty_0 \bb{\frac{\sin x}x}^- dx \geq \sum^\infty_{n=1} \frac 1{2n-1} = \infty.
\ee

Thus, the Lebesgue integral is not well-defined. The calculation of $\lim_{N\to \infty} \int^N_0 (\sin x/x) dx$ is given in Example \ref{exa:sinx_over_x_integral}.
\end{solution}


\section{$\sL^p$ Space, $L^p$ Space and Convergence in $\sL^p(E,\sE,\mu)$}

\subsection{$\sL^p$-norms}

\begin{definition}[$\sL^p$ Norm]\label{def:slp_norm}
Let $(E, \sE, \mu)$ be a measure space. For $1 \leq p < \infty$, we denote by $\sL^p = \sL^p(E, \sE, \mu)$ the set of measurable functions $f$ with finite $\sL^p$-norm\index{lp-norm@$\sL^p$-norm}:
\be
\dabs{f}_p = \bb{\int_E |f|^pd\mu }^{1/p} < \infty.
\ee
\end{definition}

\begin{definition}[essential supremum]\label{def:essential_sup}
We denote by $\sL^\infty = \sL^\infty(E, \sE, \mu)$ the set of measurable functions $f$ with the essential supremum\index{essential supremum} of $f$:
\be
\dabs{f}_\infty := \esssup\bb{f} = \inf\{\lm : |f| \leq \lm \text{ a.e.}\} = \inf\bra{\lm : \mu\bb{x:|f(x)| > \lm} = 0}.
\ee
\end{definition}

\begin{remark}
Note that $\dabs{f}_p \leq \mu(E)^{1/p}\dabs{f}_\infty$ for all $1 \leq p < \infty$. 
\end{remark}

\begin{example} 
For $\alpha\in(0,\infty)$ and $p\in [1,\infty)$ and for 
\be
f_\alpha(x) = x^{-\alpha}, \quad x>0.
\ee

For $0<a<b<\infty$ by the fundamental theorem of calculus (Theorem \ref{thm:fundamental_theorem_of_calculus_lebesgue}), we have over intervals $[a,b]$,
\be
 \int_a ^b x^{-\alpha p} dx = \frac{b^{1-\alpha p} - a^{1 - \alpha p}}{1 - \alpha p}.
\ee

Now note that $f_{\alpha} \ind_{[\tfrac{1}{n},1]} \uparrow f_{\alpha} \ind_{[0,1]}$, $f_{\alpha} \ind_{[1,n]} \uparrow f_{\alpha} \ind_{[1,\infty)}$ and then with monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise})by passing to the limits $a\downarrow 0$ with $b=1$ and $b\uparrow \infty$ with $a=1$, we have
\beast
f_\alpha \in \sL^p((0,1],dx) \ \Leftrightarrow \ \alpha p <1,\quad \quad  f_\alpha \in \sL^p([1,\infty),dx) \ \Leftrightarrow \ \alpha p >1.
\eeast
\end{example} 



\begin{definition}
For $1 \leq p \leq \infty$ and $f_n \in \sL^p$, we say that $f_n$ converges to $f$ in $\sL^p$ if $\dabs{f_n - f}_p \to 0$.
\end{definition}

\subsection{Chebyshev's inequality}

\begin{theorem}\label{thm:chebyshev_inequality}
Let $f$ be a non-negative measurable function and let $\lm \geq 0$. Then $\lm\mu(f \geq \lm) \leq \mu(f)$.
\end{theorem}
\begin{proof}[\bf Proof]
We use the notation $\{f \geq \lm\}$ for the set $\{x \in E : f(x) \geq \lm\}$. Then $\lm\ind_{\{f\geq\lm\}} \leq f  \ra \lm\mu(f \geq \lm) \leq \mu(f)$, by Theorem \ref{thm:non_negative_measurable_property}.
\end{proof}

Now let $g$ be any measurable function. We can deduce inequalities for $g$ by choosing some non-negative measurable function $\phi$ and applying Chebyshev's inequality (Theorem \ref{thm:chebyshev_inequality}) to $f = \phi \circ g$. 

For example, if $g \in \sL^p$, $p < \infty$ and $\lm > 0$, then $\mu(|g| \geq \lm) = \mu(|g|^p \geq \lm^p) \leq \lm^{-p}\mu(|g|^p) < \infty$.

So we obtain the tail estimate $\mu(|g| \geq \lm) = O(\lm^{-p}),\ \text{ as }\lm \to \infty$.


\subsection{Jensen's inequality}

\begin{definition}
Let $I \subseteq \R$ be an interval. A function $f : I \to \R$ is convex\index{convex} if, for all $x, y \in I$ and $t \in [0, 1]$,
\be
f(tx + (1 - t)y) \leq tf(x) + (1 - t)f(y).
\ee
\end{definition}

\begin{lemma}\label{lem:jensen_affine}
Let $f : I \to \R$ be convex and let $m$ be a point in the interior of $I$. Then there exist $a, b \in \R$ such $f(x) \geq ax + b$ for all $x$, with equality at $x = m$.
\end{lemma}

\begin{proof}[\bf Proof]
By convexity, for $m, x, y \in I$ with $x < m < y$, we have
\be
\frac{f(m) - f(x)}{m - x} \leq \frac{f(y) - f(m)}{y - m}.
\ee

So, fixing an interior point $m$, there exists $a \in \R$ such that, for all $x < m$ and all $y > m$
\be
\frac{f(m) - f(x)}{m - x} \leq a \leq \frac{f(y) - f(m)}{y - m}.
\ee
Then $f(x) \geq a(x - m) + f(m)$, for all $x \in I$.
\end{proof}

\begin{theorem}[Jensen's inequality\index{Jensen's inequality!measure}]\label{thm:jensen_inequality_measure}
For measure space $(E,\sE,\mu)$ with $\mu(E) =1$, let $g$ be an integrable function with values in $I$ and $f : I \to \R$ be convex. Then $\mu(f\circ g)$ is well defined and
\be
\mu(f\circ g) \geq f(\mu(g)).
\ee

The equality holds when $f$ is not strictly convex, e.g. when it is a straight line, or when $g$ follows a degenerate distribution, i.e. $g = \mu(g)$ a.e.. 
\end{theorem}

\begin{remark}
\ben
\item [(i)] Note that this won't hold for finite measure ($\mu(E)< \infty$). We can think about the case $g$ equals to some constant $c$ a.e.. as we can not tell that $f(c)\mu(E) \geq f\bb{c\mu(E)}$.

\item [(ii)] Jensen's inequality also gets other versions, i.e., alternative finite form\footnote{see wikipedia}.
\een
\end{remark}

\begin{proof}[\bf Proof]
If $f$ is a stright line, it is easy to have the equality.

For the case where $g$ is almost everywhere constant. We say $g=c$ a.e., then $\mu\bb{g}=c\mu(E) =c$ by Theorem \ref{thm:lebesgue_integrable_function_property}.

Otherwise, $m = \mu(g)$ must lie in the interior of $I$ (if not the equality $m = \mu(g)$ does not hold). Choose $a, b \in \R$ as in Lemma \ref{lem:jensen_affine}, then $f\circ g \geq ag + b$ a.e. with equality at $g = m = \mu(g)$ a.e.. In particular, 
\be
f\circ g \geq ag + b \quad\ra\quad \bb{f\circ g}^- \leq (ag+b)^-.
\ee
and $(ag+b)^-$ is a convex function, thus for $t\in [0,1]$
\be
(ag+b)^- \leq t (ag)^- + (1-t)b^- \leq t\bb{(ag)^- + (ag)^+} + (1-t)\bb{b^- + b^+} = t \abs{ag} + (1-t)\abs{b}.
\ee
Then by Theorem \ref{thm:non_negative_measurable_property}, $\mu(\bb{f\circ g}^-) \leq |a|\mu(|g|) + |b| < \infty$, since $g$ is $\mu$-integrable.

So $\mu(f\circ g)$ is well defined (as existence of one of $\mu\bb{\bb{f\circ g}^+}$ and $\mu\bb{\bb{f\circ g}^-}$ implies the existence of $\mu(f\circ g)$ in Remark \ref{rem:integral_either_finite}). If $f\circ g$ is not $\mu$-integrable, we have $\mu(f\circ g) = \infty$ which satisfies the inequality. Moreover, if $f\circ g$ is $\mu$-integrable, by Theorem \ref{thm:lebesgue_integrable_function_property} (ii),
\be
\mu(f\circ g) \geq a\mu(g) + b = am + b = f(m) = f(\mu(g))
\ee
with equality at $g = \mu(g)$ a.e..

Finally, note that for the equality to be held, $\mu\bb{g \neq \mu(g)} >0$ can not be the case since this will give different values of $ag +b$.
\end{proof}

We deduce from Jensen's inequality the monotonicity of $\sL^p(E,\sE,\mu)$-norms with respect to a measure. 

\begin{proposition}\label{pro:lp-norm_monotonicity}
Let $1 \leq p < q < \infty$ and $\mu(E) =1$. For any real-valued function $g \in \sL^p(E,\sE,\mu)$, $\dabs{g}_p \leq \dabs{g}_q$. Moreover, $\sL^q(E,\sE,\mu)\subseteq \sL^p(E,\sE,\mu)$. 
\end{proposition}

\begin{proof}[\bf Proof] 
First, set $f(x) = |x|^{q/p}$, then $f$ is convex. Since $g^p$ is real-valued integrable function, by Jensen's inequality (Theorem \ref{thm:jensen_inequality_measure}), 
\be
\dabs{g}_p = (\mu|g|^p)^{1/p} = (f(\mu|g|^p))^{1/q} \leq (\mu f(|g|^p))^{1/q} = (\mu|g|^q)^{1/q} = \dabs{g}_q.
\ee

Then $\forall g\in \sL^q(E,\sE,\mu)$, set $g_n = \abs{g}\land n$. Thus, $g_n$ is bounded real-valued function and thus integrable, so is $g_n^{q}$. So, by Jensen's inequality (Theorem \ref{thm:jensen_inequality_measure}), 
\be
\dabs{g_n}_p = (\mu|g_n|^p)^{1/p} = (f(\mu|g_n|^p))^{1/q} \leq (\mu f(|g_n|^p))^{1/q} = (\mu|g_n|^q)^{1/q} = \dabs{g_n}_q \leq \dabs{g}_q < \infty.
\ee
 
Since $g_n \ua \abs{g}$, with monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have $\dabs{g_n}_p \ua \dabs{g}_p$, thus, $\dabs{g}_p \leq \dabs{g}_q < \infty$, $g\in \sL^p(E,\sE,\mu)$. Hence $\sL^q(E,\sE,\mu)\subseteq \sL^p(E,\sE,\mu)$.
\end{proof}

\begin{remark}
This statement is not ture for infinite measure, for example, $f(x) = \frac 1x$,
\beast
\dabs{f}_1 = \mu(\abs{f}) & = & \int^\infty_1 \frac 1x dx = \left.\log x\right|^\infty_1 \quad \ra \quad f \notin \sL^1\bb{[1,\infty),\sB([1,\infty)),\text{Leb}}\\
\dabs{f}_2 = \mu(\abs{f}^2)^{1/2} & = & \bb{\int^\infty_1 \frac 1{x^2} dx}^2 = \bb{-\left.\frac 1x\right|^\infty_1}^{1/2} = 1 < \infty \ \ra \ f \in \sL^2\bb{[1,\infty),\sB([1,\infty)),\text{Leb}}
\eeast
\end{remark}

\subsection{H\"older's inequality and Minkowski's inequality}

\begin{definition}
For $p, q \in [1,\infty]$, we say that $p$ and $q$ are conjugate indices\index{conjugate indices} if
\be
\frac 1p + \frac 1q = 1.
\ee
\end{definition}

\begin{theorem}[H\"older's inequality\index{H\"older's inequality!measure}]\label{thm:holder_inequality_measure}
Let $p, q \in [1,\infty]$ be conjugate indices. Then, for all measurable functions $f\in \sL^p(\E,\sE,\mu)$ and $g\in \sL^q(\E,\sE,\mu)$, $fg$ is integrable and % we have\footnote{need equality case.}
\be
\mu(|fg|) \leq \dabs{f}_p\dabs{g}_q.
\ee

\ben
\item [(i)] For $p,q\in (1,\infty)$, H\"older's inequality becomes an equality if and only if $\abs{f}^p$ and $\abs{g}^q$ are linearly dependent in $\sL^1(E,\sE,\mu)$, i.e., for $f\in \sL^p(\E,\sE,\mu)$ and $g\in \sL^q(\E,\sE,\mu)$, there exist real number $\alpha,\beta \geq 0$ such that $\alpha \abs{f}^p = \beta \abs{g}^q$ a.e.%\footnote{need proof, see wiki}.
\item [(ii)] For $p,q\in \bra{1}\cup \bra{\infty}$, H\"older's inequality becomes an equality if and only if $p=1$ and $g = \dabs{g}_\infty$ a.e. or $q=1$ and $f = \dabs{f}_\infty$ a.e..
\een
\end{theorem}

\begin{proof}[\bf Proof]
Consider the case that $p,q \in (1,\infty)$. If $\dabs{f}_p = 0$, we have
\be
\bb{\int_E |f|^pd\mu }^{1/p} = 0 \quad\ra\quad \bb{\int_E |f|^pd\mu } = 0 \quad\ra\quad \abs{f}^p = 0 \ \text{ a.e.\quad (by Theorem \ref{thm:non_negative_measurable_property})} 
\ee

Thus, $\abs{f}= 0$ a.e. $\abs{fg} = 0$ a.e.. This is because 
\be
\bra{\abs{fg} > 0} = \bigcup_{n\in \Z^+} \bra{\abs{fg} > \frac 1n} = \bigcup_{n\in \Z^+} \bigcup_{q\in \R^+} \bra{\abs{f} > \frac 1{nq}}\cap \bra{\abs{g}>q} \subseteq \bigcup_{n\in \Z^+} \bigcup_{q\in \R^+} \bra{\abs{f} > \frac 1{nq}}
\ee
is a sum of countable zero-measure sets. This implies that $\mu\bb{\bra{\abs{fg} > 0}} = 0$. Thus, $\abs{fg} = 0$ a.e. and by Theorem \ref{thm:non_negative_measurable_property}, $\mu(\abs{fg}) = 0$ and the inequality holds.

% we can not give the order of the following infinities...
%If $\dabs{f}_p = \infty$ and $\mu\bb{\abs{fg}} < \infty$, the inequality holds for $\dabs{g}_q >0$. If $\dabs{g}_q= 0$, we use the previous case and get the inequality.
%If $\dabs{f}_p = \infty$ and $\mu\bb{\abs{fg}} = \infty$, it is obvious that $\dabs{g}_q > 0$ (use the argument in the previous case). Set $f_n = \abs{f}\land n$, $g_n = \abs{g}\land n$, thus $\mu\bb{f_ng_n} < \infty= \dabs{f}_p\dabs{g}_q$ for all $n$\footnote{but this is only true for finite measure}. Thus, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}),
%\be
%\mu\bb{f_ng_n} \ua \mu\bb{\abs{fg}} \quad\ra\quad \mu\bb{\abs{fg}} \leq \dabs{f}_p\dabs{g}_q.
%\ee

If $\dabs{f}_p \in (0,\infty)$, let $\dabs{f}_p = a$. So we can define a finite measure $\nu$ on $\sE$ by 
\be
\nu(A) = \frac 1{a^p}\int_A |f|^pd\mu = \frac 1{a^p} \mu \bb{|f|^p\ind_A}.
\ee

Obviously, $\nu(E)=1$ and for simple function $h$ ($h\geq 0$), we have $a^p\nu(h) = \mu(h|f|^p)$. Thus, for non-negative measurable function $h$, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have $a^p\nu(h) = \mu(h|f|^p)$. Or we can have this by Proposition \ref{pro:density_function_measure}. 

Now for the non-negative measurable function $h$, if it is $\nu$-integrable, $h<\infty$ a.e.. %\be
%\nu(h) = \nu\bb{h\ind_{\{h<\infty\}}} + \nu \bb{h \ind_{\{h=\infty\}}} < \infty \ \ra\ \nu \bb{h \ind_{\{h=\infty\}}} < \infty \ \ra \ \bb{\ind_{\{h=\infty\}}} =0 \ \ra\ h<\infty \text{ a.e.}.
%\ee
Thus,
\beast
\nu \bb{h} = \underbrace{ \nu\bb{h\ind_{\bra{h<\infty}}} + \nu \bb{h \ind_{\{h=\infty\}}} }_{\text{Theorem \ref{thm:non_negative_measurable_property}}} \leq \underbrace{ \nu\bb{h^q\ind_{\{h<\infty\}}}^{1/q} + \nu \bb{h \ind_{\{h=\infty\}}} }_{\text{Proposition \ref{pro:lp-norm_monotonicity}}}\leq \underbrace{ \nu\bb{h^q}^{1/q} + 0}_{\text{as $h<\infty$ a.e.}} = \nu\bb{h^q}^{1/q} \qquad (*).
\eeast

%If $h$ is not $\nu$-integrable, $\nu(h) = \infty$. $\nu(h^q) \geq \nu(h) =\infty$ by Theorem \ref{thm:non_negative_measurable_property}. Then $\dabs{h}_q = \nu\bb{h^q}^{1/q} =\infty$ and hence by the above case that $\dabs{f}_p = \infty$,
%\be
%\nu(h) = \nu(\abs{h\cdot 1}) \leq \dabs{h}_q\dabs{1}_p = \dabs{h}_q \bb{\nu(E)}^{1/p} = \dabs{h}_q.
%\ee 

%Thus, in both cases, $\nu(h) \leq \nu(h^q)^{1/q}.\ (*)$

Note that $q(p - 1) = p$ and $1+\frac pq = p$. Then use ($*$) and Jensen's inequality (Theorem \ref{thm:jensen_inequality_measure})

\be
\mu(|fg|) = \mu \bb{\frac{ |g|}{|f|^{p-1}} |f|^p} = a^p \nu \bb{\frac{ |g|}{|f|^{p-1}}} \leq a a^{p/q} \nu \bb{ \frac{|g|^q}{|f|^{q(p-1)}}}^{1/q} = a \mu(|g|^q)^{1/q} = \dabs{f}_p\dabs{g}_q.
\ee
with equality when $\frac{ |g|}{|f|^{p-1}} = c$ a.e. for some $c\geq 0$ as $l(x) = x^{q}$ is strictly convex. So the equality holds when
\be
\abs{g} = c |f|^{p-1} \text{ a.e.} \ \ra \ \abs{g}^q = c^q |f|^{q(p-1)}  = c^q |f|^p \text{ a.e.}.
\ee

If $p,q = 1$ or $\infty$. Let $p=1$ and $q=\infty$, we have $\dabs{g}_\infty = \inf \bra{\lm\geq 0: \abs{g} \leq \lm\text{ a.e.} } \ \ra \ \mu\bb{g} \leq \dabs{g}_\infty$ (by Theorem \ref{thm:non_negative_measurable_property}). %If $\dabs{g}_\infty=\infty$, the inequality is obvious. 
If $\dabs{g}_\infty <\infty$,
$\abs{f}\abs{g} \leq \abs{f}\dabs{g}_\infty$ a.e., 
\be
\mu\bb{\abs{fg}} = \mu\bb{\abs{f}\abs{g}} \leq \mu\bb{\abs{f}\dabs{g}_\infty} = \mu\bb{\abs{f}}\dabs{g}_\infty = \dabs{f}_1\dabs{g}_\infty.
\ee

Obviously, the eqaulity holds for $\abs{g} = \dabs{g}_\infty$ a.e.
\end{proof}

\begin{remark}
H\"older's inequality can also be proved by Young's inequality. See Klenke\cite{Klenke_2008}.$P_{150}$.

If $p=q=2$, H\"older's inequality is Cauchy-Schwarz inequality (Theorem \ref{thm:cauchy_schwarz_inequality_measure}). H\"older's inequality also holds for complex-valued functions $f$ and $g$ on $E$\footnote{need checking}.
\end{remark}

\begin{theorem}[Cauchy-Schwarz inequality\index{Cauchy-Schwarz inequality!measure}]\label{thm:cauchy_schwarz_inequality_measure}
Let $(E,\sE,\mu)$ be a probability space. Then for all measurable functions $f,g\in \sL^2(E,\sE,\mu)$, $fg$ is integrable and %thus $\mu(fg)$ is well-defined, then
\be
\bb{\mu\bb{fg}}^2 \leq \bb{\mu\abs{fg}}^2 \leq \mu \bb{f^2}\mu\bb{g^2}.
\ee

The equality holds when $\alpha f = \beta g$ for some $\alpha,\beta \in \R$ a.e..
\end{theorem}

\begin{remark}
The first inequality is given by Theorem \ref{thm:lebesgue_integrable_function_property}.(iv) and second is given by Theorem \ref{thm:holder_inequality_measure}
\end{remark}

\begin{theorem}[Minkowski's inequality\index{Minkowski's inequality!measure}]\label{thm:minkowski_inequality_measure}
For $p \in [1,\infty]$ and measurable functions $f,g\in \sL^p(E,\sE,\mu)$, we have
\be
\dabs{f + g}_p \leq \dabs{f}_p + \dabs{g}_p.
\ee

For $p\in (1,\infty)$, the equality holds if and only if $f=cg$ or $g = cf$ for some $c\geq 0$ a.e..
\end{theorem}

\begin{proof}[\bf Proof]
If $p=1$, $\abs{f+g} = \abs{f^+ -f^- + g^+-g^-} \leq \abs{f^+ + f^-} + \abs{g^+ + g^-} = \abs{f} + \abs{g}$, then
\be
\mu(\abs{f+g}) \leq \mu(\abs{f})+\mu(\abs{g}) \quad\quad\text{(by Theorem \ref{thm:non_negative_measurable_property} (ii))}.
\ee

If $p=\infty$, we let $\dabs{f}_\infty = \lm_f$ and $\dabs{g}_\infty = \lm_g$,
\be
\abs{f}\leq \lm_f \text{ a.e.},\quad \abs{g}\leq \lm_g \text{ a.e.} \quad\ra \quad \abs{f}+\abs{g}\leq \lm_f+\lm_g \text{ a.e.}\quad\ra\quad \abs{f+g} \leq \lm_f+\lm_g \text{ a.e.} .
\ee

Thus, $\dabs{f+g}_\infty = \inf\bra{\lm:\abs{f+g}\leq \lm \text{ a.e.}} \leq \lm_f + \lm_g = \dabs{f}_\infty + \dabs{g}_\infty$, so the inequality holds for $p=\infty$.

Now consider the case $p\in (1,\infty)$. If $\dabs{f}_p = \infty$ or $\dabs{g}_p = \infty$, the inequality holds obviously. 

So we consider the case that $p>1$ and $\dabs{f}_p < \infty$ or $\dabs{g}_p < \infty$, then

\be
\abs{\frac{f + g}2}^p \leq \abs{\frac{\abs{f} + \abs{g}}2}^p \leq \abs{\max\bra{\abs{f},\abs{g}}}^p \leq (|f|^p + |g|^p)  \quad\ra\quad \abs{f + g}^p \leq 2^p\bb{\abs{f}^p + \abs{g}^p}
\ee

By Theorem \ref{thm:non_negative_measurable_property} (ii), $\mu(|f + g|^p) \leq 2^p\bb{\mu(|f|^p) + \mu(|g|^p)} < \infty \ (*)$. 

The case where $\dabs{f + g}_p = 0$ is clear, so let us assume $\dabs{f + g}_p > 0$. Observe that

\be
\dabs{|f + g|^{p-1}}_q = \mu\bb{|f + g|^{(p-1)q}}^{1/q} = \mu\bb{|f + g|^p}^{1-1/p}\quad\quad(\dag).
\ee

Also, we can see that $|f + g|^{p-1} \in \sL^q(E,\sE,\mu)$ as $\dabs{|f + g|^{p-1}}_q =\mu\bb{|f + g|^p}^{1-1/p} < \infty$ by ($*$). So, by H\"older's inequality (Theorem \ref{thm:holder_inequality_measure}),
\beast
\mu(|f + g|^p) & \stackrel{**}{\leq} & \mu\bb{|f||f + g|^{p-1}} + \mu\bb{|g||f + g|^{p-1}} \\
& \leq & \bb{\dabs{f}_p + \dabs{g}_p}\dabs{|f + g|^{p-1}}_q = \bb{\dabs{f}_p + \dabs{g}_p}\mu\bb{|f + g|^p}^{1-1/p}.
\eeast

As $\mu(|f + g|^p) < \infty$ $(*)$, we can divide both sides by $\dabs{|f + g|^{p-1}}_q = \mu\bb{|f + g|^p}^{1-1/p}$ ($\dag$), then the result follows.

For $p\in (1,\infty)$, we have the equality holds when
\be
\alpha_1 |f|^p = \beta_1|f + g|^{p-1}\text{ a.e.},\ \alpha_2 |g|^p = \beta_2|f + g|^{p-1} \text{ a.e. }\quad \text{for some }\alpha_1,\alpha_2,\beta_1,\beta_2 \geq 0.
\ee
by H\"older's inequality (Theorem \ref{thm:holder_inequality_measure}. Then we have $\abs{f} = c\abs{g}$ for some $c \geq 0$ a.e.. Also, we can see that $f$ and $g$ must have the same sign to imply the equality ($**$). Thus, the equality holds when $f = cg$ or $g = cf$ for some $c \geq 0$ a.e..
\end{proof}

\subsection{Completeness of $\sL^p$}

\begin{theorem}[Completeness of $\sL^p$\index{Completeness of $\sL^p$}]\label{thm:completeness_of_slp}
Let $p \in [1,\infty]$. Let $(f_n : n \in \N)$ be a sequence in $\sL^p$ such that 
\be
\dabs{f_n - f_m}_p \to 0\quad\text{as }n,m \to \infty.
\ee
Then there exists $f \in \sL^p$ such that
\be
\dabs{f_n - f}_p \to 0 \quad\text{as }n \to \infty.
\ee
\end{theorem}
\begin{proof}[\bf Proof]
$f_n$ is Cauchy sequence in $\sL^p$, then $\forall \ve >0$ we can find $N\in \N$ and $\exists m,n \geq N$ such that $
\dabs{f_n - f_m}_p < \ve$. So we can find a subsequence $(n_k)_{k\geq 1}$ such that 
\be
\dabs{f_{n_{k+1}} - f_{n_k}}_p < \frac 1{2^k}\quad\ra \quad  S = \sum^\infty_{k=1} \dabs{f_{n_{k+1}} - f_{n_k}}_p < 1 < \infty.
\ee

By Minkowski's inequality, for any $K \in \N$, $\dabs{\sum\limits^K_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}_p \leq \sum\limits^K_{k=1} \dabs{f_{n_{k+1}} - f_{n_k}}_p \leq S < \infty$. Then we have two cases: 

\ben
\item [(i)] For the case that $p<\infty$, by monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), this bound holds also for $K = \infty$, as
\be
\sum^K_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} \ua \sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} \quad\ra\quad \dabs{\sum^K_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}_p \ua \dabs{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}_p.
\ee
\be
\text{So\quad}\dabs{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}_p < \infty \quad\ra\quad \int \bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p d\mu = \mu\bb{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p} < \infty.
\ee

Then for any $\lm \geq 0$, by Theorem \ref{thm:non_negative_measurable_property} (ii),
\beast
\lm \ind_{\bra{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p \geq \lm}}\leq \bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p \quad \ra \quad \lm\mu\bb{ \ind_{\bra{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p \geq \lm}}}\leq \mu\bb{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p}.
\eeast

Let $\lm = \infty$, we have
\be
\infty \cdot \mu\bb{ \ind_{\bra{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p = \infty}}}\leq \mu\bb{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p} < \infty
\ee
which gives $\mu\bb{ \ind_{\bra{\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}}^p = \infty}}} = 0 \ \ra\ \sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} < \infty$ a.e..

\item [(ii)] If $p=\infty$, $\dabs{\sum\limits^K_{k=1}\abs{f_{n_{k+1}} - f_{n_k}}}_p = \inf\bra{\lm : \abs{\sum\limits^K_{k=1}\abs{f_{n_{k+1}} - f_{n_k}}}\leq \lm \text{ a.e.}} \leq S \ \ra\  \mu\bb{\abs{\sum\limits^K_{k=1}\abs{f_{n_{k+1}} - f_{n_k}}}}\leq S$.

Then by monotone convergence (Theorem \ref{thm:monotone_convergence_pointwise}),
\be
\sum^K_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} \ua \sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} \quad\ra\quad \mu\bb{\sum^K_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}} \ua \mu\bb{\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}}} \leq S<\infty.
\ee

Using the same argument, we have the same result that $\sum^\infty_{k=1} \abs{f_{n_{k+1}} - f_{n_k}} < \infty$ a.e..
\een

Hence, for both cases, by completeness of $\R$ (Theorem \ref{thm:completeness_of_r}), $f_{n_k}$ converges a.e. (as $f_{n_k}$ is a cauchy sequence a.e.). We define a measurable function $f$ by
\be
f(x) = \left\{\ba{ll}
\lim f_{n_k} (x) \quad \quad & \text{if the limit exists}\\
0 & \text{otherwise}
\ea\right.
\ee

Given $\ve > 0$, we can find $N$ so that $n \geq N$ implies
\be
\dabs{f_n-f_m}_p = \left\{\ba{ll}
\mu(|f_n - f_m|^p) < \ve\quad\quad & p \in [1,\infty)\\
\inf\bra{\lm:\abs{f_n - f_m} \leq \lm \text{ a.e.}} < \ve\quad\quad & p =\infty
\ea\right.\quad \text{for all }m \geq n,
\ee

\ben
\item [(i)] For $p\in [1,\infty)$, $\mu(|f_n - f_{n_k}|^p) < \ve$ for all sufficiently large $k$. Hence, for $n \geq N$, $\abs{f_n-f}^p \geq 0$ and $\abs{f_n -f} = \abs{f_n - \lim_{k\to \infty} f_{n_k}}$ a.e., by Theorem \ref{thm:non_negative_measurable_property} (ii)
\beast
\mu(|f_n - f|^p) & = & \mu\bb{\abs{f_n - \lim_{k\to \infty} f_{n_k}}^p} = \mu\bb{\lim_{k\to \infty} \abs{f_n -  f_{n_k}}^p}  \\
& = & \mu\bb{\liminf_{k\to \infty} |f_n - f_{n_k}|^p} \quad\text{(Definition \ref{def:number_limsup_liminf} (iii))}\\
& \leq & \liminf_{k\to \infty} \mu\bb{|f_n - f_{n_k}|^p} < \ve.\quad \text{(Fatou's lemma, Lemma \ref{lem:fatou_function}) }.
\eeast
Thus, $\dabs{f_n - f}_p \to 0$.

\item [(ii)] If $p=\infty$, $\inf\bra{\lm:\abs{f_n - f_{n_k}} \leq \lm \text{ a.e.}} < \ve$ for all sufficiently large $k$ and $\mu\bb{\abs{f_n - f_{n_k}}} < \ve$. Hence, for $n \geq N$, $\abs{f_n-f}\geq 0$ and $\abs{f_n -f} = \abs{f_n - \lim_{k\to \infty} f_{n_k}}$ a.e., for arbitrarily small $\delta$,
\beast
\inf\bra{\lm:\abs{f_n - f} \leq \lm \text{ a.e.}} & = & \inf\bra{\lm:\abs{f_n - \lim_{k\to \infty}f_{n_k}} \leq \lm \text{ a.e.}} \\
& \leq & \mu\bb{\abs{f_n - \lim_{k\to \infty}f_{n_k}}} + \delta \quad\quad \text{(Definition \ref{def:infimum}, infimum)}\\
& \leq & \liminf \mu\bb{\abs{f_n - f_{n_k}}} + \delta < \ve+\delta. \quad\quad \text{(Fatou's lemma, Lemma \ref{lem:fatou_function})}
\eeast
Thus, $\dabs{f_n - f}_\infty \to 0$.
\een

Furthermore, we need to show that $f\in \sL^p$. For $p\in [1,\infty)$,
\be
\underbrace{\mu\bb{\abs{f}^p} = \mu\bb{\lim_{k\to\infty} \abs{f_{n_k}}^p}}_{\text{Theorem \ref{thm:non_negative_measurable_property} (ii)}} = \mu\bb{\liminf \abs{f_{n_k}}^p} \leq \liminf \mu\bb{\abs{f_{n_k}}^p} < \infty.
\ee

For $p=\infty$, $\mu \bb{\abs{f_{n_k}}} \leq \inf\bra{\lm :\abs{f_{n_k}} \leq \lm \text{ a.e.}} < \infty$. For arbitrarily small $\delta$,
\be
\inf\bra{\lm :\abs{f} \leq \lm \text{ a.e.}} = \inf\bra{\lm :\lim\abs{f_{n_k}} \leq \lm \text{ a.e.}} \underbrace{\leq \mu \bb{\lim \abs{f_{n_k}}} + \delta}_{\text{Definition \ref{def:infimum} (infimum)}} \leq  \underbrace{\liminf \mu\bb{\abs{f_{n_k}}}+\delta}_{\text{Fatou lemma (Lemma \ref{lem:fatou_function})}}  < \infty.
\ee

Hence, $f \in \sL^p$ and, since $\ve > 0$ was arbitrarily small, $\dabs{f_n - f}_p \to 0$.
\end{proof}

\begin{proposition}\label{pro:cauchy_sequence_iff_slp}
The sequence $f_n$ is a Cauchy sequence in $\sL^p(E,\sE,\mu)$ if and and only if $f_n$ converges in $\sL^p$ to $f\in \sL^p(E,\sE,\mu)$.
\end{proposition}


\subsection{$L^p$ space}

Recall the definitions of norm (Definition \ref{def:norm}) and inner product (Definition \ref{def:inner_product}). Minkowski's inequality shows that each $L^p$ space is a vector space and that the $\sL^p$-norms satisfy condition (i), (iii) and (iv), but condition (ii) fails, because $\dabs{f}_p = 0$ does not imply that $f = 0$, only that $f = 0$ a.e.. 

However, it is possible to make the $\sL^p$-norms into true norms by quotienting out by the subspace of measurable functions vanishing a.e.. This quotient will be denoted $L^p$. 

The notion of convergence in $\sL^p$ defined in previous section is the usual notion of convergence in a normed space. We can define a equivalence relation
\be
u\sim v \quad\lra \quad u=v \text{ \ a.e.}
\ee

Then this quotienting gives us a complete space. Usually, we do not do this quotienting in probability theory. % (see Williams\cite{Williams_1991})

Note that, for $f \in L^2$, we have $\dabs{f}^2_2 = \inner{f}{f}$, where $\inner{\cdot}{\cdot}$ is the symmetric bilinear form on $L^2$ given by
\be
\inner{f}{g} = \int_E fg d\mu.
\ee

Thus $L^2$ is an inner product space. 

A normed vector space $V$ is complete\index{complete} if every Cauchy sequence in $V$ converges, that is to say, given any sequence $(v_n : n \in \N)$ in $V$ such that $\dabs{v_n - v_m} \to 0$ as $n,m \to \infty$, there exists $v \in V$ such that $\dabs{v_n-v} \to 0$ as $n \to \infty$. A complete normed vector space is called a Banach space (Definition \ref{def:banach_space}). A complete inner product space is called a Hilbert space\index{Hilbert space}. Such spaces have many useful properties, which makes the following result important.

\begin{corollary}
We have
\ben
\item [(a)] $L^p(E,\sE,\mu)$ is a Banach space, for all $1 \leq p \leq \infty$,
\item [(b)] $L^2(E,\sE,\mu)$ is a Hilbert space.
\een
\end{corollary}


\subsection{Orthogonal Projection}

We shall apply some general Hilbert space arguments to $\sL^2$. First, we have

\begin{proposition}
Pythagoras' rule\index{Pythagoras' rule}
\be
\dabs{f + g}_2^2 = \dabs{f}_2^2 + 2\inner{f}{g} + \dabs{g}^2_2 
\ee
and the parallelogram law\index{parallelogram law}
\be
\dabs{f + g}^2_2 + \dabs{f - g}^2_2 = 2\bb{\dabs{f}^2_2 + \dabs{g}^2_2}.
\ee
\end{proposition}

\begin{definition}
If $\inner{f}{g} = 0$, then we say that $f$ and $g$ are orthogonal\index{orthogonal!general inner product space}. For any subset $V \subseteq \sL^2$, we define\footnote{could be introduced earlier}
\be
V^\perp = \{f \in \sL^2 : \inner{f}{v} = 0 \text{ for all }v \in V \}.
\ee
\end{definition}

\begin{definition}\label{def:closed_sl2_space}
A subset $V \subseteq \sL^2$ is closed\index{closed!$\sL^2(E,\sE,\mu)$ space} if, for every sequence $(f_n : n \in \N)$ in $V$, with $f_n \to f$ in $\sL^2$, we have $f = v$ a.e., for some $v \in V$.
\end{definition}

\begin{theorem}[Orthogonal Projection\index{Orthogonal Projection Theorem!measure}]\label{thm:orthogonal_projection_sl2}
Let $V$ be a complete subspace of $\sL^2$. Then each $f \in \sL^2$ has a decomposition $f = g + h$, with $g \in V$ and $h \in V^\perp$. Moreover, $\dabs{f - g}_2 \leq \dabs{f - u}_2$ for all $u \in V$, $f-g \perp v$ for all $v\in V$ with equality only if $g = u$ a.e..

The function $g$ is called the orthogonal projection\index{orthogonal projection!measure} of $f$ on $V$.
\end{theorem}
\begin{proof}[\bf Proof]
Choose a sequence $g_n \in V$ such that
\be
\dabs{f - g_n}_2 \to d(f, V) = \inf\{\dabs{f - u}_2 : u \in V \}.
\ee

By the parallelogram law,
\be
\dabs{2(f - (g_n + g_m)/2)}_2^2 + \dabs{g_n - g_m}_2^2 = 2\bb{\dabs{f - g_n}_2^2 + \dabs{f - g_m}_2^2}.
\ee
But $\dabs{2(f-(g_n+g_m)/2)}_2^2 \geq 4d(f, V)^2$, so we must have $\dabs{g_n-g_m}_2 \to 0$ as $n,m \to \infty$. So $g_n$ is a Cauchy sequence in $\sL^2$. By completeness of $\sL^2$, $\dabs{g_n - g}_2 \to 0$, for some $g \in \sL^2$. 

Hence, $\dabs{f-g}_2 \leq \dabs{f-g_n} + \dabs{g_n -g}_2$ implies that $\dabs{f-g}_2 = \inf\{\dabs{f - u}_2 : u \in V \}$.

Now, for any $v \in V$ and $t \in \R$, we have
\be
d(f, V)^2 \leq \dabs{f - (g + tv)}_2^2 = d(f, V )^2 - 2t\inner{f - g}{v} + t^2\dabs{v}_2^2.
\ee
So we must have $\inner{f - g}{v} = 0$ for arbitrarily small $t$. Hence $h = f - g \in V^\perp$, as required.

If $g=u$ a.e., i.e., $\dabs{g-u}_2=0$ for some $u \in V$, then
\be
\dabs{f - u}_2 \leq \dabs {g-u}_2 + \dabs{f-g}_2 = 0 + d(f, V) = d(f, V).
\ee
Thus, the equality holds.
\end{proof}


\begin{proposition} 
Let $(E,\sE,\mu)$ be a measure space and let $V_1\subseteq V_2\subseteq \dots$ be an increasing sequence of closed subspaces of $\sL^2 = \sL^2(E,\sE,\mu)$ for $f\in\sL^2$, denoted by $f_n$ the orthogonal projection of $f$ on $V_n$. Show that $f_n$ converges in $\sL^2$.
\end{proposition} 

\begin{proof}[\bf Proof]
Since $\sL^2$ is complete, we need only show that the $f_n$ are Cauchy. We have, for $m\leq n$,
\be
\norm{f_m - f_n}^2_2 = \norm{(f - f_n) - (f - f_n)}^2_2 = \norm{f-f_n}^2_2 - 2\langle f-f_n,f-f_m\rangle + \norm{f-f_m}^2_2.
\ee

By the definition of orthogonal projection (Theorem \ref{thm:orthogonal_projection_sl2}), we have
\begin{equation} 
 \norm{f - f_n}^2_2 + \norm{f_n}^2_2 = \norm{f}^2_2 \quad\quad (*)
\end{equation}
Using this, and also noting that $f - f_n \in V_n ^\perp \subseteq V_m ^\perp$, we get
\begin{align} 
\norm{f_m - f_n}^2_2 &= 2\norm{f}^2_2 - \norm{f_m}^2_2 - \norm{f_n}^2_2 - 2\langle f-f_n,f-f_m\rangle \\
&= 2\norm{f}^2_2 - \norm{f_m}^2_2 - \norm{f_n}^2_2 - 2(\norm{f}^2_2 - \norm{f_n}^2_2) = \norm{f_n}^2_2 - \norm{f_m}^2_2 \quad \quad (\dag)
\end{align}
Thus $f_n$ is Cauchy if $\norm{f_n}^2_2$ is Cauchy. But $(\dag)$ shows that the $\norm{f_n}^2$ are increasing, and ($*$) shows they are bounded above by $\norm{f}^2_2$. Thus $\norm{f_n}_2$ converges and is therefore Cauchy.
\end{proof}


\subsection{Uniform integrable}

\begin{lemma}\label{lem:iu_measurable_function}
For a measure space $(E,\sE,\mu)$, let $f$ be an integrable measurable function and set 
\be
I_f(\delta) = \sup\{\mu(|f|\ind_A) : A \in \sE, \mu(A) \leq \delta\} \quad\ra\quad I_f(\delta) \da 0 \ \text{ as }\ \delta \da 0.
\ee
\end{lemma}


\begin{proof}[\bf Proof]
Suppose not. Then, for some $\ve > 0$, there exists $A_n \in \sE$, with $\mu(A_n) \leq 2^{-n}$ and $\mu(|f|\ind_{A_n}) \geq \ve$ for all $n$. By the first Borel-Cantelli lemma (Lemma \ref{lem:borel_cantelli_1_measure}), $\mu(A_n \text{ i.o.}) = 0$. But then, by dominated convergence theorem ,
\be
|f|\ind_{\{\bigcup_{m\geq n} A_m\}} \to |f|\ind_{\{A_n\text{ i.o.}\}} \quad\ra\quad \ve \leq \mu\bb{|f|\ind_{\{\bigcup_{m\geq n} A_m\}}} \to \mu\bb{|f|\ind_{\{A_n\text{ i.o.}\}}} = 0
\ee
which is a contradiction.
\end{proof}

\begin{definition}\label{def:bounded_in_slp}
For a measure space $(E,\sE,\mu)$, let $\{f_\alpha\}$ be a collection of measurable functions. For $1 \leq p \leq \infty$, we say that $\{f_\alpha\}$ is bounded in $\sL^p(E,\sE,\mu)$\index{bounded in $\sL^p$!measurable function} if 
\be
\sup_{f\in \{f_\alpha\}} \dabs{f}_p < \infty.
\ee 
\end{definition}

\begin{definition}\label{def:uniformly_integrable}
Let $(E,\sE,\mu)$ be a measure space. Define
\be
I_{\{f_\alpha\}}(\delta) = \sup\{\mu(|f|\ind_A) : f\in \{f_\alpha\} ,A \in \sE, \mu(A) \leq \delta\}.
\ee
We say that $\{f_\alpha\}$ is uniformly integrable\index{uniformly integrable!measurable function family} or UI\index{UI (uniformly integrable)!measurable function family} if $\{f_\alpha\}$ is bounded in $\sL^1(E,\sE,\mu)$ and 
\be
I_{\{f_\alpha\}}(\delta) \da 0\ \text{ as }\ \delta \da 0,\quad\text{i.e.,}\quad \forall \ve>0, \exists \delta >0 \text{ s.t. }I_{\{f_\alpha\}}(\delta) <\ve.
\ee
\end{definition}

\begin{proposition}\label{pro:slp_implies_ui}
Let $(E,\sE,\mu)$ be a measure space. If $\mu(E)<\infty$ and a collection of measurable function, $\{f_\alpha\}$ is bounded in $\sL^p(E,\sE,\mu)$, for some $p \in (1,\infty]$, then $\{f_\alpha\}$ is UI.
\end{proposition}
\begin{proof}[\bf Proof]
By H\"older's inequality (Theorem \ref{thm:holder_inequality_measure}), for conjugate indices $p \in (1,\infty]$, $q \in [1,\infty)$,
\be
\mu(|f|\ind_A) \leq \dabs{f}_p(\mu(A))^{1/q}.
\ee
Hence, if $\{f_\alpha\}$ is bounded in $\sL^p(E,\sE,\mu)$, $\dabs{f}_p(\mu(A))^{1/q} \leq \sup_{f\in \{f_\alpha\}}\dabs{f}_p (\mu(E))^{1/q} < \infty$, then $\{f_\alpha\}$ is UI. 
\end{proof}

\begin{example}
The sequence $f_n = n\ind_{(0,1/n)}$ is bounded in $\sL^1(E,\sE,\mu)$ for Lebesgue measure on $(0, 1]$, but not uniformly integrable as for all $n$, $\sup \E\bb{n\ind_{(0,1/n)}} = 1$.
\end{example}

\begin{proposition}\label{pro:finite_integrable_implies_ui}
Any single integrable measurable function is uniformly integrable. This extends easily to any finite collection of integrable measurable functions.
\end{proposition}

\begin{proof}[\bf Proof]
Direct result from Lemma \ref{lem:iu_measurable_function} and H\"older's inequality (Theorem \ref{thm:holder_inequality_measure}).
\end{proof}

\begin{proposition}\label{pro:dominated_integrable_implies_ui}
For any integrable measurable function $g$, the set
\be
\bra{f_\alpha} = \bra{f : f \text{ is a measurable function}, |f| \leq g }\quad\text{is UI.}
\ee
\end{proposition}

\begin{proof}[\bf Proof]
First, $\mu(|f|1_A) \leq \mu(g 1_A)$ for all $A$. By Proposition \ref{pro:finite_integrable_implies_ui}, we have $\bra{f_\alpha}$ is UI.
\end{proof}

\begin{lemma}\label{lem:uniformly_integrable_finite_measure}
Let $(E,\sE,\mu)$ be a measure space with $\mu(E)<\infty$. Let $\{f_\alpha\}$ be a family of measurable functions. Then $f\in \{f_\alpha\}$ is UI if and only if
\be
\sup\{\mu(|f|\ind_{|f|\geq K}) : f \in \{f_\alpha\}\} \to 0, \quad \text{as }\ K \to \infty.
\ee
\end{lemma}
\begin{proof}[\bf Proof]
Suppose $\{f_\alpha\}$ is UI. Given $\ve > 0$, choose $\delta > 0$ so that $I_{\{f_\alpha\}}(\delta) < \ve$, then choose $K < \infty$ so that $\sup_{f\in \{f_\alpha\}}\mu(\abs{f}) \leq K\delta$ since $\{f_\alpha\}$ is bounded in $\sL^1$ by the definition of UI. Then, for $f\in \{f_\alpha\}$ and $A = \{|f| \geq K\}$, we have 
\be
\mu(A) = \underbrace{\mu\bb{\abs{f} \geq K} \leq \frac{\mu(\abs{f})}K}_{\text{Chebyshev's inequality (Theorem \ref{thm:chebyshev_inequality})}} \leq \frac{\sup \mu(\abs{f})}{K} \leq \frac{\delta K}{K} =\delta,
\ee

so $\mu(|f|\ind_A) < \ve$. Hence, as $K \to \infty$, $\sup\{\mu(|f|1_{\{|f|\geq K\}}) : f\in \{f_\alpha\}\} \to 0$.

On the other hand, if this condition holds, then, since
\beast
\abs{f} = \abs{f}\ind_{\{|f|< K\}} + \abs{f}\ind_{\{|f|\geq K\}} \quad \ra \quad \underbrace{ \mu\bb{\abs{f}} \leq \mu\bb{\abs{f}\ind_{\{|f|< K\}}} + \mu{|f|\ind_{\{|f|\geq K\}}} }_{\text{Minkowski's inequality, Theorem \ref{thm:minkowski_inequality_measure}}} \quad \ra\quad \mu\bb{\abs{f}} < K\mu\bb{E} + \mu{|f|\ind_{\{|f|\geq K\}}}
\eeast

Thus, take $\ve=1$, we can choose $K$
\be
\sup_{f\in \{f_\alpha\}}\mu(\abs{f}) < K\mu\bb{E} + \sup_{f\in \{f_\alpha\}}\mu{|f|\ind_{\{|f|\geq K\}}} < K\mu\bb{E} + 1 < \infty\quad\ra\quad \{f_\alpha\} \text{ is bounded in }\sL^1.
\ee

Given $\ve > 0$, choose $K < \infty$ so that $\mu(|f|\ind_{\{|f|\geq K\}}) < \ve/2$ for all $f \in \{f_\alpha\}$. Then choose $\delta > 0$ so that $K\delta < \ve/2$. For all $f \in \{f_\alpha\}$ and $A \in \sE$ with $\mu(A) < \delta$, we have
\be
\mu(|f|\ind_A) \leq \mu(|f|\ind_{\{|f|\geq K\}}\ind_A) + \mu(|f|\ind_{\{|f|< K\}}\ind_A) < \mu(|f|\ind_{\{|f|\geq K\}})  + K\mu(A) < \ve.
\ee

Hence $\{f_\alpha\}$ is UI.
\end{proof}

Alternative definition of uniformly integrable is given by the following theorem.

\begin{theorem}\label{thm:ui_equivalent_finite_measure}
Let $(E,\sE,\mu)$ be a measure space. A collection of measurable functions $\{f_\alpha\}$ is uniformly integrable, it is equivalent to either of the following two conditions:
\be
\text{(i)}\ \inf\limits_{0\leq g\in \sL^1(E,\sE,\mu)}\sup\limits_{f\in \{f_\alpha\}} \mu\bb{\abs{f}\ind_{\abs{f}>g}} = 0, \quad\quad\quad\quad \text{(ii)}\ \inf\limits_{0\leq g\in \sL^1(E,\sE,\mu)}\sup\limits_{f\in \{f_\alpha\}} \mu\bb{\bb{\abs{f}-g}^+} = 0.
\ee

If $\mu(E) < \infty$, then uniformly integrability is equivalent to either of the following two conditions:
\be
\text{(iii)}\ \inf\limits_{a\in[0,\infty)}\sup\limits_{f\in \{f_\alpha\}} \mu\bb{\abs{f}\ind_{\abs{f}>a}} = 0,\quad\quad\quad\quad \text{(iv)}\ \inf\limits_{a\in[0,\infty)}\sup\limits_{f\in \{f_\alpha\}} \mu\bb{\bb{\abs{f}-a}^+} = 0.
\ee
\end{theorem}

\begin{proof}[\bf Proof]
Klenke\cite{Klenke_2008}.$P_{135}$.\footnote{need proof}
\end{proof}


\subsection{Convergence in $\sL^p(E,\sE,\mu)$}

\begin{definition}\label{def:convergence_in_slp_measure}
Let $(E,\sE,\mu)$ be a measure space. We say the sequence of measurable functions $f_n$ converges in $\sL^p$\index{convergence!in $\sL^p(E,\sE,\mu)$} to $f$, for some $p \in [1,\infty)$, denoted by $f_n \stackrel{\sL^p}{\to} f$, if $f,f_n\in \sL^p(E,\sE,\mu)$ for all $n$ and
\be
\mu \abs{f_n-f}^p  \to 0 \ \text{ as } n\to \infty.
\ee

If $p = \infty$, we say $f_n$ converges in $\sL^\infty$ to $f$, if $f,f_n \in \sL^\infty(E,\sE,\mu)$ for all $n$ and
\be
\dabs{f_n - f}_\infty \to 0 \ \text{ as } n\to \infty.
\ee
\end{definition}

\begin{proposition}\label{pro:convergence_slp_monotone_measure}
Let $(E,\sE,\mu)$ be a measure space and $\mu(E) = 1$. For $p=[1,\infty)$, if $f_n\stackrel{\sL^p}{\to} f$, then for any $q \in [1,p)$, $f_n \stackrel{\sL^q}{\to} f$.
\end{proposition}

\begin{proof}[\bf Proof]
This is direct result from Proposition \ref{pro:lp-norm_monotonicity}.
\end{proof}

\begin{proposition}\label{pro:convergence_slp_implies_measure}
Let $(E,\sE,\mu)$ be a measure space. For $p=[1,\infty)$, if $f_n\stackrel{\sL^p}{\to} f$, then $f_n \stackrel{\mu}{\to} f$.
\end{proposition}

\begin{proof}[\bf Proof]
If  $f_n\stackrel{\sL^p}{\to} f$, $\forall \ve >0$, and then $\ve \ind_{\{\abs{f_n-f} \geq \ve\}} \leq \abs{f_n-f}$,
\beast
\mu\bb{\{\abs{f_n-f} \geq \ve\}}^{1/p} = \frac 1{\ve}\dabs{\ve \ind_{\{\abs{f_n-f} \geq \ve\}}}_p \underbrace{\leq \frac 1{\ve} \dabs{f_n-f}_p}_{\text{by Theorem \ref{thm:lebesgue_integrable_function_property}}} \to \frac 1{\ve}0 = 0\quad\ra\quad \mu\bb{\{\abs{f_n-f} \geq \ve\}} \to 0 \ \text{ as }\ n\to\infty.
\eeast
Thus, $f_n$ converges to $f$ in measure.
\end{proof}

\begin{theorem}[bounded convergence theorem\index{bounded convergence theorem!$\sL^p$ finite measure}]\label{thm:bounded_convergence_finite_measure_lp}
Let $(E,\sE,\mu)$ be a measure space with $\mu(E) <\infty$. Let $f$ be a measurable function and let $(f_n : n \in \N)$ be a sequence of such functions. Suppose $f_n \to f$ in measure and $|f_n| \leq M$ for all $n$, for some constant $M < \infty$. Then for $p\in [1,\infty)$. $f_n \stackrel{\sL^p}{\to} f$.
\end{theorem}

\begin{remark}
When $p=1$, this is Theorem \ref{thm:bounded_convergence_finite_measure}.
\end{remark}

\begin{proof}[\bf Proof]
Let $\mu(E) = C$. Since $|f_n| \leq M$ for all $n$, we have $f_n\in \sL^p(E,\sE,\mu)$. By Theorem \ref{thm:convergence_in_measure} (ii), $f$ is the almost everywhere limit of a subsequence, so 
\be
|f| = \abs{f_{n_k} - f_{n_k} + f} \leq \abs{f_{n_k}-f} + \abs{f_{n_k}} \leq \abs{f_{n_k}-f} + M \to M \text{ \ a.e.}\ \ra\ \abs{f}^p \leq M^p \text{ a.e.} \ \ra \ f \in \sL^p(E,\sE,\mu).
\ee

For $\ve > 0$, there exists $N$ such that $n \geq N$ implies (by definition of convergence in measure (Definition \ref{def:convergence_in_measure}))
\be
\mu\bb{\bra{\abs{f_n - f}^p > \ve/(2C)}} \leq \ve/(2^{p+1}M^p).\quad\quad (*)
\ee

Then by Theorem \ref{thm:lebesgue_integrable_function_property}.(ii),
\beast
\mu|f_n-f|^p & = & \mu\bb{|f_n-f|^p\ind_{\{|f_n-f|^p>\ve/(2C)\}}}+\mu\bb{|f_n-f|^p\ind_{\{|f_n-f|^p \leq \ve/(2C)\}}} \\
& \leq & \mu\bb{2^pM^p\ind_{\{|f_n-f|^p>\ve/(2C)\}}}+\mu\bb{\ve/(2C)} \\
& = & 2^pM^p\mu\bb{\ind_{\{|f_n-f|^p>\ve/(2C)\}}}+ \frac{\ve}{2C}\mu\bb{E} \\ 
& \leq & 2^p M^p \ve/(2^{p+1}M^p)+\ve/2 = \ve, \quad \text{by $(*)$}
\eeast
which implies that $\mu(\abs{f_n-f}^p)\to 0$. Hence, $f_n \stackrel{\sL^p}{\to} f$.
\end{proof}

\begin{theorem}[Vitali Convergence Theorem\index{Vitali Convergence Theorem}]\label{thm:vitali_convergence}
Let $f_1, f_2, \dots$ be $\sL^p(E,\sE,\mu)$-integrable functions, for $1\leq p<\infty$. Then the sequence $f_n$ is a Cauchy sequence in $\sL^p(E,\sE,\mu)$ if and and only if
\ben
\item [(i)] the sequence $f_n$ is a Cauchy sequence in measure,
\item [(ii)] the collection of functions, $\{\abs{f_n}^p\}$ is uniformly integrable,
\item [(iii)] for every $\ve > 0$, there exists a set $A$ of finite measure, such that $\dabs{f_n\ind_{A^c}}_p < \ve$ for all $n$.
\een
\end{theorem}
\begin{remark}
The statement "$f_n$ is a Cauchy sequence in $\sL^p(E,\sE,\mu)$" can be replaced by "$f_n$ is convergent in $\sL^p(E,\sE,\mu)$" by Proposition \ref{pro:cauchy_sequence_iff_slp}. Also, "$f_n$ is convergent in $\sL^p(E,\sE,\mu)$" can imply strong statement "$f_n$ is convergent in measure" by Proposition \ref{pro:convergence_slp_implies_measure}.

Note that if the sequence $f_n$ is a Cauchy sequence in measure, then there exists $f$ such that $f_n$ converges to $f$ in measure\footnote{need proof}.
\end{remark}

\begin{proof}[\bf Proof]
($\ra$) Assume $f_n$ is Cauchy sequence in $\sL^p(E,\sE,\mu)$, then given $\ve >0$, there exists $N$, $\dabs{f_m-f_n}_p < \ve$ for all $m,n \geq N$ i.e., $\dabs{f_m-f_n}_p \to 0$ as $m,n \to \infty$
\ben \item [(i)] Fix $\eta >0$, and then $\eta\ind_{\{\abs{f_m-f_n} \geq \eta\}} \leq \abs{f_m-f_n}$,
\beast
\mu\bb{\{\abs{f_m-f_n} \geq \eta\}}^{1/p} = \frac 1{\eta}\dabs{\eta \ind_{\{\abs{f_m-f_n} \geq \eta\}}}_p \underbrace{\leq \frac 1{\eta} \dabs{f_m-f_n}_p}_{\text{by Theorem \ref{thm:lebesgue_integrable_function_property}}} \to \frac 1{\eta}0 = 0\quad\ra\quad \mu\bb{\{\abs{f_m-f_n} \geq \eta\}} \to 0 \ \text{ as }\ m,n\to\infty.
\eeast
Thus, $f_n$ is a Cauchy sequence in measure.

\item [(ii)] Given $\ve>0$, select $N$ such that $\dabs{f_n-f_N}_p<\ve$ when $n\geq N$. The family $\{f^N_{\alpha}\} = \{\abs{f_1}^p, \dots, \abs{f_{N-1}}^p, \abs{f_N}^p \}$ is uniformly integrable because it consists of only finitely many integrable functions.

So for every $\ve>0$, there is $\delta>0$ such that $\mu(A)\leq \delta$ implies $\dabs{f_n\ind_A}_p< \ve$ for $n\leq N$ by the fact that $\{f^N_{\alpha}\}$ is UI. On the other hand, for $n>N$,
\be
\dabs{f_n\ind_A}_p \leq \dabs{(f_n-f_N)\ind_A}_p + \dabs{f_N\ind_A}_p \leq \dabs{f_n-f_N}_p + \dabs{f_N\ind_A}_p < 2\ve
\ee
for the same sets $A$, and thus the entire infinite sequence $\{\abs{f_n}^p\}$ is uniformly integrable too.

\item [(iii)] Given $\ve$, select N such that $\dabs{f_n-f_N}_p< \ve$ for all $n\geq N$. Then let 
\be
\varphi_m = 2^{-m}\floor{2^m f_N^+}\land m - 2^{-m}\floor{2^m f_N^-}\land m = \sum^m_{i=1}a_i \ind_{A_i} - \sum^m_{j=1}b_j \ind_{B_j}.
\ee
where $a_i,b_j \in [0,\infty)$ and $A_i, B_j$ are disjoint sets. Note that the integral of $\varphi_m$ is well-definted since $f_N$ is integrable. Since $\varphi_m \to f_N \ \ra\ (\varphi_m - f_N)^p\to 0$, by dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), we have some $\varphi^N:= \varphi_k$ in the sequence $(\varphi_m)$ s.t. $\dabs{f_N-\varphi^N}_p < \ve$. Then by Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure}), we have
\be
\dabs{f_n - \varphi^N}_p \leq \dabs{f_n-f_N}_p + \dabs{f_N-\varphi^N}_p < 2\ve\quad \text{for all }n\geq N.
\ee

Let $S_N=\{\varphi^N \neq 0\}$ be the support of $\varphi^N$, 
\beast
\mu(S_N) & \leq & \underbrace{\max_{1\leq i\leq k}\{a_i,b_i:a_i,b_i \neq 0\}}_{\text{finite many}}\mu\bb{\left\{\bigcup^k_{i=1}(A_i\cup B_i):a_i,b_i \neq 0\right\}} \\
& \leq & \frac{\max_{1\leq i\leq k}\{a_i,b_i:a_i,b_i \neq 0\}}{\min_{1\leq i\leq k}\{a_i,b_i:a_i,b_i \neq 0\}}\mu\bb{\abs{\varphi^N}} \leq \frac{\max_{1\leq i\leq k}\{a_i,b_i:a_i,b_i \neq 0\}}{\min_{1\leq i\leq k}\{a_i,b_i:a_i,b_i \neq 0\}}\mu\bb{\abs{f_N}} < \infty
\eeast
since $f_N$ is integrable. Hence $S_N$ must have finite measure. Then we have
\be
\dabs{f_n \ind_{S_N^c}}_p = \dabs{f_n - f_n \ind_{S_N}}_p \underbrace{\leq \dabs{f_n - \varphi^N}_p + \dabs{\varphi^N - f_n \ind_{S_N}}_p}_{\text{Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure})}} = \dabs{f_n - \varphi^N}_p + \dabs{(\varphi^N - f_n) \ind_{A_N}}_p < 2\ve + 2\ve = 4\ve.
\ee	   

For each $n<N$, we can similarly construct $\varphi^n$ (as we did for $\varphi^N$), such that $\dabs{f_n-\varphi^n}_p<2\ve$ and let $S_n = \{\varphi^n \neq 0\}$ of finite measure, 
\be
\dabs{f_n \ind_{S_n^c}}_p= \dabs{f_n - f_n \ind_{S_n}}_p \underbrace{\leq \dabs{f_n - \varphi^n}_p + \dabs{\varphi^n - f_n \ind_{S_n}}_p}_{\text{Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure})}} = \dabs{f_n - \varphi^n}_p + \dabs{(\varphi^n - f_n) \ind_{S_n}}_p < 2\ve + 2\ve = 4\ve.
\ee

Then we set $A = S_1 \cup \dots \cup S_{N-1} \cup S_N$, a finite union, then $A$ has finite measure, and clearly 
\be
\dabs{f_n \ind_{A^c}}_p < 4\ve\ \text{ for any }n .
\ee
\een

$(\la)$ We show $\dabs{f_m-f_n}_p$ to be small for large $m,n$ by a multi-step estimate: fix $\eta>0$, we have (by Minkowski's inequality, Theorem \ref{thm:minkowski_inequality_measure}),
\be
\dabs{f_m - f_n}_p \leq \dabs{\abs{f_m - f_n}\ind_{A\bs\{\abs{f_m - f_n} \geq \eta\}}}_p + \dabs{\abs{f_m - f_n}\ind_{\{\abs{f_m - f_n} \geq \eta\}}}_p + \dabs{\abs{f_m - f_n} \ind_{E\bs A}}_p.
\ee

Use condition (iii) to choose $A$ of finite measure such that 
\be
\dabs{f_n\ind_{A^c}}_p <\ve \ \text{ for all }n \quad\ra\quad \dabs{\abs{f_m - f_n}\ind_{A^c}}_p < 2\ve.
\ee

Let $\eta = \ve/\mu(A)^{1/p} >0$ and $A_{mn} = \{\abs{f_m - f_n}\geq \eta\}$. By condition (ii), choose $\delta>0$ s.t.
\be
\dabs{f_n \ind_{A_{mn}}}_p < \ve \quad \text{whenever }\ \mu(A_{mn}) < \delta \quad\ra\quad \dabs{\abs{f_m - f_n} \ind_{A_{mn}}}_p < 2\ve.
\ee

Then by condition (i), exists $N$ such that $\mu(A_{mn}) < \delta$ if $m,n\geq N$. Thus,
\beast
\dabs{f_m - f_n}_p & \leq & \dabs{\abs{f_m - f_n}\ind_{A\bs\{\abs{f_m - f_n} \geq \eta\}}}_p + \dabs{\abs{f_m - f_n}\ind_{\{\abs{f_m - f_n} \geq \eta\}}}_p + \dabs{\abs{f_m - f_n} \ind_{A^c}}_p\\
& < & \dabs{\eta \ind_A}_p + \dabs{\abs{f_m - f_n}\ind_{A_{mn}}}_p + \dabs{\abs{f_m - f_n} \ind_{A^c}}_p\\
& = & \frac {\ve}{\mu(A)^{1/p}}\dabs{\ind_A}_p + \dabs{\abs{f_m - f_n}\ind_{A_{mn}}}_p + \dabs{\abs{f_m - f_n} \ind_{A^c}}_p < \ve + 2\ve + 2\ve = 5\ve.
\eeast

Hence, $\dabs{f_m-f_n}_p < 5\ve$ for $m,n \geq N$.
\end{proof}

\begin{remark}
This theorem can be used as a replacement for the more well-known dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure}), when a dominating factor cannot be found for the functions $f_n$ to be integrated. (If this theorem is known, the dominated convergence theorem can be derived as a special case.)

In a finite measure space, condition (iii) is trivial. In fact, condition (iii) is the tool used to reduce considerations in the general case to the case of a finite measure space.

In probability theory, the definition of 'uniform integrability' (in fact, the definition is Lemma \ref{lem:uniformly_integrable_finite_measure}) is slightly different from its definition in general measure theory. The special case is Theorem \ref{thm:ui_prob_iff_sl1}.
\end{remark}

\subsection{Dense property}

\begin{definition}\label{def:stepfunction}
A stepfunction\index{stepfunction} $f:\R\to\R $ is any finite linear combination of indicator functions of finite intervals. 
\end{definition}

\begin{proposition} 
The set of stepfunctions $\sJ$ is dense in $\sL^p(\R,\sB(\R),\mu)$ for all $p\in[1,\infty)$, i.e., for all $f\in\sL^p(\R,\sB(\R),\mu)$ and all $\ve>0$ there exists $g\in \sJ$ such that $\|f-g\|_p<\ve$.
\end{proposition} 

\begin{proof}[\bf Proof]
Let $f \in \sL^p(\R,\sB(\R),\mu)$ and assume first, for simplicity, that $f \geq 0$. Given $\ve>0$, there exists $N_1 \in \mathbb{R}$ such that
\begin{equation}
 \dabs{f-f\ind_{[-N_1,N_1]}}_p < \frac{\ve}{3}\quad\quad (*)
\end{equation}
To see this, note that $\abs{f}^p \geq \abs{f-f\ind_{[-n,n]}}^p \to 0$ as $n \to \infty$, and use dominated convergence (Theorem \ref{thm:dominated_convergence_measure}).

Now, set $f_n = 2^{-n} \floor{2^n f \ind_{[-N_1,N_1]}} \wedge n$, so $f_n$ simple and $\abs{f_n - f\ind_{[-N_1,N_1]}}^p \to 0$. Again, by dominated convergence, there exists $N_2 \in \mathbb{N}$ with
\begin{equation} 
\dabs{f\ind_{[-N_1,N_1]} - f_{N_2}}_p < \frac{\ve}{3}\quad\quad (\dag)
\end{equation}

Suppose $f_{N_2} = \sum_{k=1} ^m a_k \ind _{A_k}$, for Borel sets $A_k$ containted in $[-N_1,N_1]$, and positive reals $a_k$, $k=1,\ldots,m$. By Proposition \ref{pro:borel_set_symmetric_difference}, for each $A_k$ one can find a finite collection of finite, disjoint intervals $B_{1,k},\dots,B_{l_k, k}$, contained in $[-N_1,N_1]$, such that
\be
\mu\left(A_k \triangle \bigcup_{j=1}^{l_k} B_{j,k} \right) = \dabs{\ind_{A_k} - \ind_{\bra{\bigcup_{j=1} ^{l_k} B_{j,k}}}}_p < \frac{\ve}{3m \max_k a_k}
\ee
Set $g= \sum\limits_{k=1} ^m \bb{ a_k \sum\limits_{j=1} ^{l_k} \ind_{B_{j,k}} }$, so $g$ is a stepfunction. Thus,
\be
\dabs{f_{N_2} - g}_p < \dabs{\sum_{k=1} ^m a_k \ind _{A_k} - \sum_{k=1} ^m \bb{ a_k \sum_{j=1} ^{l_k} \ind_{B_{j,k}} }}_p \leq m\max_k a_k \dabs{\ind_{A_k} - \ind_{\bra{\bigcup_{j=1} ^{l_k} B_{j,k}}}}_p < \frac{\ve}{3}\quad \quad (\ddag)
\ee
Combining ($*$) and ($\dag$), and ($\ddag$) using Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure}), we have that
\[
 \dabs{f-g}_p \leq \dabs{f-f\ind_{[-N_1,N_1]}}_p + \dabs{f\ind_{[-N_1,N_1]} - f_{N_2}}_p + \dabs{f_{N_2} - g}_p < \ve.
\]

Finally for general $f \in \sL_p(\R,\sB(\R),\mu)$ and $\ve >0$, we set $f = f^+ - f^-$. From the above, we can find stepfunctions $g_1, g_2$ such that $\norm{f^+ - g_1}_p, \norm{f^- - g_2}_p < \frac{\ve}{2}$. But then by Minkowski's inequality again,
\be
\dabs{f-(g_1 - g_2)}_p \leq \dabs{f^+ - g_1}_p + \norm{f^- - g_2}_p < \epsilon,
\ee
and $g_1 - g_2$ is of course a stepfunction. 
\end{proof}



\subsection{Fourier transform}

\begin{definition}\label{def:fourier_transform_borel}
For a finite Borel measure $\mu$ on $\R^n$, we define the Fourier transform
\be
\wh{\mu}(u) = \int_{\R^n} e^{i\inner{u}{x}} \mu(dx),\quad u \in \R^n.
\ee
\end{definition}

\begin{remark}
Here, $\inner{\cdot}{\cdot}$ denotes the usual inner product on $\R^n$. Note that $\wh{\mu}$ is in general complex-valued, with $\ol{\wh{\mu}(u)} = \wh{\mu}(-u)$, and $\dabs{\wh{\mu}}_\infty = \wh{\mu}(0) = \mu(\R^n)$. 
\end{remark}


\begin{proposition}\label{pro:fourier_transform_continuity}
The Fourier transform of a finite Borel measure is a bounded continuous function.
\end{proposition}

\begin{proof}[\bf Proof]
First we have $\forall u \in \R^n$
\be
\abs{\wh{\mu}(u)} = \abs{\int_{\R^n} e^{i\inner{u}{x}} \mu(dx)} \leq \int_{\R^n} \abs{e^{i\inner{u}{x}}} \mu(dx) = \int_{\R^n} \mu(dx) = \mu(\R^n) < \infty.
\ee

Moreover, for any sequence $u_n \to u$ and $\forall x \in \R^n$, we have $e^{i\inner{u_n}{x}} \to e^{i\inner{u}{x}}$. Then
\be
\abs{\wh{\mu}(u_n) - \wh{\mu}(u)} = \abs{\int_{\R^n} \bb{e^{i\inner{u_n}{x}} - e^{i\inner{u}{x}}}\mu(dx)} \to 0
\ee
by bounded convergence theorem (Theorem \ref{thm:bounded_convergence_measure}, $\abs{e^{i\inner{u_n}{x}} - e^{i\inner{u}{x}}} < 2$). Thus, $\wh{\mu}$ is continuous on $\R^n$.
\end{proof}


\begin{proposition} 
For a finite Borel measure $\mu$ on $\R$ and $\int|x|^kd\mu(x)<\infty$, then the Fourier transform $\hat{\mu}$ of $\mu$ has a $k$th continuous derivative, which at 0 is given by 
\be
\hat{\mu}^{(k)}(0) = i^k\int x^k d\mu(x).
\ee
\end{proposition} 

\begin{proof}[\bf Proof] 
Note that if $\int \abs{x}^k \mu(dx) < \infty$ and $\mu$ finite, by H\"older's inequality (Theorem \ref{thm:holder_inequality_measure}), for all $n \leq k$,
\be
\int_\mathbb{R} \abs{x}^n \mu(dx) \leq \left(\int_\mathbb{R} \abs{x}^k \mu(dx) \right)^\frac{n}{k} \, \mu(\mathbb{R})^{1-\frac{n}{k}} < \infty
\ee

Thus we have
\ben
\item [(i)] $x \mapsto e^{iux}$ is integrable for all $u$.
\item [(ii)] $u \mapsto e^{iux}$ is infintely differentiable for all $x$.
\item [(iii)] $\abs{\frac{\partial^n}{\partial u^n} e^{iux}} \leq \abs{x}^n$, which is integrable for $n \leq k$.
\een

These properties allow for differention $k$ times under the integral (Theorem \ref{thm:differentiation_under_integral_sign}). Thus, by H\"older's inequality (Theorem \ref{thm:holder_inequality_measure})
\be
\abs{\wh{\mu}^{(k)}(u)} = \abs{\int_{\R} i^kx^ke^{iux} \mu(dx)} \leq \int_{\R} \abs{x^k e^{iux}} \mu(dx) = \int_{\R} \abs{x^k}\mu(dx) < \infty.
\ee

Thus, for any sequence $u_n \to u$ and $\forall x \in \R$, we have $x^ke^{iu_nx} \to x^k e^{iux}$. Then
\be
\abs{\wh{\mu}^{(k)}(u_n) - \wh{\mu}^{(k)}(u)} = \abs{\int_{\R^n} x^k \bb{e^{iu_n x} - e^{iux}}\mu(dx)} \to 0
\ee
by bounded convergence theorem (Theorem \ref{thm:bounded_convergence_measure}, $\abs{e^{i\inner{u_n}{x}} - e^{i\inner{u}{x}}} < 2$). Thus, $\wh{\mu}^{(k)}$ is continuous on $\R$. In particular, 
\be
\wh{\mu}^{(k)}(0) = \int_{\R} i^kx^ke^{i0x} \mu(dx) = i^k \int_{\R} x^k \mu(dx).
\ee

Simiarly, the conclusion holds for all $n\leq k$.%Bounded convergence shows that the $k^\mathrm{th}$ derivative is also continuous.
\end{proof}

\begin{lemma}[Riemann-Lebesgue lemma\index{Riemann-Lebesgue lemma}]\label{lem:rieman_lebesgue_fourier_transform}
Suppose that $\mu$ is a finite Borel measure on $\R$ which has a density $f$ with respect to Lebesgue measure. Show that its Fourier transform 
\be
\wh{\mu}(t) = \int^\infty_{-\infty} e^{itx} f(x)dx \to 0\ \text{ as }|t|\to \infty.
\ee
\end{lemma}

\begin{proof}[\bf Proof]
For any real numbers $a$, $b$ one has $\int^b_a e^{itx} dx \to 0$ as $|t|\to \infty$.
\be
\int^b_a e^{itx} dx = \int^b_a \cos tx dx + i \int^b_a \sin tx dx = \frac{\sin tb - \sin ta}t + i \frac{\cos ta - \cos tb}t \to 0
\ee
as $|t|\to \infty$. Thus, we can have that
\be
\wh{f}(t) \to 0\ \text{ as }\abs{t}\to \infty\quad \text{whenever $f$ is a stepfunction (see Definition \ref{def:stepfunction})} 
\ee

Now given any $f \in \sL^1(E,\sE,\leb)$, and $\ve > 0$, we can pick a stepfunction $g$ with $\dabs{f-g}_1 < \ve/2$. Then pick $T \in \R$ such that for all $t: \abs{t} \geq T$, $\wh{g}(t) < \ve/2$. Hence, 
\beast
\abs{\int_{-\infty} ^\infty e^{itx}f(x) dx} & \leq & \abs{\int_{-\infty} ^\infty e^{itx}(f(x)-g(x)+g(x)) dx} \leq \abs{\int_{-\infty} ^\infty e^{itx}(f(x)-g(x))dx} + \abs{\int_{-\infty} ^\infty e^{itx}g(x)dx}\\
& \leq & \int_{-\infty} ^\infty \abs{f(x)-g(x)}dx  + \abs{\int_{-\infty} ^\infty g(x)dx} = \dabs{f-g}_1  + \abs{\wh{g}(t)}  < \ve/2 + \ve/2 = \ve
\eeast
as required.
\end{proof}

\begin{proposition}
Suppose that $\mu$ is a finite Borel measure on $\R$ which has a density $f$ with respect to Lebesgue measure. Suppose $f$ has an integrable and continuous derivative $f'$. Show that 
\be
\hat{\mu}(t) = o(t^{-1}), \quad \text{i.e.},\quad t\hat{\mu}(t)\to 0 \text{ as }|t|\to\infty.
\ee%Extend to higher derivatives.
\end{proposition}

\begin{proof}[\bf Proof] 
By Proposition \ref{pro:integral_by_parts} (integration by parts, note the integrand is continuous). For any $N$, we have
\be
\left.e^{itx}f(x)\right|_{-N}^N  = it\, \int_{-N} ^N e^{itx} f(x) \, dx + \int_{-N} ^N e^{itx} f'(x) \, dx
\ee

We see that the LHS tends to 0 as $N \to \infty$\footnote{need details}. Now $\abs{e^{itx} f'(x) \ind_{[-N,N]}(x)} \leq f'(x)$, and $f'$ is integrable (given). Therefore, by dominated convergence theorem,
\beast
 \lim_{N \to \infty} \int_{-N} ^N e^{itx} f'(x) \, dx =  \lim_{N \to \infty} \int_{-\infty} ^\infty e^{itx} f'(x) \ind_{[-N,N]}(x) \, dx = \int_{-\infty} ^\infty \lim_{N \to \infty} e^{itx} f'(x) \ind_{[-N,N]}(x) \, dx = \int_{-\infty} ^\infty e^{itx} f'(x) \, dx
\eeast
Similarly,
\[
 it\lim_{N \to \infty} \int_{-N} ^N e^{itx} f(x) \, dx =it \int_{-\infty} ^\infty e^{itx} f(x) \, dx.
\]
Thus we have
\[
 \int_{-\infty} ^\infty e^{itx} f'(x) \, dx=-it \int_{-\infty} ^\infty e^{itx} f(x) \, dx
\]
Now $f' \in \sL^1(E,\sE,\leb)$, so by the result in Lemma \ref{lem:rieman_lebesgue_fourier_transform}, the LHS tends to 0 as $\abs{t} \to \infty$. Then of course, we have $t\hat{\mu}(t) \to 0$ as $\abs{t} \to \infty$. The extension to higher derivatives is similar.
\end{proof}


\section{Convergence of Measures}

\subsection{Weak convergence and vague convergence}

We have a variety of notions of convergence for measurable functions, including almost everywhere convergence, convergence in $\sL^p$, and convergence in measure. All these notions depend on the measurable function themselves. Weak convergence is a notion of convergence for measures.

If $(\mu_n, n \geq 0)$ is a sequence of measures on $(E,\sE)$, we could say that $\mu_n \to \mu$ if $\mu_n(A)\to \mu(A)$ for all $A \in \sE$, but this form of convergence (i.e. pointwise convergence) is very rigid. Instead we use the following definition.

\begin{definition}
Let $(E, d)$ be a metric space and endow it with its Borel $\sigma$-algebra $\sB(E)$. Let $\mu$ be a finite measure and $(\mu_n, n \geq 1)$ be a sequence of finite measures defined on $(E,\sE)$. We say that $(\mu_n)$ converges weakly\index{convergence!weakly!finite measure} to $\mu$ if for every continuous bounded function $f : E \to \R$, $\mu_n( f )\to \mu(f)$ as $n\to\infty$, denoted by $\mu_n \stackrel{w}{\to} \mu$, i.e.,
\be
\int fd\mu_n \to \int fd\mu \quad \text{as }n\to\infty,\quad \mu,\mu_n \in \sM_f(E),\quad \forall f\in C_b(E),
\ee
\end{definition}


\begin{example}
\ben
\item [(i)] $x_n \to x$ in $\R$ if and only if $\delta_{x_n} \stackrel{w}{\to} \delta_x$. Indeed, the latter is equivalent to requiring that $f (x_n)\to  f (x)$ for every continuous bounded function $f$.
\item [(ii)] Let $\mu_n = \frac 1n \sum^{n-1}_{k=0} \delta_{\frac kn}$ on $[0, 1]$. Then $\mu_n \stackrel{w}{\to} d x$, Lebesgue measure on $[0, 1]$. Indeed, $\mu_n(f)$ is a Riemann sum of $f$.
\een
\end{example}

Also, we give vague convergence. Recall the definition of compact support (Definition \ref{def:compact_support}), 

\begin{definition}
Let $(E, d)$ be a metric space and endow it with its $\sigma$-algebra $\sB(E)$. Let $\mu$ be a Radon measure and $(\mu_n, n \geq 1)$ be a sequence of Radon measures defined on $(E,\sE)$. We say that $(\mu_n)$ converges vaguely\index{convergence!vaguely} to $\mu$ if for every continuous function with compact support, $f : E \to \R$, $\mu_n( f )\to \mu(f)$ as $n\to\infty$, denoted by $\mu_n \stackrel{v}{\to} \mu$, i.e.,
\be
\int fd\mu_n \to \int fd\mu \quad \text{as }n\to\infty,\quad \mu,\mu_n \in \sM_R(E), \quad \forall f\in C_c(E),
\ee
\end{definition}

\begin{theorem}[Portemanteau Theorem\index{Portemanteau Theorem}]\label{thm:portemanteau}
Let Let $(\mu_n, n \geq 1)$ and $\mu$ be finite Borel measures on $E$, i.e., $\mu,\mu_n\in \sM_f(E)$. Let $U_f$ be the set of points of discontinuity of $f$. The following are equivalent:
\ben
\item [(i)] $\mu_n \stackrel{w}{\to} \mu$.
\item [(ii)] For every $G \subseteq E$ open, $\liminf\limits_n \mu_n(G) \geq \mu(G)$.
\item [(iii)] For every $F \subseteq E$ closed, $\limsup\limits_n \mu_n(F) \leq \mu(F)$.
\item [(iv)] For every $A\subseteq E$ Borel such that $\mu(\partial A) = 0$, $\lim\limits_n \mu_n(A) = \mu(A)$.
\item [(v)] $\int fd\mu_n \to \int fd\mu$ as $n\to \infty$ for all bounded Lipschitz continuous $f$.
\item [(vi)] $\int fd\mu_n \to \int fd\mu$ as $n\to \infty$ for all bounded measurable $f$ with $\mu(U_f) = 0$.
\een
The idea is the mass can be 'won or lost' only through the boundary.\footnote{for vague convergence part check Klenke\cite{Klenke_2008}.$P_{253}$}
\end{theorem}
\begin{proof}[\bf Proof]
(i) $\ra$ (ii): Let $G$ be an open set and introduce the sequence of functions $f_k(x) := 1 \land kd(x,G^c)$ (for $x \in E$). For each $k \geq 1$, $f_k$ is continuous and bounded (in fact, uniformly continuous), so $\mu_n(f_k) \to  \mu(f_k)$. 

As $G$ is open, $x \in G$ if and only if $d(x,G^c) > 0$. Thus $f_k \ua \ind_G$ pointwise as $k \to \infty$. For every $n$, $\mu_n(G) = \mu_n(\ind_G) \geq \mu_n(f_k)$ by fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}), so $\liminf_n \mu_n(G) \geq \mu( f_k)$ for all $k$. By the monotone convergence theorem (Theorem \ref{thm:monotone_convergence_pointwise}), taking $k \to \infty$ we have $\liminf_n \mu_n(G) \geq \mu(G)$.

(ii) $\ra$ (iii): Let $F$ be a closed set and thus $F^c$ is open. Then by (ii)
\be
\mu(F) = 1-\mu(F^c) \geq 1-\liminf_n \mu_n(F^c) = \limsup_n (1-\mu_n(F^c)) = \limsup_n\mu_n(F).
\ee

(ii) + (iii) $\ra$ (iv): Let $A$ be a Borel set such that $\mu(\partial A) = 0$. Then $\ol{A}$ is closed and $\mathring{A}$ is open
\beast
\limsup_n \mu_n(A) & \leq & \limsup_n \mu_n(\bar{A}) \leq \mu(\bar{A}) = \mu(\mathring{A} \cup \partial A) = \mu(\mathring{A}) \leq \liminf_n \mu_n(\mathring{A}) \leq \liminf_n \mu_n(A).
\eeast

It follows that the limit exists and equals to $\mu(A)$.

(iv) $\ra$ (i): Let $f \in C^+_b (E)$. We must show that $\mu_n( f )\to \mu( f)$ as $n\to \infty$. Write $f \leq K$, so by Proposition \ref{pro:measure_change_integral}
\be
\mu( f ) = \int^\infty_0 \mu( f \geq t)d t = \int^K_0 \mu( f \geq t)d t,\quad\quad \mu_n( f )=  \int^\infty_0 \mu_n( f \geq t)d t = \int^K_0 \mu_n( f \geq t)d t.\quad\quad(*)
\ee

Note that the set $A:= \{f \geq t\} = f^{-1}([t,\infty))$ is closed, while the set $\{f > t\}$ is open, so $\partial A = \partial\{f \geq t\} \subseteq \{f = t\}$. The set $B := \{t | \mu(\bra{f = t}) > 0\}$ is countable since it is equal to $\bigcup_{n\geq1}\{t | \mu(\bra{f = t}) \geq n^{-1}\mu(E)\}$, and each set in the union is finite since $\mu$ is a finite measure (for fixed $n$, the number of $t$ such that $\mu(f=t) \geq n^{-1}\mu(E)$ is smaller than $n$). Therefore $\mu(B)=0$, since the whole set is uncountable. Then $\mu(A)\leq \mu(B) = 0$, so by given condition (iv), $\mu_n (A) \to \mu(A)$ as $n\to \infty$. Thus,
\be
\mu_n( f ) \underbrace{= \int^K_0 \mu_n( f \geq t)d t }_{\text{by }(*)}\underbrace{\to  \int^K_0 \mu( f \geq t)d t}_{\text{dominated convergence theorem (Theorem \ref{thm:dominated_convergence_measure})}} \underbrace{= \mu( f )}_{\text{by }(*)}
\ee

Then check the definition of weak convergence, decompose elements of $C_b(E)$ into positive and negative parts.

(vi) $\ra$ (i) $\ra$ (v): It is trivial since all the bounded continuous function satisfies (vi) and all bounded Lipschitz continuous satisfies (i) by Definition \ref{def:lipschitz_continuous}.

(v) $\ra$ (iii): For closed set $F$ and any $\ve>0$, we can construct a Lipschitz continuous function $\rho_{F,\ve}$ as in Lemma \ref{lem:zero_one_lipschitz}. Thus, use the same argument in Fatou's lemma (Lemma \ref{lem:fatou_function}), for $k\geq n$ and non-negative function $g$, we have
\be
\inf_{m\geq n} g_m \leq g_k \quad \ra\quad \mu\bb{\inf_{m\geq n} g_m} \leq \mu\bb{g_k }\quad \ra \quad \mu\bb{\inf_{m\geq n} g_m} \leq \inf_{k\geq n} \mu\bb{g_k }.\quad \quad (\dag)
\ee

We know that $\ind_F \leq \rho_{F,\ve}$, so $\ind_F \leq \lim\limits_{\ve\da 0}\rho_{F,\ve} = \inf\limits_{\ve>0}\rho_{F,\ve}$, which gives $\mu_n(F) \leq \mu_n\bb{ \inf\limits_{\ve>0}\rho_{F,\ve}} \leq \inf\limits_{\ve>0}\mu_n\bb{\rho_{F,\ve}}$ by $(\dag)$, then for fixed $n$, we have
\be
\sup_{m\geq n} \bb{\inf\limits_{\ve>0}\mu_m\bb{\rho_{F,\ve}}} \leq \sup_{m\geq n} \bb{\mu_m\bb{\rho_{F,\ve}}}  \quad\ra\quad \sup_{m\geq n} \bb{\inf\limits_{\ve>0}\mu_m\bb{\rho_{F,\ve}}} \leq \inf\limits_{\ve>0}\sup_{m\geq n} \bb{\mu_m\bb{\rho_{F,\ve}}} 
\ee
\be
\limsup_n \mu_n (F) = \inf_{n}\sup_{m\geq n}\mu_m (F) \leq \inf_{n}\sup_{m\geq n}\bb{\inf\limits_{\ve>0}\mu_m\bb{\rho_{F,\ve}}} \leq \inf_{n}\inf\limits_{\ve>0}\sup_{m\geq n}\mu_m\bb{\rho_{F,\ve}} \leq \inf\limits_{\ve>0}\inf_{n}\sup_{m\geq n}\mu_m\bb{\rho_{F,\ve}}.
\ee

But we know that (v) $\lim_{n\to \infty} \mu_n(f) = \mu(f)$ for all bounded Lipschitz continuous functions $f$, i.e., the limit of $\mu_n(f)$ exists, and $\lim_{n\to \infty}\mu_n(f) = \limsup_n \mu_n(f) = \inf_n\sup_{m\geq n}\mu_m(f)$. Then with condition (v), we have
\be
\limsup_n \mu_n (F) \leq \inf\limits_{\ve>0}\lim_{n\to \infty}\mu_n(\rho_{F,\ve}) = \inf\limits_{\ve>0}\mu(\rho_{F,\ve}) = \lim_{\ve\da 0} \mu(\rho_{F,\ve}) = \mu(F),
\ee
by dominited convergence theorem (Theorem \ref{thm:dominated_convergence_measure}) as $\rho_{F,\ve}$ is bounded.
\end{proof}

\subsection{Tightness}

\begin{definition}\label{def:tight_measure}
Let $(\mu_i)_{i\in I}$ be a family of finite measures on $(E, d)$. We say that $(\mu_i)_{i\in I}$ is tight\index{tight!measure family} if for all $\ve > 0$ there is $K \subseteq E$ compact such that $\sup\limits_{i\in I} \mu_i(E \bs K) < \ve$.
\end{definition}

\begin{remark}
The intuitive idea is that a given collection of measures does not "escape to infinity".
\end{remark}

\begin{proposition}
If $E$ is a compact space, then every collection of (possibly complex) measures on $E$ is tight.
\end{proposition}

\begin{proof}[\bf Proof]
\footnote{need proof}
\end{proof}


\section{Ergodic theory}

\subsection{Measure-preserving transformations}

\begin{definition}\label{def:measure_preserving_transformation}
Let $(E, \sE, \mu)$ be a measure space. A measurable function $\theta : E \to E$ is called a measure-preserving transformation\index{measure-preserving transformation} if 
\be
\mu(\theta^{-1}(A)) = \mu(A),\quad \text{for all }A \in \sE.
\ee

A set $A \in \sE$ is invariant\index{invariant!set} if $\theta^{-1}(A) = A$. A measurable function $f:E\to \R$ is invariant\index{invariant!measurable function} if $f = f \circ \theta$. 
\end{definition}

\begin{proposition}\label{pro:invariant_measure_preserving}
Let $(E, \sE, \mu)$ be a measure space and $\theta : E \to E$ a measure-preserving transformation. Then the class of all invariant sets forms a $\sigma$-algebra, which we denote by 
\be
\sE_\theta := \{A \in \sE : \theta^{-1}(A) = A\}
\ee

Then $f$ is invariant if and only if $f$ is $\sE_\theta$-measurable. 
\end{proposition}

\begin{proof}[\bf Proof]
Checking that $\sE_\theta$ is a $\sigma$-algebra by Definition \ref{def:sigma_algebra},
\ben
\item [(i)] $\emptyset \in \sE_\theta$ since $\theta^{-1}(\emptyset) = \emptyset$.
\item [(ii)] If $A\in \sE_\theta$, by Proposition \ref{pro:inverse_image_preserves_set_operation}, $\theta^{-1}(A^c) = \theta^{-1}(E\bs A) = E\bs\theta^{-1}(A) = E\bs A = A^c$. Thus, $A^c \in \sE_\theta$.
\item [(iii)] If $A_n \in \sE_\theta$, by Proposition \ref{pro:inverse_image_preserves_set_operation}, $\theta^{-1}\bb{\bigcup_n A_n} = \bigcup_n \theta^{-1}(A_n) = \bigcup_n A_n$. Thus, $\bigcup_n A_n \in \sE_\theta$.
\een

Thus, $\sE_\theta$ is a $\sigma$-algebra. 

Now suppose that $f$ is invariant ($f = f\circ \theta$). Then, for all $B \in \sB(\R)$, we have
\be
f^{-1}(B) = (f \circ \theta)^{-1}(B) = \theta^{-1}\bb{f^{-1}(B)} \ \ra \ f^{-1}(B) \in \sE_\theta.
\ee

Conversely, suppose $f$ is $\sE_\theta$-measurable. Then, for all $x \in \R$ ($\bra{x}\in \sB(\R)$), we have $f^{-1}(\bra{x}) \in \sE_\theta$ (by Definition \ref{def:measurable_function}), i.e.,
\be
f^{-1}(\{x\}) = \theta^{-1}\bb{f^{-1}(\bra{x})} = \bb{f\circ \theta}^{-1}(\bra{x})
\ee

Thus, $\forall y \in E$, $\exists x\in \R$ such that $f(y) = x$. Then $f^{-1}(\bra{x}) \neq \emptyset$, thus we have $y\in f^{-1}(\bra{x}) = \bb{f\circ \theta}^{-1}(\bra{x})$. So
\be
f(y) = x = f\circ \theta (y) \ \ra \ f \text{ is invariant.}
\ee %Check that this implies $f(y)=f\circ \theta(y)$ %Check that this implies $f(y)=f\circ \theta(y)$ for all $y \in E$\footnote{need to check}.
\end{proof}

Here are two simple examples of measure preserving transformations:

\begin{example}
\ben
\item [(i)] Translation map on the torus. Take $E = [0, 1)^n$ with Lebesgue measure on its Borel $\sigma$-algebra, and consider addition modulo 1 in each coordinate. For $a \in E$ set
\be
\theta_a(x_1, \dots, x_n) = (x_1 + a_1, \dots, x_n + a_n).
\ee

\item [(ii)] Bakers' map. Take $E = [0, 1)$ with Lebesgue measure. Set
\be
\theta(x) = 2x - \floor{2x}.
\ee
\een
\end{example}

\begin{proposition}\label{pro:integrable_measure_preserving}
Let $(E, \sE, \mu)$ be a measure space. If $f$ is integrable and $\theta$ is measure-preserving, then $f \circ \theta$ is integrable and 
\be
\int_E fd\mu = \int_E f \circ \theta d\mu.
\ee
\end{proposition}

\begin{proof}[\bf Proof]
First assume $f = \ind_A$ where $A\in \sE$. We have that
\be
\mu(f\circ \theta) = \mu \bb{\ind_A \circ \theta} = \mu \bb{\ind_{\theta^{-1}(A)}} = \mu \bb{\theta^{-1}(A)}.
\ee

Then by Definition \ref{def:measure_preserving_transformation},
\be
\mu \bb{\theta^{-1}(A)} = \mu (A) = \mu \bb{\ind_A} = \mu (f) < \infty
\ee
since $f$ is integrable. By lineality, we have $f\circ \theta$ is integrable and $\mu(f) = \mu(f\circ \theta)$ for simple $f$ of the form
\be
f = \sum^m_{k =1} a_k \ind_{A_k}, \quad m\in \N,\ a_k \geq 0.
\ee

For non-negative measurable function $f$, let $f_n = 2^{-n}\floor{2^n f}$, $g_n = 2^{-n}\floor{2^n f\circ \theta }$. Thus $f_n$ and $g_n$ are simple and 
\be
f_n \ua f,\quad g_n \ua f\circ \theta.
\ee

Thus by monotone converge theorem (Theorem \ref{thm:monotone_convergence_pointwise}), we have 
\be
\mu(f_n) \ua \mu(f),\quad \mu(g_n) \ua \mu (f\circ \theta).
\ee

But by the previous results for simpe $f$, $\mu(f_n) = \mu(g_n)$ since they are simple. Thus, $\mu(f\circ \theta) = \mu(f) < \infty$ and $f\circ \theta$ is integrable.

For integrable $f$, we know that $f = f^+ - f^-$ where $f^+$ and $f^-$ are non-negative measurable and integrable. Thus,
\be
\mu \bb{\abs{f\circ \theta}} = \mu \bb{\bb{f^+ + f^-}\circ \theta} = \mu \bb{f^+ \circ \theta} + \mu \bb{f^- \circ \theta} = \mu \bb{f^+} + \mu \bb{f^-} = \mu\bb{\abs{f}} < \infty
\ee
by Theorem \ref{thm:non_negative_measurable_property} and previous results for non-negative measurable $f$.
\end{proof}

\subsection{Ergodic measure-preserving transformation}

\begin{definition}\label{def:ergodic_measure_preserving_transformation}
Let $(E, \sE, \mu)$ be a measure space and $\theta : E \to E$ a measure-preserving transformation. We say that $\theta$ is ergodic\index{ergodic!measure preserving transformation} if $\sE_\theta$ contains only sets of measure zero and their complements.
\end{definition}

\begin{proposition}\label{pro:ergodic_invariant_constant}
$(E, \sE, \mu)$ is a measure space. If $\theta$ is ergodic and $f$ is invariant, then $f = c$ a.e., for some constant $c$.
\end{proposition}

\begin{proof}[\bf Proof]
$f$ is $\sE_\theta$-measurable since $f$ is invariant (by Proposition \ref{pro:invariant_measure_preserving}). Let
\be
c = \sup \{ a: \mu(f<a)=0\} = \sup \bra{a:\mu(f\geq a) \neq 0}\quad \quad (*)
\ee
but we must check that the set over which we are taking the supremum on $\mathbb{R}$ or $\emptyset$ does not pose any problems.

First suppose $\bra{ a: \mu(f<a)=0}=\mathbb{R}$. Then by Proposition \ref{pro:measure_property}.(ii),
\be
 \mu(E) = \mu \left( \bigcup_{n \in \mathbb{N}} \{f<n\} \right) \leq \sum_{n \in \N} \mu(f < n) = 0
\ee

So, trivially, we have that for any $c$, $\mu(f \neq c) \leq \mu(E) = 0$.

Now assume $\{ a: \mu(f<a)=0\}=\emptyset$. This means that $\mu(f<a) > 0$ for all $a$. Since $f$ is $\sE_\theta$ measurable, and $\sE_\theta$ contains only null sets and their complements, we must have that $\mu( f \geq a) =0$ for all $a$. Then by Proposition \ref{pro:measure_property}.(ii),
\[
 \mu(E) = \mu \left( \bigcup_{n \in \mathbb{N}} \{f \geq -n\} \right) \leq \sum_{n \in \mathbb{N}} \mu(f \geq -n) = 0
\]
which contradicts $\mu(f > a) > 0$.

Thus we can follow through with our initial idea and define $s$ as in ($*$). Since $\sE_\theta$ is ergodic, $\forall n \in \mathbb{N}$ we have that 
\be
\mu\bb{\bra{f\leq c + \frac 1n}} \neq 0 \ \ra \ \mu\bb{\bra{f> c+\frac 1n}} =0.
\ee
by definition of $c$. Also, there exists arbitary small $\ve \leq \frac 1n$,
\be
\mu \bb{f\geq c- \frac 1n} \geq \mu \bb{f\geq c - \ve} \neq 0 \ \ra \ \mu\bb{f<c-\frac 1n}=0
\ee

Then
\be
\mu\bb{\bra{f \neq c}} = \mu \bb{ \bigcup_{n \in \mathbb{N}} \bra{f< c - \tfrac{1}{n}} \cup \bra{f > c + \tfrac{1}{n}} } \leq \sum_{n \in \mathbb{N}} \bb{\mu\bb{\bra{f< c - \tfrac{1}{n}}} + \mu\bb{\bra{f> c + \tfrac{1}{n}}}}=0
\ee
by Proposition \ref{pro:measure_property}.(i),(ii).
\end{proof}



\subsection{Birkhoff's and von Neumann's ergodic theorems}

Throughout this section, $(E, \sE, \mu)$ will denote a measure space, on which is given a measure-preserving transformation $\theta$. Given an measurable function $f$, set $S_0 = 0$ and define, for $n \geq 1$,
\be
S_n = S_n(f) = f + f \circ \theta + \dots + f \circ \theta^{n-1}.
\ee

\begin{lemma}[maximal ergodic lemma\index{maximal ergodic lemma}]\label{lem:maximal_ergodic}
Let $\theta : E \to E$ be a measure-preserving transformation (Note that $\theta$ does not need to be ergodic). Let $f$ be an integrable function on $E$. Set $S^* = \sup_{n\geq 0} S_n(f)$. Then 
\be
\int_{\{S^*>0\}} fd\mu \geq 0.
\ee
\end{lemma}
\begin{proof}[\bf Proof]
Set $S^*_n = \max_{0\leq m \leq n}S_m$ and $A_n = \{S^*_n > 0\}$. Note that $S^*_n \geq 0$. Then, for $m = 1, \dots, n$,
\be
S_m = f + S_{m-1} \circ \theta \leq f + S^*_n \circ \theta.
\ee

On $A_n$, we have $S^*_n = \max_{1\leq m\leq n} S_m$, so 
\be
S^*_n \leq f + S^*_n \circ \theta.
\ee

On $A^c_n$, we have
\be
S^*_n = 0 \leq S^*_n \circ \theta.
\ee

So, integrating and adding (by Theorem \ref{thm:non_negative_measurable_property} since both sides are non-negative), we obtain 
\be
\int_E S^*_n d\mu \leq \int_{A_n} fd\mu + \int_E S^*_n \circ\theta d\mu.
\ee

But $S^*_n$ is integrable (since $S_m,\ m=1,\dots n$ are integrable by Proposition \ref{pro:integrable_measure_preserving}), so 
\be
\int_E S^*_n\circ \theta d\mu = \int_E S^*_n d\mu < \infty \quad\ra\quad \int_{A_n} f d\mu \geq 0.
\ee

As $n \to \infty$, $A_n \ua \{S^* > 0\}$ so, by dominated convergence, with dominating function $|f|$,
\be
\int_{\{S^*>0\}} fd\mu = \lim_{n\to\infty} \int_{A_n} fd\mu \geq 0.
\ee
\end{proof}

\begin{theorem}[Birkhoff's almost everywhere ergodic theorem\index{Birkhoff's almost everywhere ergodic theorem}]\label{thm:birkhoff_ergodic}
Assume that $(E, \sE, \mu)$ is $\sigma$-finite and that $f$ is an integrable function on $E$. Let $\theta : E \to E$ be a measure-preserving transformation (Note that $\theta$ does not need to be ergodic). Then there exists an invariant function $\ol{f}$, with $\mu(|\ol{f}|) \leq \mu(|f|)$, such that $S_n(f)/n \to \ol{f}$ a.e. as $n \to \infty$.
\end{theorem}



\begin{proof}[\bf Proof]
We know that
\be
S_n \circ \theta = S_{n+1} - f  \ \ra \ \frac {S_n}n \circ \theta = \frac{S_{n+1}}{n+1}\frac{n+1}{n} - \frac fn.
\ee

Taking $\liminf$ on both sides, we have
\be
\bb{\liminf_n \frac{S_n}n}\circ \theta = \liminf_n \frac{S_{n+1}}{n+1} \frac {n+1}{n} - 0 = \liminf_n \frac{S_n}n.
\ee

Thus, the functions $\liminf_n(S_n/n)$ is invariant. Similarly, $\limsup_n(S_n/n)$ is also invariant. 

Therefore, for $a < b$, so is the following set
\be
D = D(a, b) = (a,b),\quad\quad \liminf_n (S_n/n) < a < b < \limsup_n (S_n/n).
\ee

We shall show that $\mu(D) = 0$. 

First, $f$ is integrable on $E$, thus $f$ is integrable on $D$ since $\mu(\abs{f}\ind_D) \leq \mu (\abs{f}) < \infty$.

Thus, we make the following argument on $D$. Note that either $b > 0$ or $a < 0$. We can interchange the two cases by replacing $f$ by $-f$. Let us assume then that $b > 0$.

Let $B \in \sE$ with $\mu(B) < \infty$, then $g = f - b\ind_B$ is integrable (since $\ind_B$ is integrable) and, for each $x \in D$, for some $n$,
\be
S_n(g)(x) = S_n(f- b\ind_B)(x) = S_n(f)(x) - b S(\ind_B)(x) \geq S_n(f)(x) - nb.
\ee

Hence $S^*(g) \geq \limsup_n S_n(f) - nb > 0$ everywhere in $D$ and, by the maximal ergodic lemma (Lemma \ref{lem:maximal_ergodic}),
\be
0 \leq \int_D (f - b\ind_B)d\mu = \int_D fd\mu - b\mu(B).
\ee

Since $\mu$ is $\sigma$-finite (see Definition \ref{def:sigma_finite_measure}), there is a sequence of sets $B_n \in \sE$, with $\mu(B_n) < \infty$ for all $n$ and $B_n \ua D$. Hence, by fundamental property of measure (Lemma \ref{lem:measure_increasing_sequence}),
\be
b\mu(D) = \lim_{n\to\infty} b\mu(B_n) \leq \int_D fd\mu < \infty
\ee
since $f$ is integrable on $D$. In particular, we see that $\mu(D) < \infty$. 

Similarly, $h = a\ind_B - f$ is also integrable for each $x \in D$, for some $n$. Let $B=D$, then
\be
S_n(h)(x) = S_n(a\ind_B - f)(x) = a n\ind_D - S_n(f)(x) = an - S_n(f)(x).
\ee

Hence $S^*(h) \geq an - \liminf_n S_n(f) > 0$ everywhere in $D$, and by the maximal ergodic lemma (Lemma \ref{lem:maximal_ergodic}),
\be
\int_D(a - f)d\mu \geq 0 \ \ra \ a\mu(D) \geq \int_D fd\mu \quad\ra\quad b\mu(D) \leq \int_D fd\mu \leq a\mu(D).
\ee
by Theorem \ref{thm:lebesgue_integrable_function_property}.(i). Since $a < b$ and the integral is finite, this forces $\mu(D) = 0$. Set 
\be
\Delta = \left\{\liminf_n (S_n/n) < \limsup_n (S_n/n)\right\}
\ee
then $\Delta$ is invariant (by Proposition \ref{pro:indicator_measurable} since $\liminf_n (S_n/n)$ and $\limsup_n (S_n/n)$ are invariant ($\sE_\theta$-measurable)). Also, 
\be
\Delta = \bigcup_{a,b\in\Q,a<b} D(a, b),
\ee
so by Proposition \ref{pro:measure_property}.(ii),
\be
\mu(\Delta) = \mu \bb{\bigcup_{a,b\in\Q,a<b} D(a, b)} \leq \sum_{a,b\in\Q,a<b} \mu(D(a,b)) = 0.
\ee

On the complement of $\Delta$, $S_n/n$ converges in $[-\infty,\infty]$, so we can define an invariant function $\ol{f}$ by
\be
\ol{f} = \left\{\ba{ll}
\lim_n(S_n/n) \quad\quad & \text{on } \Delta^c,\\
0 & \text{on }\Delta.
\ea\right.\qquad \text{ i.e. } \ol{f} = \lim_n (S_n/n) \ind_{\Delta^c}
\ee

Finally, $\mu(|f \circ \theta^n|) = \mu(|f|)$ by Proposition \ref{pro:integrable_measure_preserving} since $f$ is integrable on $E$, so 
\be
\mu(|S_n|) \leq \mu(\abs{f}) + \mu (\abs{f\circ \theta}) + \dots + \mu(\abs{f\circ \theta^{n-1}}) = n\mu(|f|)
\ee
for all $n$. Since $\ol{f} = \lim \lim_n(S_n/n)$ on $\Delta^c$, we have $\abs{\ol{f}} = \lim \lim_n\abs{S_n/n}$ on $\Delta^c$. Hence, by Fatou's lemma (Lemma \ref{lem:fatou_function}),
\be
\mu(|\ol{f}|) = \mu \bb{\lim_n \abs{S_n/n}} = \mu\bb{\liminf\limits_n |S_n/n|} \leq \liminf\limits_n \mu(|S_n/n|) \leq \mu(|f|).
\ee
\end{proof}



\begin{example} 
For $E = [0, 1)$, $a \in E$ and $\mu(dx) = dx$, define
\be
\theta (x) = x + a \lmod{1}.
\ee

It is measure-preserving and $\theta$ is not guaranteed to be ergodic for all $a\in [0,1)$. %Determine for which values of a the transformation $\tau$ is ergodic. 
%Let $f$ be an integrable function on $[0,1)$. Determine for each value of a the limit 
%\be
%\bar{f} = \lim_{n\to\infty} \frac 1n (f + f \circ \tau + \dots + f \circ \tau^{n-1}).
%\ee
%\end{problem} 


First we have 

\centertexdraw{
    \drawdim in

    \arrowheadtype t:F \arrowheadsize l:0.08 w:0.04
    
    \linewd 0.01 \setgray 0
    
    \move (-0.2 0) \avec(1.8 0)
    \move (0 -0.2) \avec(0 1.8)
   
    \move (0 1) \lvec(0.5 1.5) 
    \move (0.5 0) \lvec(1.5 1) 
%    \lvec(0.25 0) \lvec(0 0) \lvec(0 0.25) \lvec(1.25 1.5) 
%    \lfill f:0.8

    \htext (-0.1 1){$a$}
%    \htext (-0.1 0.6){$a$}


    \htext (-0.1 1.5){1}
    \htext (1.5 -0.15){1}
    \htext (-0.1 -0.15){0}

%    \htext (1.6 0.5){$\frac a2$}
%    \htext (0.5 1.6){$\frac b2$}

%    \move (1.55 0.55) \avec(0.8 0.55)
%    \move (0.75 1.55) \avec(0.75 1)

    \lpatt(0.05 0.05)

    \move (0 1.5) \lvec(1.5 1.5) \lvec(1.5 0)

    \move (0 1) \lvec(1.5 1) 
%   \move (0 0.5) \lvec(1.5 0.9)  

    \move (0.5 1.5) \lvec(0.5 0) 
%    \move (0.45 0.9) \lvec(0.45 0)  

%    \move (1.05 0.6) \lvec(1.05 0) 
%    \move (1.2 0.9) \lvec(1.2 0)  

%    \htext (0.4 -0.2){$\frac a2$}
    \htext (0.4 -0.2){$1-a$}

%    \htext (0.9 -0.2){$\frac {a+1}2$}
%    \htext (1.15 -0.2){$\frac {b+1}2$}

    \htext (-3 0.5){$\theta(x) = \left\{\ba{ll} x+a & x\in [0,1-a)\\ x+a-1 \quad\quad & x \in [1-a,1) \ea\right.$}
   
}

Thus, $\forall b<c\in [0,1)$ and $A = (b,c)$, then $\mu\bb{\theta^{-1}(A)} = \mu\bb{(b,c)}$. So $\mu\circ \theta^{-1} = \mu$ on intervals of the form $(b,c)$, which form a $\pi$-system generating $\sB([0,1))$. Then by uniqueness of extension theorem (Theorem \ref{thm:uniqueness_of_extension_measure}, $\mu(E) = 1 <\infty$ since $\mu$ is Lebesgue measure and $E = [0,1)$), $\mu \circ \theta^{-1} = \mu$ on $\sB([0,1))$. Thus, $\theta$ is measure-preserving.

%Again, show that $\tau$ is measure preserving by checking the property for intervals (or any $\pi$-system which generates $\mathcal{B}([0,1))$.

First we show that $\theta$ is not ergodic when $a$ is rational. Indeed, suppose $a=p/q$, with $p,q \in \N$ and $p,q$ coprime. Then set
\be
A:= \bigcup_{k=0}^{q-1} \left[\frac kq, \frac kq + \frac 1{2q}\right) = \left[0, \frac{1}{2q} \right) \cup \left[ \frac{2}{2q}, \frac{3}{2q} \right) \cup \cdots \cup \left[ \frac{2q-2}{2q}, \frac{2q-1}{2q} \right)
\ee
It is easy to see that $\mu(A)=\frac{1}{2}$, but $A$ is invariant. So $\theta$ is not ergodic. Also, as $\theta^q$ is the identity ($\theta^q (x) = x + p \lmod{1} = x$), we have
\beast
\frac{S_n(f)}{n} & = & \frac{1}{n}(f+ f \circ \theta + \cdots  + f \circ \theta^{n-1}) \\
& = & \frac{\floor{\frac{n}{q}}}{n} (f+ f \circ \theta + \cdots + f \circ \theta^{q-1}) + \frac{1}{n}(f + f \circ \theta + \cdots + f \circ \theta^{n - q\floor{\frac{n}{q}}-1})
\eeast
so by Birkhoff's theorem (Theorem \ref{thm:birkhoff_ergodic}), 
\be
\ol{f} \stackrel{\text{a.e.}}{=} \lim_{n\to \infty} \frac{S_n(f)}{n} \stackrel{\text{a.e.}}{=} \frac{1}{q}(f+ f \circ \theta + \cdots + f \circ \theta^{q-1}).
\ee
since $f+ f \circ \theta + \cdots + f \circ \theta^{q-1}$ is finite a.e.. Equivalently,
\be
\ol{f} = \frac{1}{q} \sum^{q-1}_{k=0} f\bb{\bb{x+k\frac pq}\lmod{1}} \ \text{ a.e.}.
\ee

%alternative proof 

%The case where $a$ is irrational is more difficult. We claim that in this case, $\theta$ is ergodic. Suppose $B$ is an invariant set. First note that we may assume there exists an interval $L$ of the form $L=\left[\frac{i-1}{2^n},\frac{i}{2^n}\right)$, with $\mu(B \cap L) < \mu(B)\mu(L)$. Indeed, if not, it is easy to see that we must have $\mu(B \cap A) = \mu(B)\mu(A)$ for all $A \in \mathcal{A}$ (with $\mathcal{A}$ defined as in 9.4). We can then proceed using the same argument as in 9.4.

%There must also exist $U:=\left[\frac{j-1}{2^n},\frac{i}{2^n}\right)$ with $\mu(B \cap U) > \mu(B)\mu(U)>\mu(B \cap L)$, for otherwise we would have
%\[
%\mu(B)=\sum_{k=1} ^{2^n} \mu \left( B \cap \left[\frac{k-1}{2^n},\frac{k}{2^n}\right) \right) < \sum_{k=1} ^{2^n} \frac{1}{2^n} \mu(B) = \mu(B)
%\]
%which is a contradiction. Think of $L$ as a lower than average density interval, and $U$ as a higher than average density interval.

%Now, if we can find a sequence $n_1,n_2, \ldots$ with $\liminf_k \tau^{-n_k}(B \cap L) = B \cap U$, we are done. To see this, note that then
%\[
%\mu(B \cap U) = \mu(\liminf_k \theta^{-n_k}(B \cap L)) \leq \liminf_k \mu(\theta^{-n_k}(B \cap L)) =\mu(B \cap L)
%\]
%since $\tau$ is measure-preserving, and this is a contradiction. Luckily, we can ideed find such a sequence. First note that $\liminf_k \theta^{-n_k}(B \cap L) = B \cap \liminf_k \theta^{-n_k}(L)$, as $B$ is invariant. Let us assume $j>0$. The case when $j=0$ is not much more difficult (and in a sense can be excluded by the rotational symmetry of the problem). Now as the orbit $\{i, \theta^{-1}(i), \ldots \}$ is dense in $[0,1)$ (check this using the pigeon-hole principle), we can find a sequence $n_k$ such that $\theta^{-n_k}(i) \to j$ from below. Then $\liminf_k \theta^{-n_k}(L) = U$, and we are done. As in 9.3, we get that $\frac{1}{n}(f + f \circ\theta + \cdots + f \circ\theta^{n-1}) \to \int f$ a.e.

Now suppose $a \in [0,1)\bs \Q$ and $f$ is invariant. Then the Fourier coefficients of $f$ will be 
\beast
a_n & = & \int^1_0 f(x) e^{-i2\pi nx}dx = \int^1_0 f\bb{(x+a)\lmod{1}}e^{-i2\pi n \bb{(x+a)\lmod{1}}} dx \\
& = & \int^1_0 f(x) e^{-i2\pi n \bb{(x+a)\lmod{1}}} dx = \int^1_0 f(x)e^{-i2\pi n x} e^{-i2\pi na} = a_n e^{-i2\pi na}.
\eeast

Thus, $a_n = 0$, $\forall n \neq 0$ (since $a\notin \Q$). So $f$ is a constant. If there exists $A\in \sE_\theta$ such that $\mu(A) \in (0,1)$, then the function $\ind_A$ must be $\sE_\theta$-measurable (Proposition \ref{pro:indicator_measurable}) and thus invariant (Proposition \ref{pro:ergodic_invariant_constant}). However, $\ind_A$ is not constant. Contradiction. Thus, all the sets in $\sE_\theta$ are of measure 0 or 1. That is, $\theta$ is ergodic for irrational $a$.%Hence $f^{-1}([0,x)) \in \bra{\emptyset,E}$

Thus, for an integrable function $f$, by Birkhoff's almost everywhere ergodic theorem (Theorem \ref{thm:birkhoff_ergodic}), there exists an integrable, invariant function $\ol{f}$, such that, for some constant $c$ (since $\ol{f}$ is invariant),
\be
c = \ol{f} = \lim_{n \to \infty} \frac{S_n(f)}n = \frac{1}{n}(f + f \circ \theta + \cdots + f \circ \theta^{n-1}) \ \text{ a.e..}
\ee

Thus, since $f$ is integrable, by Proposition \ref{pro:integrable_measure_preserving}, $f\circ \theta^{n}$ is integrable for all $n$,
\be
\int_E f\circ \theta^n(x) dx = \int_E f(x) dx \ \ra \ \int \frac{S_n(f)}{n}(x) = \int_E f(x) dx
\ee

Then by Dominated convergence theorem (Theorem \ref{thm:dominated_convergence_probability}), 
\be
c = \int_E c dx = \lim_{n\to \infty} \int_E \frac{S_n(f)}{n}(x) dx = \int_E f(x)dx = \int^1_0 f(x)dx.
\ee

%Also, by von Neumann's $\sL^p$ ergodic theorem (Theorem \ref{thm:von_neumann_lp_ergodic}), $f$ is integrable ($\in \sL^1(E,\sE,\mu)$), then
%\be
%\mu\bb{\abs{\bar{f} - \frac{S_n(f)}{n}}} \to 0
%\ee
% then scheffe lemma 

%so, in particular,
%\[
% \int \tfrac{1}{n}(f + f \circ \tau + \cdots + f \circ \tau^{n-1}) \to \int \bar{f} 
%\]
%Since $\tau$ is measure-preserving, $\int f \circ \tau^k = \int f$ for all $k$. Thus the LHS is simply $\int f$. Therefore, putting everything together,
%\[
% \lim_{n \to \infty} \frac{1}{n}(f + f \circ \tau + \cdots + f \circ \tau^{n-1}) = \int_0 ^1 f \quad \mathrm{a.e.}
%\]

Thus, $\ol{f} = \int^1_0 f(x)dx$.
\end{example}



\begin{example}\label{exa:baker_map}
For $E = [0, 1)$ and $\mu(dx) = dx$, define Bakers' map\index{Bakers' map},
\be
\theta (x) = 2x - \floor{2x} = 2x \lmod{1}.
\ee

It is a measure-preserving transformation of Lebesgue measure on $[0, 1)$, and that $\theta$ is ergodic. %Find $\bar{f}$ for each integrable function $f$.

First we have 

\centertexdraw{
    \drawdim in

    \arrowheadtype t:F \arrowheadsize l:0.08 w:0.04
    
    \linewd 0.01 \setgray 0
    
    \move (-0.2 0) \avec(1.8 0)
    \move (0 -0.2) \avec(0 1.8)
   
    \move (0 0) \lvec(0.75 1.5) 
    \move (0.75 0) \lvec(1.5 1.5) 
%    \lvec(0.25 0) \lvec(0 0) \lvec(0 0.25) \lvec(1.25 1.5) 
%    \lfill f:0.8

    \htext (-0.1 0.9){$b$}
    \htext (-0.1 0.6){$a$}


    \htext (-0.1 1.5){1}
    \htext (1.5 -0.15){1}
    \htext (-0.1 -0.15){0}

%    \htext (1.6 0.5){$\frac a2$}
%    \htext (0.5 1.6){$\frac b2$}

%    \move (1.55 0.55) \avec(0.8 0.55)
%    \move (0.75 1.55) \avec(0.75 1)

    \lpatt(0.05 0.05)

    \move (0 1.5) \lvec(1.5 1.5) \lvec(1.5 0)

    \move (0 0.6) \lvec(1.5 0.6) 
    \move (0 0.9) \lvec(1.5 0.9)  

    \move (0.3 0.6) \lvec(0.3 0) 
    \move (0.45 0.9) \lvec(0.45 0)  

    \move (1.05 0.6) \lvec(1.05 0) 
    \move (1.2 0.9) \lvec(1.2 0)  

    \htext (0.25 -0.2){$\frac a2$}
    \htext (0.4 -0.2){$\frac b2$}

    \htext (0.9 -0.2){$\frac {a+1}2$}
    \htext (1.15 -0.2){$\frac {b+1}2$}

    \htext (-3 0.5){$\theta(x) = \left\{\ba{ll} 2x & x\in [0,\frac 12)\\ 2x-1 \quad\quad & x \in [\frac 12,1) \ea\right.$}
   
}

Thus, $\forall a<b\in [0,1)$ and $A = (a,b)$, then $\theta^{-1}(A) = \bb{\frac a2,\frac b2}\cup \bb{\frac {a+1}2,\frac {b+1}2}$. Then %See that very easily if we make the graph of $\theta$. 
\beast
\mu\bb{\theta^{-1}(A)} & = & \mu\bb{\theta^{-1}(a,b)} = \mu \bb{\bb{\frac a2,\frac b2}} + \mu \bb{\bb{\frac {a+1}2,\frac {b+1}2}} \\
& = & \frac {b-a}2 + \frac{b+1}2 - \frac {a+1}2 = b-a = \mu\bb{(a,b)}.
\eeast

Thus, $\mu\circ \theta^{-1} = \mu$ on intervals of the form $(a,b)$, which form a $\pi$-system generating $\sB([0,1))$. Then by uniqueness of extension theorem (Theorem \ref{thm:uniqueness_of_extension_measure}, $\mu(E) = 1 <\infty$ since $\mu$ is Lebesgue measure and $E = [0,1)$), $\mu \circ \theta^{-1} = \mu$ on $\sB([0,1))$. Thus, $\theta$ is measure-preserving.

Now to each $x \in [0,1)$, we may assign a unique binary representation $x=0.x_1 x_2 x_3 \ldots$, provided we do not allow an infinite string of 1's. Then we see that $\theta(x) = 0.x_2 x_3 \ldots $. Define random variables $X_n (x) = x_n$ (the probability triple is $([0,1),\mathcal{B}([0,1)),\mu)$). Then the $X_n$ are the Rademacher functions, and are i.i.d. $\bd(1,\frac{1}{2})$. Now
\[
 \theta^{-n}(\{X_1 = \varepsilon_1, \ldots, X_k = \varepsilon_k\}) = \{X_{n+1} = \varepsilon_1, \ldots X_{n+k} = \varepsilon_k \} \in \mathcal{T}_n
\]
where $\mathcal{T}_n= \sigma(X_k : k \geq n + 1)$. Since $\mathcal{B}([0,1)) = \sigma(X_n : n \in \mathbb{N})$ (check this), we have that $\theta^{-n}(B) \in \mathcal{T}_n$ for all $B \in \mathcal{B}([0,1))$. Now if $A$ is invariant then $A \in \sE_\theta$ and thus $\theta^{-n}(A) = A$ for all $n$. Thus
\[
 \sE_\theta \subset \bigcap_n \mathcal{T}_n =: \sT_\infty
\]
Since $\sT_\infty$ is the tail $\sigma$-algebra, by Kolmogorov's 0-1 Law (Theorem \ref{thm:kolmogorov_0_1}), $\sE_\theta$ can contain only events of measure 1 or 0, so $\theta$ is ergodic.

%{\bf Approach 2.} First observe that
%\[
% \mu(\tau^{-n}(B) \cap [0,\tfrac{1}{2^n})) = \mu([0,\tfrac{1}{2^n}))\mu(\tau^{-n}(B))
%\]
%It is not hard to see that this extends to $\mu(\tau^{-n}(B) \cap A) = \mu(A)\mu(\tau^{-n}(B))$ whenever $A$ is in the $\pi$-system of dyadic intervals
%\[
% \mathcal{A}:=\{[\tfrac{a}{2^n},\tfrac{b}{2^n}) \cap [0,1) : a,b,n \in \mathbb{Z}_+\}
%\]
%Then we see that, if $B$ is invariant, and $A \in \mathcal{A}$, we have that $\mu(B \cap A) = \mu(B)\mu(A)$. Thus the probability measure $\mu$ is independent on the $\pi$-systems $\mathcal{E}_\tau$ and $\mathcal{A}$. Theorem 1.11.1 from the printed notes then gives that $\mu$ is independent on $\sigma(\mathcal{E}_\tau) = \mathcal{E}_\tau$ and $\sigma(\mathcal{A}) = \mathcal{B}([0,1)) \supset \mathcal{E}_\tau$ (check this). So, in particular, for $B \in \mathcal{E}_\tau$, we have that $\mu(B) = \mu(B \cap B) = \mu(B)\mu(B) =0$ or 1.

For an integrable function $f$, by Birkhoff's almost everywhere ergodic theorem (Theorem \ref{thm:birkhoff_ergodic}), there exists an integrable, invariant function $\ol{f}$, such that,
\be
\ol{f}= \lim_{n \to \infty} \frac{1}{n}(f + f \circ \theta + \cdots + f \circ \theta^{n-1}) \ \text{ a.e..}
\ee

As $\theta$ is ergodic, $\ol{f}$ is invariant, then $\ol{f}$ is a constant $c$ almost everywhere (Proposition \ref{pro:ergodic_invariant_constant}), so 
\be
c = \ol{f} = \lim_{n\to \infty} \frac{S_n(f)}{n}(x)  \ \text{ a.e..}
\ee

Thus, since $f$ is integrable, by Proposition \ref{pro:integrable_measure_preserving}, $f\circ \theta^{n}$ is integrable for all $n$,
\be
\int_E f\circ \theta^n(x) dx = \int_E f(x) dx \ \ra \ \int \frac{S_n(f)}{n}(x) = \int_E f(x) dx
\ee

Then by Dominated convergence theorem (Theorem \ref{thm:dominated_convergence_probability}), 
\be
c = \int_E c dx = \lim_{n\to \infty} \int_E \frac{S_n(f)}{n}(x) dx = \int_E f(x)dx = \int^1_0 f(x)dx.
\ee

%Also, by von Neumann's $\sL^p$ ergodic theorem (Theorem \ref{thm:von_neumann_lp_ergodic}), $f$ is integrable ($\in \sL^1(E,\sE,\mu)$), then
%\be
%\mu\bb{\abs{\bar{f} - \frac{S_n(f)}{n}}} \to 0
%\ee
% then scheffe lemma 

%so, in particular,
%\[
% \int \tfrac{1}{n}(f + f \circ \tau + \cdots + f \circ \tau^{n-1}) \to \int \bar{f} 
%\]
%Since $\tau$ is measure-preserving, $\int f \circ \tau^k = \int f$ for all $k$. Thus the LHS is simply $\int f$. Therefore, putting everything together,
%\[
% \lim_{n \to \infty} \frac{1}{n}(f + f \circ \tau + \cdots + f \circ \tau^{n-1}) = \int_0 ^1 f \quad \mathrm{a.e.}
%\]

Thus, $\ol{f} = \int^1_0 f(x)dx$ a.e..
\end{example}



\begin{theorem}[von Neumann's $\sL^p$ ergodic theorem\index{von Neumann's $\sL^p$ ergodic theorem}]\label{thm:von_neumann_lp_ergodic}
Assume that $\mu(E) < \infty$. Let $p \in [1,\infty)$. Let $\theta : E \to E$ be a measure-preserving transformation (Note that $\theta$ does not need to be ergodic). Then, for all $f \in \sL^p(E,\sE,\mu)$, $S_n(f)/n \to \ol{f}$ in $\sL^p(E,\sE,\mu)$.
\end{theorem}

\begin{proof}[\bf Proof]
We have (by Proposition \ref{pro:integrable_measure_preserving}),
\be
\dabs{f \circ \theta^n}_p = \bb{\int_E |f|^p \circ \theta^n d\mu}^{1/p} = \bb{\int_E |f|^p d\mu}^{1/p} = \dabs{f}_p.
\ee

So, by Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure}),
\be
\dabs{S_n(f)}_p \leq \dabs{f}_p + \dots + \dabs{f\circ \theta^{n-1}}_p = n\dabs{f}_p \ \ra \ \dabs{S_n(f)/n}_p \leq \dabs{f}_p.
\ee

Given $\ve > 0$, choose $K < \infty$ so that $\dabs{f - g}_p < \ve/3$, where $g = (-K) \lor f \land K$. Note that $g\in \sL^p(E,\sE,\mu)$.

By Birkhoff's theorem (Theorem \ref{thm:birkhoff_ergodic}), $S_n(g)/n \to \ol{g}$ a.e.. We have $|S_n(g)/n| \leq K$ for all $n$ so, by bounded convergence theorem (Theorem \ref{thm:bounded_convergence_finite_measure_lp}), $S_n(g)/n,\ol{g} \in \sL^p(E,\sE,\mu)$ and there exists $N$ such that, for $n \geq N$,
\be
\dabs{S_n(g)/n - \ol{g}}_p < \ve/3.
\ee

Since ($f-g \in \sL^p(E,\sE,\mu)$ and by Proposition \ref{pro:integrable_measure_preserving}), $\mu\bb{\abs{(f-g)\circ \theta^n}^p} = \mu\bb{\abs{f-g}^p}$ for all $n$. Then by Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure}),
\beast
\mu\bb{ |S_n(f - g)|^p }^{1/p} = \dabs{S_n(f - g)}_p & \leq & \dabs{f-g}_p + \dabs{(f-g)\circ \theta} + \dots \dabs{(f-g)\circ \theta^{n-1}}_p \\
& = & \mu(\abs{f-g}^p)^{1/p} + \mu (\abs{(f-g)\circ \theta}^p)^{1/p} + \dots + \mu(\abs{(f-g)\circ \theta^{n-1}}^p)^{1/p} \\
& = & n\mu(|f-g|^p)^{1/p} =  n\dabs{f-g}_p.
\eeast

Thus, we have
\be
\mu\bb{ |S_n(f - g)/n|^p } \leq \mu(|f-g|^p) =  \dabs{f-g}_p^p.
\ee

By Birkhoff's theorem (Theorem \ref{thm:birkhoff_ergodic}), $\ol{f} = \lim_n (S_n(f)/n)$ a.e. then $\abs{\ol{f}} = \lim_n \abs{S_n(f)/n}$ a.e.. Similary, we have
\be
\ol{f} - \ol{g} = \lim_n (S_n(f-g)/n)\text{ a.e. } \ \ra \ \abs{\ol{f} - \ol{g}} = \lim_n \abs{S_n(f-g)/n}\text{ a.e. }.
\ee

By Fatou's lemma (Lemma \ref{lem:fatou_function}),
\be
\dabs{\ol{f} - \ol{g}}_p^p = \mu \bb{\lim_n \abs{S_n(f-g)/n}^p} = \mu \bb{ \liminf_n |S_n(f - g)/n|^p } \leq \liminf_n \mu\bb{ |S_n(f - g)/n|^p } \leq \dabs{f - g}^p_p
\ee


Hence, for $n \geq N$, by Minkowski's inequality (Theorem \ref{thm:minkowski_inequality_measure}),
\vspace{2mm}
\beast
\dabs{S_n(f)/n - \ol{f}}_p & \leq & \dabs{S_n(f - g)/n}_p + \dabs{S_n(g)/n - \ol{g}}_p + \dabs{\ol{g} - \ol{f}}_p \\
& \leq & \dabs{S_n(f - g)/n}_p + \dabs{S_n(g)/n - \ol{g}}_p + \dabs{g - f}_p  \\
& < & \ve/3 + \ve/3 + \ve/3 = \ve.
\eeast
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Signed Measure}

\section{Problems}


