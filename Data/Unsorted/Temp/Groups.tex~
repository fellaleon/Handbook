
%\chapter{Vectors}

\chapter{Groups and Rings}

\begin{problem}
Let $G$ be a group of even order with a cyclic Sylow 2-subgroup. By considering the regular action of $G$, show that $G$ has a normal subgroup of index 2. %[If $x$ is a generator of a Sylow 2-subgroup, show that $x$ is an odd permutation by working out its cycle structure.]
\end{problem}

\begin{solution}[\bf Solution.]
The action is regular (or simply transitive) if it is both transitive and free; this is equivalent to saying that for any two $x, y \in X$ there exists precisely one $g \in G$ such that $gx = y$. In this case, $X$ is known as a principal homogeneous space for $G$ or as a $G$-torsor.

{\bf [The following proof is from Zexiang Chen, need checking]}

Let $X$ be a generator of the Sylow 2-subgroup $H$. $H\leq G$. Let $G$ act on $H$, by $G\times G\to G$, $(g,h) \mapsto gh$ which induces a homomorphism $\phi:G \to \sym G, \phi(g) = \phi_g$.

$\abs{G} = 2^a b$, where $b$ is odd. $o(x) = 2^a$, $\phi(x) = \phi_x$, which has order $2^a$, because $o(\phi(x)) = k\mid 2^a$, but kernel of $\phi$ is trivial so $k = 2^a$. So $\phi_x$ must be a product of $m$ lots of $2^a$ cycles and so $\ve(\phi_x) = (2^a-1)m = \text{odd}^m = \text{odd}$. So $\phi_x$ is an odd permutation.

Then since $\phi(G) \leq \sym(G)$, and we have an odd permutation, so $\phi(G)$ contains hthe same number of odd and even permutations. (by the map $\ve:\phi(G)\to \bra{\pm 1}$), pick thoe even permutations, which is a normal subgroups of $\phi(G)$, and claim that the preimage of that is a normal subgroup of $G$ of index 2.

\end{solution}

{\large \textcolor{red}{from Part IA Groups}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\begin{problem}
Consider the M\"obius maps $f(z) = e^{2\pi i/n} z$ and $g(z) = 1/z$. Show that the subgroup $G$ of the M\"obius group $\sM$ generated by $f$ and $g$ is a dihedral group. ["Generated" here means that every element in $G$ is the product of elements of the form $f$, $g$, $f^{-1}$ and $g^{-1}$.]
\end{problem}

\begin{solution}[\bf Solution.]
Certainly $g^2 = e$. If $n=1$ then $f=e$, so $G = \bsa{f,g} = \bsa{e,g}\cong C_2$; if $n=2$, then $f(z) =-z$, so $f^2 = e$ and $fg= gf$, and thus $G = \bsa{f,g} = \bra{e,f,g,fg} \cong D_{4}$; so assume $n\geq 3$. Both $f$ and $g$ preserve the unit circle, and on it the set of $n$th of unity, which lie at the vertices of a regular $n$-gon; we may look at the effect on these vertices, since no non-identity element of $\sM$ fixes all of them - doing so we see that $f$ rotates them anticlockwise by $\frac{2\pi}n$ and $g$ reflects them in the real axis. Since the corresponding symmetries of the regular $n$-gon generate $D_{2n}$, we have $G\cong D_{2n}$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Express the M\"obius tranformation $f(z) = (2z + 3)/(z - 4)$ as the composition of maps of the form $z \mapsto az$, $z \mapsto z +b$ and $z \mapsto  1/z$. Hence show that $f$ maps the circle $\abs{z -2i} = 2$ onto the circle $\abs{8z + (6 + 11i)} = 11$.
\end{problem}

\begin{solution}[\bf Solution.]
As $\frac{2z+3}{z-4} = 2 + \frac {11}{z-4}$, $f$ is the composition of $z \mapsto z-4$, $z \mapsto 1/z$, $z \mapsto 11z$ and $z \mapsto 2+z$.

The circle $\abs{z-2i} =2$ has centre $2i$ and radius 2; applying $z-4$ moves to centre $2i-4$ and preserves the radius. Inversing sends the circle with centre $c$ and radius $r$ to the circle with centre $\frac{\ol{c}}{c\ol{c}-r^2}$ and radius $\frac{r}{\abs{c\ol{c}-r^2}}$ 
\beast
\abs{z-c} = r & \lra & (z-c)(\ol{z}-\ol{c}) = r^2 \ \lra\ z\ol{z} - c\ol{z} - \ol{c}z + c\ol{c} - r^2 = 0 \\
& \lra & \frac 1{c\ol{c} - r^2} - \frac{c}{z(c\ol{c} - r^2)} - \frac {\ol{c}}{\ol{z}(c\ol{c} - r^2 )} + \frac 1{z\ol{z}} = 0\\
& \lra & \bb{\frac 1z - \frac{\ol{c}}{c\ol{c} - r^2 }}\bb{\frac 1{\ol{z}} - \frac{c}{c\ol{c} - r^2 }} = \frac{(c\ol{c})-(c\ol{c} - r^2)}{(c\ol{c} - r^2 )^2} = \frac{r^2}{(c\ol{c} - r^2 )^2}.
\eeast

So the new circle has centre $\frac{-4-2i}{20-4} = -\frac{2+i}8$ and radius $\frac{2}{20-4} = \frac 18$. Applying $z \mapsto 11z$ and then $z\mapsto z+2$ moves the centre to $11\bb{-\frac{2+i}8} +2 = -\frac {6+11i}8$ and changes the radius to $\frac {11}8$, so the final circle is $\abs{8z + (6 + 11i)} = 11$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be the subgroup of M\"obius transformations which map the set $\{0, 1,\infty\}$ onto itself. Find all the elements in $G$. To which standard group is $G$ isomorphic? Find the group of M\"obius transformations which map the set $\{0, 2,\infty\}$ onto itself.
\end{problem}

\begin{solution}[\bf Solution.]
For each ordering of $0,1,\infty$, there exists a unique element of $\sM$ taking 0 to the first, 1 to the second and $\infty$ to the third: $z\mapsto z$ sends 0 to 0, 1 to 1, $\infty$ to $\infty$; $z\mapsto 1-z$ sends 0 to 1, 1 to 0, $\infty$ to $\infty$; $z \mapsto 1/z$ sends 0 to $\infty$, 1 to 1, $\infty$ to 0; $z \mapsto \frac{z-1}z$ sends 0 to $\infty$, 1 to 0, $\infty$ to 1; $z\mapsto \frac 1{1-z}$ sends 0 to 1, 1 to $\infty$, $\infty$ to 0;  $z \mapsto z/{z-1}$ sends 0 to 0, 1 to $\infty$, $\infty$ to 1. 

As it consists of permutation of 3 points, $G\cong S_3$. 

Similarly the M\"obius transformations sending $\bra{0,2,\infty}$ to itself are $z\mapsto z$, $z\mapsto 2-z$, $z\mapsto 4/z$, $z\mapsto \frac{2z-4}z$, $z\mapsto \frac 4{2-z}$, $z\mapsto \frac{2z}{z-2}$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be a group of even order. Show that $G$ contains an element of order two.
\end{problem}

\begin{solution}[\bf Solution.]
Pair each non-self-inverse element of $G$ with its inverse (note that $(x^{-1})^{-1}=x$ so this makes sense). This shows that there are evenly many non-self-inverse elements. As $G$ is even, there are also evenly many self-inverse elements. One such is $e$, so there must be another, say $g$, and then $g = g^{-1} \ \ra \ g^2 =e$ so that $g$ has order two.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A \emph{fifteen puzzle} consists of fifteen small square tiles, numbered 1 to 15, which are mounted in a $4 \times 4$
frame in such a way that each tile can slide vertically or horizontally into an adjacent square (if it is not already occupied by another tile), but the tiles cannot be lifted out of the tray. On the packet in which the puzzle was sold, it is asserted that it is impossible to manoeuvre the tiles from the first to the second of the configurations shown below. The packet is too small to contain a proof. Is the assertion true? Prove it.
\be
\ba{ccccccccc}
1 & 2 & 3 & 4 & \quad\quad & 15 & 14 & 13 & 12\\
5 & 6 & 7 & 8 & & 11 & 10 & 9 & 8\\
9 & 10 & 11 & 12 & & 7 & 6 & 5 & 4\\
13 & 14 & 15 & - & & 3 & 2 & 1 & -
\ea
\ee
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\begin{problem}
Describe the finite subgroups of the group of isometries of the plane. [If we think of the plane as $\C$ you may assume that all isometries have the form $z \mapsto  az + b$ or $z \mapsto  a\bar{z} + b$, where $a$ and $b$ are complex numbers and in both cases $\abs{a} = 1$. Hint: is there a point in the plane fixed by all the elements in the group? ]
\end{problem}

\begin{solution}[\bf Solution.]
First consider isometries $z\mapsto az + b$, if $a=1$ and $b\neq 0$ this is a translation, hence of infinite order, so cannot lie in a finite subgroup $G$. 

If $a\neq 1$ it is a rotation with centre $\frac b{1-a}$ (as this is the unique fixed point); if $G$ contains rotations $f$,$f'$ with different centres, say $f(z) = az + b$, $f'(z) = a'z + b$, then $f'f(z) = a'a z + a'b + b'$ while $ff'(z) = a'a z + ab' + b$, and $\frac b{1-a} \neq \frac {b'}{1-a'}$ implies that $a'b + b' \neq ab' + b$, so $(f'f)^{-1}ff'$ is a translation. Contradiction to finite subgroup again. 

Thus $G$ can only contain rotations about one centre; as in question \ref{que:multiplication_finite}, as $G$ is finite, the rotations form a cyclic group, say $\bsa{f}$. Now if $G$ contains a non-rotation $g$, where $g(z) = a\ol{z} + b$, then if $g'\in G$ is any other non-rotation then $g^{-1}g'$ is a rotation, say $f^i$ for some $i$. (Otherwise, it's a translation.)

So there are equally many rotations and non-rotations, and $G = \bsa{f,g} = \bra{e,f,f^2,\dots,f^{n-1}, g, gf,gf^2 ,\dots, gf^{n-1}}$. As 
\be
g^2(z) = a(\ol{a}z+ \ol{b}) + b = z + a \ol{b} + b,
\ee
we must have $a\ol{b} + b = 0$, and $g^2 = e$. (Otherwise $g^2$ is a translation). Similarly, $(gf)^2 = e$, i.e. $gf gf = e$, so $gfg^{-1} = f^{-1}$. So $G$ is dihedral.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that the set $\{1, 3, 5, 7\}$ with multiplication modulo 8 is a group. Is this group isomorphic to $C_4$ or $C_2 \times C_2$? Justify your answer.
\end{problem}

\begin{solution}[\bf Solution.]
We have
\begin{center}
\begin{tabular}{c|cccc}
$X_8$ & 1 & 3 & 5 & 7\\
\hline
1 & 1 & 3 & 5 & 7\\
3 & 3 & 1 & 7 & 5\\
5 & 5 & 7 & 1 & 3\\
7 & 7 & 5 & 3 & 1
\end{tabular}
\end{center}

So $X_8$ is a binary operation on $\bra{1,3,5,7}$ (i.e., we have closure); multiplication is associative so $X_8$ is as well; 1 is the identity; and each element is its own inverse. Thus we have a group. 

Since no element has order 4, it is not isomorphic to $C_4$ - but it is isomorphic to $C_2 \times C_2$ as each element is its own inverse.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{problem}
%Let $H$ be a subgroup of the group $G$. Find a (natural) bijection between the set of all left cosets and the set of all right cosets of $H$ in $G$.
%\end{problem}

%\begin{solution}[\bf Solution.]
%\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $H$ be a subgroup of the (finite) group $G$, let $K$ be a subgroup of $H$. Show that the index $|G : K|$
equals the product $|G : H||H : K|$.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be a subgroup of the symmetric group $S_n$. Show that if $G$ contains any odd permutations then precisely half of the elements of $G$ are odd.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that any subgroup of a cyclic group is cyclic. Find all the subgroups of the cyclic group $C_n$.
\end{problem}

\begin{solution}[\bf Solution.]
Let $G = \bsa{g}$ be a cyclic group, and $H$ be a subgroup of $G$. If $H = \bra{e}$, then $H=\bsa{e}$ is cyclic so we may assume $H \neq \bsa{e}$; take $h_1\in H\bs \bra{e}$, then $h_1 = g^n$ for some $n \in \Z$. Since $h_1^{-1} = g^{-n} \in H$, $\exists m\in \N$ with $g^m \in H$. 

Let $n\in \N$ be minimal with $g^n \in H$, and set $h = g^n$. Certainly $\bsa{h}\subseteq H$. Conversely, given $g^r\in H$ write $c = qn + r$ with $q,r\in \Z$ and $0\leq r < n-1$, then $g^r = g^{c -qn} = g^c \bb{g^n}^{-q} = g^c h^{-q} \in H$, so by the minimality of $n$ we must have $r=0$, whence $c = qn$ and $g^c = g^{qn} = h^q \in \bsa{h}$. Thus, $H\subseteq \bsa{h}$ which gives $\bsa{h} = H$, and thus $H$ is cyclic.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that the symmetric group $S_4$ has a subgroup of order $d$ for each divisor $d$ of 24, and find two
non-isomorphic subgroups of order 4.

Show that the alternating group $A_4$ has a subgroup of each order up to 4, but there is no subgroup of order 6.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
List all the subgroups of the dihedral group $D_8$, and indicate which pairs of subgroups are isomorphic. Repeat for the quaternion group $Q_8$.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that the dihedral group $D_{12}$ is isomorphic to the direct product $D_6 \times C_2$.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
%\begin{problem}
%A finite group $G$ is generated by a set $T$ of elements of $G$ if each element of $G$ can be written as a finite product (possibly with repetitions) of powers of elements of $T$. Show that the symmetric group $S_n$ is generated by each of the following sets of permutations:
%\ben
%\item [(i)] the set $\{(j, k) : 1 \leq j < k \leq n\}$ of all transpositions in $S_n$;
%\item [(ii)] the set $\{(j, j + 1) : 1 \leq j < n\}$;
%\item [(iii)] the set $\{(1, k) : 1 < k \leq n\}$;
%\item [(iv)] the set $\{(1, 2), (12 \dots n)\}$ consisting of a transposition and an $n$-cycle.
%\een
%\end{problem}

%\begin{solution}[\bf Solution.]
%\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Consider a pack of $2n$ cards, numbered from 0 to $2n-1$. An outer perfect shuffle is a shuffle of the cards,
in which one first splits the pack in two halves of equal sizes and then interleaves the cards of the two halves in such a way that the top and bottom card remain in the top and bottom position. Show that the order of the outer shuffle is the multiplicative order of 2 modulo $2n - 1$. 

Deduce that after at most $2n - 2$ repetitions of the outer shuffle we get the cards in the pack into the original position.

What is the actual order of the outer shuffle of the usual pack of 52 cards?

(There is also an inner perfect shuffle which differs from the outer shuffle in that the interleaving of the cards of the two halves is done so that neither the top nor the bottom card remains in the same position. What is the order of this shuffle of the usual pack of 52 cards?)
\end{problem}


\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
How many subgroups of order four does the quaternion group $Q_8$ have?
\end{problem}

\begin{solution}[\bf Solution.]
In $Q_8$ the only element of order 2 is -1, so there is no subgroup isomorphic to $C_2\times C_2$; there are 6 element of order 4, forming 3 pairs $\bra{g,g^{-1}}$ as $\bsa{g} = \bsa{g^{-1}}$ there are 3 subgroups isomorphic to $C_4$. Thus, $Q_8$ has 3 subgroups of order 4: $\bra{1,i,-1,-i}$, $\bra{1,j,-1,-j}$ and $\bra{1,k,-1,-k}$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
What is the order of the M\"obius map $f(z) = iz$? If $h$ is any M\"obius map, find the order of $hfh^{-1}$ and its fixed points. Use this to construct a M\"obius map of order four that fixes 1 and -1.
\end{problem}

\begin{solution}[\bf Solution.]
$f^4 z = i^4 z = z$ while $f^2 z = i^2 z = -z$, so $f$ has order 4. Given $h$, 
\be
(hfh^{-1})^4 = hfh^{-1} hfh^{-1} hfh^{-1} hfh^{-1} = hffffh^{-1} = hf^4h^{-1} = hh^{-1} = 1
\ee
while 
\be
(hfh^{-1})^2 = hfh^{-1} hfh^{-1} = hf^2h^{-1}  \neq 1.
\ee
since $f^2 \neq 1$. So $hfh^{-1}$ has order 4. Since the fixed points of $f$ are 0 and $\infty$, we have 
\be
hfh^{-1} h(0) = hf(0) = h(0),\quad hfh^{-1} h(\infty) = hf(\infty) = h(\infty).
\ee

So $h(0)$ and $h(\infty)$ are fixed points of $hfh^{-1} $; as no non-identity M\"obius map fixes 3 distinct points, these are the only fixed points of $hfh^{-1} $. 

If we take $h(z) = \frac{z-1}{z+1}$ then $h(0) = -1$, $h(\infty) = 1$ thus $hfh^{-1} $ is of order 4 and fixes 1 and -1. Since $h^{-1}(z) = \frac{z+1}{-z+1}$, we have 
\be
hfh^{-1} (z) = hf\bb{\frac{z+1}{-z+1}} = h\bb{\frac{iz + i}{-z+1}} = \bb{\frac{iz+i}{-z+1}-1}\left/\bb{\frac{iz+i}{-z+1} +1}\right. = \frac{(i+1)z + (i-1)}{(i-1)z + (i+1)}.
\ee
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $X = \bra{1, 2, 3, 4, 5, 6}$, and let $G$ be the cyclic group generated by the permutation $\sigma(1) = 2$, $\sigma(2) = 1, \sigma(3) = 4, \sigma(4) = 5, \sigma(5) = 6, \sigma(6) = 3$. Since $G$ is a subgroup of $S_6$, it acts on $X$. Find all orbits and stabilizers for the action of $G$ on $X$ and check that your answers are consistent with the Orbit-stabilizer theorem.
\end{problem}

\begin{solution}[\bf Solution.]
Since $\sigma$ sends 1,2,3,4,5,6 to 2,1,4,5,6,3 in order, $\sigma^2$ sends 1,2,3,4,5,6 to 1,2,5,6,3,4 in order, $\sigma^3$ sends 1,2,3,4,5,6 to 2,1,6,3,4,5 in order, and $\sigma^4$ sends 1,2,3,4,5,6 to 1,2,3,4,5,6 in order. So $\sigma^4 = \iota$ and $G = \bra{1,\sigma,\sigma^2,\sigma^3}$. Write $O_i$ for the orbit of $i$, so that $O_i = \bra{i,\sigma(i),\sigma^2(i),\sigma^3(i)}$ by the above.

$O_1 = O_2 = \bra{1,2}$ while $O_3 = O_4 = O_5 = O_6 = \bra{3,4,5,6}$. Also by the above, $\stab(1) = \stab(2) = \bra{\iota,\sigma^2}$ while $\stab(3) = \stab(4) = \stab(5) = \stab(6) = \bra{\iota}$. Thus in all cases $\abs{O_i}\cdot \abs{\stab(i)} = 4 = \abs{G}$, as given by the orbit-stabilizer theorem.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that $\rho(t, (x, y)) = (e^tx, e^{-t}y)$, where $t \in \R$ and $(x, y) \in \R^2$, defines an action of $(R, +)$ on $\R^2$. Describe the orbits of the action and find all possible stabilizers.
\end{problem}

\begin{solution}[\bf Solution.]
Certainly $\rho(0,(x,y)) = (x,y)$; also 
\be
\rho(t,\rho(t',(x,y))) = \rho(t,(e^{t'}x, e^{-t'}y)) = \bb{e^te^{t'}x,e^{-t}e^{-t'}y} = \rho\bb{t+t',(x,y)}.
\ee

Thus this gives an action of $(\R,+)$ on $\R^2$. The orbits of the action are as follows: the origin; the positive $x$-axis; the negative $x$-axis; the positive $y$-axis; the negative $y$-axis; and curves $xy$=constant restricted to a quadrant of the plane. The first orbit has stabilizer $\R$; all other stabilizers are $\bra{0}$, since if $(x,y)\neq (0,0)$ then $\bb{e^tx,e^{-t}y} = (x,y) \ \ra \ t = (0)$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be a finite group and let $X$ be the set of all it subgroups. Given $g \in G$ and $H \in X$ show that $(g,H) \mapsto gHg^{-1}$ defines an action of $G$ on $X$. Show that the orbit of $H$ has at most $\abs{G}=\abs{H}$ elements. If $H \neq G$, show that there is an element in $G$ which does not belong to any conjugate of $H$.
\end{problem}

\begin{solution}[\bf Solution.]
Certainly, $gHg^{-1}$ is still a subgroup of $G$ (it contains $geg^{-1} = e$, and given $ghg^{-1}$, $ghg^{-1}\in gHg^{-1}$) we have 
\be
ghg^{-1} \cdot gh'g^{-1} = g(hh')g^{-1} \in gHg^{-1},\quad \bb{ghg^{-1}}^{-1} = gh^{-1}g^{-1} \in gHg^{-1}),
\ee
and $(e,H)\mapsto eHe^{-1} = H$; given $g,g'\in G$ and $H\in X$ we have 
\be
\rho(gg',H) = gg'H(gg')^{-1} = gg' H g'^{-1}g^{-1} = \rho(g,g'Hg'^{-1}) = \rho(g,\rho(g',H)).
\ee

Thus, this gives an action of $G$ on $X$.

If $h\in H$ we have $\rho(h,H) = hHh^{-1} = H$, so $\stab(H)$ contains $H$. Thus
\be
\abs{\text{orbit of }H} = \frac{\abs{G}}{\abs{\stab(H)}} = \leq \frac{\abs{G}}{\abs{H}}.
\ee

If $H\neq G$, Let $\frac{\abs{G}}{\abs{H}} = k >1$ then as each conjugate of $H$ contains $\abs{H}$ elements, one of which is $e$, the number of elements of $G$ contained in conjugates of $H$ is at most 
\be
1 + k(\abs{H}-1) = 1+ k\abs{H} -k = 1+ \abs{G} - k < \abs{G},
\ee
so there is an element of $G$ which does not lie in any conjugate of $H$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be the group of all symmetries of the cube and let $\ell$ be the line between two diagonally opposite vertices. Let $H = \bra{g \in G : g\ell = \ell }$. Show that $H$ is a subgroup of $G$ isomorphic to $S_3 \times C_2$.
\end{problem}

\begin{solution}[\bf Solution.]
There are 4 axes joining diagonally opposite vertices; since $G$ has a single orbit on vertices it also has a single orbit on such axes, and hence $H = \stab(1)$ has order $\abs{G}/4 = 48/4 = 12$.

Let the vertices at each end of $\ell$ be $v$ and $v'$, then $H$ contains $\stab(v)$, whose order is $\abs{G}/8 = 48/8 = 6$ since $\stab(v)$ acts on the 3 vertices $w,x,y$ nearest $v$, with a single orbit, and there is a reflection fixing $v$ and $w$ but interchanging $x$ and $y$, we have $\stab(v) \cong S_3$.

There is a symmetry $\sigma$ interchanging each vertex with that diagonally opposite it, and $\sigma$ commutes with every element of $G$; then $\sigma \in H$, and so $H=\bsa{\stab(v),\sigma} = \stab(v)\times \bsa{\sigma} \cong S_3 \times C_2$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $S^1$ denote the unit circle in $\C$ and let $S^3 = \bra{(w_1,w_2) \in \C^2 : \abs{w_1}^2 + \abs{w_2}^2 = 1}$. Show that given $(t_1, t_2) \in S^1 \times S^1$ and $(w_1,w_2) \in S^3$, 
\be
((t_1, t_2),(w_1,w_2)) \mapsto (t_1w_1, t_2w_2)
\ee
defines an action of $S^1 \times S^1$ on $S^3$. Describe the orbits and find all stabilizers.
\end{problem}

\begin{solution}[\bf Solution.]
Clearly, $\forall t_1,t_2\in S^1\times S^1$, $(w_1,w_2)\in S^2$ we have $(t_1w_1,t_2w_2)\in \C^2$, and 
\be
\abs{t_1w_1}^2 + \abs{t_2w_2}^2 = \abs{t_1}^2\abs{w_1}^2 + \abs{t_2}^2 \abs{w_1}^2 = \abs{w_1}^2 + \abs{w_2}^2 = 1
\ee
since $\abs{t_1} = \abs{t_2} =1$ - so $(t_1w_1,t_2w_2)\in S^3$. Certainly $\rho((1,1),(w_1,w_2)) = (w_1,w_2)$,
\be
\rho((t_1,t_2),\rho((s_1,s_2),(w_1,w_2))) = \rho((t_1,t_2),\rho(s_1w_1 ,s_2w_2)) = (t_1s_1w_1,t_2s_2w_2) = \rho((t_1s_1,t_2s_2),(w_1,w_2)).
\ee

So this gives an action of $S^1 \times S^1$ on $S^3$. 

For each $\alpha$ with $0\leq \alpha \leq 1$, let $0_\alpha = \bra{(w_1,w_2)\in S^3:\abs{w_1}^2 = \alpha} = \bra{(w_1,w_2)\in \C^2:\abs{w_1}^2 = \alpha, \abs{w_2}^2 = 1-\alpha}$ - then the $O_\alpha$ are the orbits of the action, because each set is preserved by the action and if $(w_1,w_2),(w_1',w_2')\in O_\alpha$ then $\abs{w_1} = \abs{w_1'}$ and $\abs{w_2} = \abs{w_2'}$, so with $t_1 = w_1'/w_1$, $t_2 = w_2'/w_2$ we have $(t_1,t_2)\in S^1 \times S^1$ and $\rho((t_1,t_2),(w_1,w_2)) = (w_1',w_2')$. If $0<\alpha <1$ the stabilizer of a point $(w_1,w_2)$ in $O_\alpha$ is trivial, since $w_1,w_2\neq 0$; if $\alpha = 0$ the stabilizer is $S^1\times \bra{1}$, while if $\alpha = 1$ it is $\bra{1}\times S^1$.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{problem}
%Let $p$ be a prime. Show that every group of order $p^2$ is abelian. [Hint: consider the action of the group on itself by conjugation.]
%\end{problem}

%\begin{solution}[\bf Solution.]
%Let $G$ be a group of order $p^2$. In the action of $G$ on itself by conjugation, one orbit is $\bra{e}$ as the possible stabilizer order are $1,p,p^2$ (by Lagrange's theorem), the possible orbit sizes are $p^2,p,1$. So all orbits have size 1 or $p$, and as the sume of the orbit sizes is $\abs{G}= p^2$, there must be at least $p$ orbits of size 1 (by considering the sum module $p$).

%Now $\bra{z}$ is an orbit of size 1 $\lra \ \forall g\in G, gzg^{-1} =z \ \lra\ \forall g\in G,gz =zg$. Write 
%\be
%Z(G) = \bra{z\in G:\forall g\in G,gz = zg},
%\ee
%so that $Z(G)\geq p$. If $\abs{Z(G)} < p^2$, take $g\in G\bs Z(G)$, then $\stab(g)$ contains $Z(G)$ since
%\be
%z\in Z(G)\ \ra \ zg = gz \ \ra \ zgz^{-1} = g
%\ee
%and also $g$ itself since $ggg^{-1} = g$, so $\stab(g) >p$ (as $g\notin Z(G)$ and $Z(G)\geq p$). As $\stab{g}$ is a subgroup of $G$ we must have $\stab(g) = G$, whence the orbit containing $g$ is of size 1, contrary to $g\in Z(G)$. Thus $\abs{Z(G)}=p^2$ and so $Z(G) =G$. That is, for all $g,h\in G$, we have $gh = hg$, i.e., $G$ is abelian.
%\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{problem}
Let $G$ be a group. If $H$ is a normal subgroup of $G$ and $K$ is a normal subgroup of $H$, is $K$ a normal subgroup of $G$?
\end{problem} 

\begin{solution}[\bf Solution.]
No. Normality is not transitive.
\end{solution}

\begin{problem}
Let $K$ be a normal subgroup of index $m$ in the group $G$. Show that $g^m \in K$ for any element $g\in G$.
\end{problem} 

\begin{solution}[\bf Solution.]
\end{solution}

\begin{problem}
Let $H$ be a subgroup of the cyclic group $C_n$. What is the quotient $C_n/H$? 

Let $D_{2n}$ be the group of symmetries of a regular $n$-gon. Show that any subgroup $K$ of rotations is normal in $D_{2n}$, and identify the quotient $D_{2n}/K$.
\end{problem} 

\begin{solution}[\bf Solution.]
Let $C_n = \bsa{g}$ and $H = \bsa{g^m}$ where $m\mid n$, then $C_n/H = \bra{H,gH,g^2H,\dots, g^{m-1}H}= \bsa{gH} \cong C_m$.

\end{solution}

\begin{problem}
Show that $D_{2n}$ has two conjugacy classes of reflections if $n$ is even, but only one if $n$ is odd.
\end{problem} 

\begin{solution}[\bf Solution.]
If $n$ is odd, any axis of symmetry joins a vectex to the midpoint of the opposite edge; if $r_v$ is the reflection in the axis through the vectex $v$, then given any other vertex $w$, there exists a rotation $g$ with $gv = w$, and then $gr_v g^{-1}$ is a reflection with 
\be
\bb{gr_v g^{-1}}w = gr_v g^{-1} gv = gr_v v = gv = w,
\ee
i.e., $gr_v g^{-1} = r_w$, so there is one conjugacy class of reflections. 

If however $n$ is even there are two types of axis of symmetry, joining opposite vertices and joint the midpoints of opposite edges; just as in the ease where $n$ is odd, any two reflections about axes of the same type are conjugate, but the first type of reflection fixes two vertices, and so any conjugate will fix two vertices, while the second type fixes no vertices; so there are two conjugacy classes of reflections.

\end{solution}

\begin{problem}
Let $D_8$ be the dihedral group of order 8. Find the conjugacy classes of $D_8$ and their sizes. Show that the centre $Z$ of the group has order 2, and identify the quotient group $D_8/Z$ of order 4. Repeat with the quaternion group $Q_8$.
\end{problem} 

\begin{solution}[\bf Solution.]
\end{solution}

\begin{problem}
Let $Q$ be a plane quadrilateral. Show that its group $G(Q)$ of symmetries has order at most 8. For which $n$ in the set $\{1, 2,\dots, 8\}$ is there a quadrilateral $Q$ with $G(Q)$ of order $n$?

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
What is the group of all rotational symmetries of a Toblerone chocolate bar, a solid triangular prism with an equilateral triangle as a cross-section, with ends orthogonal to the longitudinal axis of the prism? And the group of all symmetries?

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
Show that the subgroup $H$ of the group $G$ is normal in $G$ if and only if $H$ is the union of some conjugacy classes of $G$.

Show that the symmetric group $S_4$ has a normal subgroup (usually denoted $V_4$) of order 4.

To which group of order 6 is the quotient group $S_4/V_4$ isomorphic?

Find an action of $S_4$ giving rise to this isomorphism.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}



\begin{problem}
Let $G$ be a finite group and let $X$ be the set of all subgroups of $G$. Show that $G$ acts on $X$ by $g : H \mapsto g H g^{-1}$ for $g \in G$ and $H \in X$, where $g H g^{-1} = \{ g h g^{-1} : h \in H\}$. Show that the orbit containing $H$ in this action of $G$ has size at most $|G|/|H|$. If $H$ is a proper subgroup of $G$, show that there exists an element of $G$ which is contained in no conjugate $g H g^{-1}$ of $H$ in $G$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
Let $G$ a finite group of prime power order $p^a$, with $a > 0$. By considering the conjugation action of $G$, show that the centre $Z$ of $G$ is non-trivial.

Show that any group of order $p^2$ is abelian, and that there are up to isomorphism just two groups of that order for each prime $p$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
Find the conjugacy classes of elements in the alternating group $A_5$, and determine their sizes. 

Show that $A_5$ has no non-trivial normal subgroups (so $A_5$ is a \emph{simple} group).

Show that if $H$ is a proper subgroup of index $n$ in $A_5$ then $n > 4$. [Consider the left coset action of $A_5$ on the set of left cosets of $H$ in $A_5$.]

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
Let $G$ be a finite group of order $p^a m$, where $p^a$ is the highest power of the prime $p$ dividing $|G|$. Let $X$ be the set of all subsets of $G$ of size $p^a$. Show that $G$ acts on $X$ by $g : A \mapsto g A$ for $g \in G$ and $A\in X$.

Show that $X$ has size prime to $p$, and deduce that there is a $G$-orbit $X'$ of $G$ on $X$ of size prime to $p$. By considering the stabiliser of an element in $X'$, show that $G$ has a subgroup of order $p^a$, a \emph{Sylow} subgroup of $G$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}
If $H$ is a subgroup of a finite group $G$ and $G$ has twice as many elements as $H$, show that $H$ is normal in $G$.

\end{problem} 

\begin{solution}[\bf Solution.]
If $\abs{G} = 2\abs{H}$, there are 2 left cosets of $H$ in $G$, and 2 right cosets - in each case, one coset is $H$ so the other must be $G\bs H$. Hence the left and right cosets of $H$ are the same; so $H$ is normal in $G$.
\end{solution}

\begin{problem}
Show that every subgroup of rotations in the dihedral group $D_{2n}$ is normal.
\end{problem} 

\begin{solution}[\bf Solution.]
If $r$ is a rotation in $D_{2n}$, its conjugacy class is $\bra{r,r^{-1}}$, since $grg^{-1} =r^{-1}$ is a rotation and $g$ is a reflection. Thus, if $H$ is a subgroup of rotations in $D_{2n}$, then $\forall g\in D_{2n}$, $h\in H$ we have $ghg^{-1}\in \bra{h,h^{-1}} \subseteq H$, so $H$ is normal in $G$.
\end{solution}


\begin{problem}
Show that a subgroup $H$ of a group $G$ is normal if and only if it is a union of conjugacy classes.

\end{problem} 

\begin{solution}[\bf Solution.]
$H$ is normal in $G\ \lra \ \forall g\in G,h\in H$ we have $ghg^{-1} \in H \ \lra \ H$ is closed under conjugation by elements of $G\ \lra \ H$ is a union of conjugacy classes.
\end{solution}


\begin{problem}
We know that in an abelian group every subgroup is normal. Now, let $G$ be a group in which every subgroup is normal, is it true that $G$ must be abelian?

\end{problem} 

\begin{solution}[\bf Solution.]
Let $G$ be the quaternian group $Q_8 = \bra{\pm 1,\pm i,\pm j,\pm k}$ - this is non-abelian, but its subgroups are all normal (to show this it suffices to consider subgroups of order 2 or 4; subgroups for order 4 are normal, and as -1 is the only element of order 2, the only subgroup of order 2 is $\bra{\pm 1}$, which is normal as it is the union of the conjugacy classes $\bra{1}$ and $\bra{-1}$).
\end{solution}

\begin{problem}
Show that $\Q/\Z$ is an infinite group in which every element has finite order.

\end{problem} 

\begin{solution}[\bf Solution.]
$\Q/\Z$ contains distinct cosets $\frac 1n + \Z$ for all $n\in \N$, so is infinite; given a coset $q+\Z$, write $q = \frac ab$ with $a\in \Z,b\in \N$, then $b(q+\Z) = bq + \Z = a +\Z:\Z$, so $q+\Z$ has order at most $b$, i.e., every element of $\Q/\Z$ has finite order.
\end{solution}

\begin{problem}
Let $G$ be the set of all $3 \times 3$ matrices of the form
\be
\bepm
1 & x & y\\
0 & 1 & z\\
0 & 0 & 1
\eepm,
\ee
with $x, y, z \in \R$. Show that $G$ is a subgroup of the group of invertible real matrices under multiplication. Let $H$ be the subset of $G$ given by those matrices with $x = z = 0$. Show that $H$ is a normal subgroup of $G$ and find $G/H$. [Use the isomorphism theorem.]

\end{problem}

\begin{solution}[\bf Solution.]
Since $\bepm 1 & 0 & 0\\ 0 & 1 & 0 \\ 0 & 0 & 1\eepm \in G$, $\bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm^{-1} = \bepm 1 & -x & xz -y\\ 0 & 1 & -z \\ 0 & 0 & 1\eepm \in G$ and $\bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm \bepm 1 & x' & y'\\ 0 & 1 & z' \\ 0 & 0 & 1\eepm = \bepm 1 & x+x' & y+y' + xz'\\ 0 & 1 & z+z' \\ 0 & 0 & 1\eepm\in G$, we see that $G$ is a subgroup of the group of invertible real matrices under multiplication. 

Define $\theta:G \to \R^2$ by $\theta \bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm = (x,z)$ - then from the above
\be
\theta \bb{\bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm \bepm 1 & x' & y'\\ 0 & 1 & z' \\ 0 & 0 & 1\eepm} = (x+x', z+z') = (x,z)+(x' +z') = \theta \bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm+\theta \bepm 1 & x' & y'\\ 0 & 1 & z' \\ 0 & 0 & 1\eepm, 
\ee
so $\theta$ is a homomorphism. Given $(a,b)\in \R^2$ we have $\theta \bepm 1 & a & 0\\ 0 & 1 & b \\ 0 & 0 & 1\eepm = (a,b)$, so $\theta$ is surjective, i.e., $\im \theta = \R^2$; since $\ker \theta = \bra{g\in G:\theta(g)=(0,0)} = \bra{\bepm 1 & x & y\\ 0 & 1 & z \\ 0 & 0 & 1\eepm,x=z=0} = H$, we see that $H$ is normal subgroup of $G$ and $G/H = G/\ker \theta \cong \im \theta = \R^2$.
\end{solution}



\begin{problem}
Consider the additive group $\C$ and the subgroup $\Gamma$ consisting of all Gaussian integers $m+in$, where $m, n \in \Z$. By considering the map
\be
x + iy \mapsto (e^{2\pi ix}, e^{2\pi iy}),
\ee
show that the quotient group $C/\Gamma$ is isomorphic to the torus $S^1 \times S^1$.

\end{problem} 

\begin{solution}[\bf Solution.]

Define $\theta:\C \to S^1 \times S^1$ by $\theta(x+iy) = \bb{e^{2\pi ix}, e^{2\pi iy}}$ - then 
\be
\theta((x+iy)+(x'+iy')) = \theta((x+x') + i(y + y')) =  \bb{e^{2\pi i(x+x')}, e^{2\pi i(y+y')}} = \bb{e^{2\pi ix}, e^{2\pi iy}}\cdot \bb{e^{2\pi ix'}, e^{2\pi iy'}} = \theta (x+iy) \theta (x'+iy'),
\ee
so $\theta$ is a homomorphism (and is visibly surjective). Since 
\be
\ker\theta = \bra{z\in \C:\theta(z) = (1,1)} = \bra{x+iy: e^{2\pi ix} = e^{2\pi iy} = 1} = \bra{m+in:m,n\in \Z} = \Gamma,
\ee
we have $\C/\Gamma = \C/\ker\theta \cong \im \theta = S^1 \times S^1$.

\end{solution}

\begin{problem}
Let $H$ be a subgroup of a group $G$. Show that $H$ is a normal subgroup of $G$ if and only if there is some group $K$, and some homomorphism $\theta : G \to K$, whose kernel is $H$.
\end{problem} 

\begin{solution}[\bf Solution.]
If $H$ is the kernel of a homomorphism it is certainly a normal subgroup of $G$; conversely if $H$ is normal in $G$ we have a quotient group $G/H$ and a quotient map $\theta:G\to G/H$ defined by $\theta (g) = g+H$, and then $\theta$ is a homomorphism whose kernel is $\bra{g\in G:g+H=H} =  H$.
\end{solution}

\begin{problem}
Let $GL(2,\R)$ be the group of all $2 \times 2$ invertible matrices and let $SL(2,\R)$ be the subset of $GL(2,\R)$ consisting of matrices of determinant 1. Show that $SL(2,\R)$ is a normal subgroup of $GL(2,\R)$. Show that the quotient group $GL(2,\R)/SL(2,\R)$ is isomorphic to the multiplicative group of non-zero real numbers.
\end{problem} 

\begin{solution}[\bf Solution.]
Write $\R^*$ for the multiplicative group of non-zero real numbers. Define $\theta: GL(2,\R)\to \R^*$ by $\theta(A) = \det A$ - as $\det AB = \det A \det B$, $\theta$ is a homomorphism (and is surjective since $\det \bepm x & 0 \\ 0 & 1\eepm = x$, $\forall x\in \R^*$). We have 
\be
\ker\theta = \bra{A\in GL(2,\R):\det A =1} = SL(2,\R);
\ee
so $SL(2,\R)$ is a normal subgroup of $GL(2,\R)$, and $GL(2,\R)/SL(2,\R) = GL(2,\R)/\ker\theta \cong \im \theta = \R^*$.
\end{solution}

\begin{problem}
Let $G$ be a finite group and $H \neq G$ a subgroup. Let $k$ be the cardinality of the set of left cosets of $H$ ($k$ is sometimes called the index of $H$) and suppose that $|G|$ does not divide $k!$. Show that $H$ contains a non-trivial normal subgroup of $G$. [Let $G$ act on the set of left cosets and reinterpret the action as a homomorphism from $G$ to the group of permutations of the set of left cosets.] Show that a group of order 28 has a normal subgroup of order 7. [Use Cauchy's theorem.]
\end{problem} 

\begin{solution}[\bf Solution.]
Let $X$ be the set of left coset of $H$ in $G$, i.e., $X = \bra{kH:k\in G}$ - then $G$ acts on $X$ by left multiplication, i.e., $g\cdot kH = gk H$. This gives a homomorphism $\theta : G\to \sym(X)$, where $\theta(g)$ is the bijection which sends each coset $kH$ to $gkH$. Clearly $\ker \theta \leq H$, since $g\in \ker\theta \ \ra \ \forall kH \in X$, $g\cdot kH = kH \ \ra \ g\cdot H = H \ \ra \ g\in H$; we have $G/\ker\theta \cong \im \theta \leq \sym(X)$, so by Lagrange's theorem $\abs{G/\ker\theta}$ must divide $\abs{\sym(x)} = k!$. Since $\abs{G}$ does not divide $k!$, we cannot have $\abs{\ker\theta} = 1$ - so $\ker\theta$ is a non-trivial normal subgroup of $G$ lying in $H$.

Let $G$ be a group of order 28. By Cauchy's theorem $G$ contains an element $g$ of order 7, so $H = \bsa{g}$ is a subgroup of order 7. Since there are $\frac{28}7 = 4$ left cosets of $H$ in $G$, and $28\nmid 24 = 4!$, $H$ contains a non-trivial normal subgroup of $G$ - but the only subgroups of $H$ are itself and $\bra{e}$, so the non-trivial normal subgroup must be $H$. Thus $G$ has a normal subgroup of order 7.
\end{solution}

\begin{problem}
Show that if a group $G$ of order 28 has a normal subgroup of order 4, then G is abelian. [Use previous question. You might wish to note that if $H$ is a subgroup of order 4 and $K$ is a subgroup of order 7, then $H \cap K = {e}$.]
\end{problem} 

\begin{solution}[\bf Solution.]
Let $G$ be a group of order 28; by previous question it has a normal subgroup $H$ of order 7. Assume $G$ also has a normal subgroup $K$ of order 4. By Lagrange's theorem $\abs{H\cap K}$ divides both $\abs{H} = 7$ and $\abs{K} = 4$, so we must have $H\cap K = \bra{e}$. Thus the 28 elements $hk$ for $h\in H$, $k\in K$ must all be distinct (as $hk = h'k' \ \ra \ h'h^{-1} = k'k^{-1} \in H\cap K \ \ ra \ h'h^{-1} = e = k'k^{-1} \ \ra \ h = h',k = k'$), so they form the whole of $G$. Given $h\in H$, $k\in K$, let $x = hkh^{-1}k^{-1}$ - then $x = hkh^{-1}\cdot k^{-1}\in K$ as $hkh^{-1}, k^{-1}\in K$, and also $x = h\cdot kh^{-1}k^{-1}\in H$ as $h,kh^{-1}k^{-1}\in H$ (since both $K$ and $H$ are normal subgroups); so $x\in H\cap K = \bra{e}$, i.e., $hkh^{-1}k^{-1} = e$ or $hk = kh$. Now as both $H$ and $K$ are abelian (as $H$ is cyclic and $K$ is either cyclic or $C_2 \times C_2$), $\forall hk,h'k'\in G$ we have $hk\cdot h'k' = hh' kk' = h'h k'k = h'k'\cdot hk$, so $G$ is abelian.
\end{solution}

\begin{problem}
Let $G$ be a subgroup of the group of isometries of the plane. Show that the set $T$ of translations in $G$ is a normal subgroup of $G$ ($T$ is called the translation subgroup). [If we think of the plane as $\C$ you may assume that all isometries have the form $z \mapsto az + b$ or $z \mapsto a\ol{z} + b$, where $a$ and $b$ are complex numbers and in both cases $|a| = 1$.]
\end{problem} 

\begin{solution}[\bf Solution.]
Take $t\in T$, where $t(z) = z+c$. If $g(z) = az+b$ then $g^{-1}(z) = a^{-1}z-a^{-1}b$, so 
\be
gtg^{-1}(z) = gt\bb{a^{-1}z-a^{-1}b} = g\bb{a^{-1}z-a^{-1}b + c} = z + ac,
\ee
while if $g(z) =a\ol{z} +b$ then $g^{-1}(z) = \ol{a}^{-1}\ol{z}-\ol{a}^{-1}\ol{b}$, so 
\be
gtg^{-1}(z) = gt \bb{\ol{a}^{-1}\ol{z}-\ol{a}^{-1}\ol{b}} = g \bb{\ol{a}^{-1}\ol{z}-\ol{a}^{-1}\ol{b} + c} = z + a\ol{c}
\ee
so if $g\in G$ then $gtg^{-1}$ is a translation in $G$, i.e., $gtg^{-1}\in T$. Thus $T$ is a normal subgroup of $G$.
\end{solution}






\begin{problem}
A frieze group is a group $F$ of isometries of $\C$ that leaves the real line invariant (that is, if $z \in\C$ has zero imaginary part and $g \in F$, then $g(z)$ also has zero imaginary part) and whose translation subgroup $T$ is infinite cyclic. If $F$ is a frieze group, classify $F\bs T$.
\end{problem} 

\begin{solution}[\bf Solution.]
We may assume $T$ is generated by $z\mapsto z+1$. We begin by analysing the possible types of elements of $F\bs T$. An isometry $z\mapsto az +b$ or $z \mapsto a\ol{z} +b$ which leaves $\R$ invariant must have both $a$ and $b$ real, and as $\abs{a} = 1$ this forces $a=\pm 1$. Thus there are three possible types of elements of $F\bs T:(I)z\mapsto -z +b$, $(II) z\mapsto \ol{z}+b$, $(III)z\mapsto -\ol{z}+b$.

Note that if $F$ contains two such elements $f$,$f'$ of the same type, then $f^{-1}f'$ will be a translation, so must lie in $T$ - so $F$ will contain a single coset $fT$ of elments of the type concerned, and it suffices to consider isometries of each type with $0\leq b <1$. Note that in type II, the square of $z\mapsto \ol{z}+b$ is $z\mapsto \ol{(\ol{z}+b)} +b = z + 2b$ which is a translation, so we must have $2b\in \Z$ and hence $b=0$ or $1/2$. Also, any element of type I or type III may be conjugated to $z\mapsto z$ or $z\mapsto -\ol{z}$ respectively.

Now a product of two elements of different types is an element of the third type - thus we may have elements of none, one or all three of the types I, II and III. Write 
\be
f_1(z) = -z,\quad f_2(z) = \ol{z},\quad f_3(z) = \ol{z}+ \frac 1z, \quad f_4(z) = - \ol{z},\quad f_5(z) = - \ol{z}+ \frac 1z.
\ee

Then it follows that $F/T$ is conjugate to one of the following, where we write $\ol{g}$ to denote the coset $gT$, and $e(z) =z$, (i) $\bra{e}$; (ii) $\bra{\ol{e},\ol{f_1}}$; (iii) $\bra{\ol{e},\ol{f_2}}$; (iv) $\bra{\ol{e}, \ol{f_3}}$; (v) $\bra{\ol{e},\ol{f_4}}$; (vi) $\bra{\ol{e},\ol{f_1},\ol{f_2},\ol{f_4}}$; (vii) $\bra{\ol{e},\ol{f_1},\ol{f_3},\ol{f_5}}$. Thus $F/T \cong \bra{e},C_2\text{ or } C_2 \times C_2$. 
\end{solution}

\begin{problem} 
Consider the M\"obius maps $f(z) = e^{2\pi i/n}z$ and $g(z) = 1/z$. Show that the subgroup $G$ of the M\"obius group $M$ generated by $f$ and $g$ is a dihedral group of order $2n$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}Let $g(z) = (z + 1)/(z - 1)$. By considering the points $g(0)$, $g(\infty)$, $g(1)$ and $g(i)$, find the image of the real axis $\R$ and of the imaginary axis $\I$ under $g$. What is $g(\Sigma)$, where $\Sigma$ is the first quadrant in $\C$?

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}What is the order of the M\"obius map $f(z) = iz$? If $h$ is any M\"obius map, find the order of $h f h^{-1}$ and its fixed points. Use this to construct a M\"obius map of order four that fixes 1 and -1.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}


\begin{problem}Show that the set $SL_2(\Z)$ of all $2 \times 2$ matrices of determinant 1 with integer entries is a group under multiplication.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}Let $G$ be the group of M\"obius transformations which map the set $\{0, 1,\infty\}$ onto itself. Find all the elements in $G$. To which standard group is $G$ isomorphic? Justify your answer.

Find the group of M\"obius transformations which map the set $\{0, 2,\infty\}$ onto itself. [Try to do as little calculation as possible.]

\end{problem} 

\begin{solution}[\bf Solution.]


\end{solution}

\begin{problem}Let $G$ be as in the previous question. Show that, given $\sigma\in S_4$, there exists $f_\sigma \in G$ for which, whenever $z_1$, $z_2$, $z_3$ and $z_4$ are four distinct points in $\C_\infty$, we have $f_\sigma([z_1, z_2, z_3, z_4]) = [z_{\sigma(1)}, z_{\sigma(2)}, z_{\sigma(3)}, z_{\sigma(4)}]$.

Show that the map $\sigma \mapsto f_{\sigma^{-1}}$ from $S_4$ to $G$ gives a homomorphism from $S_4$ onto $S_3$. Find its kernel.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}The \emph{centre} of a group $G$ consists of all those elements of $G$ that commute with all the elements of $G$. Show that the centre $Z$ of the general linear group $GL_2(\C)$ consists of all scalar matrices. Identify the centre of the special linear group $SL_2(\C)$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}Let $G$ be the set of all $3\times 3$ real matrices of determinant 1 of the form 
\be
\bepm
a & 0 & 0\\
b & x & y\\
c & z & w
\eepm.
\ee
Verify that $G$ is a group. Find a homomorphism from $G$ onto the group $GL_2(\R)$ of all non-singular $2\times 2$ real matrices, and find its kernel.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}When do two elements of $SO_3$ commute?

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}Let $K$ be a normal subgroup of order 2 in the group $G$. Show that $K$ lies in the centre of $G$, that is $kg = gk$ for all $k \in K$ and $g \in G$.

Describe a surjective homomorphism of the orthogonal group $O(3)$ onto $C_2$ and another onto the special orthogonal group $SO(3)$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}If $A$ is a complex $n \times n$ matrix with entries $a_{ij}$, let $A^*$ be the complex $n \times n$ matrix $\bar{A}^t$ with entries $\bar{a}_{ji}$.

The matrix $A$ is called unitary if $AA^* = I$. Show that the set $U(n)$ of unitary matrices forms a group under matrix multiplication. Show that
\be
SU(n) = \{A \in U(n) : \det A = 1\}
\ee
is a normal subgroup of $U(n)$ and that $U(n)/SU(n)$ is isomorphic to $S^1$, the group of the unit circle in $\C$ under multiplication. Show that $SU(2)$ contains the quaternion group $Q_8$ as a subgroup.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}

\begin{problem}Let $G$ be the special linear group $SL_2(5)$ of $2\times 2$ matrices of determinant 1 over the field $\F_5$ of integers modulo 5, so that the arithmetic in $G$ is modulo 5. Show that $G$ is a group of order 120. Prove that $-I$ is the only element of $G$ of order 2.

Find a subgroup of $G$ of order 8 isomorphic to $Q_8$, and an element of order 3 normalising it in $G$. Deduce that $G$ has a subgroup of index 5, and obtain a homomorphism from $G$ to $S_5$. Deduce that $SL_2(5)/\{\pm I\}$ is isomorphic to the alternating group $A_5$. Show that $SL_2(5)$ has no subgroup isomorphic to $A_5$.

\end{problem} 

\begin{solution}[\bf Solution.]

\end{solution}



\begin{problem}What is the largest possible order of an element in $S_5$? And in $S_9$? Show that every element in $S_{10}$ of order 14 is odd.

\end{problem} 

\begin{solution}[\bf Solution.]Largest order of an element in $S_5$ is 6, with cycle type 32 (e.g. (123)(45)); in $S_9$ it is 20, with cyple type 54 (e.g. (12345)(6789)). In $S_{10}$ on element of order 14 must have cycles of lengths divisible by 7 and 2, so its cycle type is 721, giving sign $(-1)^{6+1} = -1$, i.e., it is odd. 

\end{solution}

\begin{problem} Show that any subgroup of $S_n$ which is not contained in $A_n$ contains an equal number of odd and even permutations.

\end{problem} 

\begin{solution}[\bf Solution.]Let $H\leq S_n$ with $H\nleq A_n$, and take $\pi \in H\bs A_n$. Then $x\mapsto \pi x$ is a map from $H\cap A_n$ to $H\bs A_n$ (since if $x$ is even, $\pi x$ is odd); it is injective as $\pi x = \pi y \ \ra \ x = y$, and it is surjective because if $z\in H\bs A_n$ then $\pi^{-1}z\in H\cap A_n$ so it is bijective, so $\abs{H\cap A_n} = \abs{H\bs A_n}$, i.e., $H$ contains an equal number of odd and even permutations.

\end{solution}

\begin{problem} Let $N$ be a normal subgroup of the orthogonal group $O(2)$. Show that if $N$ contains a reflection in some line through the origin, then $N = O(2)$.

\end{problem} 

\begin{solution}[\bf Solution.]Take $r\in N$ a reflection about an axis $l$. If $r'$ is another reflection in $O(2)$, about an axis $l'$, let $p\in O(2)$ be a rotation which sends $l$ to $l'$; then $prp^{-1}$ is reflection with $prp^{-1}(l') = pr(l) = p(l) = l'$, i.e., $prp^{-1} = r'$ - so as $N\lhd O(2)$ we have $r'\in N$. Now let $p \in O(2)$ be a rotation; then $pr\in O(2)$ is a reflection, so $pr\in N$, so $p\in N$. Thus $N = O(2)$.

\end{solution}

\begin{problem} Show that $S_n$ is generated by the two elements (12) and $(123 \dots n)$.

\end{problem} 

\begin{solution}[\bf Solution.]Let $H = \bsa{(12),(123\dots n)}$. We have $(123\dots n)(12)(123\dots n)^{-1} = (23)$, then $(123\dots n)(23)(123\dots n)^{-1} = (34)$ - in general $(123\dots n)^k(12)(123\dots n)^{-k} = (k+1\ k+2)$, so $H$ contains $(12),(23),\dots (n-1\ n)$. Now if $i<j$ we may write $(i\ j) = (i\ i+1)(i+1\ i+2)\dots (j-2\ j-1)(j-1\ j)(j-2\ j-1) \dots (i+1\ i+2)(i \ i+1)$; so $H$ contains all transpositions. Since any element of $S_n$ is a product of transpositions, we have $H=S_n$, i.e., $S_n$ is generated by $(12)$ and $(123\dots n)$.

\end{solution}

\begin{problem}
Let $H$ be a normal subgroup of a group G and let $K$ be a normal subgroup of $H$. Is it true that $K$ must be a normal subgroup of $G$?
\end{problem} 

\begin{solution}[\bf Solution.]Let $G=S_4$, $H=\bsa{(12)(34),(13)(24)}$ and $K = \bsa{(12)(34)}$ - then $H\lhd G$ since it is the union of the conjugacy classes $\bra{1}$ and $\bra{(12)(34),(14)(23)}$, and $K \lhd H$ as $H$ is abelian, but $K\ntriangleleft G$ as $(13)(12)(34)(13) = (14)(23)\notin K$.

\end{solution}

\begin{problem} Find the elements in $S_n$ that commute with (12).

\end{problem} 

\begin{solution}[\bf Solution.]Take $\pi\in S_n$ commuting with $(12)$ - then $K=\bsa{(12)(34)}$ - then $\pi(1) = \pi(12)(2) = (12)\pi (2)$, so (12) sends $\pi(1)$ to $\pi(2)$ so $\bra{\pi(1),\pi(2)} = \bra{1,2}$, so $\pi$ either fixes or interchanges 1 and 2. Conversely such a permutation clearly commutes with (12).

\end{solution}

\begin{problem} Let $z_1$, $z_2$, $z_3$ and $z_4$ be four distinct points in $\C_\infty$ and let $\lm = [z_1, z_2, z_3, z_4]$ be the cross ratio of the four points. Let $G$ be the group of M\"obius maps which map the set $\bra{0,1,\infty}$ onto itself. Show that given $\sigma \in S_4$, there exists $f_\sigma \in G$ such that $f_\sigma (\lm) = [z_{\sigma(1)}, z_{\sigma(2)}, z_{\sigma(3)}, z_{\sigma(4)}]$.

\end{problem} 

\begin{solution}[\bf Solution.]We know that $\bsb{z_1,z_2,z_3,z_4} = \bsb{w_1,w_2,w_3,w_4} \ \lra \ \exists $ a M\"obius map $g$ with $g(z_j) = w_j$ for $j= 1,2,3,4$. Thus gives $\sigma \in S_4$, the map $f_8:\C_\infty \to \C_\infty$ defined by $f_\sigma([z_1,z_2,z_3,z_4]) = [z_{\sigma(1)},z_{\sigma(2)},z_{\sigma(3)},z_{\sigma(4)}]$ is well-defined, because if $[z_1,z_2,z_3,z_4] = [w_1,w_2,w_3,w_4]$ $\exists $ a M\"obius map $g$ with $g(z_j) = w_j$ for all $j$, and then 
\be
\bsb{z_{\sigma(1)},z_{\sigma(2)},z_{\sigma(3)},z_{\sigma(4)}} = \bsb{g(z_{\sigma(1)}),g(z_{\sigma(2)}),g(z_{\sigma(3)}),g(z_{\sigma(4)})} = \bsb{w_{\sigma(1)},w_{\sigma(2)},w_{\sigma(3)},w_{\sigma(4)}};
\ee
we must shwo that $f_\sigma \in G$. Given $\sigma,\pi\in S_4$, for $1\leq j\leq 4$ set $w_j = z_{\sigma(j)}$,
\beast
f_\pi\bb{f_\sigma(\lm)} & = & f_\pi\bb{\bsb{z_{\sigma(1)},z_{\sigma(2)},z_{\sigma(3)},z_{\sigma(4)}}} = f_\pi \bb{\bsb{w_1,w_2,w_3,w_4}} \\
& = & \bsb{w_{\pi(1)},w_{\pi(2)},w_{\pi(3)},w_{\pi(4)}} = \bsb{z_{\sigma\pi(1)},z_{\sigma\pi(2)},z_{\sigma\pi(3)},z_{\sigma\pi(4)}} = f_{\sigma \pi}(\lm),
\eeast
so $f_\pi f_\sigma = f_{\sigma \pi}$, $f_\pi f_\sigma = f_{\pi^{-1}}f_{\sigma^{-1}} = f_{\sigma^{-1} \pi^{-1}} = f_{(\pi \sigma)^{-1}}$, so the map sending $\sigma$ to $f_{\sigma^{-1}}$ is a group homomorphism from $S_4$ into the group of invertible maps $\C_\infty \to \C_\infty$. Now let $g$ be the M\"obius map sending $z_1,z_2,z_3$ to 0,1,$\infty$ respectively - then 
\be
\lm = [z_1,z_2,z_3,z_4] = [g(z_1),g(z_2),g(z_3),g(z_4)] = [0,1,\infty,g(z_4)] = g(z_4).
\ee

Thus 
\be
f_{(12)}(\lm) = [z_2,z_1,z_3,z_4] = [g(z_2),g(z_1),g(z_3),g(z_4)] = [1,0,\infty,\lm] = \frac{(\lm-1)(0-\infty)}{(\lm -\infty)(0-1)} = 1-\lm,
\ee
while 
\be
f_{(1234)}(\lm) = [z_2,z_3,z_4,z_1] = [g(z_2),g(z_3),g(z_4),g(z_1)] = [1,\infty,\lm, 0] = \frac{(0-1)(\infty-\lm)}{(0-\lm)(\infty-1)} = \frac 1{\lm}.
\ee

So $f_{(12)},f_{(1234)}\in G$, so as (12) and (1234) generate $S_4$ by previous question and $\sigma \mapsto f_{\sigma^{-1}}$ is a homomorphism, we must have $f_{\sigma}\in G, \forall \sigma \in S_4$.
\end{solution}

\begin{problem} Show that the map $S_4 \ni \sigma \mapsto f_{\sigma^{-1}} \in G \cong S_3$ given by the previous question is a surjective homomorphism. Find its kernel.

\end{problem} 

\begin{solution}[\bf Solution.]In previous question we showed that $\sigma \mapsto f_{\sigma^{-1}}$ is a homomorphism $S_4\to G$ - as $f_{(12)}$ and $f_{(1234)}$ generate $G$, the homomorphism is surjective. Thus if $K$ is the kernel, then $\abs{K} = \frac{\abs{S_4}}{\abs{G}} = \frac{24}6 = 4$ - we have 
\be
f_{(12)(34)}(\lm) = \bsb{z_2,z_1,z_4,z_3} = \frac{(z_3-z_2)(z_1 -z_4)}{(z_3-z_4)(z_1-z_2)} = \lm,\quad f_{(13)(24)}(\lm) = \bsb{z_3,z_4,z_1,z_2} = \frac{(z_2-z_3)(z_4-z_1)}{(z_2-z_1)(z_4-z_3)} = \lm,
\ee
so $(12)(34),(13)(24)\in K$, thus as $\abs{\bsa{(12)(34),(13)(24)}} = 4$ we must have $K = \bsa{(12)(34),(13)(24)}$.

\end{solution}

\begin{problem} Let $X$ be the set of all $2 \times 2$ real matrices with trace zero. Given $A \in SL(2,\R)$ and $B \in X$, show that $(A,B) \mapsto ABA^{-1}$ defines an action of $SL(2,\R)$ on $X$. Find the orbit and stabilizer of
\be
B = \bepm 0 & 1\\ 0 & 0\eepm.
\ee

Show that the set of matrices in $X$ with zero determinant is a union of 3 orbits.

\end{problem} 

\begin{solution}[\bf Solution.]If $\tr B = 0$ then $\tr(ABA^{-1}) = \tr(A^{-1}AB) = \tr(B) = 0$, so $ABA^{-1}\in X$ - clearly $IBI^{-1} = B$, and given $A,A'\in SL(2,\R)$ we have 
\be
\rho(A,\rho(A',B)) = \rho(A,A'BA^{-1}) = AA' BA'^{-1}A^{-1} = (AA')B(AA')^{-1} = \rho(AA',B),
\ee
so $(A,B)\mapsto ABA^{-1}$ defines on action of $SL(2,\R)$ on $X$.

If $A = \bepm a & b\\ c& d \eepm \in SL(2,\R)$, then 
\be
A\bepm 0 & 1 \\ 0 & 0 \eepm A^{-1} = \bepm a & b\\ c& d \eepm \bepm 0 & 1\\ 0 & 0 \eepm \bepm d & -b\\ -c & a \eepm  = \bepm 0 & 0\\ 0 & c \eepm \bepm d & -b\\ -c & a \eepm = \bepm -ac & a^2\\ -c^2 & ac \eepm;
\ee
so the orbit of $B = \bepm 0 & 1\\ 0 & 0 \eepm$ is
\be
\bra{\bepm -ac & a^2\\ -c^2 & ac \eepm:a,c\in \R,(0,c)\neq (0,0)},
\ee
and $A\in \stab(B)\ \lra\ c=0,a=\pm 1$ so the stabilizer of $B$ is $\bra{\pm \bepm 1 & b\\ 0 & 1\eepm:b\in \R}$. Likewise if $C= \bepm 0 & 0 \\ 1& 0 \eepm$ then 
\be
ACA^{-1} = \bepm a & b \\ c & d \eepm \bepm 0 & 0 \\ 1& 0 \eepm\bepm d & -b \\ -c & a \eepm = \bepm b & 0 \\ d & 0 \eepm\bepm d & -b \\ -c& a \eepm = \bepm bd & -b^2 \\ d^2 & -bd \eepm
\ee
so the orbit of $C$ is $\bra{\bepm bd & -b^2 \\ d^2 & -bd \eepm: b,d\in \R, (b,d)\neq (0,0)}$. Now if $M= \bepm u & v \\ w & -u \eepm \in X$ with $\det M = 0$, then $-u^2 - vw = 0$, so $vw = -u^2 \leq 0$. So either $v\geq 0\geq w$ or $v\geq 0 \geq w$ and $(v,w)\neq (0,0)$, let $a= \sqrt{v}$, $c=\pm \sqrt{-w}$ then $(ac)^2= -vw = u^2$, so we may choose the sign of $c$ to ensure $ac=-u$, and then $M = \bepm ac & a^2 \\ -c^2 & ac \eepm$ so $M$ lie in the orbit of $B$. Simiarly if $w\geq 0\geq v$ and $(v,w)\neq (0,0)$, let $b=\sqrt{-v}$, $d = \pm \sqrt{w}$ - then $(bd)^2 = -vw = u^2$, so we may choose the sign of $d$ to ensure $bd = u$, and then $M = \bepm bd & -b^2 \\ d^2 & -bd \eepm$ so $M$ lies in the orbit of $C$. Finally if $v=w=0$ then $u^2 = 0$ so $u=0$, and $M = \bepm 0 & 0 \\ 0 & 0 \eepm$ (which of course is an orbit on its own). Thus the set of matrices in $X$ with zero determinant is the union of the orbit of $B,C$ and $\bepm 0 & 0 \\ 0 & 0 \eepm$.
\end{solution}

\begin{problem} When do two elements in $SO(3)$ commute?

\end{problem} 

\begin{solution}[\bf Solution.]Take $A,B\in SO(3)$ having axes $l,m$ - then $BAB^{-1}$ has axis $B(l)$, so it $A$ and $B$ commute then $B(l) =l$. If $B$ presents the orientation of $l$, it fixes $l$ pointwise, so we must have $m=l$, i.e., $A$ and $B$ have the same axis. If instead $B$ reverses $l$, then $B$ must be a rotation by $\pi$, and $m$ must be orthogonal to $l$; arguing similarly with $ABA^{-1}$ we see that $A$ and $B$ are both rotations by $\pi$ about orthogonal axes.
\end{solution}

\begin{problem} 
If $A$ is a complex $n \times n$ matrix with entries $a_{ij}$, let $A^*$ be the complex $n\times n$ matrix with entries $\ol{a_{ji}}$. The matrix $A$ is called unitary if $AA^* = I$. Show that the set $U(n)$ of unitary matrices forms a group under matrix multiplication. Show that
\be
SU(n) = \bra{A \in U(n) : \det A = 1}
\ee
is a normal subgroup of $U(n)$ and that $U(n)/SU(n)$ is isomorphic to $S^1$. Show that $SU(2)$ contains the quaternion group $Q_8$ as a subgroup.

\end{problem} 

\begin{solution}[\bf Solution.]
Certainly if $A\in U(n)$ then $A$ is invertible, so $U(n) \subseteq GL(n)$; we have $II^* = II = I$ so $I \in U(n)$; given $A,B\in U(n)$ we have $AA^* = BB^* = I$, so $(AB)(AB)^* = ABB^*A^* = AA^* = I$, so $AB\in U(n)$; given $A\in U(n)$ we have $AA^* = I$, so $A^{-1} = A^*$, so
\be
A^{-1}(A^{-1})^* = A^{-1}A = I \ \ra \ A^{-1} = U(n).
\ee

Thus $U(n)$ is a group. Define $\theta : U(n) \to \C^\times$ by $\theta(A) =\det(A)$ - then $\theta$ is a homomorphism with kernel $SU(n)$; if $A\in U(n)$ then we have $1=\det AA^* =\det A \det A^* = (\det A)\ol{(\det A)}$, so $\det A\in S^1$, i.e., $\im\theta \leq S^1$; given $z\in S^1$, let $A =\bepm z_1 & & \\ & \ddots & \\ & & 1 \eepm$, then $A\in U(n)$ and $\det(A) = 2$, so $\im \theta = S^1$. Hence $SU(n)\lhd U(n)$ and $U(n)/SU(n) = U(n)/\ker\theta \cong \im \theta = S^1$.

In $SU(2)$ write $1 = \bepm 1 & \\ & 1\eepm$, $i = \bepm i & \\ & -i\eepm$, $j = \bepm & 1 \\ -1 & \eepm$, $k = \bepm & i \\ i & \eepm$ - then $i^2 = j^2 = k^2 = ijk = -1$, so $\bra{\pm 1,\pm i,\pm j, \pm k} = Q_8$.
\end{solution}

\begin{problem} 
Show that any subgroup of $A_5$ has order at most 12. [Use Question in Example Sheet 3.]
\end{problem} 

\begin{solution}[\bf Solution.]
Take $H\leq A_5$ and suppose $\abs{H}>12$ - then there are at most 4 left cosets of $H$ in $A_5$, so by previous of sheet 3 $H$ contains a non-trivial normal subgroup of $A_5$; as $A_5$ is simple this normal subgroup must be $A_5$ itself, so we must have $H=A_5$. Thus any prper subgroup of $A_5$ has order at most 12.

\end{solution}

\begin{problem} Let $G$ be a finite non-trivial subgroup of $SO(3)$. Let $X$ be the set of points on the unit sphere in $\R^3$ which are fixed by some non-trivial rotation in $G$. Show that $G$ acts on $X$ and that the number of orbits is either 2 or 3. What is $G$ if there are only two orbits? [With more work one can show that if there are three orbits, then $G$ must be dihedral or the group of rotational symmetries of a Platonic solid.]

\end{problem} 

\begin{solution}[\bf Solution.]
Take $x\in X$, so $\exists g\in G$ non-trivial with $gx = x$; gives $h\in G$, we have $hgh^{-1}$ non-trivial and $(hgh^{-1})(hx) = hgx = hx$, so that $hx$ is fixed by $hgh^{-1}$ and therefore lies in $X$. Hence we have a map $\rho:G\times X \to X$ given by $\rho(h,x) = hx$; certainly $\rho(I,x) =x$, $\forall x\in X$, and $\rho(g,\rho(h,x)) = \rho(g,hx) = g(hx) = \rho(gh,x)$, so $\rho$ is an action. 

Set $\Gamma = \bra{(g,x)\in G\times X: gx = x}$, and let the orbits of $G$ on $X$ be $O_1,\dots, O_k$. By the orbit-stabilizer theorem, if $x\in O_i$ then $\abs{\stab(x)} = \frac{\abs{G}}{\abs{O_i}}$. Thus 
\be
\abs{\Gamma} = \sum^k_{i=1}  \sum_{x\in O_i}\abs{\stab(x)} = \sum^k_{i=1} \sum_{x\in O_i} \frac{\abs{G}}{\abs{O_i}} = \sum^k_{i=1} \abs{O_i} \cdot \frac{\abs{G}}{\abs{O_i}} = \sum^k_{i=1}\abs{G} = k\abs{G} .
\ee

On the other hand, if $g\in G$ is non-trivial then $g$ fixes just 2 points in $X$ (while $I$ fixes all points in $X$), so $\abs{\Gamma} = \abs{X} + 2(\abs{G}-1)$, so $\abs{X} + 2\abs{G}-2 = k\abs{G}$. So $\abs{X} -2 = (k-2)\abs{G}$ - as $G$ is non-trivial $\exists$ at least 2 points in $X$, so $(k-2)\abs{G}\geq 0$ and hence $k\geq 2$; on the other hand $\abs{X} leq 2(\abs{G}-1)$ since each non-identity element of $G$ contributes just 2 points to $X$, so $(k-2)\abs{G} \leq 2(\abs{G}-1)-2 = 2\abs{G} -4$, so $k =2$ or 3, i.e., the number of orbits is 2 or 3. If $k=2$ then $\abs{X}-2 = 0$ so $\abs{X}=2$, and thus all elements of $G$ have the same axis. So $G$ is cyclic.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\chapter{Rings}

\subsection{Rings Problems}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}\label{que:nilpotent} 
An element $r$ of a ring $R$ is nilpotent if $r^n = 0$ for some $n$.
\ben
\item [(i)] What are the nilpotent elements of $\Z/6\Z$? Of $\Z/8\Z$? Of $\Z/24\Z$? Of $\Z/1000\Z$?
\item [(ii)] Show that if $r$ is nilpotent then $r$ is not a unit, but $1 + r$ and $1 - r$ are units.
\item [(iii)] Show that the nilpotent elements form an ideal $N$ in $R$. What are the nilpotent elements in the quotient ring $R/N$?
\een
\end{problem}


\begin{solution}
\ben
\item [(i)] 0; 0,2,4,6; 0,6,12,18.
\item [(ii)] If $r$ is nilpotent then $r^n = 0$ for some $n$. Suppose $ra = 1$, then $r^n a^n = 1$ and thus $0 \cdot a^n =1$. Contradiction.

However,
\beast
1 & = & 1+r^n = (1+r)(1-r+r^2 - r^3 + \dots + (-1)^{n-1}r^{n-1})\\
1 & = & 1-r^n = (1-r)(1+r+r^2 + r^3 + \dots + r^{n-1})
\eeast

Thus, $1\pm r$ are units.

\item [(iii)] Let $N = \bra{r:r^n = 0\text{ for some }n}$. $\forall a,b\in N$, then $a^m = 0$ and $b^n = 0$ for some $m,n$. Wlog, take $m\geq n$, so $a^m = b^m = 0$. Then for $a+b$
\be
(a+b)^{2m} = \sum^{2m}_{i=0} \binom{2m}{i}a^i b^{2m-i}.
\ee

Thus, for each $i$, either $a^i = 0$ or $b^{2m-i} = 0$. So $(a+b)^{2n} = 0 \ \ra \ a+b \in N$. Associativity is clear. Also $0^1 = 0$ so $0\in N$. If $a\in N \ \ra \ a^n = 0$ for some $n$. Then $(-a)^n = (-1)^n a^n = 0$ so $-a\in N$.

For the strong closure property, $\forall a\in N,r\in R$, we have
\be
(ar)^n = a^n r^n = 0  \ \ra \ ar \in N
\ee

Thus, $N$ is an ideal in $R$.

The quotient ring elements have the form $ar$, $a\in N,r\in R$. Thus, $(ar)^n = 0$ for some n. Thus, elements of $R/N$ are all the nilpotent elements.

\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $r$ be an element of a ring $R$. Show that, in the polynomial ring $R[X]$, the polynomial $1+rX$ is a unit if and only if $r$ is nilpotent. Is it possible for the polynomial $1 + X$ to be a product of two non-units?
\end{problem}

\begin{solution}[\bf Solution.]
$\ra$. Assume $1+rX$ is a unit, then there exists $a_0 + a_1X + \dots + a_n X^n \in R[X]$ s.t. $(1+rX)(a_0 + a_1X + \dots + a_n X^n) = 1, \ a_n \neq 0$
\be
a_0 = 1,\ ra_n = 0,\ a_{k+1} = -ra_k, \ k=1,\dots,n-1 \ \ra \  a_n = r^n (-1)^n \ \ra \ r^{n+1}(-1)^n = 0 \ \ra \ r^{n+1} = 0.
\ee

Thus, $r$ is nilpotent.

$\la$. If $r$ is nilpotent. Then $r^n = 0$ for some $n$ and for $(1-rX + (rX)^2 + \dots + (rX)^{n-1}(-1)^{n-1})$,
\be
1 = 1+ (rX)^n = (1+rX)(1-rX + (rX)^2 + \dots + (rX)^{n-1}(-1)^{n-1}).
\ee

Thus, $1+rX$ is a unit.

Let $R = \Z/6\Z$. So $R[X]$ has coefficient $\bra{0,1,2,3,4,5}$ and 
\be
(1+3X)(1+4X) = 1 + 7X + 12 X^2 = 1+ X \text{ in $R[X]$}.
\ee

Since 3,4 are not nilpotent in $\Z/6\Z$ by Question \ref{que:nilpotent}, thus, by the previous result, $1+3X$ and $1+4X$ are not units.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\ben
\item [(i)] Show that if $I$ and $J$ are ideals in the ring $R$, then so is $I \cap J$, and the quotient $R/(I \cap J)$ is isomorphic to a subring of the product $R/I \times R/J$.
\item [(ii)] Show that if $p$ and $q$ are coprime integers, then $\Z/p\Z \times \Z /q\Z$ is isomorphic to $\Z/pq\Z$.
\een
\end{problem}

\begin{solution}
\ben
\item [(i)] Clearly, $I\cap J$ is a subgroup under addition. For multiplication, if $a\in I\cap J$, $a\in I$ and $a\in J$, then, $\forall r\in R$, $ar\in I$ and $ar\in J$, so $ar \in I\cap J$, so $I\cap J\lhd R$.

%Now we show that $R/(I \cap J)$ is well-defined.

Consider $\phi:R \to R/I \times R/J$ by $phi(r) = (r+I,r+J)$. It is clearly well-defined and 
\beast
\phi(r_1 + r_2) & = & (r_1+r_2 + I, r_1 + r_2 + J) = (r_1 + I,r_1 + J) + (r_2+I,r_2 +J) = \phi(r_1) + \phi(r_2),\\
\phi(r_1r_2) & = & (r_1r_2 + I, r_1 r_2 + J) = (r_1+I, r_1+J)(r_2+I,r_2 +J) = \phi(r_1)\phi(r_2),\\
\phi(1) & = & (1+I,1+J).
\eeast

So $\phi$ is homomorphism and 
\be
\ker\phi = \bra{r\in R:r+I = I,r+J = J} = \bra{r\in R:r\in I,r\in J} = I \cap J.
\ee

Then by first isomorphism theorem, $R/(I\cap J) \cong \im(\phi) \leq R/I \times R/J$.

\item [(ii)] Now $I \cap J$ is $p\Z\cap q\Z$. Since $p,q$ are coprime, $I \cap J = p\Z\cap q\Z = pq\Z$. %Also, the function $\phi$ defined above is injective since $\ker \phi = I\cap J = \bra{0}$ (see groups under addition (homomorphism is injective iff ker is identity)). Furthermore, 
Also,
\be
\abs{\Z/p\Z \times \Z/q\Z} = pq = \abs{\Z/pq\Z} \ \ra \ \im(\phi) = \Z/p\Z \times \Z/q\Z .
\ee
%so $\phi$ is surjective. Thus, $\phi$ is bijective and 

Thus, by first isomorphism theorem and previous result ($(R/(I\cap J) \cong \im(\phi) \leq R/I \times R/J)$), $\Z/p\Z \times \Z /q\Z$ is isomorphic to $\Z/pq\Z$.
\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\ben
\item [(i)] A proper ideal $P$ of the ring $R$ is prime if $rs \in P \ \ra \ r \in P$ or $s \in P$, for all $r, s \in R$.
Let $I$ be an ideal of the ring $R$ and $P_1, \dots, P_n$ be prime ideals of $R$. Show that if $I \subset \cup^n_{i=1} P_i$, then $I \subset P_i$ for some $i$.
\item [(ii)] A proper ideal $M$ of the ring $R$ is maximal if no proper ideal strictly contains it (i.e. $M \subset I \subset R \ \ra \ I = M$ or $I = R$).

Show that $(2,X)$ is maximal in $\Z[X]$ but that $(2,X^2 + 1)$ is not.
\item [(iii)] Show that a maximal ideal is a prime ideal.
\een
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $I_1 \subseteq I_2 \subseteq I_3 \subseteq \dots$ be ideals in a ring $R$. Show that the union $I = \cup^\infty_{n=1} I_n$ is also an ideal. If each $I_n$ is proper, explain why $I$ must be proper. If each $I_n$ is prime, show that $I$ must be prime.
\end{problem}

\begin{solution}[\bf Solution.] 
\ben
\item [(i)] Closure, associativity, identity and inverses under addition follow from the fact that $(I_n,+) \leq (R,+)$. Hence, $(I,+) \leq (R,+)$.

For multiplication, we see that if $a \in I$, then $a\in I_n$ for some $n$, so $\forall r\in R$, $ar \in I_n \in I$. So $I$ is an ideal.

\item [(ii)] If $I_n$ is proper ($I \neq R$), then $1\notin I_n$, otherwise, $\forall r\in R$, $1\cdot r = r \in I$ and thus $I = R$. Since each $I_n$ is proper, $1\notin I$, so $I$ is not proper. %If $I$ is not proper, $I =R$, then $1\in I$, there must exists $I_n$ s.t. $1 \in I$ for some $n$, thus $I_n$ is not proper. Thus, If each $I_n$ is proper, then $I$ must be proper. %$1\notin I_n$ for all $n$. Otherwise, $I_n =R$ for some $n$ and $I = R$

\item [(iii)] If $I_n$ are prime for all $n$, then whenever $ab\in I_n$, either $a\in I_n$ or $b\in I_n$. Then whenever $ab\in I$, we have $ab\in I_n$ for some $I_n$, then $a\in I_n \subseteq I$ or $b\in I_n \subseteq I$. Thus, $I$ is prime. 
\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $R$ be the ring $C[0,1]$ of continuous real-valued functions on [0,1], and let $I = \bra{f\in R:f(x) = 0,x\in [0,\frac 12]}$. Show that $I$ is an ideal. What is $R/I$?
\end{problem}

\begin{solution}[\bf Solution.]
Addition is clearly a group (use $f(x) +g(x) = (f+g)(x)$). Multiplication is closed, for $f\in I$, take $r(x) \in C[0,1]$, then $fr \in C[0,1]$ and $fr(x) = 0$ for $x\in [0,\frac 12]$, $fr \in I$. Thus, $I \lhd R$.

Let $\theta:R \to C[0,\frac 12]$ by $\theta(f(x)) = f_{\frac 12} (x)$ where $f_{\frac 12}(x) = f(x)$ for $x\in [0,\frac 12]$. Clearly, $\ker\theta = I$ and $\theta$ is a projective map, so it is homomorphism. 

Now check that $\im(\theta) = C[0,\frac 12]$. Given any $f_{\frac 12}(x) = C[0,\frac 12]$, we find $f(x)$ by 
\be
f(x) = \left\{ \ba{ll}
f_{\frac 12}(x) \quad\quad & x\in [0,\frac 12]\\
f_{\frac 12}(\frac 12) & x\in [\frac 12 ,1]
\ea\right.
\ee

So $\im(\theta) = C[0,\frac 12]$. By using first isomorphism theorem, 
\be
R/I \cong \im(\theta) = C\bsb{0,\tfrac 12}.
\ee
\end{solution}

\begin{problem}
Let $R$ be an integral domain and $\F$ be its field of fractions. Suppose that $\phi : R \to K$ is an injective ring homomorphism from $R$ to a field $K$. Show that $\phi$ extends to an injective homomorphism $\Phi : F \to K$ from $F$ to $K$. What happens if we do not assume that $\phi$ is injective?
\end{problem}

\begin{solution}[\bf Solution.]
Let $\Phi:\F\to K$ by $\Phi(ab^{-1}) = \phi(a)\bb{\phi(b)}^{-1}$ for $a,b\in R, b^{-1}\in \F$.

This function is well-defined because
\ben
\item [(i)] $K$ is a field, so $\phi(b) \in K$, its inverse $\phi(b)^{-1}$ exists.
\item [(ii)] $\phi$ is injective, so for $b\neq 0$, $\phi(b) \neq 0$.
\item [(iii)] Suppose that $ab^{-1} = cd^{-1}$, $ad = bc$, since $\phi$ is a homomorphism,
\be
\phi(ad) = \phi(bc) \ \ra \ \phi(a)\phi(d) = \phi(b)\phi(c) \ \ra \ \phi(a)\phi(b)^{-1} = \phi(c)\phi(d)^{-1}.
\ee
\een

Then for $a_1,b_1,a_2,b_2\in R$ and $b_1^{-1},b_2^{-1} \in \F$. Thus,
\beast
\Phi\bb{a_1b_1^{-1}+a_2b_2^{-1}} = \Phi\bb{\frac{a_1b_2 + a_2b_1}{b_1b_2}} & = & \phi(a_1b_2 + a_2b_1)\phi(b_1b_2)^{-1} = \bb{\phi(a_1)\phi(b_2) + \phi(a_2)\phi(b_1)}\phi(b_1)^{-1}\phi(b_2)^{-1}\\
& = & \phi(a_1)\phi(b_1)^{-1} + \phi(a_2)\phi(b_2)^{-1} = \Phi(a_1 b_1^{-1}) + \Phi(a_2 b_2^{-1}).
\eeast

\beast
\Phi\bb{a_1b_1^{-1}a_2b_2^{-1}} & = & \phi(a_1a_2)\phi(b_1b_2)^{-1} = \phi(a_1)\phi(a_2)\phi(b_1)^{-1}\phi(b_2)^{-1} = \Phi(a_1b_1^{-1}) \Phi(a_2b_2^{-1}).
\eeast

\be
\Phi(1) = \phi(1) = 1.
\ee

So $\Phi$ is a homomorphism. If $\Phi(a_1b_1^{-1}) = \Phi(a_2b_2^{-1})$, 
\be
\phi(a_1)\phi(b_1)^{-1} = \phi(a_2)\phi(b_2)^{-1} \ \ra \ \phi(a_1b_2) = \phi(a_2 b_1) \ \ra \ a_1b_2 = a_2b_1 \ \ra \ a_1b_1^{-1} = a_2b_2^{-1}.
\ee
since $\phi$ is injective. So $\Phi$ is also injective.

If $\phi$ is not injective, there exists $a\neq b$ s.t. $\phi(a) = \phi(b)$ thus there exists $c \neq 0$ s.t. $\phi(c) = 0$. Thus, $\ker \Phi \neq \bra{0}$. Since $\F$ is a field, $\ker\Phi$ is either $\bra{0}$ or $\F$. So $\ker \Phi = \F$. So $K = \bra{0}$.

(Or we can see that $\exists \phi(r) = 0$, $r\neq 0$ in $R$. So to define $\Phi(r^{-1})$, $\Phi(r^{-1}) = \phi(1)\phi(r)^{-1} = \phi(r)^{-1} = 0^{-1} = 0$.)
\end{solution}

%\begin{problem}
%Let $R$ be any ring. Show that the ring $R[X]$ is a principal ideal domain if and only if $R$ is a field.
%\end{problem}

%\begin{solution}[\bf Solution.]
%($\la$). Suppose $R$ is a field and for any $I \lhd R[X]$, we take $f\in I$ with the least degree, then for any $g\in I$, by Euclid's algorithm for polynomials (Proposition \ref{pro:euclid_algorithm_polynomial}), we can find $q(X)$ and $r(X)\in I$,
%\be
%g(X) = q(X)f(X) + r(X)
%\ee
%with $\deg r < \deg f$. Since $f$ has the least degree, we have $r = 0$ and for any $g(X)\in I$, $f(X)|g(X)$. Thus, $I = \bsa{f(X)}$. Thus, $R[X]$ is PID.

%($\ra$). Suppose $R[X]$ is a PID, for any $a\in R$, we construct $I = \bsa{a,X}$ for $a\neq 0 \in R$. Also, we can find $b\in R$ such that $I = \bsa{b}$ since $R[X]$ is PID. Thus, we can find $f(X) = a_0 + a_1 X + \dots \in R[X], a_0,a_1,\dots \in R$ such that
%\be
%bf = a+X \ \ra \ b(a_0 + a_1X + \dots ) = a+X \ \ra \ ba_1 = 1.
%\ee

%So $b$ is a unit. So $1\in b R[X] = \bsa{b} = \bsa{a,X}$. Thus, there exist $g(X),h(X) \in R[X]$, $g(X) = c_0 + c_1 X + \dots$, $c_0,c_1,\dots \in R$
%\be
%a g(X) + Xh(X) = 1 \ \ra \ a c_0 = 1.
%\ee

%Thus, $a$ is unit. Therefore, this can be done for any $a$, so $R$ is a field.

%(In fact, ED $\to$ PID, so there is another way to see that $R$ is field $\to$ $R[X]$ is PID)
%\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{problem}
%Show that a finite integral domain is a field.
%\end{problem}

%\begin{solution}[\bf Solution.]
%Consider the map $\phi:R \to R$, $r \mapsto ar$, that is, multiplication by $a \neq 0$. Then this map is injective (Let $R$ be an integral domain and $\phi$ be a map $\phi:\R\to \R$, $r \mapsto ar$ for $a\neq 0$. Then $\phi$ is injective). Since $R$ is finite the map is also surjective. So the map is bijective. Therefore there exists $r \in R$ with $ar = 1$. Thus a has a multiplicative inverse. So $R$ is a field.
%\end{solution}

\begin{problem}\label{que:idempotent} 
An element $r$ of a ring $R$ is idempotent if $r^2 = r$.
\ben
\item [(i)] What are the idempotent elements of $\Z/6\Z$? Of $\Z/8\Z$? Of $\Z/24\Z$? Of $\Z/1000\Z$?
\item [(ii)] Show that if $r$ is idempotent then so is $r' = 1 - r$, and $rr' = 0$. 
\item [(iii)] Show also that the ideal $\bsa{r}$ is naturally a ring, and that $R$ is isomorphic to $\bsa{r} \times \bsa{r'}$.
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] 0,1,3; 0,1; 0,1,9,16; For $\Z/1000\Z$, we see that 
\be
r = \left\{ \ba{l}
10x \\
10x + 1\\
10x + 5\\
10x + 6
\ea\right.
\ee

If $r = 10x$, for some $a$,
\be
100x^2 = 10 x + 1000a \ \ra \ 10x(10x -1) = 1000a \ \ra \ x = 100y \ \ra \ x = 0 \ \ra \ r = 0.
\ee

If $r = 10x + 1$, for some $a$,
\be
100x^2 + 20x + 1 = 10x + 1 + 1000a \ \ra \ 10x(10x + 1) = 1000a \ \ra \ x = 100y \ \ra \ x = 0 \ \ra \ r = 1.
\ee

If $r = 10x + 5$, for some $a$,
\be
100x^2 + 100x + 25 = 10x + 5 + 1000a \ \ra \ x(10x + 9) + 2 = 100a \ \ra \ x = 10y + 2.
\ee

Thus, $r = 100y + 25$, for some $a$,
\be
10000y^2 + 5000y + 625 = 100y + 25 + 1000a \ \ra \ y (100y + 49) + 6 = 10a \ \ra \ y = 10z + 6 \ \ra \ r = 625.
\ee

If $r = 10x + 6$, for some $a$,
\be
100x^2 + 120x + 36 = 10x + 6 + 1000a \ \ra \ x(10x + 11) + 3 = 100a \ \ra \ x = 10y + 7.
\ee

Thus, $r = 100y + 76$, for some $a$,
\be
10000y^2 + 15200y + 5776 = 100y + 76 + 1000a \ \ra \ y (100y + 151) + 57 = 10a \ \ra \ y = 10z + 3 \ \ra \ r = 376.
\ee

Thus, the idempotents are 0,1,376,625.

\item [(ii)] $r^2 = r$, $r'^2 = (1-r)^2 = r^2 - 2r + 1 = r - 2r + 1 = 1-r = r'$ and $rr' = r(1-r) = r - r^2 = 0$.
\item [(iii)] Clearly, $\bsa{r}$ is group under addition. For the multiplication, $\forall rg_1,rg_2 \in \bsa{r}$ for some $g_1,g_2 \in R$, 
\be
rg_1 rg_2 = r^2 g_1g_2 = rg_1g_2 \in \bsa{r}.
\ee

Now we need to show that $1\in \bsa{r}$. Claim $r$ is the identity in $\bsa{r}$. It is easy to check that $\forall rg \in \bsa{r}$ for some $g\in R$
\be
r (rg) = r^2 g = rg.
\ee

Thus, $\bsa{r}$ is a ring.

Now let $\phi : R\to \bsa{r}\times \bsa{r'}$ by $\phi(g) = \bb{rg,r'g} = \bb{rg,(1-r)g}$. Then for any $g_1,g_2\in R$,
\be
\phi(g_1 + g_2) = (r(g_1+g_2), (1-r)(g_1 + g_2)) = \bb{rg_1,(1-r)g_1} + \bb{rg_2,(1-r)g_2} = \phi(g_1) + \phi(g_2),
\ee
\be
\phi(g_1g_2) = \bb{rg_1g_2,(1-r)g_1g_2} = \bb{r^2 g_1g_2, (1-r)^2 g_1g_2} = (rg_1,(1-r)g_1)(rg_2,(1-r)g_2) = \phi(g_1)\phi(g_2).
\ee

So $\phi$ is a homomorphism. Then
\be
\ker\phi = \bra{g\in R: rg = 0, (1-r)g = 0} \subseteq \bra{g\in R: rg + (1-r)g = 0} = \bra{0} \ \ra \ \ker\phi = \bra{0}.
\ee

If $\phi(g_1) = \phi(g_2)$, 
\be
rg_1 = rg_2,\ (1-r)g_1 = (1-r)g_2 \ \ra \ g_1 = g_2 \ \ra \ \phi \text{ is injective.}
\ee

To show $\phi$ is surjective, $\forall a = rg_1 \in \bsa{r}, b = (1-r)g_2 \in \bsa{r'}$, we need to find $g\in R$ s.t. $\phi(g) = (a,b)$. So 
\be
rg = rg_1,\ (1-r)g = (1-r)g_2 \ \ra \ g = rg_1 + (1-r)g_2.
\ee
by the fact $r\cdot r' = 0$. So $\phi$ is surjective (i.e., $\im \phi  = \bsa{r}\times \bsa{r'}$) and then $\phi$ is bijective. (We can also use first isomorphism theorem to show that
\be
R/\ker\phi \cong \im \phi \ \ra \ R = R/\ker\phi  \cong \bsa{r}\times \bsa{r'}.
\ee

Thus, $\phi$ is bijective.)
\een

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
By writing out the addition and multiplication tables, construct a field of order 4. Can you construct a field of order 6?
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Is every abelian group the additive group of some ring?
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $P$ be a prime ideal of $R$. Prove that $P[X]$ is a prime ideal of $R[X]$. If $M$ is a maximal ideal of $R$, does it follow that $M[X]$ is a maximal ideal of $R[X]$?
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A sequence $\{a_n\}$ of rational numbers is a Cauchy sequence if $\abs{a_n -a_m} \to 0$ as $m, n \to\infty$, and $\{a_n\}$ is a null sequence if $a_n \to 0$ as $n \to \infty$. Quoting any standard results from Analysis, show that the Cauchy sequences with componentwise addition and multiplication form a ring $C$, and that the null sequences form a maximal ideal $N$.

Deduce that $C/N$ is a field, with a subfield which may be identified with $\Q$. Explain briefly why the equation $x^2 = 2$ has a solution in this field.
\end{problem}

\begin{solution}[\bf Solution.]
For addition, if $\bra{a_n},\bra{b_n} \in C$ with Cauchy sequences $\bra{a_n},\bra{b_n}$,
\be
\abs{(a_n + b_n) - (a_m + b_m)} \leq \abs{a_n -a_m} + \abs{b_n - b_m} \to 0 \quad n,m\to \infty.
\ee

The sequence $\bra{c_n}$ with $c_n = 0$ for all $n$ is the identity and $\bra{-a_n}$ is the inverse of $\bra{a_n}$. So $C$ is a group under componentwise addition.

For multiplication, the closure is shown by
\be
\abs{a_nb_n - a_mb_m} = \abs{a_n b_n - a_m b_n + a_m b_n - a_mb_m} \leq \abs{a_n-a_m}\abs{b_n} + \abs{a_m}\abs{b_n - b_m} \to 0,\quad n,m \to \infty.
\ee

Also, the multiplication identity is $\bra{d_n}$ with $d_n = 1$ for all $n$. Thus, $C$ is a ring.

For the null sequence $\bra{a_n},\bra{b_n} \in N$, $a_n + b_n \to 0$, $\bra{c_n}$ with $c_n = 0$ for all $n$ is identity and $\bra{-a_n}$ is the inverse of $\bra{a_n}$. Thus, null sequence is subgroup of $C$. For any $\bra{c_n} \in C$, Cauchy sequence is convergent to some finite $c$ on $\R$. So
\be
c_n a_n \to 0 \cdot c = 0 \ \ra \ \bra{c_n a_n } \in N.
\ee

So $N\lhd C$. Now suppose that there exists Cauchy sequence with non-zero limit in some ideal $M$, i.e., $N\subsetneq M \lhd C$. $\forall a_n \in M\bs N$, we have that there exists $\ve >0$, $\forall K$, $\exists m > K$, $\abs{a_m} > \ve$. Also, since $\bra{a_n}$ is Cauchy, there exists $L$ s.t. $\forall n,m>L$, $\abs{a_n -a_m} < \ve/2$. Thus, 
\be
\abs{a_n} \geq \abs{a_m} - \abs{a_n-a_m} > \ve/2
\ee
$\forall n > L$. So only finite many terms of $a_n$ can be 0. Now $\forall \bra{b_n} \in C$ and let 
\be
c_n = \left\{\ba{ll}
0 & a_n = 0\\
b_n/a_n \quad\quad & a_n \neq 0
\ea\right.\qquad\qquad d_n = \left\{\ba{ll}
b_{n}\quad\quad  & a_{n} = 0 \\
0 & a_{n} \neq 0
\ea\right.
\ee

%For the zero subsequence $\bra{a_{n_k}}$, 

Thus, $\bra{c_n} \in C$ and $\bra{d_n} \in N$. So by definition by ideal
\be
\bra{b_n} = \underbrace{\bra{c_n a_n}}_{\in M} + \underbrace{\bra{d_n} }_{\in N \subsetneq M} \in M.
\ee

Thus, $C \subseteq M$. So we see that $M = C$, i.e., $N$ is maximal ideal. Then $C/N$ is a field (since for ring $R$, the quotient ring $R/I$ is a field if and only if $I$ is maximal in $R$).

Thus, there exists a subfield $\Q\leq C/N$ in which the equation $x^2 = 2$ has a solution since for $x_n \to \sqrt{2}$ ($\bra{x_n} \in C$, rational is dense.),
\be
(x_n + N)^2 = x_n^2 + 2x_n N + N^2 \subseteq x_n^2 + N
\ee
has limit 2.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $\varpi$ be a set of prime numbers. Write $\Z_\varpi$ for the collection of all rationals $m/n$ (in lowest terms) such that the only prime factors of the denominator $n$ are in $\varpi$.
\ben
\item [(i)] Show that $\Z_\varpi$ is a subring of the field $\Q$ of rational numbers.
\item [(ii)] Show that any subring $R$ of $\Q$ is of the form $\Z_\varpi$ for some set $\varpi$ of primes.
\item [(iii)] Given (ii), what are the maximal subrings of $\Q$?
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] $\frac 01$ and $\frac 11$ can be chosen to be in $\Z_\varpi$. $\forall \frac {m_1}{n_1},\frac {m_2}{n_2} \in \Z_\varpi$,
\be
\frac {m_1}{n_1} + \frac {m_2}{n_2} = \frac {m_1n_2 + m_2n_1}{n_1n_2} \in \Z_\varpi,\quad \frac {m_1}{n_1} \frac {m_2}{n_2} = \frac {m_1m_2}{n_1n_2} \in \Z_\varpi
\ee
because the denominator can't have any prime factor other than those of $n_1$ and $n_2$. Thus, $\Z_\varpi$ is a subring, i.e., $\Z_\varpi \leq \Q$.

\item [(ii)] Assume $\varpi$ consists of all the prime numbers of the elements' denominators in $R$. Then clearly, $R\subseteq \Z_\varpi$.


Since $1\in R$, $\forall r\in \Z$ we have $r= 1+ 1+ \dots + 1 \in R$. Thus, $\forall \frac ab \in R, r\in \Z$, $\frac ab r \in R$.

So for $b = p_1^{b_1}p_2^{b_2}\dots$ where $p_i$ are prime numbers ($p_i \in \varpi$), we can find $r\in \Z$ such that $b/r = p_i \in \varpi$. Since $a/b$ is reduced to the lowest from, $(a,b) = 1$ ($a,b$ are coprime). Then $\exists c,d \in \Z$ such that
\be
ac + bd = 1 \ \ra \ ac + p_i rd = 1 \ \ra \ (a,p_i) = 1 \ \ra \ \frac ab r = \frac a{p_i} \in R \ \ra \ \frac 1{p_i} \in R
\ee
by letting $a =1$. Thus, we have $\Z_\varpi \subseteq R$ and hence $\Z_\varpi = R$. 

\item [(iii)] Since $\Z_\varpi \subseteq Z_{\varpi \cup \varpi'}$, the maximal subrings are $\Z_{\theta}$ where $\theta$ are whole prime number sets missing only one prime number.
\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Does every ring have a maximal ideal?
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}



\begin{problem}
Exhibit an integral domain $R$ and a (non-zero, non-unit) element of $R$ that is not a product of irreducibles.
\end{problem}

\begin{solution}[\bf Solution.]
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $n \geq 3$. By factorising $n$ or $n + 1$ (as appropriate), show that $\Z[\sqrt{-n}]$ is not a UFD.
\end{problem}

\begin{solution}[\bf Solution]
\end{solution}


\begin{problem}
\label{ques:group_integral_domain} Show that if $R$ is an integral domain then a polynomial in $R[X]$ of degree $d$ can have at most $d$ roots. Give a quadratic polynomial in $(\Z/8\Z)[X]$ that has more than two roots.
\end{problem}

\begin{solution}[\bf Solution.]
Since $R$ is an integral domain, we have that $R[X]$ is an integral domain (see lemma in notes). Let $f(X)\in R[X]$ with $\deg(f(X))=d$ and 
\be
f(X) = \sum^d_{i=0} a_i X^i,\quad a_d \neq 0 .
\ee

If $f(X)$ has no roots, we are done. Suppose $a$ is a root of $f(X)$ then 
\be
f(X) = (X-a)g(X) \text{ for some }g(X).
\ee

Suppose that 
\be
g(X) = \sum^m_{i = 0} b_i X^i.
\ee

If $m \geq d$, we have the leading term of $f(X) = (X-a)g(X)$ is $b_m X^{m+1} = 0$ since $\deg(f(X)) = d$. Then we have that
\be
b_m X^{m+1} = 0 \ \ra \ b_m = 0.
\ee
since $R[X]$ is an integral domain.

Thus, $m<d$ and thus consider the leading term $f(X)$ which is $b_{d-1}X^d = a_d X^d$, so $b_{d-1} = a_d \neq 0$ since $R[X]$ is integral domain. Thus, $g(X)$ has degree $d-1$. So apply this method inductively, we have that $f(X)$ has at most $d$ roots.

Consider $f(X) = X^2 -1$ in $\Z/8\Z[X]$, we have roots $1,3,5,7$ since $\Z/8\Z$ is not an integral domain.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $R$ be an integral domain. The \emph{highest common factor} (hcf) of non-zero elements $a$ and $b$ in $R$ is an element $d$ in $R$ such that $d$ divides both $a$ and $b$, and if $c$ divides both $a$ and $b$ then $c$ divides $d$.
\ben
\item [(i)] Give two elements of $\Z[\sqrt{-5}]$ that do not have a hcf.
\item [(ii)] Show that the hcf of $a$ and $b$, if it exists, is unique up to multiplication by a unit.
\item [(iii)] Explain briefly why, if $R$ is a UFD, the hcf of two elements exists. Give an example to show that this is not always the case in an integral domain.
\item [(iv)] Show that if $R$ is a PID, the hcf of elements $a$ and $b$ exists and can be written as $ra + sb$ for some $r, s \in R$. Give an example to show that this is not always the case in a UFD.
\item [(v)] Explain briefly how, if $R$ is a Euclidean domain, the Euclidean algorithm can be used to find the hcf of any two non-zero elements. 
\item [(vi)]Use the algorithm to find the hcf of $11 + 7i$ and $18 - i$ in $\Z[i]$.
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] Let $a = 6 = (1+ \sqrt{-5})(1- \sqrt{-5})$ and $b= 2 (1+ \sqrt{-5})$. Thus,
\be
N(a) = N((1+ \sqrt{-5}))N((1- \sqrt{-5})) = 6 \cdot 6 = 36,\quad N(b) = N(2)N((1+ \sqrt{-5})) = 4 \cdot 6 = 24.
\ee

If $d$ is a hcf of $a,b$. $d|a$ and $d|b$ which implies that
\be
N(d) \mid N(a),\ N(d)\mid N(b) \ \ra \ N(d) \mid 12.
\ee

Since $N(d)$ is of the form $a^2 + 5b^2$, there is no such $d$ satisfying $N(d) = 12$. Thus, the we have $N(d) = 6$. Then $d = 1+\sqrt{-5}$ and $d\mid a$ and $d \mid b$. However, $2\mid a$ and $2\mid b$, so if $d$ a hcf, we have $2\mid d$. But $2\nmid 1+\sqrt{-5}$ since $N(2) = 4\nmid 6 = N(d)$. Contradiction. 

Thus, there is no hcf of $a,b$. (Therefore, we can see that $\Z[\sqrt{-5}]$ is not a UFD.)%The units in $\Z[\sqrt{-5}]$ are $\pm 1$. 

\item [(ii)] Suppose $d$ and $d'$ are hcfs of $a$ and $b$ then $d\mid d'$ and $d' \mid d$. Thus, for $r_1,r_2 \in R$, we have
\be
d' = dr_1, \ d = d'r_2 \ \ra \ d' = d' r_1r_2 \ \ra \ r_1r_2 = 1
\ee
since $R$ is an integral domain. Thus, $r_1,r_2$ are units. So hcf is unique up to multiplication by a unit.


\item [(iii)] If $a_i$ is zero, $\hcf(a_1,\dots,a_n) = \hcf(a_1,\dots,a_{i-1},a_{i+1},\dots,a_n)$. Thus, we only consider the case that $a_i$ is unit or a product of irreducibles, each $a_i$ is of the form
\be
u_i \prod_j p^{n_{ij}}_j
\ee
where $p_j$ is irreducible and $p_j$ is not associate to $p_k$ whenever $j \neq k$. $u_i$ is a unit in $R$ and $n_{ij} \geq 0$.

The claim is that $\prod_j p^{m_j}_j$ is a highest common factor of $a_1,\dots , a_n$ where $m_j = \min_i\{n_{ij}\}$. It is clear that this is a factor of each $a_i$ i.e., $d\mid a_i$, and if $d' \mid a_i$ for each $i$.

If $a_i$ is a unit, we have $a_i = cd'$ for some $c\in R$, then $\bb{a_i^{-1}c}d' =1$ and therefore $d'$ is a unit. If $a_i$ is not a unit, then each irreducible dividing $d'$ is also an irreducible dividing $a_i$ and so must be one of the $p_j$. Thus
\be
d' = u\prod_j p^{t_j}_j
\ee
where $u$ is a unit. But the $t_j$ can be at most $\min_i\{n_{ij}\}$ if $d' | a_i$ for each $i$. Thus 
\be
d = \prod_j p^{m_j}_j = p \cdot \prod_j p^{t_j}_j = p u^{-1} d' \ \ra \ d' \mid d
\ee
where $p\in R$.

\item [(iv)] Since $R$ is a PID, it is a UFD. Thus the hcf exists. For $a,b \in R$, there exist $d\in R$ such that $\bsa{a,b} = \bsa{d}$ since $R$ is PID. Thus,
\be
a = rd,\ b = sd,\ r,s \in R \ \ra \ d\mid a,\ d\mid b.
\ee

Also, $d = \alpha a + \beta b$ for $\alpha,\beta \in R$. Thus, for any $c$ such that $c\mid a$ and $c \mid b$, we have
\be
a = pc,\ b = qc,\ p,q \in R \ \ra \ d = (\alpha p + \beta q)c \ \ra \ c\mid d.
\ee

Thus, $d$ is a hcf of $a,b$.

If $R$ is a UFD but not PID, this is not true. For instance, $\Z[X]$ is a UFD but not a PID. The hcf of 2 and $X$ is 1. But there don't exist $\alpha,\beta\in \Z[X]$ such that
\be
1 = \alpha X + \beta \cdot 2.
\ee

\item [(v)] $R$ is a ED. Thus, there exists a function $\phi: R\bs \bra{0} \to \Z^+$ s.t. $\phi(ab) \geq \phi(a)$ for $a,b\in R\bs\bra{0}$ and if $a,b\in R$ with $b\neq 0$ then $\exists q,r\in R$ s.t. $a = bq + r$ and either $r=0$ or $\phi(r)< \phi(b)$.

Then the procedure of finding $d$ is: Let $a_1 = a$, $b_1 = b$ (wlog assume $\phi(a)\geq \phi(b)$) then $a_1 = b_1 q_1 + r_1 $ for some $q_1,r_1 \in R$ with either $r_1 = 0$ or $\phi(r_1) < \phi(b_1)$. If $r_1 = 0$, it ends and $b_1$ is a hcf of $a,b$. If $\phi(r_1) >0$, we let $a_2 = b_1$, $b_2 = r_1$ and repeat the steps. If $r_i = 0$, the procedure ends and $b_i$ is a hcf of $a,b$, otherwise it keeps going.

\item [(vi)] Let the norm $N$ be the Euclidean function. Thus, we know that $N(11 + 7i) = 170 < 325 = N(18-i)$. Thus,
\beast
18 - i & = & (11 + 7i) + 7 - 8i,\quad\quad N(7-8i) = 113< 170 = N(11+7i)\\
(11 + 7i) & = & i(7 - 8i) + 3,\quad\quad N(3) = 9 < 113 = N(7-8i)\\
7 - 8i & = & 3 (2 - 3i) + 1 + i,\quad\quad N(1+i) = 2 < 9 = N(3)\\
3 & = & (1-i)(1+i) + 1,\quad\quad N(1) = 1 <2 = N(1+i)\\
1+i & = & 1(1+i) + 0.
\eeast

Thus, hcf of $18 - i$ and $11 + 7i$ is 1.
\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $F$ be a finite field. Show that the prime subfield $K$ (that is, the smallest subfield) of $F$ has $p$ elements for some prime number $p$. Show that $F$ is vector space over $K$ and deduce $F$ has $p^n$ elements for some $n$.
\end{problem}

\begin{solution}[\bf Solution.]
Let $1$ be the multiplicative identity in $F$ and $n = \abs{F}$. Define the homomorphism
\be
\phi: \Z \to F,\ k \mapsto \underbrace{1+\dots + 1}_{k\lmod{n}}.
\ee

Since $F$ is finite and $\Z$ is infinite, the homomorphism is not injective. Thus, $\ker\phi \neq \bra{0}$. Thus, $\ker\phi \lhd \Z$ i.e. $\ker\phi = m\Z = \bsa{m}$ for some $m$ ($m\in \ker \phi$). Thus, if $m$ is a composite number in $\Z$, we have $m = ab$, for some $a,b\in \Z$ with $a,b\neq \pm 1$. But
\be
0 = \phi(m) = \phi(ab) = \phi(a)\phi(b) \ \ra \ \phi(a) = 0 \text{ or } \phi(b) = 0
\ee
since $F$ is a field (and therefore an integral domain). Then $\ker \phi = a\Z $ or $\ker\phi = b\Z$ which is a contradiction. Thus, $\ker\phi = p\Z$ for some prime number $p$. By the first isomorphism theorem, 
\be
\Z/p\Z = \Z/\ker\phi \cong \im\phi \leq F.
\ee

Thus, we can take the subring $K = \im \phi$. Since $K \cong \Z/pZ$, it is a field, thus a subfield of $F$.

$(F,+)$ is an abelian group. $\forall a_1,a_2 \in K,r_1,r_2 \in F$,
\beast
(a_1+a_2)(r_1+r_2) & = & a_1r_1 + a_1r_2 + a_2 r_1 + a_2 r_2,\\
(a_1a_2r_1) & = & a_1(a_2r_1),\\
1\cdot r & = & r.
\eeast

Thus, $F$ is a vector space over $K$. Since $F$ is a finite vector space, so it has a basis $e_1,\dots,e_n$. Then every element of $F$ is of the form 
\be
\sum^n_{i=1} a_i e_i, \quad a_i \in K.
\ee

Thus, there is a bijection between element of $F$ and $\bra{(a_1,\dots,a_n)\in K^n}$. Hence $\abs{F} = p^n$.
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}\label{que:gl_n_sl_n} 
Let $\F_q$ be a finite field of $q$ elements.
\ben
\item [(i)] Let $V$ be a vector space of dimension $n$ over $\F_q$. Show that $V$ has $q^n$ vectors. How many (ordered) bases does $V$ have? Find the order of the group $GL_n(\F_q)$ of all non-singular $n \times n$ matrices with entries in $\F_q$.
\item [(ii)] Show that the determinant homomorphism from $GL_n(\F_q)$ to $\F_q\bs\bra{0}$ is surjective and hence find the order of the group $SL_n(\F_q)$ consisting of all matrices in $GL_n(\F_q)$ of determinant 1.
\item [(iii)] Show that the multiplicative group of the non-zero elements of $\F_q$ is cyclic.

[Hint, recall the structure theorem for finite abelian groups, and note question \ref{ques:group_integral_domain}.)
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] By the previous question, we know that $\abs{V} = q^n$. Then we use the following procedure to find bases. Pick $r_1 \in V$ arbitrarily ($r_1 \neq 0$) and there are $q^n - 1$ possibilities. Then define 
\be
U_1 = \bsa{r_1} = \bra{ar_1: a\in \F_q}.%,\quad \abs{U_1} = q.
\ee

If $a,b\in V$ and $ar_1 = br_1 \ \ra \ r_1 = a^{-1}b r_1 \ \ra \ 1 = a^{-1}b \ \ra \ a = b$ since $V$ is a vector space (if $\lm v = 0$ then either $\lm = 0$ or $v= 0$). Thus, $\abs{U_1} = q$.

Then we pick $r_2 \in V\bs U_1$, there are $q^n - q$ possibilities. Then define
\be
U_2 = \bsa{r_1,r_2} = \bra{a_1 r_1 + a_2 r_2: a_1,a_2 \in \F_q} = \bra{\bsa{r_1}+ar_2 :a\in \F_q }.
\ee

Obviously, $\abs{U_2} = q^2$. Repeating the procedure, we can work out that for $m = 1,\dots, n$
\be
U_m = \bra{a_1r_1 + \dots + a_mr_m : a_1,\dots, a_m \in \F_q},\quad \abs{U_m} = q^m.
\ee

Thus, the number of ordered bases is 
\be
\prod^{n-1}_{i=0} \bb{q^n - q^i}.
\ee

Let $\bra{e_1,\dots,e_n}$ be the standard basis of $V$, where $e_i = \bepm 0 & \dots & 1 & \dots & 0 \eepm^T$ has the only 1 at the $i$th row. Thus, $\forall A \in GL_n(\F_q)$, we consider $\bra{Ae_1, \dots, Ae_n}$. If
\be
\sum_i a_i Ae_i = 0 \ \ra \ A \sum_i a_i e_i = 0 \ \ra \ \sum_i a_i e_i = 0 \ \ra \ a_i = 0, \forall i
\ee
since $A$ is invertible and $\bra{e_1,\dots,e_n}$ is a basis. Thus, for any $A\in GL_n(\F_q)$, $\bra{Ae_1, \dots, Ae_n}$ is a basis. 

Conversely, if $\bra{e_1',\dots, e_n'}$ is a basis of $V$, then the transformation matrix $P$ between $\bra{e_1,\dots,e_n}$ and $\bra{e_1',\dots,e_n'}$ is invertible ($A \in GL_n(\F_q)$). (Here we have $E' = AE$. If $\det A = 0$, $\det E' = \det A\det E = 0$ which is a contradiction.)

Thus, for any basis $\bra{e_1',\dots, e_n'}$ in $V$, we can find a $A\in GL_n(\F_q)$ such that 
\be
\bra{e_1',\dots, e_n'} = \bra{Ae_1,\dots, Ae_n}.
\ee

Therefore, there is a bijective between $GL_n(\F_q)$ and the set of (ordered) bases of $V$. Thus,
\be
\abs{GL_n(\F_q)} = \prod^{n-1}_{i=0} \bb{q^n - q^i}.
\ee

\item [(ii)] Now consider the determinant (group) homomorphism 
\be
\det:GL_n(\F_q) \to \F_q\bs\bra{0} = \F_q^\times,\ A \mapsto \det A.
\ee

For any $a \in \F_q^\times$, we can find $A \in GL_n$,
\be
\bepm
a & & & \\
& 1 & & \\
& & \ddots & \\
& & & 1
\eepm \ \ra \ \det A = a \ \ra \ \det \text{ is surjective }(\im \theta = \F_q^\times).
\ee

To check $\det$ is a (group) homomorphism, $\forall A,B\in GL_n(\F_q)$
\be
\det(AB) = \det A \det B = \det A \cdot \det B
\ee
by the property of $\det$ function. Thus, we apply the first isomorphism theorem,
\be
GL_n(\F_q) /\ker\det \cong \im \det \ \ra \ GL_n(\F_q) / SL_n(\F_q) \cong \F_q^\times \ \ra \ \frac{\abs{GL_n(\F_q)}}{\abs{SL_n(\F_q)}} = q-1.
\ee

Thus, 
\be
\abs{SL_n(\F_q)} = \frac{\abs{GL_n(\F_q)}}{q-1} = \frac{\prod^{n-1}_{i=0} \bb{q^n - q^i}}{q-1} = q^{n-1}\prod^{n-2}_{i=0} \bb{q^n - q^i}.
\ee


\item [(iii)] By structure theorem for finite abelian groups, we have the multiplicative group
\be
\F_q^\times \cong C_{d_1} \times C_{d_2} \times \dots \times C_{d_n}\quad \text{with }d_{i+1}\mid d_i
\ee

If $\F_q^\times$ is isomorphic to $C_{d_1} \times C_{d_2} \times \dots \times C_{d_n}$ where $n \geq 2$, then there exists $n_a,n_b \in \bra{d_1,d_2,\dots,d_n}$ s.t. $n_a\mid n_b$. Then there is a cyclic subgroup $\bsa{a} \cong C_{n_a}$ and $\bsa{b} \cong C_{n_b}$ generated by $a$ and $b$ with order $n_a$ and $n_b$. Since $n_a \mid n_b$ we have $\bsa{b^{\frac{n_b}{n_a}}} \cong \bsa{a} \cong C_m$ for some $m >1$. Thus, there exists a subgroup $\bsa{b^{\frac{n_b}{n_a}}} \times \bsa{a} \cong C_m \times C_m$ since $H\times K$ is also a group if $H,K$ are groups.

Thus there are at least $m^2$ elements satisfying $a^m = 1$. These are all roots of $X^m - 1$ in $\F_p[X]$ which is a UFD. $X^m - 1$ has a unique expression up to ordering and associates as a product of at most $m$ irreducibles in $\F_p[X]$.

In particular, there are at most $m$ linear factors $X - a$ and so at most $m$ roots, contradicting that there are at least $m^2$ roots.

Thus, the multiplicative group $\F_q^\times$ is cyclic.
\een
\end{solution}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that the set $SL_2(\Z)$ of integer $2\times 2$ matrices of determinant 1 is a group under multiplication. Show that there is a natural homomorphism from $SL_2(\Z)$ to $SL_2(\F_p)$, the group of determinant 1 matrices with entries in $\F_p =\Z/p\Z$. Identify the kernel.
\end{problem}

\begin{solution}[\bf Solution.]
To check $SL_2(\Z)$ is a group under multiplication:
\ben
\item [(i)] associativity: clear from the matrix multiplication.
\item [(ii)] closure: if $A,B\in SL_2(\Z)$, then $\det A = \det B = 1$. Thus, $\det AB = \det A\det B = 1$ and therefore $AB\in SL_2(\Z)$.
\item [(iii)] identity: $\bepm 1 & 0 \\ 0 & 1 \eepm$.
\item [(iv)] inverse: for $a,b,c,d \in \Z$, $\bepm a & b\\ c & d \eepm^{-1} = \bepm d & -b\\ -c & a \eepm$.
\een

Define a function 
\be
\phi: SL_2(\Z) \to SL_2(\F_p),\ A \to A \lmod{p}.%which take module of $p$ for the elements of $A$.
\ee

If $a,b\in \Z$, then 
\be
a \lmod{p} + b\lmod{p} \equiv a + b \lmod{p},\quad a \lmod{p} b\lmod{p} \equiv ab \lmod{p}.
\ee

Thus, $AB \lmod{p} \equiv A \lmod{p} B\lmod{p}$. Therefore, $\phi$ is a homomorphism. Since the identity in $SL_2(\F_q)$ is $\bepm 1 & 0 \\ 0 & 1 \eepm$, the kernel of $\phi$ is
\beast
\ker\phi & = & \bra{\bepm a & b \\ c & d \eepm \in SL_2(\Z): a\equiv d \equiv 1 \lmod{p}, b \equiv c \equiv 0 \lmod{p}}\\
& = & \bra{\bepm a & b \\ c & d \eepm: a\equiv d \equiv 1 \lmod{p}, b \equiv c \equiv 0 \lmod{p}, ad - bc = 1}\\
& = & \bra{I + p\bepm \alpha & \beta \\ \gamma & \delta \eepm: (1+p\alpha)(1+p\delta) - p^2 \beta \gamma = 1}\\
& = & \bra{I + p\bepm \alpha & \beta \\ \gamma & \delta \eepm: \tr\bepm \alpha & \beta \\ \gamma & \delta \eepm = p \det \bepm \alpha & \beta \\ \gamma & \delta \eepm}.
\eeast
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $V$ be a 2-dimensional vector space over the field $F = \F_q$ of $q$ elements, let $\Omega$ be the set of its 1-dimensional subspaces.
\ben
\item [(i)] Show that $\Omega$ has size $q + 1$ and $GL_2(\F_q)$ acts on it. Show that the kernel $Z$ of this action consists of scalar matrices and the group $PGL_2(\F_q) = GL_2(\F_q)/Z$ has order $q(q^2-1)$. Show that the group $PSL_2(\F_q)$ obtained similarly from $SL_2(\F_q)$ has order $q(q^2 - 1)/d$ with $d$ equal highest common factor of $q - 1$ and 2.
\item [(ii)] Show that $\Omega$ can be identified with the set $\F_q \cup\{\infty\}$ in such a way that $GL_2(\F_q)$ acts on $\Omega$ as the
group of M\"obius transformations $z \mapsto \frac{az+b}{cz+d}$. Show that in this action $PSL_2(\F_q)$ consists of those transformations with determinant a square in $\F_q$.
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] If $\bsa{v}$ is a line in $V$, then it is spanned by $\bepm 0\\ 1 \eepm$ and $\bepm a \\ 0 \eepm$ with $a\in \F_q$. So $\abs{\Omega} = q + 1$.

Alternatively, every 1-d subspace has size $q$ (including 0) and $\abs{V} = q^2$. The subspaces intersect only in 0, so $V\bs \bra{0}$ is partitioned into subsets of size $q-1$ by the subspaces. But $\abs{V\bs \bra{0}} = q^2 - 1 = (q+1)(q-1)$. Hence there are $q+1$ 1-d subspaces.

Now define
\be
\phi: GL_2 (\F_q) \times \Omega \to \Omega,\ (A,\bsa{v}) \mapsto \bsa{Av}.
\ee

This is an action since
\ben
\item [(a)] If $A \in GL_2 (\F_q)$, $\bsa{v} \in \Omega$, then $A\bsa{v} \in \Omega$.
\item [(b)] $\forall A,B \in GL_2(\F_q), \bsa{v}\in \Omega$, we have
\be
(AB)\bsa{v} = \bsa{ABv} = A\bsa{Bv} = A \bb{B \bsa{v}}
\ee
\item [(c)] $\forall \bsa{v}\in \Omega$, $I \bsa{v} = \bsa{v}$.
\een

Now the kernel of the action $\phi$ is 
\be
\ker \phi = \bra{A \in GL_2(\F_q):A\bsa{v} = \bsa{v}, \forall \bsa{v}\in \Omega}
\ee

Clearly, For $\lm \neq 0$, we have
\be
\bepm \lm & 0 \\ 0 & \lm \eepm \subseteq \ker \phi.
\ee

Furthermore, we can see that for any $\bepm a & b \\ c & d \eepm \in \ker\phi$,
\be
\bepm
a & b \\
c & d
\eepm \bsa{\bepm 1 \\ 0 \eepm} = \bsa{\bepm a \\ c \eepm}  \ \ra \ c = 0,\quad\quad 
\bepm
a & b \\
c & d
\eepm \bsa{\bepm 0 \\ 1 \eepm} = \bsa{\bepm b \\ d \eepm}  \ \ra \ b = 0.
\ee

Thus, 
\be
\bepm
a & 0 \\
0 & d
\eepm \bsa{\bepm 1 \\ 1 \eepm} = \bsa{\bepm a \\ d \eepm}  \ \ra \ a = d.
\ee

Therefore, we have $\bra{\bepm \lm & 0 \\ 0 & \lm \eepm:\lm \neq 0,\lm \in \F_q} = \ker \phi =Z$. We know that $\abs{\bra{\bepm \lm & 0 \\ 0 & \lm \eepm:\lm \neq 0,\lm \in \F_q}} = q -1$. Then (by the result in question \ref{que:gl_n_sl_n}, $\abs{GL_n(\F_q)} = \prod^{n-1}_{i=0} \bb{q^n - q^i}$)
\be
PGL_2(\F_q) = GL_2(\F_q)/Z \ \ra \ \abs{PGL_2(\F_q)} = \frac{\abs{GL_2(\F_q)}}{\abs{Z}} =  \frac{(q^2 -1)(q^2 -q)}{q-1} = q(q^2-1)
\ee
by Lagrange theorem.

Now consider $SL_2(\F_q)$. It is a subgroup of $GL_2(\F_q)$ and also an action $\vp$ on $\Omega$. Thus, 
\be
\ker \vp = \bra{\bepm \lm & 0 \\ 0 & \lm \eepm \in SL_2(\F_q):\lm \in \F_q^\times} = \bra{\pm I}
\ee

First we know that $\F_q^\times = \F_q\bs \bra{0}$ is a group with order $q-1$. If $-1$ is an element of $\F_q$, we have $(-1)^{q-1} = 1$ by the property of group. Thus, if $q$ is odd, this equation holds and thus $\abs{\ker\vp} = 2$. If $q$ is even, $(-1)^{q-1} = -1\neq 1$ which will gives that $\abs{\ker\vp} = 1$. Hence
\be
\ker\vp = \left\{\ba{ll}
2 \quad \quad & q \text{ is odd}\\
1 & q \text{ is even}
\ea\right. = \hcf(q-1,2) := d.
\ee

Then by Lagrange theorem, we have (by result in question\ref{que:gl_n_sl_n}, $\abs{SL_n(\F_q)} = q^{n-1}\prod^{n-2}_{i=0} \bb{q^n - q^i}$)
\be
PSL_2(\F_q) = SL_2(\F_q)/Z \ \ra \ \abs{PSL_2(\F_q)} = \frac{\abs{SL_2(\F_q)}}{\ker\vp} =  \frac{q(q^2 -1)}{d} = q(q^2-1)/d.
\ee

\item [(ii)] Define funtion
\be
f:\Omega \to \F_p \cup \bra{\infty},\ \bsa{\bepm a\\ b \eepm} \mapsto \left\{ \ba{ll}
a/b\quad\quad & b \neq 0\\
\infty & b = 0
\ea\right.
\ee

Now, if two matrices differ by a scalar multiple, then they induce the same transformation, so this map is constant on the cosets that make up $PGL_2(\F_q)$. Thus we actually have a surjective map $PGL_2(\F_q)$. (It's not too hard to show that this map is injective as well, and therefore an isomorphism).

Thus, let $A = \bepm a & b \\ c & d \eepm \in GL_2(\F_q)$, then
\be
\bepm a & b \\ c & d \eepm \cdot z = f\bsa{\bepm a & b \\ c & d \eepm\bepm z \\ 1 \eepm} = f\bsa{\bepm az+b \\ cz + d \eepm} = \frac{az +b}{cz + d}
\ee
which is M\"obius transformation. 

Let $M$ be the group of M\"obius transformations on induced by these matrices

Now, we can restrict our original map to one from $SL_2(\F_q) \to M$. Let's denote the image of this map by $M$. So we can take it as being a surjective map $SL_2(\F_q) \to M'$. As before, we can ``quotient out" to make it a map $PSL_2(\F_q)\to M'$. Again, this is actually an isomorphism (which justifies referring to as $PSL_2(\F_k)\to M'$ in the first place).

So, the question becomes: show that a matrix induces a transformation in $M'$ if and only if its determinant is a square. But by definition, a transformation is in $M'$ if and only if it is induced by some matrix of determinant one (with scalar multiples).
\een
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that the groups $SL_2(\F_4)$ and $PSL_2(\F_5)$ defined above both have order 60. Use this and some questions from sheet 1 to show that they are both isomorphic to the alternating group $A_5$. Show that $SL_2(\F_5)$ and $PGL_2(\F_5)$ both have order 120, that $SL_2(\F_5)$ is not isomorphic to $S_5$, but $PGL_2(\F_5)$ is.
\end{problem}

\begin{solution}[\bf Solution.]
From the previous questions, we have that
\be
\abs{SL_n(\F_q)} = q^{n-1}\prod^{n-2}_{i=0} \bb{q^n - q^i},\quad \abs{SL_2(\F_4)} = 4^{2-1}\bb{4^2 - 4^0} = 4 \cdot 15 = 60. 
\ee

\be
\abs{PSL_2(\F_q)} = q(q^2-1)/d,\quad \abs{PSL_2(\F_5)} = 5(5^2-1)/2 = 5 \cdot 12 = 60. 
\ee

From Example sheet 1, we have
\ben
\item [(i)] Let $G$ be a group of order 60 which has more than one Sylow 5-subgroup. Then $G$ must be simple. 
\item [(ii)] Let $G$ be a simple group of order 60. Then $G$ is isomorphic to the alternating group $A_5$.
\een

We know that $SL_2(\F_4) \leq S_5$ and $A_5 \cap SL_2(\F_4)$ has index 1 or 2 in $A_5$, so $SL_2(\F_4) \cong A_5$.

Furthermore, we have two distinct matrices
\be
\bepm
1 & 1 \\
0 & 1 
\eepm, \ \bepm
1 & 0 \\
1 & 1 
\eepm \in PSL_2(\F_5)
\ee
with order 5 as
\be
\bepm
1 & 1 \\
0 & 1 
\eepm^n = \bepm
1 & n \\
0 & 1 
\eepm, \quad \bepm
1 & 0 \\
1 & 1 
\eepm^n = \bepm
1 & 0 \\
n & 1 
\eepm
\ee

Thus, we have at least two Sylow 5-subgroups:
\be
\bra{\bepm
1 & 1 \\
0 & 1 
\eepm, \bepm
1 & 2 \\
0 & 1 
\eepm, \bepm
1 & 3 \\
0 & 1 
\eepm,\bepm
1 & 4 \\
0 & 1 
\eepm,\bepm
1 & 0 \\
0 & 1 
\eepm
},\quad\quad \bra{\bepm
1 & 0 \\
1 & 1 
\eepm, \bepm
1 & 0 \\
2 & 1 
\eepm, \bepm
1 & 0 \\
3 & 1 
\eepm,\bepm
1 & 0 \\
4 & 1 
\eepm,\bepm
1 & 0 \\
0 & 1 
\eepm
}.
\ee

Thus, by (i) and then (ii), we have $PSL_2(\F_5)\cong A_5$.


rom the previous questions, we have that
\be
\abs{SL_n(\F_q)} = q^{n-1}\prod^{n-2}_{i=0} \bb{q^n - q^i},\quad \abs{SL_2(\F_5)} = 5^{2-1}\bb{5^2 - 5^0} = 5 \cdot 24 = 120. 
\ee

\be
\abs{PGL_2(\F_q)} = q(q^2-1),\quad \abs{PSL_2(\F_5)} = 5(5^2-1) = 5 \cdot 24 = 120. 
\ee

For $SL_2(\F_5)$ act on itself, we see that its centre (kernel) is $Z(SL_2(\F_5)) = \bra{\pm I}$. However, $Z(S_5) = \iota$. Thus, $SL_2(\F_5) \not\cong S_5$.

We have that $PGL_2(\F_5) \leq S_6$ with index 6. Also, $S_6$ acts on $S_6/PGL_2(\F_5) = X$. We know that (by lemma) $\phi:S_6 \to S_{\abs{X}}$ is a homomorphisim.

Thus, $PGL_2(\F_5)$ fixes an element of $X$, so $PGL_2(\F_5)$ is a stabiliser in $S_6$. Thus, $PGL_2(\F_5) \cong S_5$.
\end{solution}

\subsection{Modules}

{\bf All rings in this course are commutative with a multiplicative identity.}


\begin{problem}
How many abelian groups are there of order 6? Of order 60? Of order 6000?
\end{problem}

\begin{solution}[\bf Solution.] 
\ben
\item [(i)] $d= 6 = 2\times 3$. But $2\nmid 3$. Thus, the only abelian group of order $6$ is $C_6$.
\item [(ii)] $d = 60 = 2^2 \times 3 \times 5$. 

If $d_1 = 2$, $d_2$ has to be $2\time 3\times 5$ since $d_1 \mid d_2$. So it is $C_2 \times C_{30}$.

If $d_1 = 1$, the only possible is $d_2 = 60$ which gives $C_{60}$. 

If $d_1 = 3$ or $5$, then it leads to contradiction since we cannot find $d_2$ such that $d_1\mid d_2$.

Thus, we only got two possibilities.

\item [(iii)] $d= 6000 = 2^4 \times 3 \times 5^3$. First we can see that $d_1 \nmid 3$. 

If $d_1 = 1$, we have $C_{6000}$.

If $d_1 = 2$, we can have at most four cyclic groups.
\ben
\item [(a)] Only two. $C_2 \times C_{3000}$.
\item [(b)] Three. If $d_2 \mid 5$, we have $C_2 \times C_{10} \times C_{300}$. If $d_2 \nmid 5$, we have $C_2 \times C_2 \times C_{1500}$.
\item [(c)] Four. If $d_2 \mid 5$, we have $C_2 \times C_{10} \times C_{10} \times C_{30}$. Now we consider the case $d_2 \nmid 5$. If $d_3 \mid 5$, we $C_2\times C_2 \times C_{10} \times C_{150}$. If $d_3\nmid 5$, we have $C_2 \times C_2 \times C_2 \times C_{750}$.
\een

If $d_1 = 4$, we have two cyclic groups. $C_4 \times C_{1500}$.

If $d_1 = 5$, we have two possibilities (at most three cyclic groups)
\ben
\item [(a)] Only two cyclic groups, $d_2 = 6000/5 = 1200$. This gives $C_5 \times C_{1200}$.
\item [(b)] Three cyclic groups. This could be $C_5\times C_5 \times C_{240}$, $C_5 \times C_{10} \times C_{120}$, $C_5\times C_{20} \times C_{60}$.
\een

If $d_1 = 10$, we have at most three cyclic groups. $C_{10} \times C_{600}$, $C_{10}\times C_{10} \times C_{60}$.

If $d_1 = 20$, we have at most two cyclic groups. $C_{20} \times C_{300}$.
\een

Hence, totally, we have 15 possibilities. 
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $M$ be a module over an integral domain $R$ (Actually, this only needs to be a commutative ring). An element $m \in M$ is a torsion element if $rm = 0$ for some non-zero $r \in R$. Show that the set $T$ of all torsion elements in $M$ is a submodule of $M$, and that the quotient $M/T$ is torsion-free  that is, contains no non-zero torsion elements.
\end{problem}

\begin{solution}[\bf Solution]
To check $T$ is submodule of $M$, we need to show
\ben
\item [(i)] $(T,+)$ is an additive subgroup.

Associativity is from the fact that $(M,+)$ is an abelian group.

If $m_1,m_2\in T$, there exist $r_1,r_2 \in R$ such that 
\be
r_1m_1 = r_2m_2 = 0 \ \ra \ r_2r_1 m_1 = r_1 r_2 m_2 = 0 \ \ra \ (r_1r_2)(m_1 + m_2) = r_2r_1 m_1 + r_1r_2m_2 = 0 + 0 = 0.
\ee

Thus, $m_1 + m_2 \in T$.

Clearly, the identity of $T$ is 0. 

If $m \in T$, there exists $r\in R$ such that $rm = 0$. Then since $1m = m$ and $0m = 0$, we have $(-1)m = -m$,
\be
r(-m) = r(\underbrace{(-1)}_{\in R}\underbrace{m}_{\in M}) = (-1)rm = (-1)0 = -0 = 0 \ \ra \ -m \in T
\ee

\item [(ii)] $\forall r \in R, m\in T$, $rm \in T$. There exists $r' \in R$ such that $r'm = 0$. Then
\be
r'(rm) = r(r'm) = r 0 = r(m-m) = rm + r(-m) = rm - rm = 0 \ \ra \ rm \in T.
\ee
\een

Hence, $T$ is a submodule.

Now suppose $m + T$ is a torison element in $M/T$ with $m\in M$. Then there exists some $r\in R, t\in T$ such that $r(m + t) = 0$, we have
\be
0 = r(m+t) = rm + \underbrace{rt }_{\in T} \ \ra \ rm \in T.
\ee

Thus, there exists $r'\in R$ such that $0 = r'rm = (r'r)m$. Thus, $m \in T$ and $m + T = T = 0 + T$. Thus, the only torsion element is zero.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\label{que:fg_acc} We say that an $R$-module satisfies condition ($N$) on submodules if any submodule is finitely generated. Show that this condition is equivalent to condition ($ACC$): every increasing chain of submodules terminates.
\end{problem}

\begin{solution}[\bf Solution]
($\ra$) Let $M$ be an $R$-module. Take $N_1,N_2,\dots$ to be submodules s.t. 
\be
N_1 \subseteq N_2 \subseteq \dots.
\ee

Then take $N = \bigcup^\infty_{i=1}N_i$. We claim that $N \leq M$. 

$\forall n_1,n_2 \in N$, $\exists i_1,i_2$ s.t. $n_1 \in N_{i_1}, n_2 \in N_{i_2}$. Wlog assume $i_1\leq i_2$, then $N_{i_1} \subseteq N_{i_2}$, we have $n_1,n_2 \in N_{i_2}$, so $n_1 + n_2 \in N_{i_2}$ and $n_1+n_2 \in N$. Also, it is easy to see that $0\in N_{i_2} \subseteq N$ and $-n_1 \in N_{i_2} \subseteq N$. 

Furthermore, $\forall r\in R, n\in N$, $n \in N_i$ for some $i$. So $rn \in N_i$ since $N_i$ is a submodule. Thus, $rn \in N$.

Therefore, $N$ is a submodule of $M$.

Now since $N$ is finitely generated, $\exists n_1,n_2,\dot,n_k \in N$ such that
\be
N = Rn_1 + Rn_2 + \dots + Rn_k.
\ee

Thus, $\exists i\in \N$ s.t. $n_1,n_2,\dots,n_k \in N_i$. Therefore, $N \subseteq N_i$. Since $N_i \subseteq N$, we have $N=N_i$, which satisfies ACC.

($\la$) Suppose that there exists a submodule $N$ which is not finitely generated, say $n_1,n_2,\dots$ are the generators. Then we pick $m_1$ to be any of $n_i$, $M_1 = Rm_1$. Then we pick $m_2$ from $\bra{n_i}$ such that $m_2 \notin M_1$ and construct $M_2 = Rm_1 + Rm_2$. So we have $M_1 \subsetneq M_2$. Following this procedure, we can have infinite $M_i$ such that 
\be
M_1 \subsetneq M_2 \subsetneq \dots \subsetneq \dots
\ee
which does not satisfy ACC. Contradiction. Thus, all submodules are finitely generated.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\ben
\item [(i)] Is the abelian group $\Q$ torsion-free? Is it free? Is it finitely generated?
\item [(ii)] What are the torsion elements in the abelian group $\Q/\Z$? In $\R/\Z$? In $\R/\Q$?
\item [(iii)] Prove that $\R$ is not finitely generated as a module over the ring $\Q$.
\een
\end{problem}

\begin{solution}[\bf Solution.]
\ben
\item [(i)] Consider 
\be
\Z\bs\bra{0} \times \Q \to \Q,\ (n,q) \mapsto nq
\ee

If $nq = 0$, then since $\Q$ is an integral domain, we have $q = 0$ with $n\neq 0$. Thus, $\Q$ is torsion-free.

Supppose $S$ generates $\Q$ freely. If $\abs{S} = 1$, i.e. $\Q = \Z \frac ab$ with $a,b\in \Z, b\neq 0, \hcf(a,b) = 1$. We can find 
\be
\frac 1{b+1} \notin \Z\frac ab \ \ra \ \text{contradiction.}
\ee

If $\abs{S} = 2$, we can find non-zero distinct $\frac ab, \frac cd \in S \subseteq \Q$ with $a,b,c,d\in \Z,b,d \neq 0$. However, we can find non-zero $bc,ad \in \Z$,
\be
bc \frac ab - ad \frac cd = ac - ac = 0 \ \ra \ S \text{ is not independent} \ \ra \ \Q \text{ is not free. (Contradiction)}
\ee

Thus, $\Q$ is not free. 

If $\Q$ is finitely generated, we have
\be
\Q = \Z\frac {a_1}{b_1} + \dots + \Z\frac {a_k}{b_k}.
\ee

Thus, we can choose prime number $p$ such that $p\nmid b_1,b_2, \dots, b_k$ (for instance $p$ is the smallest number bigger than $b_1b_1 \dots b_k$). As we know that $\frac 1p \in \Q$, $p$ can be expressed by ()
\be
\frac 1p = z_1 \frac {a_1}{b_1} + \dots + z_k\frac {a_k}{b_k} = \frac{*}{b_1 \dots b_k} 
\ee
where $z_1,\dots,z_k \in \Z$. Thus,
\be
p \mid b_1\dots, b_k \ \ra \ p \mid b_1 \text{ or } \dots \text{ or } p \mid b_k. \quad (\text{contradiction})
\ee

\item [(ii)] Say $\R$ is finitely generated as a module over the ring $\Q$. That is, $r_1,\dots, r_k \in \R$
\be
\R = \Q r_1 + \dots + \Q r_k
\ee

LHS is uncountable. But RHS is countable (sum of finite number of countable sets). Contradiction.
\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $M$ be a module over a ring $R$, and let $N$ be a submodule of $M$.
\ben
\item [(i)] Show that if $M$ is finitely generated then so is $M/N$.
\item [(ii)] Show that if $N$ and $M/N$ are finitely generated then so is $M$.
\item [(iii)] Show that if $M/N$ is free, then $M \cong = N \oplus M/N$.
\item [(iv)] Show that if $R$ is a PID and $M$ is a finitely-generated free module, then $N$ is free.
\een
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Use elementary operations to bring the integer matrix $A = \bepm
-4 & -6 & 7\\
2 & 2 & 4\\
6 & 6 & 15
\eepm
$ to Smith normal form $D$. Check your result using minors. Explain how to find invertible matrices $P$, $Q$ for which $D = QAP$.
\end{problem}

\begin{solution}[\bf Solution.]
We have ($P$ for column operation, $Q$ for row operation)
\be
\underrightarrow{c_2 - c_1} \quad 
\bepm
-4 & -2 & 7\\
2 & 0 & 4\\
6 & 0 & 15
\eepm \quad\quad  P:\quad  \bepm
1 & -1 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_1 - 2c_2} \quad 
\bepm
0 & -2 & 7\\
2 & 0 & 4\\
6 & 0 & 15
\eepm \quad\quad  P:\quad  \bepm
3 & -1 & 0\\
-2 & 1 & 0\\
0 & 0 & 1
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_1 \lra c_3} \quad 
\bepm
7 & -2 & 0\\
4 & 0 & 2\\
15 & 0 & 6
\eepm \quad\quad  P:\quad  \bepm
0 & -1 & 3\\
0 & 1 & -2\\
1 & 0 & 0
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_1 + 3c_2} \quad 
\bepm
1 & -2 & 0\\
4 & 0 & 2\\
15 & 0 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & -1 & 3\\
3 & 1 & -2\\
1 & 0 & 0
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_2 + 2c_1} \quad 
\bepm
1 & 0 & 0\\
4 & 8 & 2\\
15 & 30 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & -7 & 3\\
3 & 7 & -2\\
1 & 2 & 0
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{r_2 - 4r_1} \quad 
\bepm
1 & 0 & 0\\
0 & 8 & 2\\
15 & 30 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & -7 & 3\\
3 & 7 & -2\\
1 & 2 & 0
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
-4 & 1 & 0\\
0 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{r_3 - 15r_1} \quad 
\bepm
1 & 0 & 0\\
0 & 8 & 2\\
0 & 30 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & -7 & 3\\
3 & 7 & -2\\
1 & 2 & 0
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
-4 & 1 & 0\\
-15 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_2 \lra c_3} \quad 
\bepm
1 & 0 & 0\\
0 & 2 & 8\\
0 & 6 & 30
\eepm \quad\quad  P:\quad  \bepm
-3 & 3 & -7\\
3 & -2 & 7\\
1 & 0 & 2
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
-4 & 1 & 0\\
-15 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{c_3 - 4c_2} \quad 
\bepm
1 & 0 & 0\\
0 & 2 & 0\\
0 & 6 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & 3 & -19\\
3 & -2 & 15\\
1 & 0 & 2
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
-4 & 1 & 0\\
-15 & 0 & 1
\eepm 
\ee

\be
\underrightarrow{r_3 - 3r_2} \quad 
D = \bepm
1 & 0 & 0\\
0 & 2 & 0\\
0 & 0 & 6
\eepm \quad\quad  P:\quad  \bepm
-3 & 3 & -19\\
3 & -2 & 15\\
1 & 0 & 2
\eepm \quad Q:\quad  \bepm
1 & 0 & 0\\
-4 & 1 & 0\\
-3 & -3 & 1
\eepm 
\ee

We see that 
\be
\hcf\bb{-4,-6,7,2 ,2, 4,6, 6, 15} = 1 \ \ra \ d_1 = 1.
\ee

\be
\hcf \bb{\det\bepm -6 & 7 \\ 2 & 4 \eepm = -38, \det \bepm 2 & 4 \\ 6 & 15 \eepm = 6 } = 2 \ \ra \ d_2 = 2.
\ee

Thus,
\be
d_3 = \frac{\det A}{d_1d_2} = \frac{-4 \cdot 6 - 2 \cdot (-132) + 6 \cdot (-38)}{2} = \frac{-24 + 264 - 228}2 = \frac{12}2  = 6.
\ee
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Work out the invariant factors of the matrices over $R[X]$:
\be
\bepm
2X - 1 & X & X - 1 & 1\\
X & 0 & 1 & 0\\
0 & 1 & X & X\\
1 & X^2 & 0 & 2X - 2
\eepm
\quad \text{and}\quad 
\bepm
X^2 + 2X & 0 & 0 & 0\\
0 & X^2 + 3X + 2 & 0 & 0\\
0 & 0 & X^3 + 2X^2 & 0\\
0 & 0 & 0 & X^4 + X^3
\eepm.
\ee
\end{problem}

\begin{solution}[\bf Solution.]
We want to reduce it to 
\be
\bepm
f_1(X) & 0 & 0 & 0\\
0 & f_2(X) & 0 & 0\\
0 & 0 & f_3(X) & 0\\
0 & 0 & 0 & f_4(X)
\eepm.
\ee

For the first matrix, we have that the hcf of all elements 1, so $d_1 =1$. Also we have
\be
\det\bepm
0 & 1\\
1 & X
\eepm = -1 \quad (\text{a unit}) \ \ra \ d_2 = 1.
\ee

Furthermore,
\be
\det \bepm
X & X-1 & 1\\
0 & 1 & 0\\
1 & X & X
\eepm = X^2 - 1 = (X+1)(X-1),\quad \det \bepm
X & 0 & 1\\
0 & 1 & X \\
1 & X^2 & 0 
\eepm = -X^4 - 1 = -(X^4 + 1)\ \ra \ d_3 = 1.
\ee

Thus, 
\beast
d_4 = \det A & = & (2X-1)\bb{-\bb{2X-2 -X^3}} - X\bb{X^2(X^2 -X -X) + (2X-2)(X^2 -X+1)} - \bb{X(X) - 1}\\
& = & 2X^4 - X^3 - 4X^2 + 2X + 4X -2 - X^5 + 2X^4 - X(2X^3 - 2X^2 - 2X^2 + 2X + 2X - 2) - X^2 + 1\\
& = & 4X^4 - X^3 - 4X^2 + 6X -2 - X^5 - 2X^4 + 4X^3 - 4X^2 + 2X - X^2 + 1\\
& = & -X^5 + 2X^4 + 3X^3 - 9X^2 + 8X -1.
\eeast

For the second matrix, 
\be
X^2 + 2X = X(X+2),\quad X^2 + 3X +2 = (X+1)(X+2),\quad X^3 + 2X^2 = X^2 (X+2),\quad X^4 + X^3 = X^3(X+1).
\ee
So hcf of each entry is 1, hcf of $2\times 2$ minors is $X(X+2)$, hcf of $3\times 3$ is $X^3(X+1)(X+2)^2$ and hcf of $4\times 4$ minors is $\det A = X^6(X+1)^2(X+2)^3$. Thus, we have
\be
\bepm
1 & 0 & 0 & 0\\
0 & \ X(X + 2) \ & 0 & 0\\
0 & 0 & X^2(X+1)(X+2) & 0\\
0 & 0 & 0 & X^3 (X+1)(X+2)
\eepm.
\ee
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $G$ be the abelian group with generators $a$, $b$, $c$, and relations $6a+10b = 0$, $6a+15c = 0$, $10b+15c = 0$. (That is, $G$ is the free abelian group on generators $a$, $b$, $c$ quotiented by the subgroup generated by the elements $6a + 10b$, $6a+ 15c$, $10b+ 15c$). Determine the structure of $G$ as a direct sum of cyclic groups.
\end{problem}

\begin{solution}[\bf Solution.]
$(6,10,0)$, $(6,0,15)$, $(0,10,15)$ are generators for the relation module. Let
\be
N = \bepm
6 & 6 & 0\\
10 & 0 & 10\\
0 & 15 & 15
\eepm \ \ra \ \left\{\ba{l}
1\times 1 \text{minor}: \ 6,10,15, \quad \hcf = 1\\
2\times 2 \text{minor}: \ -60,60,150,-150, \quad \hcf = 30\\
3\times 3 \text{minor}: \ -1800, \quad \hcf = -1800
\ea\right.
\ee

Thus, $N$ in Smith normal form is 
\be
\bepm
1 & 0 & 0\\
0 & 30 & 0\\
0 & 0 & -60
\eepm 
\ee

Thus, 
\be
G \cong \Z/\Z \oplus \Z/30\Z \oplus \Z/(-60)\Z = \Z/30\Z \oplus \Z/60\Z.
\ee
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Prove that a finitely-generated abelian group $G$ is finite if and only if $G/pG = 0$ for some prime $p$. 

Give a non-trivial abelian group $G$ such that $G/pG = 0$ for all primes $p$, and prove that your example is not finitely generated.
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $A$ be a complex matrix with characteristic polynomial $(X + 1)^6(X - 2)^3$ and minimal polynomial $(X + 1)^3(X - 2)^2$. Write down the possible Jordan normal forms for $A$.
\end{problem}

\begin{solution}[\bf Solution.]
We have $f_1(X)\dots f_r(X) = (X+1)^6(X-2)^3$, $f_r(X) = (X+1)^3(X-2)^2$. Thus, there are three possibilities:
\ben
\item [(i)] $f_1(X) = (X+1)$, $f_2(X) = (X+1) f_3(X) = (X+1)(X-2)$ 
\item [(ii)] $f_1(X) = (X+1)$, $f_2(X) = (X+1)^2(X-2)$ 
\item [(iii)] $f_1(X) = (X+1)^3(X-2)$ 
\een

Thus, the corresponding rational canonical forms are
\be
\bepm 
-1 & & & & & & & & \\
& -1 & & & & & & & \\
& & -1 & & & & & & \\
& & & 2 & & & & & \\
& & & & -1 & & & & \\
& & & & 1 & -1 & & & \\
& & & & & 1 & -1 & & \\
& & & & & & & 2 & \\
& & & & & & & 1 & 2
\eepm,\ \bepm 
-1 & & & & & & & & \\
& -1 & & & & & & & \\
& 1 & -1 & & & & & & \\
& & & 2 & & & & & \\
& & & & -1 & & & & \\
& & & & 1 & -1 & & & \\
& & & & & 1 & -1 & & \\
& & & & & & & 2 & \\
& & & & & & & 1 & 2
\eepm,\ \bepm 
-1 & & & & & & & & \\
1 & -1 & & & & & & & \\
& 1 & -1 & & & & & & \\
& & & 2 & & & & & \\
& & & & -1 & & & & \\
& & & & 1 & -1 & & & \\
& & & & & 1 & -1 & & \\
& & & & & & & 2 & \\
& & & & & & & 1 & 2
\eepm.\nonumber
\ee
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Find a $2 \times 2$ matrix over $\Z[X]$ that is not equivalent to a diagonal matrix.
\end{problem}

\begin{solution}[\bf Solution.]
Let $A = \bepm 2 & 0 \\ X & 0 \eepm $. Suppose $A$ is equivalent to a diagonal matrix
\be
B = \bepm
f(X) & 0\\
0 & g(X)
\eepm = PAQ
\ee
where $P,Q$ are invertible. As we known,
\be
f(X)g(X) = \det B = \det P\det A \det Q = 0.
\ee

Since $\Z[X]$ is an integral domain (actually a UFD), $f(X)=0$ or $g(X) = 0$. Wlog we say $g(X) = 0$. Thus, we have
\be
A = \bepm 2 & 0 \\ X & 0 \eepm,\quad B = \bepm f(X) & 0 \\ 0 & 0 \eepm.
\ee

In lectures we proved that 
\be
\bsa{2,X} = \bsa{1\times 1 \text{ minors of }A} = \bsa{1\times 1 \text{ minors of }B} = \bsa{f(X)} \quad (\text{ which is a principal ideal})
\ee
since $A$ and $B$ are equivalent. But $\bsa{2,X}$ is not principal ideal (see the proof in notes).
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $M$ be a finitely-generated module over a ring $R$, and let $f$ be an $R$-module homomorphism from $M$ to itself. Does $f$ injective imply $f$ surjective? Does $f$ surjective imply $f$ injective? 
\end{problem}

\begin{solution}[\bf Solution.]

\end{solution}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Write $f(n)$ for the number of distinct abelian groups of order $n$.
\ben
\item [(i)] Show that if $n = p^{a_1}_1 p^{a_2}_2 \dots p^{a_k}_k$ with the $p_i$ distinct primes and $a_i \in \N$ then $f(n) = f(p^{a_1}_1)\dots f(p^{a_k}_k)$.
\item [(ii)] Show that $f(p^a)$ equals the number $p(a)$ of partitions of $a$, that is, $p(a)$ is the number of ways of writing $a$ as a sum of positive integers, where the order of summands is unimportant. (For example, $p(5) = 7$, since 5 = 4 + 1 = 3 + 2 = 3 + 1 + 1 = 2 + 2 + 1 = 2 + 1 + 1 + 1 = 1 + 1 + 1 + 1 + 1.)
\een
\end{problem}

\begin{solution}[\bf Solution.]
Let $G_n$ be the abelian group of order $n$.

\ben
\item [(i)] Structure theorem for finite abelian groups $G_n$ is isomorphic to 
\be
C_{d_1} \times C_{d_2} \times \dots \times C_{d_m},\quad d_1\mid d_2 \mid \dots \mid d_m. %We know that $\hcf(m,n) = 1$, then $C_{mn} = C_m \times C_n$
\ee

Now we write $d_i = \prod^k_{j=1}p_j^{b_ij}$ since $d_i \mid n$ with
\be
\forall j, \ b_{1j} \leq b_{2j} \leq \dots \leq b_{mj},\quad \sum^m_{i=1}b_{ij} = a_j.
\ee

By primary decomposition,
\be
C_{d_i} = R/\bsa{d_i} \cong R\left/\bsa{p_1^{b_{i1}}}\right. \oplus R\left/\bsa{p_2^{b_{i2}}}\right. \oplus \dots \oplus R\left/\bsa{p_k^{b_{ik}}}\right..
\ee

Hence,
\be
G_n \cong C_{d_1} \times C_{d_2} \times \dots \times C_{d_m} \cong \bigotimes^m_{i = 1} \bigotimes^k_{j=1} C_{p_j^{b_{ij}}} \cong \bigotimes^k_{j=1} \bigotimes^m_{i = 1} C_{p_j^{b_{ij}}} \cong \bigotimes^k_{j=1} \bb{C_{p_j^{b_{1j}}} \times C_{p_j^{b_{2j}}} \times \dots \times C_{p_j^{b_{mj}}}} .
\ee

Since $G_{p_j^{a_j}} \cong C_{p_j^{b_{1j}}} \times C_{p_j^{b_{2j}}} \times \dots \times C_{p_j^{b_{mj}}}$ (structure theorem), we have
\be
G_n \cong \bigotimes^k_{j=1} G_{p_j^{a_j}} = G_{p_1^{a_1}} \times \dots \times G_{p_k^{a_k}}.
\ee

Then we have $f(n) = f\bb{p_1^{a_1}} \times \dots \times f\bb{p_k^{a_k}}$.
%\be
%\abs{G_n} = \abs{G_{p_1^{a_1}}} \times \dots \times \abs{G_{p_k^{a_k}}}
%\ee
%since $\abs{H\times K} = \abs{H}\abs{K}$


\item [(ii)] Now $A = G_{p^a}$ where $p$ is a prime. Then we have
\be
G_{p^a} \cong C_{p^{a_1}} \times \dots \times C_{p^{a_k}},\quad a_1\mid \dots \mid a_k,\quad \sum^k_{i=1} a_i = a.
\ee

Thus, all the situations are included in the partitions of $a$ as $\sum^k_{i=1} a_i = a$. So $f(p^a) \leq p(a)$.

Also, for any partition we sort it with increasing order $b_1 \leq \dots b_m$. Then $p^{b_1} \mid \dots p^{b_m}$ which corresponds one of the abelian groups. Thus, $p(a) \leq f(p^a)$. Hence $f(p^a) = p(a)$.

Furthermore, to find $p(a)$, we define $g(a,n)$ which is the possibilities of putting $a$ elements into $n$ positions with increasing order. ($p(a) = g(a,a)$)

Then we have
\be
g(a,n) = \sum^{a\land n}_{i=1}g(a-i,i),\quad g(1,n) = g(0,n) = g(a,1) = 1.
\ee

For instance, 
\be
p(3) = g(3,3) = g(2,1) + g(1,2) + g(0,3) = 3.
\ee
\beast
p(4) = g(4,4) & = & g(3,1) + g(2,2) + g(1,3) + g(0,4)\\
& = & 3 + g(2,2) = 3 + g(1,1) + g(0,2) = 3 + 2 = 5.
\eeast
\beast
p(5) = g(5,5) & = & g(4,1) + g(3,2) + g(2,3) + g(1,4) + g(0,5)\\
& = & 1 + g(3,2) + g(2,3) + 1 + 1 = 3 + g(3,2) + g(2,3)\\
& = & 3 + g(2,1) + g(1,2) + g(1,1) + g(0,2) = 3 + 4 = 7.
\eeast

Thus, in previous question, the order 6000 abelian groups have 15 different forms as
\be
6000 = 2^4 \times 3 \times 5^3 \ \ra \ f(6000) = f(2^4)f(3)f(5^3) = p(4)p(1)p(3) = 5\cdot 1 \cdot 3 = 15.
\ee

%\be
%p(a) = p(a-1) + p(a-2) + \dots + p(1) + 1 \ \ra \ p(a) - p(a-1) = p(a-1)
%\ee

\een
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
$A$ real $n\times n$ matrix $A$ satisfies the equation $A^2 +I = 0$. Show that $n$ is even and $A$ is similar to a block matrix $\bepm
0 & -I\\
I & 0 
\eepm$ with each block an $m \times m$ matrix (where $n = 2m$).
\end{problem}

\begin{solution}[\bf Solution.]
First we have $A^2 = -I$ and $(\det A)^2 = \det A^2 = (-1)^n \geq 0$, thus $n$ is even.

$X^2 + 1$ is irreducible over $\R$, so it is minimal polynomial of $A$. Rational canonical form:
\be
\bepm
C(f_1(X)) & & \\
& \ddots & \\
& & C(f_r(X))
\eepm,\quad f_1(X)\mid \dots \mid f_r(X).
\ee

Then $f_r(X)$ is minimal polynomial. Since $f_1(X) = a_0 + a_1X + \dots + a_{n-1}X^{n-1} + X^n$,
\be
C(f_1(X)) = \bepm
0 & & & & & -a_0\\
1 & 0 & & & & -a_1\\
& \ddots & \ddots & & & \vdots\\
& & & \ddots & 0 & \vdots\\
& & & & 1 & -a_{n-1}
\eepm
\ee

$f_1(X)\dots f_r(X)$ is the characteristic polynomial. So $f_i(X) = X^2 + 1$ for any $i$. Then Rational canonical form of $A$ is
\be
\bepm
\bepm 0 & -1 \\ 1 & 0 \eepm & & \\
& \ddots & \\
& & \bepm 0 & -1 \\ 1 & 0 \eepm
\eepm \quad \ra \quad \text{$A$ is similar to $\bepm 0 & -I \\ I & 0 \eepm$}.
\ee
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let $R$ be a Noetherian ring and $M$ be a finitely generated $R$-module. Show that all submodules of $M$ are finitely generated.
\end{problem}

\begin{solution}[\bf Solution]
From Question \ref{que:fg_acc}, we know that it suffices to show $M$ is Noetherian (i.e., has ACC).

Thus, the statement becomes that $R$ is Noetherian and $M$ is finitely generated, then $M$ is Noetherian.

Since $M$ is finitely generated, we can write $M \cong R^k/N$ for some $k$ and $N$. 

We know that $R$ is Noetherian, thus $R\oplus R /R \cong R$ by second isomorphism theorem. Thus, $R\oplus R$ is Noetherian. By induction, $R^k$ is Noetherian.

Now we want to show that if $M \cong L/N$, then $L$ is Noetherian iff $M$ and $N$ are Noetherian.

($\ra$). If $L$ is Noetherian, $N$ is submodule of $L$ so any chain in $N$ is a chain in $L$. So $N$ is Noetherian. 
\be
L_1/N \subseteq L_2/N \subseteq \dots, \quad L_1 \subseteq L_2 \subseteq \dots.
\ee

If the chain terminates $L_n = L_m,\forall m\geq n$, we have $L_n/N = L_m /N, \forall m \geq n$. Thus, $M$ is Noetherian.

($\la$). For any $L_1 \subseteq L_2 \subseteq \dots $ chain in $L$. We have 
\ben
\item $L_1 \cap N \subseteq L_2 \cap N \subseteq$ is a chain in $N$, so it terminates. 
\item $L_1 / N \subseteq L_2 / N \subseteq$ is a chain in $L/N \cong M$ which also terminates.
\een

Thus, $\exists r\in \N$ s.t. (take the bigger of two indices) 
\be
L_r \cap N = L_{r+i} \cap N,\quad L_r /N = L_{r+i}/N,\quad\forall i.
\ee

Now we show $L_r = L_{r+i}$, $\forall i$. Take $x\in L_{r+i}$, we have $x + N \in L_{r+i}/N = L_r/N$, so 
\be
x + N = y + N \text{ for some }y\in L_r \ \ra \ x-y \in N, x-y \in L_{r+i} \ (\text{as }y \in L_r \subseteq L_{r+i}).
\ee

Thus, 
\be
x-y \in L_{r+i} \cap N = L_r \cap N \ \ra \ x-y \in L_r \ \ra \ x\in L_r \ \ra \ L_{r+i} \subseteq L_r.
\ee

Thus, $M$ is Noetherian. 
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Show that a complex number $\alpha$ is an algebraic integer if and only if the additive group of the ring $\Z[\alpha]$ is finitely generated (i.e. $\Z[\alpha]$ is a finitely generated $\Z$-module). Furthermore if $\alpha$ and $\beta$ are algebraic integers show that the subring $\Z[\alpha, \beta]$ of $\C$ generated by $\alpha$ and $\beta$ also has a finitely generated additive group and deduce that $\alpha - \beta$ and $\alpha \beta$ are algebraic integers. Show that the algebraic integers form a subring of $\C$.
\end{problem}

\begin{solution}[\bf Solution.]
Define the homomorphism 
\be
\phi: \Z[X]\to \Z[\alpha],\ p(X) \mapsto p(\alpha)
\ee 
between the additive groups $\Z[X],\Z[\alpha]$. $\ker \phi = \bra{p(X)m(X): p(X) \in \Z[X]}$ where $m(X)$ is the (monic) minimal polynomial of $\alpha$. By the first isomorphism theorem, $\Z[\alpha] \cong \Z[X]/ker\phi$. So 
\beast
\Z[\alpha] \text{ is a finitely generated $\Z$-module} & \lra & \ker \phi \neq \bra{0} \\
& \lra & \alpha \text{ is a a root of some }p\in \Z[X] \\
& \lra & \alpha \text{ is an algebraic integer.}
\eeast

Define the homomorphism 
\be
\vp : Z[X,Y] \to \Z[\alpha,\beta],\ p(X,Y) \mapsto p(\alpha,\beta),\quad \ker \vp = \bra{p(X,Y) \in \Z[X,Y]: p(\alpha,\beta) = 0}.
\ee

If $\alpha,\beta$ are algebraic integers, then $m_1(\alpha) = m_2(\beta) = 0$ for some $m_1,m_2\in \Z[X]\bs \bra{0}$. Hence if $m(X,Y) = m_1(X) + m_2(Y)$, then $m(\alpha,\beta) = 0$ and $\ker\vp \neq \bra{0}$. So $\Z[\alpha,\beta] \cong \frac{\Z[X,Y]}{\ker\vp}$ is finitely generated.

Every ideal in $\Z$ is finitely generated (since $\Z$ is a PID. In fact, it is generated by its smalledst positive element). Hence (proved in lectures) $\Z$ satisfies ACC for ideals, i.e., $\Z$ is a Noetherian ring. 

Since $\Z[\alpha,\beta]$ is a finitely generated $\Z$-module, by previous question, every submodule of $\Z[\alpha,\beta]$ is finitely generated. Furthermore, $\Z[\alpha -\beta]$ and $\Z[\alpha \beta]$ are submodules of $\Z[\alpha,\beta]$, so they are finitely generated. Then by the first part of the question, $\alpha -\beta$ and $\alpha \beta$ are algebraic integers.

Let $A\subseteq \C$ be the set of algebraic integers. We check 

{\bf addition.}
\ben
\item [] associativity and commutativity are clear.
\item [] closure: $\alpha,\beta \in A$ implies that $\alpha + \beta \in A$ (as $\Z[\alpha + \beta] \leq \Z[\alpha,\beta]$)
\item [] identity: 0
\item [] inverse: $0,\beta \in A$, then $0-\beta = -\beta \in A$ 
\een

{\bf multiplication.}
\ben
\item [] associativity and commutativity are clear.
\item [] closure: $\alpha,\beta \in A$ implies that $\alpha + \beta \in A$ (as $\Z[\alpha\beta] \leq \Z[\alpha,\beta]$)
\item [] identity: 1
\een

{\bf distributive laws.} clear.

So $A$ is subring of $\C$.
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
What is the rational canonical form of a matrix?

Show that the group $GL_2(\F_2)$ of non-singular $2 \times 2$ matrices over the field $\F_2$ of 2 elements has three conjugacy classes of elements.

Show that the group $GL_3(\F_2)$ of non-singular $3\times 3$ matrices over the field $\F_2$ has six conjugacy classes of elements, corresponding to minimal polynomials $X+1$, $(X+1)^2$, $(X+1)^3$, $X^3+1$, $X^3+X^2+1$, $X^3+X+1$, one each of elements of orders 1, 2, 3 and 4, and two of elements of order 7.
\end{problem}

\begin{solution}[\bf Solution.]
Every square matrix over a field is conjugate to a matrix in rational canonical form
\be
\bepm
C(f_(X)) & & 0\\
& \ddots & \\
0 & & C(f_k(X))
\eepm \quad \text{where }\quad C(f(X)) = \bepm
0 & 0 & \dots & 0 & -a_0\\
1 & 0 & \dots & 0 & -a_1\\
0 & 1 & \dots & 0 & -a_2\\
\vdots & \vdots & \ddots & & \vdots \\
0 & 0 & \dots & 1 & -a_{n-1}
\eepm
\ee
for the characteristic polynomial $f(X) = X^n + a_{n-1}X^{n-1} + \dots + a_0$.

Martices in $GL_2(\F_2)$ are conjugate to matrices of the form 
\be
\bepm -a_0 & 0 \\ 0 & - b_0 \eepm \quad \text{or }\quad \bepm 0 & -a_0 \\ 1 & - b_0 \eepm
\ee
(2 blocks of size 1 or one of size 2).

The determinant must be 1, so every matrix in $GL_2(\F_2)$ is conjugate to one of 
\be
\bepm 1 & 0 \\ 0 & 1 \eepm,\quad \bepm 0 & 1 \\ 1 & 0 \eepm,\quad \bepm 0 & 1 \\ 1 & 1 \eepm.
\ee

These 3 matrices have orders 1,2,3, so they aren't conjugate. Hence there are 3 conjugacy classes in $GL_2(\F_2)$.

In $GL_3(\F_2)$, the matrices in rational canocial form have 3 block of size 1 or one of size 2 and one of size 1 or one of size 3. So the possible form are
\be
\bepm -a_0 & 0 &  0 \\ 0 & - b_0 & 0 \\ 0 & 0 & -c_0  \eepm, \quad \bepm 0 & -a_0 & 0 \\ 1 & - a_1 & 0 \\ 0 & 0 & -b_0\eepm, \quad \bepm 0 & 0 & -a_0 \\ 1 & 0 & - a_1 \\ 0 & 1 & -a_2\eepm
\ee

The determinant is 1, so we have following matrices
\be
A = \bepm 1 & 0 &  0 \\ 0 & 1 & 0 \\ 0 & 0 & 1  \eepm, \  B= \bepm 0 & 1 &  0 \\ 1 & 0 & 0 \\ 0 & 0 & 1  \eepm, \  C = \bepm 0 & 1 &  0 \\ 1 & 1 & 0 \\ 0 & 0 & 1  \eepm,\  D =\bepm 0 & 0 & 1 \\ 1 & 0 & 0 \\ 0 & 1 & 0  \eepm,\  E = \bepm 0 & 0 & 1 \\ 1 & 0 & 0 \\ 0 & 1 & 1  \eepm,\  F= \bepm 0 & 0 & 1 \\ 1 & 0 & 1 \\ 0 & 1 & 0  \eepm,\  G =\bepm 0 & 0 & 1 \\ 1 & 0 & 1 \\ 0 & 1 & 1  \eepm.
\ee

But $C$ and $D$ are conjugate. we have $Q = \bepm 1 & 1 & 0 \\ 1 & 0 & 1 \\ 1 & 1 & 1  \eepm$ ($CQ = QD$), 
\be
\bepm 0 & 1 & 0 \\ 1 & 1 & 0 \\ 0 & 0 & 1  \eepm \bepm 1 & 1 & 0 \\ 1 & 0 & 1 \\ 1 & 1 & 1  \eepm =  \bepm 1 & 0 & 1 \\ 0 & 1 & 1 \\ 1 & 1 & 1  \eepm = \bepm 1 & 1 & 0 \\ 1 & 0 & 1 \\ 1 & 1 & 1  \eepm \bepm 0 & 0 & 1 \\ 1 & 0 & 0 \\ 0 & 1 & 0  \eepm
\ee

Thus, 
\ben
\item [] $A$ has order 1 and minimal polynomial is $X+1$.
\item [] $B$ has order 2 and minimal polynomial is $(X+1)^2$.
\item [] $D$ has order 3 and minimal polynomial is $X^3+1$.
\item [] $E$ has order 7 and minimal polynomial is $X^3 + X^2 +1$.
\item [] $F$ has order 4 and minimal polynomial is $(X+1)^3$.
\item [] $G$ has order 7 and minimal polynomial is $X^3 + X +1$.
\een

None of these six matrices are conjugate, because any two of them have different minimal polynomials.
\end{solution}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% analysis II

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Groups, Ring and Modules (draft)}

\section{Groups}

\subsection{Basic concepts}

\begin{definition}[Group]
A set $G$ is a group\index{group} if there is a binary operation $G \times G \to G$, satisfying
\ben
\item [(i)] If $g_1, g_2 \in G$ then $g_1g_2 \in G$ (closure).
\item [(ii)] For all $g_1, g_2, g_3 \in G$, $(g_1g_2)g_3 = g_1(g_2g_3)$ (associativity).
\item [(iii)] There exists $e \in G$ such that, for all $g \in G$, $eg = ge = g$ (identity element).
\item [(iv)] For all $g \in G$ there exists $g^{-1} \in G$, $gg^{-1} = g^{-1}g = e$ (inverses).
\een
\end{definition}

\begin{definition}[Subgroup]
A subset $H$ is a subgroup\index{subgroup} of $G$ if it is a group under the restriction of the operation. We write $H \leq G$.
\end{definition}

\begin{example}
\ben
\item [(i)] Additive groups, e.g. $(\Z, +)$, $(\R, +)$, $(\C, +)$.
\item [(ii)] Matrix groups, such as the general linear group $GL(\R^n)$, i.e. the group of invertible $n\times n$ matrices, or the special linear group $SL(\R^n)$, i.e. matrices with determinant 1.
\item [(iii)] Permutation groups, i.e. the symmetric group $S_n$ of permutations on $\{1,\dots , n\}$ and the alternating group $A_n$ containing even permutations.
\item [(iv)] Cyclic groups of order $n$, i.e. $\{e, g,\dots , g^{n-1}\}$, and dihedral groups $D_{2n}$ of order $2n$, i.e. the symmetries of the regular $n$-gon.
\item [(v)] Abelian groups, e.g. groups of order 4 including the Viergruppe $V$.
\item [(vi)] The quaternion group $\{\pm 1,\pm i,\pm j,\pm k\}$, $ij = k$, $ji = -k$ of order 8.
\een
\end{example}

Given a subgroup $H \leq G$, we can define an equivalence relation on $G$ by 
\be
g_1 \sim g_2 \ \lra \ g^{-1}_1 g_2 \in H.
\ee

This partitions $G$ into equivalence classes, called left cosets\index{left cosets} of $H$ in $G$,
\be
gH = \{gh : h \in H\}.
\ee

All these cosets are of the same size $|H|$. Counting the elements of $G$ we obtain

\begin{theorem}[Lagrange]\label{thm:lagrange_group}
Let $G$ be a finite group with subgroup $H$. Then
\be
\abs{G} = \abs{H}\abs{G : H}
\ee
where $\abs{G : H}$ is the number of left cosets of $H$ in $G$, called the index of $H$ in $G$.
\end{theorem}

You can also do the same with the equivalence relation $g_1 \sim g2 \ \lra\ g_2g^{-1}_1 \in H$, obtaining right cosets as equivalence classes. The number of right cosets is equal to the number of left cosets.

\begin{definition}[Order]
The order\index{order} $o(g)$ of $g \in G$ is the least $n \in \N$ such that $g^n = e$. Note this implies that if $g^m = e$ then $o(g) | m$.
\end{definition}

\begin{lemma}
The order $o(g)$ divides $|G|$.
\end{lemma}
\begin{proof}[\bf Proof]
The set $\{e, g,\dots , g^{o(g)-1}\}$ is a subgroup of $G$. Now apply Theorem \ref{thm:lagrange_group}.
\end{proof}

\subsection{Normal subgroups, quotient groups, homomorphism and isomorphisms}

\begin{example}
The integers lie inside the real numbers, $(\Z, +) \leq (\R, +)$. We would like to add cosets,
\be
(\Z + r_1) + (\Z + r_2) = \Z + (r_1 + r_2).
\ee

In general, we want to copy this procedure to define an operation on the cosets of a subgroup. If $K \leq G$ we want to define $g_1Kg_2K = g_1g_2K$. But this requires $Kg_2K = g_2K$, after multiplying on left by $g^{-1}_1$. In particular, we need $Kg_2 \subset g_2K$ for all $g_2 \in G$, and also $Kg^{-1}_2 \subset g^{-1}_2 K$ which implies $g_2K \subset Kg_2$. So to make the definition work we need that $gK = Kg$ for all $g \in G$.
\end{example}

\begin{definition}[Normal subgroup]
A subgroup $K \leq G$ is normal\index{normal} in $G$ if $gK = Kg$ for all $g \in G$. Equivalently, $gKg^{-1} = K$ for all $g \in G$. We write $K \lhd G$.
\end{definition}

\begin{example}
In abelian groups all subgroups are normal. In general, $\{e\}$ and $G$ are always normal. In the dihedral group $D_{2n}$, the subgroup of rotations is normal but $\{e, \tau\}$, for a reflection $\tau$, is not normal if $n \geq 3$.
\end{example}

\begin{proposition}\label{pro:normal}
Let $K \lhd G$. Then the set of cosets of $K$ in $G$ form a group under the operation $g_1Kg_2K = g_1g_2K$.
\end{proposition}

\begin{definition}[Quotient group]
This group is the quotient group $G/K$.
\end{definition}

\begin{proof}[\bf Proof]
We need to check that the definition is well-defined, that is, if $g_1K = g_1'K$ and $g_2K = g_2'K$ then $g_1g_2K = g_1'g_2' K$. (See Algebra \& Geometry.)

The identity element is $K$, the inverse of $gK$ is $g^{-1}K$. Associativity is inherited from $G$.
\end{proof}

\begin{definition}[Homomorphism]
A map $\theta : G \to H$ where $G$ and $H$ are groups is a homomorphism\index{homomorphism} if 
\be
\theta(g_1g_2) = \theta(g_1)\theta(g_2).
\ee
\end{definition}

\begin{lemma}\label{lem:ker_im}
\ben
\item [(i)] The kernel $\ker \theta = \{g \in G : \theta(g) = e\} \lhd G$ is a normal subgroup. 
\item [(ii)] The image $\im \theta = \{\theta(g) : g \in G\} \leq H$ is a subgroup.
\een
\end{lemma}

\begin{proof}[Proof]
\ben
\item [(i)] Let $K = \{g \in G : \theta(g) = e\}$. Then the left coset $gK$ is the set $\{g_1\in G : \theta(g_1) = \theta(g)\}$ since
\be
\theta(g_1) = \theta(g) \ \lra\ \theta(g^{-1}g_1) = e \ \lra\  g^{-1}g_1 \in K \ \lra\ g_1 \in gK.
\ee

Similarly, the right coset $Kg$ is the set $\{g_1 \in G : \theta(g_1) = \theta(g)\}$. Thus $Kg = gK$.

\item [(ii)] We need to check that $\theta(g_1)\theta(g_2)^{-1} \in \im \theta$ for all $g_1, g_2$. But this is $\theta(g_1g_2^{-1})$.
\een
\end{proof}

\begin{definition}[Isomorphism]
An isomorphism\index{isomorphism} is a bijective homomorphism.
\end{definition}

Observe that 'isomorphic to' defines an equivalence relation on groups. The notation used is $\cong$.

\begin{theorem}[First isomorphism theorem\index{isomorphism theorem}]\label{thm:isomorphism_1} 
Let $\theta : G \to H$ be a homomorphism. Then $\ker \theta$ is a normal subgroup and $G/ \ker \theta \cong \im \theta$.
\end{theorem}
\begin{proof}[Proof]
We define a map $\Phi: G/K \to \im \theta$, $gK \mapsto \theta(g)$ where $K = \ker \theta$. Check that $\Phi$ is well-defined,
\be
g_1K = g_2K \ \ra \ g^{-1}_2 g_1 \in K \ \ra \ \theta(g^{-1}_2 g_1) = e \ \ra \ \theta(g_2)^{-1}\theta(g_1) = e \ \ra \ \theta(g_1) = \theta(g_2).
\ee

$\Phi$ is a homomorphism,
\be
\Phi(g_1Kg_2K) = \Phi(g_1g_2K) = \theta(g_1g_2) = \theta(g_1)\theta(g_2) = \Phi(g_1K)\Phi(g_2K). 
\ee
$\Phi$ is injective. If $\theta(g_1) = \theta(g_2)$ then $\theta(g^{-1}_1 g_2) = e$ and so $g^{-1}_1 g_2 \in K$. Hence $g_1K = g_2K$. Clearly, $\Phi$ is surjective.
\end{proof}

\begin{example}
Consider the map
\be
\theta : (\R, +) \to (\C^\times,\times),\ r \mapsto e^{2\pi ir}.
\ee
This is a group homomorphism, $\theta(r_1+r_2) = \theta(r_1)\theta(r_2)$. Its kernel is $(\Z, +)$. Theorem \ref{thm:isomorphism_1} implies $\R/\Z \cong \im \theta = \{e^{2\pi ir} : r \in \R\}$. The map $\Phi$ as above is $\Phi(\Z + r) = e^{2\pi ir}$.
\end{example}

\begin{theorem}[Second isomorphism theorem\index{isomorphism theorem}]\label{thm:isomorphism_2} 
Let $H \leq G$ and $K \lhd G$. Then $HK \leq G$ and $H \cap K \lhd G$ where $HK = \{hk : h \in H, k \in K\}$ and $(HK)/K \cong H/(H \cap K)$.
\end{theorem}

\begin{proof}[\bf Proof]
First show that $HK$ is a subgroup. Take $hk \in HK$. Then 
\be
(hk)(h_1k_1)^{-1} = h \underbrace{kk^{-1}_1}_{\in K} h^{-1}_1
\ee

But $Kh^{-1}_1 = h^{-1}_1 K$ since $K \lhd G$ and so $(kk^{-1})h^{-1}_1 = h^{-1}_1 k_3$ for some $k_3 \in K$. So $(hk)(h_1k_1)^{-1} = hh^{-1}_1 k_3 \in HK$.

Define
\be
\theta : H \to G/K,\ h \mapsto hK.
\ee
This is a group homomorphism,
\be
\theta(h_1h_2) = h_1h_2K = h_1Kh_2K = \theta(h_1)\theta(h_2).
\ee
So Theorem \ref{thm:isomorphism_1} implies that $H/\ker \theta \cong \im \theta$. Now 
\be
\ker \theta = \{h \in H : hK = K\} = H \cap K,\quad\quad \im \theta = \{hK : h \in H\} = (HK)/K,
\ee
cosets of $K$ in $HK$. Thus $H/(H \cap K) \cong (HK)/K$, as required.
\end{proof}

In fact, there is a bijection between subgroups of $G/K$ and the subgroups of $G$ containing $K$. This is given by the maps
\beast
\text{\{subgroups of $G/K$\}} & & \text{\{subgroups of $G$ containing $K$\}}\\
X\quad\quad & \ \longrightarrow \ & \quad \quad \{g \in G : gK \in X\}\\
L/K \quad\quad & \ \longleftarrow \ & \quad\quad\quad L
\eeast

These maps are inverses of each other.

Take a normal subgroup $K \lhd G$ and form the quotient group $G/K$, with elements the cosets $gK$ and multiplication defined by $g_1Kg_2K = g_1g_2K$. The correspondence
\be
\text{\{subgroups of $G/K$\}}\ \longleftrightarrow\ \text{\{subgroups of $G$ containing $K$\}}
\ee
restricts to
\be
\text{\{normal subgroups of $G/K$\}} \ \longleftrightarrow \ \text{\{normal subgroups of $G$ containing $K$\}}
\ee
For a subgroup $L/K \leq G/K$ we have that
\be
(gK)(L/K)(gK)^{-1} = (gLg^{-1})/K
\ee
so
\be
(gK)(L/K)(gK)^{-1} = L/K \ \lra\ gLg^{-1} = L,
\ee
that is,
\be
L/K \lhd G/K \ \lra\  L \lhd G.
\ee

\begin{theorem}[Third isomorphism theorem\index{isomorphism theorem}]\label{thm:isomorphism_3} 
If $K$ and $L$ are normal subgroups of $G$ with $K \leq L \lhd G$ then $(G/K)/(L/K) \cong G/L$.
\end{theorem}

\begin{proof}[\bf Proof]
Apply Theorem \ref{thm:isomorphism_1}  to the well chosen map
\be
\theta : G/K \to G/L,\ gK \mapsto gL.
\ee

We need to check this is well-defined,
\be
g_1K = g_2K \ \ra \ g^{-1}_1 g_2 \in K \leq L \ \ra \ g_1 L = g_2L.
\ee
$\theta$ is a homomorphism,
\be
\theta(g_1Kg_2K) = \theta(g_1g_2K) = g_1g_2L = g_1Lg_2L = \theta(g_1K)\theta(g_2K).
\ee
Clearly, $\im \theta = G/L$. Also $\ker \theta = \{gK : gL = L\} = L/K$ and so Theorem \ref{thm:isomorphism_1} implies
\be
(G/K)/(L/K) \cong G/L.
\ee
\end{proof}

\begin{definition}[Simplicity]
$G$ is simple\index{simple} if the only normal subgroups in it are $\{e\}$ and $G$ itself.
\end{definition}

\begin{example}
The only simple abelian groups are $C_p$ for $p$ prime.
\end{example}

\begin{proof}[\bf Proof]
'Normal' for abelian groups is easy to understand as all subgroups are normal because of commutativity. Take a non-trivial element $g \neq e$ in a simple abelian group $G$.

Then either $g$ is of infinite order and $G$ contains the subgroup $\{\dots, g^{-1}, e, g, g^2,\dots\}$.

Simplicity implies that $G = \{\dots, g^{-1}, e, g, g^2,\dots \}$. But then there is also the subgroup $\{\dots, g^{-2}, e, g^2, g^4,\dots \}$, a contradiction.

Or $g$ is of finite order and $G$ has the subgroup $\{e, g, g^2,\dots , g^{o(g)-1}\}$. Simplicity implies that $G = \{e, g, g^2,\dots , g^{o(g)-1}\}$. But if $o(g) = rs$, say, then we also have the subgroup $\{e, g^r, g^{2r},\dots , g^{r(s-1)}\}$. Now simplicity implies that there are no non-trivial factorisations of $o(g)$ so $G = \{e, g,\dots , g^{p-1}\}$ for some prime $p$.
\end{proof}

We shall see shortly that the alternating group $A_5$ on $\{1,\dots , 5\}$ is simple. In fact, $A_n$ is simple for $n \geq 5$, but we don't need to know the proof. Note that $|A_3| = 3$, so $A_3$ is isomorphic to $C_3$ and simple. $|A_4| = 12$ and $A_4$ contains the normal subgroup $V = \{e, (12)(34), (13)(24), (14)(23)\} \lhd A_4$, so $A_4$ is not simple.

There are finitely many families of finite simple groups, and 26 groups that do not fit into those general families, called the sporadic ones.

Note $|A_5| = 60$ and $|A_6| = 360$. There is another finite simple group of order 168, $GL_3(\Z \bmod 2)$, the group of invertible $3 \times 3$ matrices entries $\{0, 1\}$ modulo 2. (This is left as an exercise.)

\begin{theorem}
Let $G$ be a finite group. Then there are subgroups $H_1,\dots ,H_s$ such that 
\be
G = H_1 \geq H_2 \geq \dots \geq H_s = \{e\}
\ee
with $H_{i+1} \lhd H_i$ and $H_i/H_{i+1}$ simple.
\end{theorem}

{\bf Warning}. Not all $H_i$ normal in $G$.

\begin{proof}[\bf Proof]
Let $H_2$ be normal in $G$ with $|H_2|$ of largest order not equal to $|G|$. Then the correspondence between normal subgroups of $G$ containing $H_2$ and the normal subgroups of $G/H_2$ implies that $G/H_2$ simple. Repeat this to find $H_3 \lhd H_2$ with $H_2/H_3$ simple.

The process stops when we reach $H_s = \{e\}$.
\end{proof}

\begin{remark}
The simple groups $H_i/H_{i+1}$ are essentially unique, although there may be lots of ways of picking the subgroups $H_i$, called composition factors\index{composition factor}.
\end{remark}

\begin{definition}
$G$ is soluble\index{soluble} if all composition factors can be chosen to be cyclic of prime order.
\end{definition}

\begin{remark}
The terminology comes from Galois theory, see the relevant Part II course. You all know a formula for solving quadratic equations. You can do something similar involving roots for cubics and quartics, the process is called 'solution by radicals'. But you cannot necessarily do it for a quintic, e.g. $t^5 - 6t + 3 = 0$. This can be shown by defining a Galois group associated with the polynomial. If you can solve the polynomial by radicals then the Galois group is soluble.
\end{remark}

\subsection{Permutation groups, actions and representations}

The symmetry group $S_n$ consists of permutations of $\{1,\dots , n\}$. Useful notation is the disjoint cycle form, e.g. (1 2 3)(4 5)(6) where the single cycle is often suppressed.

It contains a subgroup $A_n \leq S_n$, the alternating group of even permutations.

We recall that every permutation can be expressed as a product of transpositions. An element $g$ is even if you need an even number of transpositions in such a product.

Equivalently in disjoint cycle form, $g$ is even if the number of even length cycles is even, e.g. (1 2 3) = (1 2)(2 3) is even but (1 2 3 4) = (1 2)(2 3)(3 4) is odd.

We note that the orders of these two groups are
\be
\abs{S_n} = n!,\quad\quad \abs{A_n} = \frac {n!}2.
\ee

We can quickly see that the alternating group $A_n \lhd S_n$ is a normal subgroup. There are two left cosets of $A_n$, $S_n \ A_n = gA_n$ for all permutations $g$ and two right cosets of $A_n$, $S_n \ A_n = A_ng$. Thus the left cosets are equal to the right cosets. More generally, for any set you can define the symmetric group $\text{Sym}G$ of all bijective maps $\Omega \to \Omega$.

\begin{definition}
A group $G$ is a permutation group\index{permutation group} of degree $n$ if $G \leq \sym \Omega$ with $\abs{\Omega} = n$.
\end{definition}

\begin{example}
$S_n, A_n,D_{2n} \leq \sym\Omega$ where $\Omega$ is the set of vertices of the regular $n$-gon.
\end{example}

\begin{definition}
An action\index{action} of a group $G$ on a set $\Omega$ is a map $G \times \Omega \to \Omega,\ (g, \alpha) \mapsto g * \alpha$, often also written as $g(\alpha)$, such that
\ben
\item [(i)] $g * \alpha \in \Omega$ for each $\alpha \in \Omega$,
\item [(ii)] $g_1 * (g_2 * \alpha) = g_1g_2 * \alpha$,
\item [(iii)] $e *\alpha = \alpha$.
\een
\end{definition}

\begin{lemma}\label{lem:permutation}
Let $G$ act on $\Omega$. Then for $g \in G$ the map $\Phi_g : \alpha \mapsto g * \alpha$ is a permutation of $\Omega$ and the map
\be
\Phi: G \to \sym \Omega,\ g \mapsto  \Phi_g
\ee
is a homomorphism, a permutation representation\index{permutation representation} of $G$.
\end{lemma}

The image $\Phi(G)$ is a subgroup of $\sym\Omega$, denoted $G^\Omega$. The kernel of $\Phi$, $\ker\Phi = \{g \in G : g * \alpha = \alpha \text{ for all }\alpha \in \Omega\}$, also denoted $G_{\Omega}$, is a normal subgroup and $G/G_\Omega \cong G^\Omega$.

\begin{proof}[\bf Proof]
$\Phi_{g^{-1}}$ is the inverse of $\Phi_g$ and so $\Phi_g$ is a bijection. The map $\Phi: G \to \sym \Omega$ is a homomorphism, from the second property of the definition of action. The rest is from Theorem \ref{thm:isomorphism_1}.
\end{proof}

\begin{example}
\ben
\item [(i)] Let $G$ be the symmetry group of the cube, $|G| = 48$, and $\Omega$ the set of diagonals, $\abs{\Omega} = 4$. $G$ acts on $\Omega$,
\be
G^\Omega = S_4,\quad\quad G_\Omega = \{e,\text{ symmetry sending each vertex to the opposite one}\}.
\ee

\item [(ii)] The left regular action of $G$ on $\Omega = G$, given by
\be
g * g_1 = gg_1.
\ee

$\Phi_g$ is left multiplication by $g$. The kernel is $\{e\}$, so Lemma \ref{lem:permutation} gives Cayley's Theorem \ref{thm:cayley}.

\item [(iii)] For a subgroup $H$ of $G$, let $\Omega$ be the set of left cosets of $H$. Consider the action of $G$ on $\Omega$ given by
\be
g * g_1H = gg_1H.
\ee

The kernel is $\bigcap_{g_1\in G} g_1Hg^{-1}_1$ since, for all $g_1 \in G$,
\be
gg_1H = g_1H \ \ra\ g^{-1}_1gg_1H  = H \ \ra \ g^{-1}_1 gg_1 \in H \ \ra \ g \in g_1Hg^{-1}_1 .
\ee

The kernel is the largest normal subgroup of $G$ contained in $H$. If $K \lhd G$, $K \leq H$ then $g_1Kg^{-1}_1 = K$ since $K$ is normal. But $g_1Kg^{-1}_1 \leq g_1Hg^{-1}_1$ so $K \leq g_1Hg^{-1}_1$ for all $g_1\in G$.
\een
\end{example}

\begin{theorem}[Cayley Theorem\index{Cayley Theorem}]\label{thm:cayley}
Any group $G$ is isomorphic to a subgroup of $\sym G$.
\end{theorem}

\begin{theorem}
Let $G$ be a finite group and $H$ a proper subgroup of $G$ of index $n$. Then there is a normal subgroup $K$ of $G$ contained in $H$ such that $G/K$ is isomorphic to a subgroup of $S_n$. In particular $|G : K|$ divides $n!$ and is at least $n$.

Moreover, if $G$ is non-abelian simple then $G$ is isomorphic to a subgroup of $A_n$ and $n \geq 5$.
\end{theorem}

\begin{proof}[\bf Proof]
Let $K$ be the kernel of the action of $G$ on $\Omega$, where $\Omega$ is the set of left cosets of $H$. Lemma \ref{lem:permutation} implies that $G/K \cong G^\Omega$, a subgroup of $S_n$. Lagrange's theorem \ref{thm:lagrange_group} implies subgroups of $S_n$ have order dividing $n!$. Since $K \leq H$ and $H$ is of index $n$ in $G$ we have that $|G/K| \geq n$.

Now assume $G$ is non-abelian simple. Then $K = \{e\}$, and so $G \cong G^\Omega$ subgroup of $S_n$. But $A_n \lhd S_n$ and so $G^\Omega \cap A_n \lhd G^\Omega$. Simplicity implies that either
\be
G^\Omega \cap A_n = \{e\} \quad \text{or}\quad G^\Omega \cap A_n = G^\Omega.
\ee
In the first case, the second isomorphism theorem implies
\be
G^\Omega/(G^\Omega \cap A_n) \cong (G^\Omega A_n)/A_n \leq S_n/A_n
\ee
and hence $\abs{G^\Omega } \leq 2$ since $G^\Omega \cap A_n = \{e\}$, a contradiction. Finally, we have $n > 4$ since $A_4$ has no non-abelian simple subgroups.
\end{proof}

Let us recall some definitions from the Part IA course Algebra \& Geometry. Let $G$ act on $\Omega$.

\begin{definition}
The orbit\index{orbit} on $\Omega$ containing $\alpha$ is $G(\alpha) = \{g* \alpha : g \in G\}$. The stabiliser\index{stabiliser} of $\alpha$ is $G_\alpha = \{g \in G : g * \alpha = \alpha\}$.
\end{definition}

\begin{theorem}[Orbit-stabiliser theorem\index{Orbit-stabiliser theorem}]\label{thm:orbit-stabiliser}
Let $G$ act on $\Omega$. Then $|G : G_\alpha| = |G(\alpha)|$.
\end{theorem}

\begin{proof}[\bf Proof]
The map
\be
\{\text{cosets of $G_\alpha$ in $G$}\} \to G(\alpha),\quad gG_\alpha \mapsto g * \alpha
\ee
is a bijection.
\end{proof}

\subsection{Conjugacy classes, centralisers and normalisers}

We consider the conjugation action of $G$ on $\Omega = G$, defined by
\be
g * x = g x g^{-1}.
\ee
for $x \in \Omega = G$. In this case the permutation $\Phi_g : x \mapsto gxg^{-1}$ as well as being bijective is a homomorphism $G \to G$. Thus they are automorphisms\index{automorphisms}. The automorphism group $\aut G$ of isomorphisms $G \to G$ is a group under the composition of maps. We have $\Phi_g \in \aut G$.

Orbits are called conjugacy classes\index{conjugacy classes}, $\ccl G(x) = \{gxg^{-1} : g \in G\}$. Stabilisers are called centralisers\index{centralisers} of $x$, $C_G(x) = \{g \in G : gxg^{-1} = x\} = \{g \in G : gx = xg\}$.

The orbit-stabiliser theorem implies $|G : C_G(x)| = |\ccl_G(x)|$. The kernel of the action
\be
G_\Omega = \{g \in G : \forall x\in \Omega, gxg^{-1} = x\} = \{g \in G : \forall x \in \Omega, gx = xg\} = \bigcap_{x\in G} C_G(x)
\ee
is called the centre\index{centre} of $G$, $Z(G)$.

Observe that $|\ccl_G(x)|$ divides $|G|$, which is part of Lagrange's Theorem \ref{thm:lagrange_group}.

\begin{lemma}
Let $G$ be a finite group. Then $1 = \sum 1/|C_G(x)|$, summing over distinct conjugacy classes.
\end{lemma}

\begin{proof}[\bf Proof]
We count the elements of $G$. $|G| = \sum \abs{\ccl_G(x)}$, so
\be
|G| = \sum \frac{|G|}{|C_G(x)|}
\ee
since $\abs{\ccl_G(x)} = |G|/|C_G(x)|$. Now divide by $|G|$.
\end{proof}

\begin{example}[Conjugacy classes of $S_n$ and $A_n$]
Recall from Algebra \& Geometry that two permutations are conjugate in $S_n$ precisely when they have the same cycle type when expressed in disjoint cycle form, e.g. $2^2\ 1$ denotes the cycle type of double transpositions in $S_5$, e.g. $(1\ 2)(3\ 4)(5)$.

In $S_5$, we have the following cycle types:

\begin{center}
\begin{tabular}{c|cccc|ccc}
\ cycle type\ & \ $1^5$\ & \ $2^2$ \ 1\ & \ 3\ $1^2$\ & \ 5\ & \ 2\ $1^3$\ & \ 3 \ 2 \ & \ 4\ 1\ \\\hline
\# elements & 1 & 15 & 20 & 24 & 10 & 20 & 30\\
\end{tabular}\\
\qquad\qquad\qquad\quad even permutations \qquad\quad odd permutations
\end{center}

For $x \in A_n$ we have that $\ccl_{A_n}(x) \subset \ccl_{S_n}(x)$. We also have 
\be
|\ccl_{S_n}(x)| = |S_n : C_{S_n}(x)|,\quad\quad |\ccl_{A_n}(x)| = |A_n : C_{A_n}(x)|
\ee
by the orbit-stabiliser theorem. But $C_{A_n}(x) = A_n \cap C_{S_n}$, and thus this set has index 1 or 2 in $C_{S_n}(x)$. To see this, use the second isomorphism theorem, Theorem \ref{thm:isomorphism_2},
\be
C_{S_n}(x)/(A_n \cap C_{S_n}(x)) \cong (A_nC_{S_n}(x))/A_n \leq S_n/A_n.
\ee

If all permutations that commute with $x$ are even, i.e. $C_{S_n}(x) = C_{A_n}(x)$,
\be
|\ccl_{S_n}(x)| = \frac{|S_n|}{|C_{S_n}(x)|} = \frac{2|A_n|}{C_{A_n}(x)} = 2|\ccl_{A_n}(x)|.
\ee

If there is an odd permutation commuting with $x$, i.e. $|C_{S_n}(x) : C_{A_n}(x)| = 2$,
\be
|\ccl_{S_n}(x)| = \frac{|S_n|}{|C_{S_n}(x)|} = \frac{|A_n|}{C_{A_n}(x)}= |\ccl_{A_n}(x)|.
\ee
\end{example}

\begin{example}
Consider $S_5$ and $A_5$, take $x \in A_5$. $(1\ 2)(3\ 4)(5)$ commutes with $(1\ 2)$, $(1\ 2\ 3)(4)(5)$ commutes with $(4\ 5)$. But conjugacy classes of 5 cycles do not split into 2 conjugacy classes of size 12. Consider $(1\ 2\ 3\ 4\ 5)$ and its conjugates.
\be
g(1\ 2\ 3\ 4\ 5)g^{-1} = (g(1) \dots g(5))
\ee
\be
C_{S_n}(1\ 2\ 3\ 4\ 5) = \{e, (1\ 2\ 3\ 4\ 5), (1\ 3\ 5\ 2\ 4), (1\ 4\ 2\ 5\ 3), (1\ 5\ 4\ 3\ 2)\}
\ee
$C_{S_n}(1\ 2\ 3\ 4\ 5)$ is of order 5, all elements are even.
\end{example}

\begin{proposition}
$A_5$ is simple.
\end{proposition}

\begin{proof}[\bf Proof]
Consider a normal subgroup $K$ of $A_5$. Thus $gkg^{-1} \in K$ for all $k \in K$, $g \in A_5$. Thus $K$ must be a union of conjugacy classes in $A_5$. But by Lagrange's Theorem \ref{thm:lagrange_group}, $|K|$ divides $60 = |A_5|$. There is no way of taking a union of the conjugacy classes we've worked out to give $|K|$ dividing 60, unless $K = \{e\}$ or $K = A_5$.
\end{proof}

\begin{proof}[\bf Alternative Proof]
Proof that $A_5$ is simple 

Theorem: The alternating group A5 is simple.

Proof: Suppose $\{e\} \neq H \lhd A_5$. We will prove that $H = A_5$. Our first goal is to prove the following:

Lemma: $H$ must contain a 3-cycle.

Proof: Let $\sigma \in A_5$. When we write $\sigma$ in disjoint cycle notation it is either a 5-cycle, a 3-cycle or a product of two 2-cycles. (since the other possible cycle types are odd permutations.)

Suppose $H$ contains a 5-cycle $\sigma = (abcde)$. Since $(ace) \in A_5$ and $H \lhd A_5$ we have:
\be
(ace)\sigma(ace)^{-1} = (acbed) \in H
\ee
But $H$ is a subgroup so $(abcde)(acbed) = (adb) \in H$.

Now suppose $H$ contains a product of two disjoint transpositions: $\sigma = (ab)(cd) \in H$. Then $(ae)(cd) \in A_5$ so 
\be
(ae)(cd)\sigma (ae)(cd)^{-1} = (be)(cd) \in H
\ee
since $H \lhd A_5$. Thus $(ab)(cd)(be)(cd) = (abe) \in H$.

Thus $H \neq \{e\}$ implies $H$ contains a 3-cycle.

Now pick a 3-cycle $(abc) \in H$. Consider the following two permutations:
\be
\tau = \bepm 
a & b & c & d & e\\
x & y & z & s & t
\eepm,\quad\quad
\tau' = \bepm 
a & b & c & d & e\\
x & y & z & t & s
\eepm
\ee

Notice that $\tau (abc)\tau^{-1} = (xyz)$ and $\tau'(abc)\tau'^{-1} = (xyz)$. Exactly one of $\tau$ or $\tau'$ is in $A_5$ since they differ by a transposition $(st)$. Thus $(xyz) \in H$. But $(xyz)$ was arbitrary so $H$ contains all possible 3-cycles.

Finally notice that:
\be
(ab)(cd) = (dac)(abd)\ \text{ and }\ (ab)(bc) = (abc).
\ee

Thus any even permutation can be written as a product of 3-cycles. But all possible 3-cycles are in $H$ so $H$ must be all of $A_5$, and $A_5$ is simple.

Remark: $A_4$ is not simple since $\{e, (12)(34), (13)(24), (14)(23)\}$ is a normal subgroup. Can you see why the proof above will not work for $A_4$?
\end{proof}

\subsection{Finite $p$-groups}

\begin{definition}[$p$-group]
A finite group $G$ is a $p$-group if $|G| = p^n$ for prime $p$.
\end{definition}

\begin{theorem}\label{thm:finite_p_group}
Let $G$ be a finite $p$-group. Then $Z(G) \neq \{e\}$.
\end{theorem}

\begin{proof}[\bf Proof]
We count the elements of $G$, 
\be
|G| = \sum \abs{\ccl_G(x)}.
\ee

But the size of conjugacy classes divides $|G| = p^n$. So $\abs{\ccl_G(x)} = p^a$ for some $0 \leq a \leq n$.
\beast
|G| & = & (\text{no. of conjugacy classes of size 1}) \cdot 1\\
& & \quad + (\text{no. of conjugacy classes of size $p$}) \cdot p\\
& & \quad + \dots
\eeast

But $p$ divides $|G|$. So $p$ divides the number of conjugacy classes of size 1. But $\{x\}$ is a conjugacy class if and only if
\be
\forall g \in G, \ gxg^{-1} = x \ \lra \ x \in Z(G)
\ee
So $p | |Z|$. Thus $Z(G) \neq \{e\}$.
\end{proof}

\begin{lemma}\label{lem:abelian}
For any group $G$, if $G/Z(G)$ is cyclic then $G$ is abelian.
\end{lemma}
\begin{proof}[\bf Proof]
Suppose $gZ$ generates $G/Z(G)$ and thus each coset in $Z$ is of the form $(gZ)^r = g^rZ$ for some $r$. Thus any element $x \in G$ is of the form $g^rz$ for some $z \in Z$, $r \in \N$.
\be
x_1x_2 = (g^{r_1}z_1)(g^{r_2}z_2) = g^{r_1}g^{r^2}z_1z_2 = (g^{r_2}z_2)(g^{r_1}z_1) = x_2x_1
\ee
using that $z_1 \in Z$. Thus $G$ is abelian and so $G = Z(G)$.
\end{proof}

\begin{proposition}\label{pro:abelian}
If $|G| = p^2$ for $p$ prime then $G$ is abelian.
\end{proposition}
\begin{proof}[\bf Proof]
By Theorem \ref{thm:finite_p_group}, $|Z(G)| = p$ or $p^2$ since by Lagrange's theorem $|Z(G)|$ is 1, $p$ or $p^2$. By Lemma \ref{lem:abelian}, $|Z(G)| \neq p$, for if $|Z(G)| = p$ then $|G/Z(G)| = p$ and so $G/Z(G)$ cyclic. So $|Z(G)| = p^2$. Hence $G$ is abelian.
\end{proof}

\begin{remark}
Groups of order $p^3$ are considered on the example sheet.
\end{remark}

Recall the definitions of the direct product.

\begin{definition}[External direct product]
Given two groups $G$ and $H$, $G\times H$ has a natural group structure $(g_1, h_1)(g_2, h_2) = (g_1g_2, h_1h_2)$. $G \times H$ has subgroups $G_1 = \{(g, e_H) : g \in G\} \cong G$ and $H_1 = \{(e_G, h) : h \in H\} \cong H$. Note that $G_1\cap H_1$ is the trivial subgroup of $G \times H$ and $G_1H_1 = G \times H$.
\end{definition}

\begin{definition}[Internal direct product]
Given a group $L$ and subgroups $G_1$, $H_1$ with $G_1H_1 = L$, $G_1 \cap H_1 = \{e\}$, all elements $g \in G_1$ commute with all elements $h \in H_1$. Note that $L \cong G_1 \times H_1$.
\end{definition}

\begin{theorem}
Let $G$ be a $p$-group of order $p^a$. Then there is a subgroup of order $p^b$ for any $0 \leq b \leq a$.
\end{theorem}

\begin{proof}[\bf Proof]
By induction on $a$. The result is clearly true for $a = 1$. Suppose $a > 1$ and pick an element $x \in Z(G)$, $x \neq e$, noting that by Theorem \ref{thm:finite_p_group} the centre is nontrivial. By taking a suitable power of it, we may assume that $x$ is of order $p$. Hence $K = \{e, x,\dots , x^{p-1}\}$ is a subgroup of $G$, and it is normal in $G$ since $x$ is central. 

Consider the quotient $G/K$. Its order is $p^{a-1}$ and we can apply the inductive hypothesis to get $L/K \leq G/K$ of order $p^{b-1}$. The correspondence between subgroups of $G/K$ and subgroups of $G$ containing $K$ gives a subgroup $L$ of $G$ containing $K$ of order $p^b$.
\end{proof}


\subsection{Finite abelian groups}

For example, by Proposition \ref{pro:abelian} groups of order $p^2$ are abelian, and hence isomorphic to $C_{p^2}$ or $C_p \times C_p$.

\begin{theorem}\label{thm:finite_abelian_group}
Let $G$ be a finite abelian group. Then
\be
G \cong C_{d_1} \times C_{d_2} \times \dots \times C_{d_k}
\ee
with $d_{i+1} | d_i$ and $d_1 \dots d_k = |G|$.
\end{theorem}

\begin{proof}[\bf Proof]
Postponed until Section 3.
\end{proof}

\begin{remark}[Remark on proof]
One can be less sophisticated. As the first step, consider an abelian $p$-group $G$ and the subgroup $\langle x\rangle$ generated by $x \in G$ of maximal order. If $\langle x\rangle = G$ we are done. Otherwise, if $\langle x\rangle \neq G$, the claim is that there exists a subgroup $H \leq G$ with $\langle x\rangle H = G$, $\langle x\rangle\cap H = \{e\}$, i.e. $G \cong = \langle x\rangle \times H$.
\end{remark}

\begin{example}
The abelian groups of order 8 are $C_8$, $C_4\times C_2$ and $C_2\times C_2\times C_2$. The abelian groups of order 16 are $C_{16}$, $C_8 \times C_2$, $C_4 \times C_4$, $C_4 \times C_2 \times C_2$ and $C_2 \times C_2 \times C2 \times C2$.
\end{example}

\begin{lemma}\label{lem:coprime_cong}
If $m$ and $n$ are coprime then $C_m \times C_n \cong C_{mn}$.
\end{lemma}

\begin{proof}[\bf Proof]
Take elements $g$ of order $m$ in $C_m$ and $h$ or order $n$ in $C_n$.

Then $(g, h)$ is of order $mn$ in $C_m \times C_n$ since $(g, h)^r = (g^r, h^r)$ and so the order of $(g, h)$ is the least common multiple of $m$ and $n$ which is $mn$ since $m$ and $n$ are coprime.

But $|C_m \times C_n| = mn$ and so $(g, h)$ is a generator for the group.
\end{proof}

\begin{example}
$C_2 \times C_3 \cong C_6$. Abelian groups of order $24 = 3 \times 8$ are $C_{24}$, $C_{12} \times C_2$, and $C_6 \times C_2 \times C_2$.
\end{example}

\subsection{Sylow's theorems and applications to groups of small orders}

\begin{theorem}[Sylow's Theorem\index{Sylow's Theorem}]\label{thm:sylow}
Let $G$ be a finite group of order $p^am$ where $p$ is prime and $p \nmid m$.
\ben
\item [(i)] There exists a subgroup $P$ of order $p^a$, called the Sylow $p$-subgroup.
\item [(ii)] All Sylow $p$-subgroups are conjugate.
\item [(iii)] The number $n_p$ of Sylow $p$-subgroups satisfies $n_p \equiv 1 (\bmod p)$ and divides $|G|$, and hence $n_p | m$.
\een
\end{theorem}

\begin{proof}[\bf Proof]
\ben
\item [(i)] Consider the set $\Omega$ of subsets of $G$ of size $p^a$ and let $\{g_1,\dots , g_{p^a}\} \in \Omega$. $G$ acts on $\Omega$ via left multiplication,
\be
g * \{g_1,\dots , g_{p^a}\} = \{gg_1,\dots , gg_{p^a}\}.
\ee

Consider an orbit $\sum \leq \Omega$. Take $g \in G$. If $\{g_1,\dots , g_{p^a}\} \in \Omega$ then
\be
gg^{-1}_1 * \{g_1,\dots , g_{p^a}\} = \{g, gg^{-1}_1g_2,\dots , gg^{-1}_1 g_{p^a}\} \in \sum.
\ee

So $g$ appears as an entry in one of the $p^a$-sets in orbit the $\sum$. Counting,
\be
|\sum | \geq \frac{|G|}{p^a} = \frac{p^am}{p^a} = m.
\ee
So we have two types of orbits $\sum$, (a) $|\sum| = m$, (b) $|\sum| > m$. By the orbit-stabiliser theorem, $|\sum|$ divides $|G| = p^am$. So for orbits $\sum$ of type (b), where $|\sum| > m$, we deduce that $p | |\sum|$.

The next step is to show that $|\Omega|$ is not divisible by $p$, 
\be
|\Omega| = \binom{p^am}{p^a} = \frac{p^am}{p^a} \frac{p^am - 1}{p^a - 1} \dots \frac{p^am - p^a + 1}1 .
\ee

Consider $(p^am - k)/(p^a - k)$ for $0 \leq k \leq p^a - 1$. If $k = 0$ then
\be
\frac{p^am - k}{p^a - k} = \frac{p^am}{p^a} = m.
\ee

If $k > 0$ then set $k = p^bq$, where $p \nmid q$, so that
\be
\frac{p^am - k}{p^a - k} = \frac{p^am - p^bq}{p^a - p^bq} = \frac{p^{a-b}m - q}{p^{a-b} - q}.
\ee

Note that $b < a$, so $p$ does not divide the numerator after this cancellation process, observing that $b < a \ \ra k < p^a$. So after the cancellation for the product, $p$ does not divide the numerator. Thus $p \nmid |\Omega|$, as required.

Now count the elements of $\Omega$, 
\beast
|\Omega| & = & \text{sum of sizes of orbits}\\
& = & \text{sum of sizes of orbits of type (a) + sum of sizes of orbits of type (b)}.
\eeast

But $p\nmid |\Omega|$ and $p$ divides the size of orbits of type (b), thus we do have orbits of type (a).

Consider the orbit-stabiliser theorem for an orbit $\sum$ of type (a),
\be
m = |\sum| = \frac{|G|}{|P|} = \frac{p^am}{|P|} 
\ee
where $P$ is the stabiliser of an element chosen in $\sum$. So $|P| = p^a$ and thus there is a subgroup of order $p^a$.

\item [(ii)] In fact, we will prove the following. If $P$ is a Sylow $p$-subgroup and $Q \leq G$ with $|Q| = p^b$ for $1 \leq b \leq a$, then there exists $g_1 \in G$ such that $Q \leq g_1Pg^{-1}_1$. In particular, if $Q$ is of order $p^a$ then $Q = g_1Pg^{-1}_1$.

This time consider the action of $Q$ on the set of left cosets of $P$ via left multiplication, 
\be
g * g_1P = gg_1P
\ee
for $g \in Q$, $g_1 \in G$. We consider the orbits. By the orbit-stabiliser theorem, the size of an orbit divides $|Q|$, thus is either 1 or a power of $p$.
The number of cosets is equal to the index of $P$ in $G$,
\be
\frac{|G|}{|P|} = \frac{p^am}{p^a} = m.
\ee
In particular, $m$ is equal to the number of orbits of size 1 plus pk times the number of orbits of size $k$.

Counting cosets, we see that we must have an orbit of size 1. Suppose $\{g_1P\}$ is such an orbit. Thus $gg_1P = g_1P$ for all $g \in Q$ and hence $g^{-1}_1 gg_1P = P$. So $g^{-1}_1 gg_1 \in P$ and $g \in g_1Pg^{-1}_1$. Thus $Q \leq g_1Pg^{-1}_1$, as required.

\item [(iii)] Last time we observed that $n_p$ is the index of $N_G(P)$, the normaliser of a Sylow $p$-subgroup $P$, in $G$ and so $n_p | |G|$.

Consider the action of $P$ on the set of Sylow p-subgroups of $G$ via conjugation. By the orbit-stabiliser theorem, orbits are of size 1 or of size divisible by $p$. We need to show that there is exactly one orbit of size 1.

Visibly $\{P\}$ is an orbit of size 1. Are there any others?

Suppose $\{Q\}$ is an orbit of size 1. Thus $gQg^{-1} = Q$ for all $g \in P$ and so $P \leq N_G(Q)$. But we observed last time that the normaliser of a Sylow subgroup has a unique Sylow subgroup. (This is a consequence of Sylow's second theorem applied to the normaliser.) So $P = Q$, since both are Sylow subgroups of $N_G(Q)$.

Thus $\{P\}$ is the only orbit of size 1. Counting Sylow $p$-subgroups in $G$,
\be
n_p = 1 + \text{ sum of sizes of other orbits}.
\ee
But $p$ divides the size of every other orbit. Therefore, $n_p \equiv 1 (\bmod p)$. 
\een
\end{proof}

\begin{remark}
$G$ acts on the set $\Omega$ of Sylow $p$-subgroups via conjugation, $g* P = gPg^{-1}$. By Sylow's second theorem, there is exactly one orbit. The stabiliser, called the normaliser of $P$, is $N_G(P) = \{g \in G : gPg^{-1} = P\}$. By the orbit-stabiliser theorem, the size of the orbit is $n_p = |G : N_G(P)|$. Thus $n_p | |G|$.
\end{remark}

\begin{lemma}
If $n_p = 1$ then the unique Sylow $p$-subgroup is normal in $G$.
\end{lemma}

\begin{proof}[\bf Proof]
Take the unique Sylow $p$-subgroup $P$. Then $gPg^{-1}$ is also a Sylow $p$-subgroup. Thus $gPg^{-1} = P$ for all $g \in G$. 
\end{proof}

\begin{remark}[continued]
By definition, $P \lhd N_G(P)$. So applying Sylow's second theorem to $N_G(P)$ we see that all Sylow $p$-subgroups of $N_G(P)$ are conjugate to $P$. But $P \lhd N_G(P)$ and so all its conjugates are $P$ itself. Thus $P$ is the unique Sylow $p$-subgroup of $N_G(P)$.
\end{remark}

\begin{corollary}\label{cor:non-abelian}
Let $G$ be a non-abelian simple group. Then $|G|$ divides $n_p!/2$, and $n_p \geq 5$ once we have shown that all non-abelian subgroups of $S_4$ are not simple.
\end{corollary}

\begin{proof}[\bf Proof]
$G$ is acting on the set $\Omega$ of Sylow $p$-subgroups where $|\Omega| = n_p$. If $G$ is non-abelian simple then by Theorem \ref{thm:lagrange_group} $G$ is isomorphic to a subgroup of $A_{n_p}$, and $n_p \geq 5$ subject to proviso.
\end{proof}

\begin{example}
Let $|G| = 1000 = 2^35^3$. Then $G$ is not simple.
\end{example}

\begin{proof}[\bf Proof]
$n_5 \equiv 1 (\bmod 5)$ and $n_5 | 8$. So $n_5 = 1$ and so there exists a unique Sylow 5-subgroup which is normal. Thus $G$ is not simple.
\end{proof}

\begin{example}
Let $|G| = 300 = 2^2 \cdot 3 \cdot 5^2$. Then $G$ is not simple.
\end{example}

\begin{proof}[\bf Proof]
$n_5 \equiv 1 (\bmod 5)$ and $n_5 | 12$. Assume $G$ is simple and so $n_5 \neq 1$. Then $n_5 = 6$. But 300 does not divide $6!/2$. Contradiction! Thus $|G| = 300$ implies that $n_5 = 1$. ($G$ is not abelian simple since it is not of prime order.)
\end{proof}

\begin{example}
Let $|G| = 132 = 2^2 \cdot 3 \cdot 11$. Then $G$ is not simple.
\end{example}

\begin{proof}[\bf Proof]
$n_{11} \equiv 1 (\bmod 11)$ and $n_{11} | 12$. Assume $G$ is simple and so $n_{11} \neq 1$. Then $n_{11} = 12$. $n_3 \equiv 1 (\bmod 3)$ and $n_3 | 44$. By simplicity, $n_3 \neq 1$ and $n_3 \neq 4$ by Corollary \ref{cor:non-abelian}, so $n_3 = 22$.

But since $n_{11} = 12$ and $n_3 = 22$ there are $12\cdot(11-1)$ elements of order 11 and $22\cdot(3-1)$ elements of order 3. But this gives too many elements, a contradiction!
\end{proof}

This is a typical argument. We use Sylow's theorem to estimate the number of subgroups and then count elements.

\begin{lemma}
Suppose $|G| = 2p$ for an odd prime $p$. Then $G \cong C_{2p}$ or $D_{2p}$.
\end{lemma}

\begin{proof}[\bf Proof]
$n_p \equiv 1 (\bmod p)$ and $n_p | 2$, so $n_p = 1$. Thus there is a normal subgroup $K$ of order $p$. Sylow's theorem also implies there is a subgroup $H$ of order 2. Let $H = \{e, g\}$, $K = \{e, x,\dots , x^{p-1}\}$. Note $H \cap K = \{e\}$ and $G$ is a semidirect product of $K$ by $H$. Observe that $|HK| = 2p$.

Now consider the action of $H$ on $K$ by conjugation. In particular, consider conjugation by $g$ -- it permutes the elements of $K$. (In fact, conjugation by $g$ gives an automorphism of $K$.) This is uniquely determined by the image of $x$, that is, $gxg^{-1} = x^r$ for some $r$. Then also
\be
x = g^2xg^{-2} = gx^rg^{-1} = (gxg^{-1})^r = x^{r^2}.
\ee
So $r^2 \equiv (\bmod p)$. This gives two choices. Suppose $r \equiv 1 (\bmod p)$, then $g$ and $x$ commute so $gx$ is of order $2p$ and hence $G \cong C_{2p}$. Otherwise suppose $r \equiv -1 (\bmod p)$, then $gxg^{-1} = x^{-1} = x^{p-1}$ and $G \cong D_{2p}$. In the latter case, $x$ is a rotation and $g$ is a reflection.
\end{proof}

There is a problem on the examples sheet for the case $|G| = 15$.

Recall the definition of a soluble group, a group for which the composition factors can be chosen to be abelian simple.

\begin{theorem}[1904, Burnside]
If $|G| = p^aq^b$, where $p$ and $q$ are primes, then $G$ is soluble.
\end{theorem}

\begin{theorem}[1937, Hall]
$G$ is soluble if and only if whenever $|G|$ factorises as $|G| = mn$ with $m$ and $n$ coprime there is a subgroup of order $m$.
\end{theorem}

\begin{theorem}[1963, Feit, Thompson, "Odd Order Theorem"\index{Odd Order Theorem}]
If $|G|$ is odd then $G$ is soluble.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%

\section{Rings}

\subsection{Definitions and examples}

\begin{definition}[Ring]
A set R with two operations, $+$ and $\cdot$, forms a ring\index{ring} if
\ben
\item [(i)] $(R, +)$ is an abelian group,
\item [(ii)] multiplication is associative and there is a multiplicative identity $1_R \in R$ such that
\be
\forall r \in R,\ 1_R \cdot r = r \cdot 1_R = r,
\ee
\item [(iii)] multiplication is distributive over addition, that is
\be
r_1(r_2 + r_3) = r_1r_2 + r_1r_3,\quad\quad (r_1 + r_2)r_3 = r_1r_3 + r_2r_3.
\ee
\een
\end{definition}

In this course all rings are assumed to be commutative, i.e. multiplication is commutative.

\begin{definition}[Subring]
A subset $S$ of $R$ is a subring\index{subring} if it is a ring under the restriction of the two operations. In particular, $1_R \in S$. The notation is $S \leq R$.
\end{definition}

\begin{example}
We have the four nested rings $\Z \leq \Q \leq \R \leq \C$. In the introduction we also met the Gaussian integers $\Z[i] \leq \C$. Also $\Q[\sqrt{2}] = \{a + b\sqrt{2} : a, b \in Q\} \leq \R$.
\end{example}

\begin{remark}
All fields are rings, e.g. $\Z$ modulo $n$, the set $\{0,\dots , n-1\}$ with addition and multiplication modulo $n$.
\end{remark}

\begin{definition}[Unit]
A unit\index{unit} of $R$ is an element with a multiplicative inverse in $R$, e.g. 2 is a unit in $\Q$, but not a unit in $\Z$.

Warning. There are various conventions.
\ben
\item [(i)] Not everyone insists on a multiplicative identity $1_R$.
\item [(ii)] Some people confusingly talk about $1_R$ as the unit of $R$.
\een
\end{definition}

\begin{example}
The zero ring $\{0\}$. In this case the multiplicative identity is the same as the additive one. But in all other rings $0 \neq 1$. 
\be
(0 + 0)r = 0r,\quad\quad (0 + 0)r = 0r + 0r
\ee
so $0r = 0$ for all $r \in R$. Hence 0 is not the multiplicative identity if $R$ has more than one element.
\end{example}


\begin{example}
Let $R$ be a ring. A polynomial $f$ over $R$ is of the form
\be
f(X) = a_nX^n + \dots + a_1X + a_0
\ee
with $a_i \in R$. The degree of $f$ is the largest $n$ with $a_n \neq 0$. $f$ is monic\index{monic} if $a_n = 1$, where $n$ is the degree of $f$. $R[X]$ is the polynomial ring over $R$ with ring operations
\be
(f + g)(X) = \sum_i (a_i + b_i)X^i,\quad\quad (fg)(X) = \sum_i \bb{\sum^i_{j=0} a_jb_{i-j} } X^i
\ee
where $f(X) = \sum a_iX^i$, $g(X) = \sum b_iX^i$.

$R$ is a subring of $R[X]$ by identifying $R$ with the constant polynomials $f(X) = \sum a_iX^i$ with $a_i = 0$ for all $i \geq 1$.

$R[[X]]$ is the ring of formal power series
\be
f(X) = a_0 + a_1X + a_2X^2 + \dots
\ee
with the same addition and multiplication as for $R[X]$ but note that there is no restriction demanding that all but finitely many coefficients be zero.
Laurent polynomials,
\be
f(X) = \sum_{i\in \Z} a_iX^i, \quad\quad (fg)(X) = \sum_i \bb{\sum_j a_jb_{i-j}} X^i
\ee
with the condition that all but finitely many $a_i$ are zero, e.g. $X^{-1} + X$.

Laurent series,
\be
\sum_{i\in \Z} a_iX^i
\ee
with the condition that all but finitely many of the $a_i$ for $i \leq 0$ are zero. Addition and multiplication are defined in the same way as for Laurent polynomials.

Another example is given by the ring of all $R$-valued functions on a set $A$, $f : A \to R$. The ring operations can be defined by pointwise addition and multiplication,
\be
(f + g)(a) = f(a) + g(a),\quad\quad (fg)(a) = f(a)g(a).
\ee

For example, the set of continuous functions $f : \R \to \R$ forms a subring of the ring of all functions $\R \to \R$. The set of continuous functions $\R \to \R$ contains the subring of polynomial functions, $f : \R \to \R$, $a \mapsto f(a)$, where $f(X) \in \R[X]$.

We can similarly consider Laurent polynomial functions, power series functions $\C \to \C$ and Laurent series functions $\C \to \C$.
\end{example}

\subsection{Homomorphisms, ideals, quotient rings and isomorphisms}

\begin{definition}[Ring homomorphism]
A map $\theta : R \to S$ is a ring homomorphism\index{ring homomorphism} if
\ben
\item [(i)] $\theta(r_1 + r_2) = \theta(r_1) + \theta(r_2)$,
\item [(ii)] $\theta(r_1r_2) = \theta(r_1)\theta(r_2)$,
\item [(iii)] $\theta(1_R) = 1_S$.
\een

A bijective homomorphism is called an isomorphism. The kernel of $\theta$ is $\ker \theta = \{r \in R : \theta(r) = 0\}$.
\end{definition}

\begin{lemma}
$\theta$ is injective if and only if $\ker \theta = \{0\}$.
\end{lemma}

\begin{proof}[Proof]
$\theta$ is a homomorphism of the additive groups.
\end{proof}

\begin{definition}[Ideal]
A subset $I$ of $R$ is an ideal\index{ideal}, written $I \lhd R$, if 
\ben
\item [(i)] $I$ is a subgroup of $R$ under addition,
\item [(ii)] whenever $a \in I$ and $r \in R$ then $ar \in I$.
\een

The second condition is called the strong closure property.
\end{definition}

Warning. An ideal in general is not a subring. If $1 \in I$ then $r = 1_r \in I$ for all $r \in R$ and so $I = R$ if $1 \in I$. So the only ideal which is a subring of $R$ is $R$ itself.

\begin{lemma}\label{lem:ideal}
The kernel of a ring homomorphism $\theta : R \to S$ is an ideal.
\end{lemma}

\begin{proof}[\bf Proof]
$\theta$ is a homomorphism of the additive groups $(R, +) \to (S, +)$ and so $\ker \theta$ is an additive subgroup of $R$.

If $a \in \ker \theta$ then $\theta(a) = 0$. Consider
\be
\theta(ar) = \theta(a)\theta(r) = 0\cdot\theta(r) = 0.
\ee

Thus $ar \in \ker \theta$, so we have the strong closure property.
\end{proof}

\begin{example}
\ben
\item [(i)] In a field $\F$, the only ideals are $\{0\}$ and $\F$. (Multiply any non-trivial element in the ideal by its inverse to see that 1 is in the ideal.)

\item [(ii)] In $\Z$ the ideals are of the form
\be
n\Z = \{\dots,-2n,-n, 0, n, 2n,\dots \}.
\ee
\een
\end{example}

\begin{proof}[\bf Proof]
Certainly each set $n\Z$ is an ideal of $\Z$.

Suppose $I$ is a non-zero ideal. We show that all the non-zero additive subgroups of $\Z$ are of the form $n\Z$. Let $n$ be the least positive element of $I$ and use Euclid's algorithm. If $b \in I$ then $b = nq + r$ with $0 \leq r < n$ and some $q$. Note that $r = b - nq \in I$. Minimality of $n$ implies that $r = 0$ and hence $b = nq$. Thus $I = n\Z$.
\end{proof}

\begin{definition}
Let $R$ be a ring and $a \in R$. Then the ideal generated by $a$ is $aR = \{ar : r \in R\}$. We often use the notation (a) for $aR$.

Note that this is the smallest ideal of $R$ containing $a$. Such an ideal is called a principal ideal.

More generally, the ideal generated by $a_1,\dots, a_k$ is
\be
(a_1,\dots , a_k) = a_1R +\dots a_kR = \left\{\sum^k_{i=1} a_ir_i : r_i \in R\right\}.
\ee

Even more generally, the ideal generated by a subset $A$ of $R$ is
\be
(A) = \left\{ \sum_{a\in A} ar_a :\text{ only finitely many $r_a \in R$ are non-zero }\right\}.
\ee
\end{definition}

Examples of principal ideals include $n\Z$ in $\Z$ and $(X)$ in $\C[X]$, where $(X)$ is the ideal of polynomials with zero constant term.

\begin{proposition}
Let $I \lhd R$ be an ideal. Then the quotient ring $R/I$ has elements consisting of the cosets $r + I$ with the operations 
\be
(r_1 + I) + (r_2 + I) = (r_1 + r_2) + I, \quad\quad (r_1 + I)\cdot(r_2 + I) = r_1r_2 + I.
\ee
This defines a ring.
\end{proposition}

\begin{proof}[\bf Proof]
From Proposition \ref{pro:normal} we have already checked that $R/I$ forms a group under addition as defined. So we need to check that multiplication is well-defined. If
\be
r_1 + I = r'_1 + I,\quad \quad r_2 + I = r'_2 + I
\ee
then
\be
r'_1 = r_1 + a_1,\quad\quad r'_2 = r_2 + a_2
\ee
for some $a_1, a_2 \in I$, and therefore
\be
r'_1 r'_2 = (r_1 + a_1)(r_2 + a_2) = r_1r_2 + (a_1r_2 + r_1a_2 + a_1a_2)
\ee
where the second term is contained in $I$ by the strong multiplicative closure property. Thus $r'_1 r'_2 + I = r_1r_2 + I$.

The multiplicative identity is $1 + I$ since $(1 + I)(r + I) = r + I$.

Associativity, closure under multiplication and distributivity follow from the respective properties in the ring $R$. (Check.)
\end{proof}

\begin{example}
\ben
\item [(i)] $n\Z$ is an ideal of $\Z$. Elements $m + n\Z$ of $\Z/n\Z$ may be expressed as one of
\be
0 + n\Z, 1 + n\Z,\dots , (n - 1) + n\Z.
\ee
Addition and multiplication correspond to arithmetic modulo $n$. 

\item [(ii)] Consider the ideal $I = (X)\lhd C[X]$. Elements $f(X)+I$ of the quotient ring $\C[X]/I$ may be expressed in the form $a + I$ where $a \in \C$ is the constant term of $f(X)$. Addition and multiplication correspond to that in $\C$,
\be
(a + I) + (b + I) = (a + b) + I,\quad\quad (a + I)(b + I) = ab + I.
\ee
Therefore, $\C[X]/I \cong \C$.
\een
\end{example}

\begin{proposition}[Euclid's algorithm for polynomials]
Let $\F$ be a field and consider polynomials $f(X)$, $g(X) \in \F[X]$. Then we can write 
\be
f(X) = g(X)q(X) + r(X)
\ee
with $\deg r < \deg g$.
\end{proposition}

\begin{proof}[\bf Proof]
Write
\be
f(X) = \sum^n_{i=0} a_iX^i,\quad\quad g(X) = \sum^m_{i=0} b_iX^i
\ee
with $\deg f(X) = n$ and $\deg g(X) = m$.

If $n < m$ then set $q(X) = 0$ and $r(X) = f(X)$. Now assume $n \geq m$, and argue by induction on $n$. Set $f_1(X) = f(X) - a_nb^{-1}_m X^{n-m}g(X)$ so $\deg f_1(X) < \deg f(X)$. If $m = n$ then $\deg f_1(X) < m$ and we can apply our first case to $f_1(X)$,
\be
f(X) = a_nb^{-1}_m g(X) + f_1(X).
\ee
If $n > m$ then we have by induction
\be
f_1(X) = g(X)q_1(X) + r_1(X)
\ee
for suitable $q_1(X)$ and $r_1(X)$, so
\be
f(X) = g(X)(q_1(X) + a_nb^{-1}_m X^{n-m}) + r_1(X).
\ee
\end{proof}

\begin{remark}
We require F to be a field as we need $b^{-1}_m$.
\end{remark}

\begin{example}
Consider the ideal
\be
I = (X^2 + 1) \lhd R[X].
\ee

For any $f(X) \in \R[X]$, we can write $f(X) = (X^2 + 1)q(X) + r(X)$ with $\deg r(X) \leq 1$. Thus $f(X) + I = r(X) + I$. The elements of $\R[X]/I$ are of the form $a + bX + I$.

Addition takes the form
\be
(a_1 + b_1X + I) + (a_2 + b_2X + I) = (a_1 + a_2) + (b_1 + b_2)X + I,
\ee
and similarly multiplication is given by
\beast
(a_1 + b_1X + I)(a_2 + b_2X + I) & = & a_1a_2 + (b_1a_2 + a_1b_2)X + b_1b_2X^2 + I\\
& = & (a_1a_2 - b_1b_2) + (b_1a_2 + a_1b_2)X + I.
\eeast

This corresponds to addition and multiplication in $\C$. In fact, 
\be
\R[X]/(X^2 + 1) \cong C,\quad\quad a + bX + I \mapsto  a + bi.
\ee
\end{example}

\begin{theorem}[First isomorphism theorem]\label{thm:ring_isomorphism_1}
Let $\theta : R \to S$ be a ring homomorphism. Then $\ker \theta \lhd R$ and $R/ \ker \theta \cong \im \theta \leq S$.
\end{theorem}

\begin{example}
The map
\be
\theta : \R[X] \to C, \ \sum a_jX^j \mapsto \sum a_j i^j
\ee
is a ring homomorphism with $\ker \theta = (X^2 + 1)$ and $\im \theta = \C$.
\end{example}

\begin{proof}[\bf Proof]
Lemma \ref{lem:ideal} states that $\ker \theta$ is an ideal. $\im \theta$ is a subring of $S$,
\ben
\item [(i)] $\theta$ is a homomorphism of additive groups and so Lemma \ref{lem:ker_im} implies that $im \theta$ is an additive subgroup of $S$.
\item [(ii)] $\theta(r_1)\theta(r_2) = \theta(r_1r_2)\in \im \theta$, so we have closure under multiplication. Associativity is inherited from $S$. Moreover, $\theta(1_R) = 1_S$.
\een

Let $\Phi: R/I \to \im \theta$, $r + I \mapsto \theta(r)$ and note $I = \ker \theta$. We know that $\Phi$ is well-defined and bijective and an isomorphism of additive groups from proof of Lemma \ref{lem:ker_im}. It is left to check that $\Phi$ is a ring homomorphism.
\beast
\Phi((r_1 + I)(r_2 + I)) & = & \Phi(r_1r_2 + I) = \theta(r_1r_2) = \theta(r_1)\theta(r_2) = \Phi(r_1 + I)\Phi(r_2 + I),\\
\Phi(1_R + I) & = & \theta(1_R) = 1_S.
\eeast
Thus $\Phi$ is a ring homomorphism.
\end{proof}

\begin{theorem}[Second isomorphism theorem]
Let $R$ be a subring of $S$ and $J \lhd S$ an ideal. Then $R \cap J\lhd S$ is an ideal and $\{r + J : r \in R\} = (R + J)/J \leq S/J$ and $R/(R \cap J) \cong (R + J)/J \leq S/J$.
\end{theorem}

\begin{proof}[\bf Proof]
Let
\be
\theta : R \to S/J,\ r \mapsto  r + J.
\ee

This is a ring homomorphism. (Check.) We have that
\beast
\ker \theta & = & \{r \in R : r + J = J\} = R \cap J \lhd R,\\
\im \theta & = & \{r + J : r \in R\} = (R + J)/J \leq S/J.
\eeast

Theorem \ref{thm:ring_isomorphism_1} implies that $R/ \ker \theta \cong \im \theta$, that is, $R/(R \cap J) \cong (R + J)/J \leq S/J$.
\end{proof}

There is a correspondence between additive groups,
\be
\left\{\text{additive subgroups of $R$ containing ideal $I$}\right\} \ \longleftrightarrow \ \left\{\text{additive subgroups of $R/I$}\right\} 
\ee
as in Section 1. This correspondence induces
\be
\left\{\text{subrings of $R$ containing $I$}\right\} \ \longleftrightarrow \ \left\{\text{subrings of $R/I$}\right\},
\ee
\be
\left\{\text{ideals of $R$ containing $I$}\right\} \ \longleftrightarrow \ \left\{\text{ideals of $R/I$}\right\}.
\ee
(This needs to be checked.)

\begin{theorem}[Third isomorphism theorem]
Let $I$ and $J$ be ideals of $R$, with $I \subset J$. Then $(R/I)/(J/I) \cong R/J$ where $J/I = \{r + I : r \in J\}$.
\end{theorem}

\begin{proof}[\bf Proof]
Let $\theta$ be the map
\be
\theta : R/I \to R/J,\ r + I \mapsto r + J.
\ee

This is well-defined as in Theorem \ref{thm:isomorphism_3}. One can check it is a ring homomorphism and $\theta(1 + I) = 1 + J$.

The first isomorphism theorem implies that $R/ \ker \theta \cong \im \theta \leq R/J$. Noting that
\be
\ker \theta = \{r + I : r \in J\} = J/I \lhd R/I,\quad\quad \im \theta = R/J,
\ee
we get the required result.
\end{proof}

\begin{example}
Given a ring $R$, there is a unique ring homomorphism
\be
\phi: \Z \to R,\ 1 \mapsto  1_R, \ m \mapsto  \underbrace{1 + \dots + 1}_{m \text{times}} 
\ee

The first isomorphism theorem implies $\Z/ \ker \phi \cong \im \phi \leq R$. $\im \phi$ is the prime subring of $R$. $\ker \phi \lhd \Z$ is an ideal and so is of the form $n\Z$ for some $n$.

This $n$ is the characteristic of $R$. If $R$ is one of $\Z$, $\Q$, $\R$, or $\C$ then the characteristic is 0. If $R = \Z/(p\Z)$ then the chacteristic is $p$.
\end{example}

\subsection{Integral domains, fields of fractions, maximal ideals and prime ideals}

\begin{definition}[Integral domain]
A ring is an integral domain\index{integral domain} if $ab = 0$ implies $a = 0$ or $b = 0$ for all $a, b \in R$. A zero divisor a is non-zero and there exists $b \neq 0$ such that $ab = 0$. (In an integral domain there are no zero divisors.)
\end{definition}

\begin{example}
$\Z$ is an integral domain. All fields are integral domains. Subrings of integral domains are integral domains, e.g. $\Z[i] \leq \C$.
\end{example}

\begin{definition}[Principal ideal domain]
A principal ideal domain\index{principal ideal domain} is an integral domain in which all ideals are principal ideals, i.e. of the form $(a) = aR$ for some $a \in R$.
\end{definition}

\begin{example}
$\Z$ is a principal ideal domain. We will see that any integral domain where Euclid's algorithm applies is a principal ideal domain.
\end{example}

\begin{lemma}
Let $R$ be a finite integral domain. Then $R$ is a field.
\end{lemma}

\begin{proof}[\bf Proof]
Consider the map $R \to R$, $r \mapsto ar$, that is, multiplication by $a \neq 0$.

Since $R$ is an integral domain this map is injective. (If $ar_1 = ar_2$ then $a(r_1 - r_2) = 0$ and so $r_1 - r_2 = 0$, i.e. $r_1 = r_2$. Note that cancellation is valid in integral domains.)

Since $R$ is finite the map is also surjective.

Thus there exists $r \in R$ with $ar = 1$. Thus a has a multiplicative inverse. So $R$ is a field.
\end{proof}

\begin{lemma}
If $R$ is an integral domain then $R[X]$ is an integral domain.
\end{lemma}
\begin{proof}[\bf Proof]
If
\be 
f(X) = \sum a_iX^i,\quad\quad g(X) = \sum b_iX^i
\ee
with $\deg f = m$ and $\deg g = n$ then $f(X)g(X)$ has degree $m+n$ since $a_mb_n \neq 0$ as $R$ is an integral domain. Therefore,
\be
f(X) \neq 0,\ g(X) \neq 0 \ \ra\ f(X)g(X) \neq 0.
\ee
Thus $R[X]$ is an integral domain.
\end{proof}

\begin{remark}
By induction, $R[X_1,\dots ,X_n]$ polynomial ring in indeterminates $X_1,\dots ,X_n$ is an integral domain if $R$ is. This is because $R[X_1,X_2]$ may be regarded as $(R[X_1])[X_2]$.
\end{remark}

\begin{theorem}
Let $R$ be an integral domain. Then there is a field of fractions $\F$ with the properties
\ben
\item [(i)] $R \leq \F$ is a subring,
\item [(ii)] $\F$ is a field,
\item [(iii)] every element of $\F$ has the form $ab^{-1}$ where $a \in R$ and $b^{-1}$ is the multiplicative inverse in $\F$ of $b \in R$.
\een
\end{theorem}

\begin{example}
With the notation as above, $R = \Z$, $\F = \Q$.
\end{example}

\begin{proof}[\bf Proof]
Consider pairs $(a, b)$ with $a \in R$, $b \in R$ and $b \neq 0$. Define an equivalence relation
\be
(a, b) \sim (c, d) \ \lra \ ad = bc.
\ee
(For transitivity, note that $(a, b) \sim (c, d) \ \lra \ ad = bc$, $(c, d) \sim (e, f) \ \lra\ cf = de$ so $adf = bcf = bde$ as cancellation is valid in $R$. So $af = be$ and $(a, b) \sim (e, f)$.)

Write $a/b$ for the equivalence class of $(a, b)$. We define addition by
\be
\frac ab + \frac cd = \frac{ad + bc}{bd}
\ee
and multiplication by
\be
\frac ab \cdot \frac cd = \frac{ac}{bd}.
\ee

One can easily check that these operations are well-defined.

If we let $\F = \{a/b : a \in R, b \in R, b \neq 0\}$ then $\F$ is a ring under these operations.

$R$ may be identified with the subring of elements of the form $r/1$. The multiplicative identity is 1/1. $a/b$ has multiplicative inverse $b/a$ if $a \neq 0$,
\be
\frac ab \frac ba = \frac {ab}{ab} = \frac 11.
\ee

Every element $a/b$ is of the form $(a/1)(b/1)^{-1}$ since $(b/1)^{-1} = 1/b$.
\end{proof}

\begin{lemma}
A non-zero ring $R$ is a field if and only if its only ideals are $\{0\}$ and $R$.
\end{lemma}

\begin{proof}[\bf Proof]
Suppose that $R$ is a field and take an ideal $I \lhd R$. If $I \neq\{0\}$ then pick $a \neq 0 \in I$. Then $1 = aa^{-1} \in I$. Hence $I = R$.

Conversely, assume that $\{0\}$ and $R$ are the only ideals. Take $a \in R$ with $a \neq 0$. Then $(a) \neq \{0\}$ and so $(a) = R$. Hence $1 \in (a)$ and there exists $r$ such that $ar = 1$.
\end{proof}

\begin{definition}[Maximal ideal]
An ideal $I$ in $R$ is maximal in $R$ if $I \neq R$ but whenever $I \subset J \lhd R$ then $I = J$ or $J = R$.
\end{definition}

\begin{lemma}
For an ideal $I \lhd R$, the quotient ring $R/I$ is a field if and only if $I$ is maximal in $R$.
\end{lemma}

\begin{proof}[\bf Proof]
$R/I$ is a field if and only if $I/I$ and $R/I$ are the only ideals in $R/I$. By the usual correspondence, this is equivalent to that the only ideals in $R$ containing $I$ are $I$ and $R$, which is the statement that $I$ is maximal in $R$.
\end{proof}

\begin{definition}[Prime ideal]
An ideal $I$ of $R$ is a prime ideal\index{prime ideal} in $R$ if whenever $ab \in I$ then $a \in I$ or $b \in I$.
\end{definition}

\begin{lemma}
For an ideal $I \lhd R$, the quotient ring $R/I$ is an integral domain if and only if $I$ is a prime ideal in $R$. 
\end{lemma}

\begin{proof}[\bf Proof]
Suppose $R/I$ is an integral domain and $ab \in I$. Then $I = ab+I = (a+I)(b+I)$ and so either $a + I = I$ or $b + I = I$. So $a \in I$ or $b \in I$. 

Conversely, suppose $I$ is prime and $(a + I)(b + I) = I$. Then $ab + I = I$ and so $ab \in I$. Primeness implies $a \in I$ or $b \in I$ and so $a + I = I$ or $b + I = I$.
\end{proof}

\begin{example}
In $\Z$, the maximal ideals are $p\Z$ where $p$ is a prime number. Prime ideals are $p\Z$ for $p$ prime and $\{0\}$.
\end{example}

\begin{lemma}
The characteristic of an integral domain is 0 or a prime number $p$.
\end{lemma}

\begin{proof}[\bf Proof]
Recall that we have a unique ring homomorphism $\phi: \Z \to R$. The prime subring $\im \phi \cong \Z/n\Z$, where $n$ is the characteristic of $R$. If $n$ properly factorises as $n = st$ then working modulo $n$ we have $st = 0 (\bmod n)$ and so we have zero divisors. So if $R$ is an integral domain, its prime subring is an integral domain and so $n$ is prime or 0.
\end{proof}

\subsection{Factorisation in integral domains -- units, primes, irreducibles}\label{subsec:factorisation_integral}

Throughout this section $R$ is assumed to be an integral domain.

\begin{definition}
An element $a \in R$ is a unit if it has a multiplicative inverse. Equivalently, $(a) = R$. We say a divides $b$, written $a | b$, if there is $c \in R$ such that $b = ac$. Equivalently, $(b) \subset (a)$. Elements $a$ and $b$ are associates in $R$ if $a = bc$ for some unit $c \in R$. Equivalently, $(a) = (b)$. $r \in R$ is irreducible\index{irreducible} in $R$ if it is non-zero, not a unit and whenever $r = ab$ with $a, b \in R$ then $a$ or $b$ is a unit. $r \in R$ is prime in $R$ if it is non-zero, not a unit and if $r | ab$ then $r | a$ or $r | b$.
\end{definition}

\begin{remark}
These definitions do depend on the ring $R$, e.g. 2 is prime and irreducible in $\Z$, but not in $\Q$. $2X$ is irreducible in $\Q[X]$ but not in $\Z[X]$, as $2X = 2 \cdot X$ and 2, $X$ are not units in $\Z[X]$.
\end{remark}

\begin{lemma}
$(r)$ is a prime ideal of $R$ if and only if $r$ is prime or $r = 0$.
\end{lemma}

\begin{proof}[\bf Proof]
If $r \neq 0$ and $r | ab$ then $ab \in (r)$ and so if $(r)$ is a prime ideal then $a \in (r)$ or $b \in (r)$. Thus $r | a$ or $r | b$.

(0) is a prime ideal in an integral domain. If $r$ is prime and $ab \in (r)$ then $r | ab$ and hence $r | a$ or $r | b$. Thus $a \in (r)$ or $b \in (r)$.
\end{proof}

\begin{lemma}\label{lem:irreducible}
If $r$ is prime in $R$ then $r$ is irreducible in $R$.
\end{lemma}

\begin{proof}[\bf Proof]
Suppose that $r$ is prime in $R$ and $r = ab$ with $a, b \in R$. Then $r | ab$ and so $r | a$ or $r | b$. Without loss of generality suppose $r | a$. So $a = qr$ for some $q \in R$. So $r = qrb$. Cancellation in integral domains gives $1 = qb$, so $b$ is a unit.
\end{proof}

\begin{example}
To show that the converse of Lemma \ref{lem:irreducible} does not hold in general, consider $R = \Z[\sqrt{-5}] \leq \C$. $R$ is an integral domain since it is a subring of a field. Define a norm,
\be
N(a + b\sqrt{-5}) = a^2 + 5b^2 \in \Z_{\geq 0}.
\ee
Thus $N(z) = z\bar{z}$. $N$ is multiplicative, that is, $N(z_1z_2) = N(z_1)N(z_2)$. The units of $R$ are precisely the elements of norm 1, namely $\pm 1$. Suppose $z$ is a unit and so there exists $z_1$ with $zz_1 = 1$ so $N(z)N(z_1) = N(zz_1) = N(1) = 1$ hence $N(z)$ is a unit in $Z$ and also $N(z) \geq 0$. So $N(z) = 1$ is the only possibility.

There are no elements in $R$ of norm 2 or 3. (We cannot solve $a^2 + 5b^2 = 2$ or 3.)

Consider the identity $6 = 2 \dots 3 = (1 + \sqrt{-5})(1 -\sqrt{-5})$ in $R$.

To see that 2 is irreducible, express $2 = z_1z_2$ and consider norms, $4 = N(z_1)N(z_2)$. Since there are no elements of norm 2 one of the $N(z_j) = 1$ so $z_j$ is a unit.

But 2 is not prime in $R$ since $2 | (1 + \sqrt{-5})(1 - \sqrt{-5})$ but 2 does not divide either $1 \pm \sqrt{-5}$. (Consider norms, $N(2) = 4$, $N(1 \pm 
\sqrt{-5}) = 6$ and $4 \nmid 6$.)

Similarly, 3, $1 +\sqrt{-5}$, $1 -\sqrt{-5}$ are irreducible.
\end{example}

\begin{definition}[Euclidean domain]
An integral domain $R$ is a Euclidean domain (ED) if there is a function $\phi: R - \{0\} \to \Z_{\geq 0}$ called Euclidean function such that 
\ben
\item [(i)] $\phi(ab) \geq \phi(a)$ for all $a, b \in R \ \{0\}$,
\item [(ii)] if $a, b \in R$ with $b \neq 0$ then there exist $q, r \in R$ with $a = qb + r$ with either $r = 0$ or $\phi(r) < \phi(b)$. (Euclid's algorithm.)
\een
\end{definition}

\begin{example}
\ben
\item [(i)] $\Z$ is a Euclidean domain with $\phi(n) = |n|$.
\item [(ii)] $\F[X]$ with $\F$ a field is a Euclidean domain with $phi(f(X)) = \deg f$. (Subsection \ref{subsec:factorisation_integral} gives Euclid's algorithm here.)
\item [(iii)] $R = \Z[i] = \{a + bi : a, b \in \Z\} \leq \C$ is an integral domain. As with $\Z[\sqrt{-5}]$ we can define a norm via $N(z) = z\bar{z}$ for $z \in R$. Thus $N(a + bi) = a^2 + b^2$. In this case the norm is a Euclidean function. $N$ is multiplicative and so property (i) holds,
\be
N(z_1z_2) = N(z_1)N(z_2) \geq N(z_1),
\ee
since $N(z_2) \geq 1$. To verify property (ii) take $z_1, z_2 \in R$ with $z_2 \neq 0$. Consider $z_1/z_2 \in \C$. Then in the complex plane it is distance less than 1 from the nearest element of $R$.

$z_1/z_2 = q + z_3$ with $q \in R$, $z_3 \in \C$ and $|z_3| < 1$. So $z_1 = qz_2 + z_2z_3$. Set $r = z_2z_3$. Thus $z_1 = qz_2 + r$.
\be
N(r) = |z_2z_3|^2 = |z_2|^2|z_3|^2 < |z_2|^2 = N(z_2).
\ee
\een
\end{example}

\begin{remark}
Similar arguments apply for other subrings of $\C$ and one can sometimes show that the norm is a Euclidean function but one needs that any point in the complex plane is distance less than 1 from a lattice point of $R$. Note for $\Z[\sqrt{-5}]$ this is not true.
\end{remark}

\begin{proposition}
If an integral domain $R$ is an ED then $R$ is a PID.
\end{proposition}

\begin{proof}[\bf Proof]
Let $R$ be an ED with Euclidean function $\Phi: R \ \{0\} \to \Z_{\geq 0} = \{n \in \Z : n \geq 0\}$. Let $I /R$ be an ideal and suppose that $I$ is non-zero. Pick $b \in I \{0\}$ with $\Phi(b)$ minimal. Then take $a \in I$ and use Euclid's algorithm: $a = bq + r$ with $r = 0$ or $\Phi(r) < \Phi(b)$.

Note that $r = a - bq \in R$, and hence minimality of $\Phi(b)$ implies $r = 0$. Thus $a = bq$, so $I = (b)$.
\end{proof}

\begin{example}
$\Z$, $\F[X]$ for a field $\F$ and $\Z[i]$ are all PIDs. But $\Z[X]$ is not a PID.

To see this, consider the ideal $I = (2,X) = \left\{a_iX^i : a_0 text{ is even}\right\} \lhd \Z[X]$. Suppose that $I = (f(X))$ for some $f(X) \in \Z[X]$, in particular $2 = f(X)g(X)$ for some $g(X) \in \Z[X]$. We deduce that $f(X)$ has to be a constant polynomial, that is, of degree 0, and must be $\pm 1$ or $\pm 2$.

Also $X = f(X)h(X)$ for some $h(X) \in \Z[X]$. So $f(X)$ cannot be $\pm 2$. So $f(X) = \pm 1$. Hence $(f(X)) = \Z[X]$. This is a contradiction, since $I \neq \Z[X]$, e.g. $1 \notin I$.
\end{example}

\begin{example}[Minimal polynomials of matrices with entries in a field $\F$]
Let $\triangle \in M_{n\times n}(\F)$. Consider $I = \{f(X) \in \F[X] : f(\triangle) = 0\}$.

We can check that $I \lhd \F[X]$ is an ideal. But $\F[X]$ is a PID, so $I = (m(X))$, an by multiplying $m(X)$ by a unit in $\F$ we may assume $m(X)$ is monic. This is the minimal polynomial of $\triangle$. (See the course Linear Algebra where Euclid's algorithm is explicitly used.)
\end{example}

\begin{definition}[Unique factorisation domain]
An integral domain is a unique factorisation domain (UFD) if 
\ben
\item [(i)] every non-zero element that is not a unit may be expressed as a product of finitely many irreducibles,
\item [(ii)] whenever $p_1 \dots p_m = q_1 \dots q_n$ for products of irreducibles then $m = n$ and we can reorder so that $p_i$ is an associate of $q_i$. (So factorisation is unique up to ordering and associates).
\een

Our goal is the following proposition.
\end{definition}

\begin{proposition}\label{pro:integral_domain}
If an integral domain $R$ is a PID then $R$ is a UFD.
\end{proposition}

\begin{corollary}\label{cor:ufd}
$\Z$, $\F[X]$ for a field $\F$ and $\Z[i]$ are all UFDs.
\end{corollary}

\begin{example}
$\Z[\sqrt{-5}]$ is not a UFD. Note that
\be
6 = 2  3 = (1 + \sqrt{-5})(1 - \sqrt{-5})
\ee
where 2, 3, $1 +\sqrt{-5}$ and $1 -\sqrt{-5}$ are irreducibles. Units are $\pm 1$ in $\Z[\sqrt{-5}]$, so these irreducibles are not associates of each other.

We need two lemmas about PIDs to prove Proposition \ref{pro:integral_domain}.
\end{example}

\begin{lemma}\label{lem:pid}
Let $R$ be a PID. If $p$ is an irreducible then it is prime. (This is the converse of Lemma \ref{lem:irreducible} for PIDs.)
\end{lemma}

\begin{proof}[\bf Proof]
Let $p$ be an irreducible and suppose $p | ab$. Suppose $p \nmid a$. The ideal $(p, a)$ must be principle in a PID, $(p, a) = (d)$, say.

Thus $p = q_1d$ and $a = q_2d$ for some $q_1,q_2 \in R$. $p$ is irreducible so either $q_1$ or $d$ is a unit. But if $q_1$ is a unit, then $d = q^{-1}_1 p$ and $a = q_2d = q_2q^{-1}_1 p$, so $p | a$, a contradiction. Hence $d$ is a unit. Thus $(d) = R$ and there exist $r, s \in R$ such that
\be
1 = rp + sa
\ee
and so
\be
b = rpb + sab.
\ee
Therefore, $p | b$.
\end{proof}

\begin{remark}
In fact, $d$ is a highest common factor of $p$ and $a$. Highest common factors are unique up to units, see Example Sheet 3.
\end{remark}

\begin{lemma}[Ascending chain condition, ACC]
Let $R$ be a PID and $I_j \lhd R$ with $I_1 \subset I_2 \subset I_3 \subset \dots$. Then, for some $n \in \N$, $I_n = I_{n+i}$ for all $i \geq 0$.
\end{lemma}

\begin{proof}[\bf Proof]
The union $I = \bigcup_j I_j \lhd R$ is an ideal, check. (For example, if $a \in I_j$ and $b \in I_k$, $j \leq k$ then $a \in I_k$, $B \in I_k$, so $a + b \in I_k \subset I$.) $R$ is a PID, so $I = (a)$ for some $a \in I$. We must have $a \in I_n$ for some $n \in \N$. For all $i \geq 0$,
\be
(a) \supset I \supset I_{n+i} \supset I_n \supset (a),
\ee
so we have equality throughout and in particular $I_{n+i} = I_n$.
\end{proof}

\begin{remark}
Rings satisfying the ACC are called Noetherian.

Proof of (\ref{pro:integral_domain}). 

\ben 
\item [(i)] Let $a \in R$, non-zero and not a unit. Assume it cannot be factorised as a product of finitely many irreducibles. So in particular a itself is not irreducible, hence $a = a_1b_1$ with $a_1$, $b_1$ non-zero and not units. We may assume that $a_1$ cannot be factorised as a product of finitely many irreducibles, so write $a_1 = a_2b_2$ and continue. (If both $a_1$, $b_1$ can be factorised into finitely many irreducibles, then so can $a$.)

We obtain $(a_1) \subsetneq (a_2) \subsetneq (a3) \subsetneq \dots$ with inequality at each stage, for if $(a_i) = (a_{i+1})$ then $a_i$ and $a_{i+1}$ would be associates and $b_{i+1}$ a unit.

\item [(ii)] Suppose we have $p_1 \dots p_m = q_1 \dots q_n$ with products of irreducibles. Then $p_1$ is prime by Lemma \ref{lem:pid} and $p_1 | q_1 \dots q_n$, so $p_1$ divides one of the $q_i$, $p_1 | q_1$, say, and so $q_1 = p_1u$. But $q_1$ is irreducible and $p_1$ is not a unit, hence $u$ is a unit. This
is to say $p_1$ and $q_1$ are associates. We have 
\be
p_1 \dots p_m = up_1q_2 \dots q_n.
\ee

Cancellation in $R$ gives
\be
p_2 \dots p_m = (uq_2)q_3 \dots q_n.
\ee
Note that $(uq_2)$ is irreducible. Continuing in this way gives the result.
\een
\end{remark}

\begin{remark}
The proof of (ii) depends just on Lemma \ref{lem:pid}, that irreducibles are prime, and (i) depends on the ACC.

There are several properties which follow quickly from the definition of a UFD.

\ben
\item [(i)] An element $p \in R$ is irreducible if and only if it is prime. 
	
We have already shown the 'only if' direction for integral domains.

Suppose $p$ is an irreducible and $p | ab$. We can express $a$ and $b$ as
\be
a = p_1 \dots p_m,\quad b = q_1 \quad q_n
\ee
with $p_i$, $q_i$ irreducible. Now write $ab = pc$ with $c = r_1 \dots r_s$ where $r_i$ is irreducible. Then
\be
(p_1 \dots p_m)(q_1 \dots q_n) = pr_1 \dots r_s
\ee
and uniqueness of factorisation implies that $p$ is an associate of either some $p_i$ or some $q_i$. Hence $p | a$ or $p | b$.

\item [(ii)] Highest common factors exist.
\item [(iii)] Lowest common multiples exist.
\een
\end{remark}

\begin{definition}[Highest common factor]
$d$ is a highest common factor of $a_1,\dots , a_n$, written $\hcf(a_1,\dots , a_n)$, if $d | a_i$ for each $i$ and whenever $d'$ also divides each $a_i$ then $d' | d$.

Note that one often refers to the highest common factor, although certainly multiplying by a unit will give another highest common factor.

Expressing each $a_i$ as a product of irreducibles, each $a_i$ is of the form
\be
u_i \prod_j p^{n_{ij}}_j
\ee
where $p_j$ is irreducible and $p_j$ is not associate to $p_k$ whenever $j \neq k$. $u_i$ is a unit in $R$ and $n_{ij} \geq 0$.

The claim is that $\prod_j p^{m_j}_j$ is a highest common factor of $a_1,\dots , a_n$ where $m_j = \min_i\{n_{ij}\}$. It is clear that this is a factor of each $a_i$, and if $d' | a_i$ for each $i$ then each irreducible dividing $d'$ is also an irreducible dividing ai and so must be one of the $p_j$. Thus
\be
d' = u\prod_j p^{t_j}_j
\ee
where $u$ is a unit. But the $t_j$ can be at most $\min_i\{n_{ij}\}$ if $d' | a_i$ for each $i$. Thus $d' | d$.
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Factorisations in polynomial rings, Gauss' lemma and Eisenstein's criterion}

If $\F$ is a field then $\F[X]$ is a ED, PID and UFD. Every ideal $I \lhd \F[X]$ is principal, $I = (f(X))$ for some $f(X) \in \F[X]$. An element is irreducible if and only if it is prime. $\F[X]/I$ is a field, with elements of the form $r(X)+I$ with $r(X) = 0$ or $\deg r < \deg f$, if and only if $I$ is maximal if and only if $f(X)$ is irreducible in $\F[X]$.

Gauss' lemma helps to determine when polynomials are irreducible in $\F[X]$.

\begin{definition}[Content]
Assume that the coefficient ring $R$ is a UFD. Let $f(X) = a_0 + \dots + a_nX_n$ with $a_n \neq 0$, $\deg f = n$. The content $c(f(X))$ is the highest common factor of $a_0,\dots, a_n$. $f(X)$ is primitive if $c(f(X))$ is a unit, i.e. if the $a_i$ are coprime. 
\end{definition}

Our aim is to prove the following lemma.

\begin{lemma}[Gauss' lemma]\label{lem:gauss_lemma}
Let $R$ be a UFD with $\F$ its field of fractions. Suppose $f(X) \in R[X]$ is primitive. Then $f(X)$ is irreducible in $R[X]$ if and only if $f(X)$ is irreducible in $\F[X]$.

In particular, when $R = \Z$ then $f(X)$ is irreducible in $\Z[X]$ if and only if it is irreducible in $\Q[X]$.
\end{lemma}

\begin{example}
$X^3 + X + 1$ is irreducible in $\Z[X]$, and is primitive in $\Z[X]$ and so Gauss' lemma implies $X^3 +X + 1$ is irreducible in $\Q[X]$, and so $\Q[X]/(X^3 +X + 1)$ is a field.

Suppose $X^3 +X +1$ is reducible in $\Z[X]$, so $X^3 +X +1 = g(X)h(X)$ for $g(X), h(X) \in \Z[X]$ not units. Primitivity implies that $g(X)$ and $h(X)$ are not constant polynomials, so $\deg g, \deg h \geq 1$. So one of $g(X)$ and $h(X)$ is of degree 1,
\be
g(X) = b_0 + b_1X, \quad\quad h(X) = c_0 + c_1X + c_2X^2,
\ee
say. Considering coefficients of $X^0$ and $X^3$,
\be
b_0c_0 = 1, \quad b_1c_2 = 1.
\ee
So $b_0 = \pm 1$, $b_1 = \pm 1$. This is a contradiction since $\pm 1$ is not a root of $X^3 + X + 1$.
\end{example}

\begin{lemma}\label{lem:primitive}
If $f(X)$ and $g(X)$ are primitive in $R[X]$ then so is $f(X)g(X)$.
\end{lemma}

\begin{proof}[\bf Proof]
Let
\be
f(X) = a_0 + a_1X + \dots + a_mX^m,\quad g(X) = b_0 + b_1X + \dots + b_nX^n
\ee
be primitive. Suppose the product $f(X)g(X)$ is not primitive. So there is a prime $p \in R$ dividing $c(f(X)g(X))$ but $p \nmid c(f(X))$ and $p \nmid c(f(X))$.

Let $k$ and $l$ be such that
\be
p | a_0,\ p | a_1,\ \dots ,\ p | a_{k-1},\ p \nmid a_k,\quad p | b_0,\ p | b_1,\ \dots ,\ p | b_{l-1},\ p \nmid b_l.
\ee
The coefficient $c_{k+l}$ of $X^{k+l}$ in $f(X)g(X)$ is
\be
\dots + a_{k+1}b_{l-1} + a_kb_l + a_{k-1}b_{l+1} + \dots .
\ee
$p$ divides all of these terms apart from $a_kb_l$ which it does not divide. So $p \nmid c_{k+l}$, contradicting that $p | c(f(X)g(X))$. Thus $f(X)g(X)$ is primitive.

Consider the polynomial ring $R[X]$ and let $\F$ be the field of fractions of $R$.
\end{proof}

\begin{corollary}\label{cor:associate}
For $f(X), g(X) \in R[X]$, the content $c(f(X)g(X))$ is an associate of $c(f(X))c(g(X))$. (Recall that highest common factors and hence contents are only
defined up to associates.)
\end{corollary}

\begin{proof}[\bf Proof]
As $R$ is a UFD we may write
\be
f(X) = c(f(X))f1(X),\quad\quad g(X) = c(g(X))g1(X)
\ee
where $f_1(X), g_1(X)$ are primitive. Then
\be
f(X)g(X) = c(f(X))c(g(X))f_1(X)g_1(X)
\ee
where $f_1(X)g_1(X)$ is primitive by Lemma \ref{lem:primitive}. So a highest common factor of the coefficients of $f(X)g(X)$ is $c(f(X))c(g(X))$.
\end{proof}

\begin{remark}
An irreducible $f(X)$ in $R[X]$ is either in $R$ (and irreducible in $R$) or it is primitive in $R[X]$.

To see this, assume that $f(X)$ is irreducible and write $f(X) = c(f(X))f_1(X)$ with $f_1(X)$ primitive. If $f_1(X) \notin R$ then, since a polynomial of degree at least 1 cannot be a unit, $c(f(X))$ must be a unit.
\end{remark}

Proof of Lemma \ref{lem:gauss_lemma}, Gauss' lemma. Take $f(X)$ primitive in $R[X]$. Suppose it factorises in $R[X]$ as a product of non-units in $R[X]$. Since $f(X)$ is primitive, neither of these non-units is in $R$, the factors have degrees greater than 0. So $f(X)$ factorises as a product of non-units in $\F[X]$.

Conversely, suppose that $f(X) = g(X)h(X)$ with $g(X), h(X) \in \F[X]$ non-units and hence not constant. Multiply by $a \in R$ and $b \in R$ repectively such that $ag(X), bh(X) \in R[X]$. Thus
\be
abf(X) = (ag(X))(bh(X)).
\ee

Write
\be
ag(X) = c(ag(X))g_1(X),\quad\quad bh(X) = c(bh(X))h_1(X)
\ee
where $g_1(X)$, $h_1(X)$ are primitive in $R[X]$. Note that $g_1(X)$, $h_1(X)$ are not constant and hence not units. Now Corollary \ref{cor:associate} implies that $ab$ is an associate of $c(ag(X))c(bh(X))$ by considering contents. So
\be
abf(X) = uc(ag(X))c(bh(X))u^{-1}g_1(X)h_1(X)
\ee
where $ab = uc(ag(X))c(bh(X))$ and $u$ a unit in $R$. Cancellation gives
\be
f(X) = (u^{-1}g_1(X))h_1(X)
\ee
and thus $f(X)$ factorises as a product of non-units in $R[X]$.

\begin{remark}
A similar argument shows that if $f(X) \in R[X]$, not necessarily primitive, and $f(X) = g_1(X)h(X)$ with $g_1(X)$ primitive in $R[X], h(X) \in \F[X]$ then we can deduce that in fact
\be
f(X) = g_1(X)h_0(X)
\ee
with $h_0(X) \in R[X]$.

We can see this as follows. There exists $b \in R$ with $bh(X) \in R[X]$. Consider $bf(X) = g_1(X)(bh(X))$. Write $bh(X) = c(bh(X))h_1(X)$ with $h_1(X)$ primitive. Consider contents, $b | c(g_1(X)bh(X))$ and so $b | c(bh(X))$ since $g_1(X)$ is primitive. Cancellation as in the previous result gives $f(X) = g_1(X)h_0(X)$ for some $h_0(X) \in R[X]$.

Thus if
\be
I = g_1(X)\F[X] \lhd \F[X]
\ee
and
\be
J = g_1(X)R[X] \lhd R[X]
\ee
then $I \cap R[X] = J$, with $g_1(X)$ primitive in $R[X]$.
\end{remark}

\begin{theorem} 
If $R$ is a UFD then $R[X]$ is a UFD.
\end{theorem}

\begin{proof}[\bf Proof]
Let $f(X) \in R[X]$ be non-zero and a non-unit. Write $f(X) = c(f(X))f_1(X)$ with $f_1(X)$ primitive. (The first step is to show that we need only look at primitives.)

Observe that since R is a UFD, $c(f(X))$ is expressible as a product of irreducibles in $R$ in an essentially unique way. These irreducibles are irreducible in $R[X]$.

If $f(X)$ factorises as a product of irreducibles in $R[X]$, then we can collect together the irreducibles in $R$ and the primitive irreducibles. The product of these primitive irreducibles is primitive by Lemma \ref{lem:primitive} and so the content of $f(X)$ is an associate of the product of the irreducibles in $R$. The essentially unique factorisation of $c(f(X))$ means that this product is essentially the same as the previous one.

Cancellation implies that the product of the primitives is an associate of $f_1(X)$. Thus we may assume that $f(X)$ is primitive.

$\F[X]$ is a UFD. So we can factorise $f(X)$ in $\F[X]$,
\be
f(X) = p_1(X) \dots p_k(X),
\ee
where $p_i(X)$ is irreducible in $\F[X]$.

There exists $a_i \in R$ with $a_ip_i(X) \in R[X]$. We have
\be
a_ip_i(X) = c_iq_i(X)
\ee
with $c_i = c(a_ip_i(X))$, $q_i(X)$ primitive in $R[X]$ (and irreducible in $R[X]$ by Gauss' lemma). So
\be
a_1 \dots a_kf(X) = c_1 \dots c_kq_1(X) \dots q_k(X).
\ee

Considering contents and using the assumption that $f(X)$ is primitive, we have
\be
a_1 \dots a_k = uc_1 \dots c_k
\ee
for some unit $u \in R$ since $q_i(X)$ is primitive by Lemma \ref{lem:primitive}, i.e. $q_1(X) \dots q_k(X)$ is primitive.
\be
a_1 \dots a_k f(X) = (uc_1 \dots c_k)(u^{-1}q_1(X))q_2(X) \dots q_k(X).
\ee

Cancellation gives
\be
f(X) = (u^{-1}q_1(X))q_2(X) \dots q_k(X),
\ee
a product of irreducibles in $R[X]$. This shows the existence part. For the uniqueness of the factorisation assume that
\be
f(X) = q_1(X) \dots q_k(X) = r_1(X) \dots r_l(X)
\ee
with $q_i(X)$, $r_i(X)$ irreducible in $R[X]$. We are assuming that $f(X)$ is primitive and so each $r_i(X)$ must be primitive.

By Gauss' lemma, $r_i(X)$ is irreducible in $\F[X]$. Uniqueness of factorisation in $\F[X]$ implies that $k = l$, and after reordering we have $q_i(X) = u_ir_i(X)$ with $u_i$ a unit in $\F[X]$, hence in $\F$.

We can write $u_i = a_i/b_i$ for some $a_i, b_i \in R$ with $b_i \neq 0$. Then $b_iq_i(X) = a_ir_i(X)$. But $q_i(X)$ and $r_i(X)$ are primitive and hence $b_i$ and $a_i$ must be associates being the content of $b_iq_i(X) = a_ir_i(X)$. Cancelling gives that $q_i(X)$ and $r_i(X)$ are associates in $R[X]$. Thus factorisation is essentially unique in $R[X]$.
\end{proof}

\begin{corollary}
Let $R$ be a UFD. Then $R[X_1,\dots ,X_n]$ is a UFD.
\end{corollary}
\begin{proof}[\bf Proof]
We assume that $R$ is a UFD and repeated application of Lemma \ref{lem:primitive} gives that $R[X_1]$, $R[X_1,X_2] = (R[X_1])[X_2],\dots ,R[X_1,\dots ,X_n]$ is a UFD.
\end{proof}

\begin{proposition}[Eisenstein's criterion\index{Eisenstein's criterion}]
Let $R$ be a UFD and let 
\be
f(X) = a_0+a_1X+ \dots + a_nX^n \in R[X],\ a_n \neq 0,
\ee
be primitive. Assume that for some irreducible $p$ we have $ p \nmid a_n$, $p | a_i$ for $0 \leq i < n$ and $p^2 \nmid a_0$. Then $f(X)$ is irreducible in $R[X]$, and hence in $\F[X]$ by Gauss' lemma.
\end{proposition}

\begin{proof}[\bf Proof]
Suppose that $f(X) = g(X)h(X)$ with
\be
g(X) = r_kX^k + \dots + r_0,\quad \quad h(X) = s_lX^l + \dots + s_0
\ee
where $r_k, s_l \neq 0$. Note that $k + l = n$. Since $p | a_0 = r_0s_0$ and $p^2 \nmid a_0$ we may assume that $p | r_0$ and $p \nmid s_0$. $p \nmid a_n = r_ks_l$ implies $p \nmid r_k$, $p \nmid s_l$.

Set $j$ to be such that $p | r_0,\dots , p | r_{j-1}, p \nmid r_j$. Consider the term
\be
a_j = r_0s_j + \dots + r_js_0.
\ee
Note $p \nmid a_j$. Thus $j = n$, and hence $k = n$, $l = 0$. As $f(X)$ is primitive, the constant polynomial $h(X)$ must be a unit. Thus $f(X)$ cannot be factorised as a product of non-units.
\end{proof}

\begin{example}
Consider $R = \Z$ and let $f(X) = X^n - p \in \Z[X]$, where $p$ is prime. 

By Eisenstein's criterion, $f(X)$ is irreducible in $\Z[X]$ and hence in $\Q[X]$. So $f(X)$ does not have any roots in $\Q$, as a root would yield a linear factor of $f(X)$ in $\Q[X]$. Thus $p$ has no nth roots in $\Q$.
\end{example}

\begin{example}
Consider the cyclotomic polynomial
\be
f(X) = X^{p-1} + X^{p-2} + \dots + 1
\ee
where $p$ is prime. The claim is that this is irreducible in $\Z[X]$, and hence in $\Q[X]$. Note that $(X - 1)f(X) = X^p - 1$. We make the substitution $X = 1 + Y$ and get
\be
Y f(1 + Y ) = (1 + Y )^p - 1, \quad\quad f(1 + Y ) = Y^{p-1} + \binom{p}{1} Y^{p-2} + \dots + \binom{p}{p - 1} 
\ee
where $\binom{p}{i}$ are binomial coefficients. Eisenstein's criterion does now apply, we have $p |\binom{p}{i}$, $p^2 \nmid\binom{p}{p-1} = p$. We deduce that $f(1 + Y )$ is irreducible and hence $f(X)$ is irreducible in $\Z[X]$, and hence in $\Q[X]$.
\end{example}

\subsection{Gaussian integers}

We consider the set of Gaussian integers\index{Gaussian integers} as introduced before,
\be
\Z[i] = \{a + ib : a, b \in \Z\}.
\ee

The norm
\be
N(a + ib) = a^2 + b^2 = (a + ib)(a - ib) = z\bar{z},
\ee
where $z = a + ib$, is multiplicative, that is,
\be
N(z_1z_2) = N(z_1)N(z_2).
\ee

The units have to be of norm 1, hence the only units are $\pm 1$, $\pm i$.

Recall from an earlier example that $\Z[i]$ is a Euclidean domain and hence a PID and a UFD. Thus the irreducibles and primes are the same, by Lemma \ref{lem:irreducible} and Lemma \label{lem:pid}. What are they?
\bit
\item $2 = (1 + i)(1 - i)$.
\item 3, $N(3) = 9$. If it were to factorise as a product of two non-units then they would have norm 3. But there are no elements of norm 3.
\item $5 = (1 + 2i)(1 - 2i)$.
\eit

\begin{lemma}\label{lem:square_modulo}
A prime number $p$ in $\Z$ is irreducible (and prime) in $\Z[i]$ if and only if $p$ is not of the form $x^2 + y^2$ with $x, y \in \Z - \{0\}$.
\end{lemma}
\begin{proof}[\bf Proof]
If $p = x^2 + y^2$ then $p = (x + iy)(x - iy)$ and so $p$ is not irreducible in $\Z[i]$. Otherwise consider $N(p) = p^2$, $p$ factorises into two non-units, necessarily of norm $p$, only if there is $x + iy$ with $N(x + iy) = p$. So $x^2 + y^2 = p$.
\end{proof}

\begin{proposition}
The irreducibles (and primes) in $\Z[i]$ are up to associates
\ben
\item [(i)] $p \in \Z$ prime with $p \equiv 3 (\bmod 4)$,
\item [(ii)] $z$ with $z\bar{z} = p$, for $p$ prime in $\Z$ with $p = 2$ or $p \equiv 1 (\bmod 4)$.
\een
\end{proposition}

\begin{proof}[\bf Proof]
Let us first show that these are actually irreducibles (and primes).
\ben
\item [(i)] If $p \equiv 3 (\bmod 4)$ then it is not of the form $x^2 + y^2$ since squares modulo 4 are 0 or 1 and so $x^2 + y^2 \equiv 0,\ 1 \text{ or }2 (\bmod 4)$. By Lemma \ref{lem:square_modulo}, $p$ is irreducible (and prime) in $\Z[i]$.

\item [(ii)] For example, $p = 2 = (1 + i)(1 - i)$ is of the correct form, $1 \pm  i$ are irreducibles of norm 2.

Consider the finite field of $p$ elements $\{0, 1,\dots , p - 1\} = \F_p\cong \Z/p\Z$. Its multiplicative group $\F_p \bs \{0\}$ is cyclic. If not then the structure theorem for abelian groups implies we can find a subgroup of form $C_m \times C_m$ for some $m > 1$.

Thus there are at least $m^2$ elements satisfying $a^m = 1$. These are all roots of $X^m - 1$ in $\F_p[X]$ which is a UFD. $X^m - 1$ has a unique expression up to ordering and associates as a product of at most $m$ irreducibles in $\F_p[X]$.

In particular, there are at most $m$ linear factors $X - a$ and so at most $m$ roots, contradicting that there are at least $m^2$ roots.

In this case, $\F_p$ has a cyclic multiplicative group. A cyclic group $\langle g\rangle$ of order $4n$ has a subgroup of order 4, namely $\langle g^n \rangle$, and a unique element of order 2, namely $g^{2n}$. $p - 1$ is the element of order 2 in $\F_p - \{0\}$, the multiplicative group.

An element of order 4 corresponds to $a \in \Z$ with $a^2 \equiv -1 (\bmod p)$. Thus $p | a^2 + 1 = (a + i)(a - i)$. But $p \nmid a \pm  i$ and so $p$ is not an irreducible (and prime) in $\Z[i]$.

Thus $p$ must factorise, $p = z_1z_2$ with $z_i$ non-units in $\Z[i]$. We have $N(z_i) = p$. Write $z_i = x \pm  iy$. We get $p = x^2 + y^2$.
\een

Now assume $\alpha$ is irreducible in $\Z[i]$, so $\bar{\alpha}$ is irreducible. Take $p | N(\alpha)$. We use that $N(\alpha) = \alpha\bar{\alpha}$, a product of irreducibles.

If $p \equiv 3 (\bmod 4)$ then $p$ prime and unique factorisation implies that $p$ is an associate of either $\alpha$ or $\bar{\alpha}$. So $p$ is an associate of $\alpha$.

If $p = 2$, or $p \equiv 1 (\bmod 4)$ then $p = z\bar{z} | \alpha\bar{\alpha}$ and unique factorisation, so $z$ is an associate of $\alpha$ or $\bar{\alpha}$ and so $\alpha$ is an associate of $z$ or $\bar{z}$.

Thus our list is complete.
\end{proof}

\begin{corollary}
Let $n = p^{n_1}_1 \dots p^{n_k}_k \in \Z$ be the prime factorisation of $n$, with $p_1,\dots , p_k$ distinct primes in $\Z$. Then $n$ is of the form $x^2 + y^2$ if and only if whenever $p_i \equiv 3(\bmod 4)$ then $n_i$ is even.
\end{corollary}

\begin{proof}[\bf Proof]
Suppose $n = x^2 + y^2 = (x + iy)(x - iy) = z\bar{z}$ with $z = x + iy$. Thus $N(z) = n$. Express $z$ as a product of irreducibles in $\Z[i]$,
\be
z = \alpha_1 \dots \alpha_s,
\ee
say. But we know what the irreducibles are from Proposition \ref{pro:irreducible}. Either $N(\alpha_j) = p^2_j$ with $p_j \equiv 3 (\bmod 4)$ or $N(\alpha_j) = p_j$ with $p_j = 2$ or $p_j \equiv 1 (\bmod 4)$. Thus $n = N(z) = \prod N(\alpha_j)$ is of the required form.

Conversely, if $n = p^{n_1}_1 \dots p^{n_k}_k$ with $n_j$ even for $p_j \equiv 3 (\bmod 4)$ then we can replace any $p_j = 2$ or $p_j \equiv 1 (\bmod 4)$ by $p_j = \alpha_j \bar{\alpha}_j$ and any other primes $p_j = \alpha_j = \bar{\alpha}_j$ and so $p^2_j = \alpha_j \bar{\alpha}_j$ for some irreducible $\alpha_j$. Thus $n$ is of the form $z\bar{z}$ for some $z = x + iy$ and so $n = x^2 + y^2$.
\end{proof}

\begin{example}
Let $n = 65 = 5 \times 13$ and note that $5 = (2 + i)(2 - i)$, $13 = (2 + 3i)(2 - 3i)$. The unique factorisation up to reordering and associates is
$n = (2 + i)(2 - i)(2 + 3i)(2 - 3i)$.

We use this to express $n$ as $x^2 + y^2 = z\bar{z}$ with $z = x + iy$
\be
n = [(2 + i)(2 + 3i)][(2 - i)(2 - 3i)] = (1 + 8i)(1 - 8i) = 1^2 + 8^2
\ee
or
\be
n = [(2 + i)(2 - 3i)][(2 - i)(2 + 3i)] = (7 - 4i)(7 + 4i) = 4^2 + 7^2.
\ee
\end{example}

\subsection{$\Z[\alpha]$ with $\alpha$ an algebraic integer}

\begin{definition}
A complex number $\alpha \in \C$ is an algebraic integer\index{algebraic integer} if there is a monic polynomial $f(X) \in \Z[X]$ with $f(\alpha) = 0$.

For example,
\begin{center}
\begin{tabular}{cc}
$\alpha \in \C$ & \quad Minimal polynomial of $\alpha$ \quad\\
\hline
$i$ & $f(X) = X^2 + 1$\\ 
$\sqrt{2}$ &  $f(X) = X^2 - 2$\\
$\frac 12(1 +\sqrt{-3})$ & $f(X) = X^2 - X + 1$
\end{tabular}
\end{center}

$Z[\alpha]$ is the smallest subring of $\C$ containing $\Z$ and $\alpha$. $\Z[\alpha] \cong \Z[X]/I$ where $I$ is the kernel of the map $\theta : \Z[X] \to \Z[\alpha],\ g(X) \mapsto  g(\alpha)$.
\end{definition}

\begin{proposition}
For an algebraic integer $\alpha$ this kernel is a principal ideal generated by a monic irreducible polynomial in $\Z[X]$.
\end{proposition}

\begin{definition}
This generator is called the minimal polynomial of $\alpha$, written $f_\alpha(X)$.
\end{definition}
\begin{proof}[\bf Proof]
By definition, $f(\alpha) = 0$ for some monic $f(X) \in \Z[X]$. So we can pick $f_\alpha(X)\in I$ of minimal degree $\geq 0$, and we may assume $f_\alpha(X)$ is primitive in $\Z[X]$. The claim is that this is the required polynomial.

We wish to show that $I = (f_\alpha(X))$.

Let $h(X) \in I$. Then, as $\Q[X]$ is a Euclidean domain, we can write
\be
h(X) = q(X)f_\alpha(X) + r(X)
\ee
with $r(X) = 0$ or $\deg r(X) < \deg f_\alpha(X)$. Clearing denominators, there exists $a \in \Z\bs\{0\}$ such that
\be
ah(X) = aq(X)f_\alpha(X) + ar(X)
\ee
with $aq(X) \in \Z[X]$ and $ar(X) \in \Z[X]$. But $ar(\alpha) = 0$ so $ar(X) \in I$. Minimality of degree of $f_\alpha(X)$ implies that $ar(X) = 0$ so $r(X) = 0$. So $ah(X) = aq(X)f_\alpha(X)$. Consider the contents of both sides,
\be
a | c(ah(X)),\quad\quad c(aq(X)f_\alpha(X)) = c(aq(X))
\ee
since $f_\alpha(X)$ is primitive. So $a$ divides all the coefficients of $aq(X)$. So $q(X)\in \Z[X]$. Thus $h(X) \in (f_\alpha(X)) \lhd \Z[X]$.

We claim that $f_\alpha(X)$ is prime (and irreducible).

If $f_\alpha(X) = f_1(X)f_2(X)$ then $0 = f_1(\alpha)f_2(\alpha)$ and so $f_i(X) \in I$ for some $i$. $f_\alpha(X) | f_i(X)$ for some $i$.

Finally, we show that $f_\alpha(X)$ is monic.

Since $f_\alpha(X) | f(X)$ where $f(X)$ as in the first line.
\end{proof}

\begin{definition}[Rational integers]
The elements of $\Z$ are called rational integers.
\end{definition}

\begin{lemma}
If $\alpha$ is an algebraic integer and $\alpha \in \Q$ then $\alpha \in \Z$.
\end{lemma}

\begin{proof}[\bf Proof]
$f_\alpha(X)$ is irreducible in $\Z[X]$ and monic. By Gauss' lemma, Lemma \ref{lem:gauss_lemma}, $f_\alpha(X)$ is irreducible in $\Q[X]$. $\alpha$ is a root. So $f_\alpha(X) = X - \alpha$. Thus $\alpha \in \Z$.
\end{proof}

\begin{example}
Let $p \in \Z$ be prime and consider $\Z[X]/(p, f_\alpha(X))$. We have $\F_p \cong \Z/p\Z$. By the isomorphism theorems,
\be
\F_p[X]/( \bar{f}_\alpha(X)) \cong \Z[X]/(p, f_\alpha(X)) \cong \Z[\alpha]/(p)
\ee
where $\bar{f}_\alpha(X)$ is the polynomial in $\F_p[X]$ obtained from $f_\alpha(X)$ by taking coefficients modulo $p$.

For example, $\alpha = i$, $f_\alpha(X) = X^2 + 1$. Then
\be
\F_p/(X^2 + 1) \cong \Z[i]/(p).
\ee
For $p = 2\text{ or }p \equiv 1 (\bmod 4)$ this is not an integral domain, for $p \equiv 3 (\bmod 4)$ it is an integral domain.
\end{example}

\begin{remark}
There is quite a lot on algebraic integers in the Part II course Number Fields. For example, quadratic fields which are of the form $\Q(\sqrt{d}) = \{a + b
\sqrt{d} : a, b \in \Q\} \leq \C$. In $\Q(\sqrt{d})$ the algebraic integers form a ring $R$. However, $(1 + \sqrt{-3})/2$ is an algebraic integer so $R$ is not necessarily $\Z(\sqrt{d})$.

$R$ is Euclidean if and only if $d$ is -11, -7, -3, -2, -1, 2, 3, 5, 6, 7, 11, 13, 17, 19, 21, 29, 33, 37, 41, 57 or 73 (21 possibilities). 

$R$ is a UFD for $d < 0$ if and only if $d$ is -1, -2, -3, -7, -11, -19, -43, -67, -163 (9 possibilities, cf. H.M. Stark \textit{An introduction to number theory}). For $d > 0$ there exist 38 possibilities with $2 \leq d < 100$ so that $R$ is a UFD. This question is still open.
\end{remark}

\subsection{Hilbert's basis theorem} 

Recall that we showed that a PID satisfies the ascending chain condition (ACC) on ideals.

\begin{lemma}
A ring $R$ satisfies the ACC if and only if all ideals in $R$ are finitely generated.
\end{lemma}

\begin{proof}[\bf Proof]
Suppose that all ideals are finitely generated and consider a chain
\be
I_1 \subset I_2 \subset \dots 
\ee
with $I_j \lhd R$. Then the union $\bigcup_j I_j \lhd R$ is an ideal too. So by supposition $\bigcup_j I_j$ is finitely generated. There exists $N$ such that all these finitely many generators lie in $I_N$.

If $m \geq N$ then $I_m \subset \bigcup_j I_j \subset I_N$. Also $I_N \subset I_m$ and so $I_m = I_N$.

Conversely, assume the ACC and let $J \lhd R$. Take $a_1\in J$ with $a_1 \neq 0$. If $J \neq (a_1)$ pick $a_2 \in J \bs (a_1)$. If $J \neq (a_1, a_2)$ pick $a_3 \in J \bs (a_1, a_2)$ etc. We are producing a chain
\be
(a_1) \subsetneq (a_1, a_2) \subsetneq (a_1, a_2, a_3) \subsetneq \dots .
\ee

By the ACC this process stops, so $J = (a_1,\dots , a_N)$ for some $N$.
\end{proof}

\begin{definition}
A ring with these properties is called Noetherian\index{Noetherian}.
\end{definition}

\begin{theorem}[Hilbert's basis theorem\index{Hilbert's basis theorem}]
If $R$ is Noetherian then $R[X]$ is Noetherian.
\end{theorem}

\begin{proof}[\bf Proof]
Let $J \lhd R[X]$ be an ideal. We aim to show that it is finitely generated. Consider
\be
I_j = \left\{ a_j \in R : \exists f(X) \in J, \ f(X) = \sum^j_{i=0} a_iX^i \in J\right\} \cup \{0\},
\ee
the set of leading coefficients of polynomials of degree $j$ in $J$.

$I_j \lhd R$ is an ideal since if $\sum^j_{i=0} a_iX^i \in J$, $\sum^j_{i=0} b_iX^i \in J$ then 
\be
\sum^j_{i=0} (a_i + b_i)X^i \in J
\ee
and if $a \in R$ then $\sum^j_{i=0} aa_iX^i \in J$. $I_j \subset I_{j+1}$ since if $\sum^j_{i=0} a_iX^i \in J$ then $X \bb{\sum^j_{i=0} a_iX^i} \in J$.

The ACC for $R$ implies that there exists $N$ with $I_m = I_N$ for all $m \geq N$ and $I_N$ is finitely generated by the leading coefficients of $f_1(X),\dots , f_k(X)$, say.

Now take any $f(X) \in J$ of degree $m \geq N$. The leading coefficient of $f(X)$ lies in $I_m = I_N$ and so there exists $r_1,\dots,r_k \in R$ so that $r_1f_1(X) + \dots + r_kf_k(X)$ has the same leading coefficient. So 
\be
f(X) - (r_1f_1(X) + \dots + r_kf_k(X))X^{m-N} \in J
\ee
and is of degree less than $m$. Repeating this process yields $q_1(X),\dots , q_k(X) \in R[X]$ such that
\be
f(X) - (q_1(X)f_1(X) + \dots + q_k(X)f_k(X)) \in J
\ee
of degree less than $N$.

Now consider polynomials in $J$ of degree less than $N$. For $j < N$ there is a finite set $S_j$ of polynomials in $J$ of degree $j$ whose leading coefficients generate $I_j$ . Let $S = \bigcup_{j<N} S_j$, a finite set.

A similar argument to the one before shows that any polynomial in $J$ of degree less than $N$ is of the form $\sum g_i(X)h_i(X)$ for $g_i(X) \in S$, $h_i(X) \in R[X]$.

Thus $J$ is generated by $S \cup \{f_1(X),\dots,f_k(X)\}$.
\end{proof}

\begin{corollary}
If $\F$ is a field then $\F[X_1,\dots ,X_n]$ is Noetherian and $\Z[X_1,\dots ,X_n]$ is also Noetherian.
\end{corollary}

\begin{corollary}
Any ring image of $\Z[X_1,\dots ,X_n]$ is Noetherian.
\end{corollary}

\begin{proof}[\bf Proof]
Let $\theta : \Z[X_1,\dots ,X_n] \to S$ be a homomorphism. Then $\theta$ is surjective. If $I \lhd S$ is an ideal then
\be
J = \{f(X_1,\dots ,X_n) \in \Z[X_1,\dots ,X_n] : \theta(f(X_1,\dots ,X_n)) \in I\}
\ee
is finitely generated. Then $I$ is generated by the images under $\theta$ of a finite generating set of $J$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Modules}

\subsection{Introduction}

\begin{definition}
Let $R$ be a commutative ring. A set $M$ is an $R$-module with operation $+$, with $(M, +)$ forming an abelian group, and also has a map 
\be
R \times M \to M,\ (r,m) \mapsto m
\ee
satisfying
\beast
(r_1 + r_2)m & = & r_1m + r_2m\\
r(m_1 + m_2) & = & rm_1 + rm_2\\
r_1(r_2m) & = & (r_1r_2)m\\
1m & = & m
\eeast
for all $r_1, r_2, r \in R$ and $m_1,m_2,m \in M$.
\end{definition}

\begin{example}
\ben
\item [(i)] Let $R = \F$ be a field. Then all vector spaces over $\F$ are $\F$-modules.
\item [(ii)] For any $R$, $R^n$ forms an $R$-module,
\be
r(r_1,\dots , r_n) = (rr_1,\dots , rr_n).
\ee
In particular, when $n = 1$, $R$ itself is an $R$-module.

\item [(iii)] If $I \lhd R$ is an ideal then $I$ is an $R$-module and $R/I$ is an $R$-module.
\item [(iv)] Let $R = \Z$. $\Z$-modules are precisely the abelian groups. Given an abelian group $A$ with operation written as $+$ then the module map is given by
\beast
na & = & \underbrace{a + \dots+ a}_{n \text{ times}} \quad\quad n\geq 1\\
0a & = & 0\\
(-n)a & = & -(an) \quad\quad n \geq 1
\eeast

\item [(v)] $R = \F[X]$, $\F$ a field. If $V$ is an $\F$-vector space and $\alpha: V \to V$ a linear map (vector space endomorphism) then $V$ may be regarded as a $\F[X]$-module via 
\be
f(X)\dots v = f(\alpha)(v)
\ee
for $v \in V$. Different maps $\alpha$ yield different $\F[X]$-modules.

\item [(vi)] If $R \leq S$ are rings then $S$ can be regarded as an $R$-module via
\be
rs = (rs)
\ee
for $r \in R$, $s \in S$. For example, let $\Z \leq \Z[\alpha]$, $\alpha$ an algebraic integer. We can regard $\Z[\alpha]$ as a $\Z$-module.

\item [(vii)] Let $R$ be the prime subring of a finite field $\F$. Here $R \cong \F_p$ for some prime $p$. (Question 8 on Example Sheet 3 shows that $\F$ has cardinality $p^n$ for some $n$.) We can view $\F$ as an $\F_p$-vector space.
\een
\end{example}

\begin{remark}
There exists exactly one field of cardinality $p^n$ for every prime $p$ and $n \geq 1$, up to isomorphism. For example, 

\begin{center}
\begin{tabular}{cc}
Cardinality & Field \\
\hline
4 & \quad  $\F_2[X]/(X^2 + X + 1)$\quad \\
8 & $\F_2[X]/(X^3 + X + 1)$
\end{tabular}
\end{center}

noting that e.g. $X^2 + X + 1$ is irreducible modulo 2. See also Question 9 on Example Sheet 2.
\end{remark}

\begin{definition}
A subset $N$ of an $R$-module $M$ is an $R$-submodule, written $N \leq M$, if it is an additive subgroup of $M$ and $rn \in N$ for all $r \in R$, $n \in N$.
\end{definition}

\begin{example}
Ideals $I \lhd R$ are the $R$-submodules of the $R$-module $R$. In a $\F$-vector space the vector subspaces are the $\F$-submodules.
\end{example}

\begin{definition}
If $N \leq M$ then the quotient module\index{quotient module} $M/N$ has elements $m + N$ with the operation + defined as for quotients of the additive groups,
\be
r(m + N) = rm + N
\ee
for $r \in R$, $m \in M$. Check that this turns $M/N$ into an $R$-module.
\end{definition}

\begin{definition}
A map $\theta : M \to N$ is an $R$-module homomorphism if
\beast
\theta(m_1 + m_2) = \theta(m_1) + \theta(m_2),\\
\theta(rm) & = & r\theta(m).
\eeast
\end{definition}

\begin{example}
If $R = \F$, $\F$ a field, then an $R$-module homomorphism is a linear map between $\F$-vector spaces.
\end{example}

\begin{theorem}[First isomorphism theorem]\label{thm:modulo_isomorphism_1}
If $\theta : M \to N$ is an $R$-module homorphism then $\ker \theta$ is an $R$-submodule of $M$, the image of $\theta$ is a submodule of $N$ and with
\beast
\ker \theta & = & \{a \in M : \theta(m) = 0\},\\
\im \theta & = & \{\theta(m) : m \in M\}
\eeast
we have that $M/\ker \theta \cong \im \theta$.
\end{theorem}

\begin{proof}[\bf Proof]
Left to the reader. The isomorphism theorem for additive subgroups shows that $M/ \ker \theta \cong \im \theta$ for the additive groups. So we only need to check the multiplicative properties.
\end{proof}

As usual there is a 1-1 correspondence,
\be
\{\text{submodules of }M/N\} \longleftrightarrow \{\text{submodules of $M$ containing $N$}\}.
\ee

If $N \leq L \leq M$ are $R$-modules then
\be
M/L \cong (M/N)/(L/N).
\ee
Compare this with the third isomorphism theorem.

\begin{example}
In the special case of $R = \F$ a field and vector spaces, we have quotient spaces $V/W$ where $W \leq V$ and there are isomorphism theorems for linear maps ($\F$-module homomorphisms).
\end{example}

\begin{definition}
Let $m \in M$ then the annihilator\index{annihilator} of $m$ is
\be
\ann(m) = \{r \in R : rm = 0\}.
\ee

The annihilator of $M$ is
\be
\ann(M) = \{r \in R : \forall m \in M,\ rm = 0\} = \bigcap_{m\in M} \ann(m).
\ee

These annihilators are ideals in $R$ since
\be
r_1m = 0, r_2m = 0 \ \ra \ 0 = r_1m + r_2m = (r_1 + r_2)m, \quad r_1m = 0 \ \ra \ (rr_1)m = 0.
\ee
\end{definition}

\begin{lemma}
If $M$ is an $R$-module and $m \in M$ then
\be
Rm \cong R/ \ann(m)
\ee
where $Rm = \{rm : r \in R\}$.
\end{lemma}

\begin{proof}[\bf Proof]
Apply Theorem \ref{thm:modulo_isomorphism_1} to the $R$-module homomorphism $\theta : R \to M,\ r \mapsto rm$ with $\ker \theta = \ann(m)$ and $\im \theta = Rm$.
\end{proof}

Modules of the form $Rm$ are cyclic modules. More generally, if $m_1,\dots ,m_k \in M$ and
\be
M = Rm_1 + \dots + Rm_k = \{r_1m_1 + \dots + r_km_k : r_1,\dots,r_k \in R\}
\ee
then $M$ is generated by $m_1,\dots ,m_k$, and $M$ is finitely generated.

\begin{example}
If $R = \Z$ then $\Z[\alpha]$ is a $\Z$-module where $\alpha$ is an algebraic integer. In fact, it is a finitely generated $\Z$-module. (Exercise.)
\end{example}

\begin{lemma}
Let $N \leq M$ be $R$-modules. If $M$ is finitely generated then $M/N$ is finitely generated.
\end{lemma}

\begin{proof}[\bf Proof]
Suppose $M = Rm_1 +\dots+Rm_k$ then $M/N$ is generated by $m_1 +N,\dots ,m_k +N$ since
\be
m + N = r_1m_1 + \dots + r_km_k + N = r_1(m_1 + N) + \dots + r_k(m_k + N).
\ee
for some $r_1,\dots,r_k \in R$.
\end{proof}

Warning. $N$ need not be finitely generated.

\begin{example}
The polynomial ring $\C[X_1,X_2,\dots]$ in countably infinitely many variables $X_1,X_2,\dots$. Consider the ideal $I$ of polynomials with zero constant term. This is not finitely generated since $I = \bigcup I_j$ where $I_j = (X_1,\dots ,X_j)$ and hence $I_1 \subsetneq I_2 \subsetneq I_3 \subsetneq \dots$.
Thus $\C[X_1,X_2,\dots]$ is not Noetherian.

If $R = \C[X_1,X_2,\dots]$ then the submodules are the ideals, and we have shown that there is a submodule which is not finitely generated inside the cyclic module $R$.
\end{example}

\subsection{Direct sums, free modules}

\begin{definition}
If $M_1,\dots ,M_k$ are $R$-modules then the direct sum\index{direct sum} $M_1 \oplus \dots\oplus M_k$ has elements $(m_1,\dots ,m_k)$ with $m_i \in M_i$, addition
\be
(m_1,\dots ,m_k) + (m'_1,\dots ,m'_k) = (m_1 + m'_1,\dots ,m_k + m'_k)
\ee
and scalar multiplication
\be
r(m_1,\dots ,m_k) = (rm_1,\dots , rm_k).
\ee
\end{definition}

\begin{definition}
Let $m_1,\dots ,m_k \in M$. Then the set $\{m_1,\dots ,m_k\}$ is independent if
\be
r_1m_1 + \dots + r_km_k = 0 \ \ra \ r_1 = \dots = r_k = 0.
\ee
\end{definition}

\begin{definition}
The subset $S \subset M$ generates $M$ freely if
\ben
\item [(i)] $S$ generates $M$,
\item [(ii)] every map $\psi : S \to N$, where $N$ is an $R$-module, extends to an $R$-module homomorphism $\theta : M \to N$.
\een
\end{definition}

\begin{remark}
If such a $\theta$ exists then it is unique since if we have two such $\theta_1$ and $\theta_2$ then $S \subset \ker(\theta_1 - \theta_2)$ and so $M \leq \ker(\theta_1 - \theta_2)$ since $S$ generates $M$. Thus $\theta_1 = \theta_2$.
\end{remark}

\begin{definition}
A module freely generated by some subset $S$ is free and $S$ is a basis\index{basis}.
\end{definition}

\begin{proposition}
For $S = \{m_1,\dots ,m_k\} \subset M$ the following are equivalent:
\ben
\item [(i)] $S$ generates $M$ freely.
\item [(ii)] $S$ generates $M$ and is an independent set.
\item [(iii)] Every element of $M$ is uniquely expressible in the form $r_1m_1+\dots+r_km_k$ for some $r_i \in R$.
\een
\end{proposition}

\begin{proof}[\bf Proof]
[(i) $\ra$ (ii)] Suppose that $S$ generates $M$ freely. We need to show independence. Let $N = R^k$ and define
\be
\psi : S \to N,\ m_j \mapsto  (0,\dots , 1,\dots),
\ee
i.e. a 1 in the $j$th place. So there is an $R$-module homomorphism $\theta : M \to N$. Then
\be
\theta(r_1m_1 + \dots + r_km_k) = (r_1,\dots , r_k).
\ee
So if $r_1m_1 + \dots + r_km_k = 0$ then $r_1 = \dots = r_k = 0$.

The two implications (ii) $\ra$ (iii) and (iii) $\ra$ (i) are left as an exercise.
\end{proof}

\begin{example}
For $R = \Z$, $M = \Z$, the set $\{2, 3\}$ is a generating set, but contains no basis for $M$. For example, $\{2\}$ is independent, but is not a generating set.
\end{example}

\begin{proposition}\label{pro:r_k}
Let $M$ be a $R$-module, generated by $\{m_1,\dots ,m_k\}$. Then there is a free module $R^k$ and a surjective homomorphism $\theta : R^k \to M$. Thus $M \cong R^k/ \ker \theta$.
\end{proposition}

\begin{proof}[\bf Proof]
Define an $R$-module homomorphism
\be
\theta : R^k \to M,\ (r_1,\dots ,r_k) \mapsto  r_1m_1 + \dots + r_km_k.
\ee
\end{proof}

The kernel in Proposition \ref{pro:r_k} is the relation module.

\begin{definition}
An $R$-module $M$ is finitely presented if there exists a finite generating set $S = \{m_1,\dots ,m_k\} \subset M$ and the relation module is also finitely generated, by $\{n_1,\dots , n_l\}$. We say that $M$ is generated by $S$ subject to relations $r_1m_1+\dots+r_km_k = 0$ for each $n_i = (r_{i_1},\dots,r_{i_k})$.
\end{definition}

\begin{proposition}
Let $R$ be a non-zero ring, $M$ be an $R$-module freely generated by $\{u_1,\dots , u_m\}$ and $\{v_1,\dots , v_n\}$. Then $m = n$.
\end{proposition}

\begin{proof}[\bf Proof]
One can define determinants for square matrices with coefficients just as in Linear Algebra by
\beast
\det A & = & \sum_{\pi \in S_n} \sgn(\pi)A_{1,\pi(1)} \dots A_{n,\pi(n)},\\
\det AB & = & \det A\det B,\\
A \adj(A) & = & (\det A)I.
\eeast

Thus $A$ is invertible if and only if $\det A$ is a unit in $R$. Assume that $n \geq m$ with unique expressions
\be
v_j = \sum_i A_{ij}u_i,\quad\quad u_k = \sum_j B_{jk}v_j .
\ee

So
\be
u_k = \sum_j\sum_i B_{jk}A_{ij}u_i = \sum_i \sum_j A_{ij}B_jku_i = \sum_i (AB)_{ik}u_i.
\ee

As $\{u_1,\dots , u_m\}$ is independent we have $AB = I$. If $n > m$ then
\be
\bepm
A & 0
\eepm
\bepm
B\\
0
\eepm
= I_m
\ee
so $\det \bepm A & 0 \eepm \neq 0$. Contradiction. So $m = n$.
\end{proof}

\subsection{Matrices over Euclidean domains, equivalence of matrices, Smith normal form}

In this section we will assume that $R$ is a Euclidean domain with Euclidean function $\phi: R - \{0\} \to \Z_{\geq0}$.

If $a, b \in R$ then there exists a $\hcf(a, b)$, defined up to associates, obtained by Euclid's algorithm (cf. the Part IA course Numbers and Sets, Example Sheet Question 2). Moreover, $\hcf(a, b) = ax + by$ for some $x, y \in R$.

\begin{definition}
The elementary row operations on a $m \times n$ matrix $A$ are:
\ben
\item [(ER1)] Add $c$ times $i$th row to $j$th row. (Achieved by multiplying $A$ on the left by $I +C$ where $C_{kl} = 0$ except for $C_{ij} = c$.)
\item [(ER2)] Interchange rows $i$ and $j$, $i \neq j$. (Multiplying by $I + C$ where $C_{kl} = 0$, $C_{ii} = C_{jj} = -1$, $C_{ij} = C_{ji} = 1$.)
\item [(ER3)] Multiplying row $i$ by a unit $c$. (Multiplying by $C$ diagonal, all diagonal entries 1 apart from $C_{ii} = c$.)
\een

All of these are achieved by multiplication on the left by suitable matrices. These operations are reversible as the corresponding matrices are invertible.
We could similarly consider elementary column operations (EC1), (EC2), (EC3), which are achieved by multiplying on the right by suitable invertible matrices.
\end{definition}

\begin{definition}
Two $m\times n$ matrices are equivalent if one can get from one to the other via a sequence of elementary operations.
\end{definition}

If $A,B$ are equivalent then there exists an invertible $m\times m$ matrix $Q$ and an invertible $n \times n$ matrix $P$ with $B = QAP^{-1}$. We can see this by doing the bookkeeping on the accumulation of row and column operations.

\begin{theorem}[Smith normal form]\label{thm:smith_normal_form}
Let $A$ be an $m\times n$ matrix over a Euclidean domain $R$. Then by a sequence of elementary operations, we can put it into the form
\be
\bepm
d_1 & & & & & 0\\
& \ddots & & & &\\
& & d_r & & & \\
& & & 0 & & \\
& & & & \ddots &\\
0 & & & & & 0
\eepm
\ee
with $d_1,\dots ,d_r$ non-zero and $d_1 | d_2 | \dots | d_r$. These $d_k$, the invariant factors, are unique up to associates.

In fact, the product $d_1 \dots d_k$ is a highest common factor of the $k \times k$ minors of $A$.

Recall the following definition. A $k\times k$ minor of $A$ is the determinant of a $k\times k$ submatrix of $A$. In particular, $d_1$ is a highest common factor of the entries of $A$, $d_1d_2$ is a highest common factor of the $2 \times 2$ minors.
\end{theorem}

\begin{lemma}\label{lem:unchanged_under_elementary_operation}
The ideal in $R$ generated by $k \times k$ minors of $A$ is unchanged under elementary operations.
\end{lemma}

\begin{proof}[\bf Proof]
Consider the $1 \times 1$ minors, i.e. the entries of $A$. Under an elementary operation, $A_{ij}$ either stays the same or is replaced by $A_{ij} + cA_{ik}$ or $A_{ij} + cA_{kj}$ or multiplied by a unit or replaced by some other entry $A_{kl}$, and so we deduce that the ideal generated by the entries of the new matrix is contained in the ideal generated by the entries of the old matrix. Now the other direction follows from the fact that the operations are revertible. We thus obtain equality.

More generally, have a similar but messier argument.
\end{proof}

\begin{proof}[\bf Proof of Theorem \ref{thm:smith_normal_form}]
If $A = 0$ there is nothing to do. Suppose $A \neq 0$ and we may assume after switching rows and columns that $A_{11} \neq 0$. The idea is to use sequences of elementary operations to reduce $\phi(A_{11})$. The process must stop since $\phi(A_{11}) \in \Z_{\geq 0}$.

{\bf Case 1}. If A11 does not divide some entry $A_{1j}$ of the first row then use Euclid's algorithm, write $A_{1j} = qA_{11} + r$ with $r \neq 0$, so $\phi(r) < \phi(A_{11})$. Subtract $q$ times the first column from the $j$th column to give entry $r$ in the $(1\ j)$ position. Switch columns 1 and $j$ so that $r$ is now in the top left hand corner.

{\bf Case 2}. If A11 does not divide some entry of the first column, use a similar process to get a new matrix with $r \neq 0$ and $phi(r) < \phi(A_{11})$ in the top left hand corner.

Keep using these two cases until we cannot do so any longer, i.e. when $A_k$ divides all entries in first row and column. Then subtract suitable multiples of the first column from the others and substract suitable multiples of the first row from the others to get matrix of the form
\be
\bepm
d & 0\\
0 & C
\eepm
\ee
with $d \neq 0$ for some $(m - 1) \times (n - 1)$ matrix $C$.

{\bf Case 3}. If we have a matrix of the form
\be
\bepm
d & 0\\
0 & C
\eepm
\ee
but $d$ does not divide some entry of $C$ then $d \nmid A_{ij}$, say. Use Euclid's algorithm so that $A_{ij} = qd + r$ with $r \neq 0$ and $\phi(r) < \phi(d)$. Add column 1 to column $j$. Subtract $q$ times row 1 from row $i$ so that we have replaced $A_{ij}$ by $r$. Switch columns $j$ and 1, rows $i$ and
1, so $r$ appears in top left hand corner.

We are now in a position to apply Case 1 and Case 2 again to reduce the $\phi$-value of the top left hand corner. Repeat the whole process (Cases 1, 2 and 3) until we can't anymore, i.e. when the matrix is of the form
\be
\bepm
d & 0\\
0 & C
\eepm
\ee
with $d$ dividing all entries of $C$.

Keep on going with elementary operations on $C$ etc. The result follows.
\end{proof}

Observe that for a matrix of the form
\be
\bepm
d_1 & & & & & 0\\
& \ddots & & & &\\
& & d_r & & & \\
& & & 0 & & \\
& & & & \ddots &\\
0 & & & & & 0
\eepm
\ee
with $d_1 | d_2 | \dots | d_r$ and $d_k \neq 0$ for all $k$ the ideal generated by the $k \times k$ minors is $(d_1 \dots d_k)$, thus by Lemma \ref{lem:unchanged_under_elementary_operation} the ideal generated by the $k \times k$ minors of the original matrix is $(d_1 \dots d_k)$.

\begin{example}
We consider the following sequence of transformations,
\be
A = \bepm
2 & -1\\
1 & 2
\eepm \ \ra \ 
\bepm
1 & -1\\
3 & 2
\eepm 
\ \ra \ 
\bepm
1 & 0\\
3 & 5
\eepm
\ \ra \ 
\bepm
1 & 0\\
0 & 5
\eepm.
\ee

\ben
\item [(i)] Add column 2 to column 1. (Multiply on the right by $\bepm 1 & 0\\ 1 & 1 \eepm$.)
\item [(ii)] Add column 1 to column 2. (Multiply on the right by $\bepm 1 & 1\\ 0 & 1 \eepm$.)
\item [(iii)] Subtract $3\times$ row 1 from row 2. (Multiply on the left by $\bepm 1 & 0\\-3 & 1\eepm$.)
\een

Thus 
\be
\bepm
1 & 0\\
0 & 5
\eepm
=
\bepm
1 & 0\\
-3 & 1
\eepm
A
\bepm
1 & 1\\
1 & 2
\eepm.
\ee
\end{example}

\begin{lemma}\label{lem:finitely_generated}
Let $M$ be a free $R$-module of rank $m$, i.e. there is a basis of cardinality $m$, and $R$ be an Euclidean domain and suppose that $N \leq M$ is a submodule. Then $N$ is finitely generated.
\end{lemma}

\begin{proof}[\bf Proof]
Pick a basis for $M$ and so $M \cong R^m$. Identify $M$ with $R^m$. Consider the ideal
\be
I = \{r \in R : (r_1, r_2,\dots , r_m) \in N\} \lhd R.
\ee

Since $R$ is an ED and hence a PID, $I$ is generated by $a\in R$, say. Fix an element $n \in N$ of form $(a, a_2,\dots , a_m)$. Then for any $(r_1, r_2,\dots , r_m) \in N$ we have $r_1 = ra$ for some $r \in R$. Then
\beast
(r_1, r_2,\dots , r_m) - rn & = & (r_1, r_2,\dots , r_m) - r(a, a_2,\dots , a_m) \in N\\
& = & (0, r_2 - ra_2,\dots , r_m - ra_m).
\eeast
Consider $\{(0, s_2,\dots , s_m) \in N\} \leq \{(0, r_2,\dots , r_m) \in R^m\}$ and apply induction to see that the module on the LHS is of rank $m - 1$, generated by $n_2,\dots , n_m$, say. Then $n, n_2,\dots , n_m$ generate $N$.
\end{proof}

\begin{theorem}
Let $R$ be a Euclidean domain, $N \leq R^m$. Then there is a basis $\{v_1,\dots , v_m\}$ of $R^m$ such that N is generated by $\{d_1v_1, d_2v_2,\dots , d_rv_r\}$ for some $1 \leq r \leq m$ and $d_1 | d_2 | \dots | d_r$.
\end{theorem}

\begin{proof}[\bf Proof]
Use Lemma \ref{lem:finitely_generated} to see that $N$ is finitely generated by $x_1,\dots , x_n$, say. So write these as columns of a matrix $A$, an $m \times n$ matrix.

By Theorem \ref{thm:smith_normal_form} on Smith normal forms, we know that we can put $A$ into the form
\be
\bepm
d_1 & & & & & 0\\
& \ddots & & & &\\
& & d_r & & & \\
& & & 0 & & \\
& & & & \ddots &\\
0 & & & & & 0
\eepm,\quad\quad d_i \neq 0,\quad d_1 | d_2 | \dots | d_r
\ee
by elementary row and columns operations.

Observe that performing an elementary row operation is associated with a change of basis of $R^m$, e.g. adding $c$ times row $j$ to row $i$ replaces the basis ${\bf e}_1,\dots , {\bf e}_m$ of $R^m$ by ${\bf e}_1,\dots , {\bf e}_i,\dots , {\bf e}_j - c{\bf e}_i,\dots , {\bf e}_m$ (replacing the $j$th element ${\bf e}_j$ by ${\bf e}_j - c{\bf e}_i$) since
\be
a_1\bbe_1 +\dots + a_m\bbe_m = a_1\bbe_1 + \dots + (a_i + ca_j)\bbe_i \dots + a_j(\bbe_j - c\bbe_i) + \dots + a_m\bbe_m
\ee
Thus the $i$th coefficient has been replaced by $a_i + ca_j$.

Similary, column operations arise in connection with the change of the generating set of $N$. Thus the elementary operations arise when changing basis for Rm and generating set for $N$.

At the end of the process the matrix is in Smith normal form and the basis $\{v_1,\dots , v_m\}$ of $R^m$ is such that $\{d_1v_1, d_2v_2,\dots , d_rv_r, 0,\dots , 0\}$ is a generating set for $N$, as required. We can throw away the 0s.
\end{proof}

\begin{corollary}
A submodule $N$ of $R^m$ when $R$ is a ED is free of rank at most $m$.
\end{corollary}

\begin{proof}[\bf Proof]
The set $\{d_1v_1,\dots , d_rv_r\}$ freely generates $N$ since $\{v_1,\dots , v_m\}$ are free generators of $R^m$.
\end{proof}

\begin{theorem}\label{thm:r_ed}
Let $M$ be a finitely generated $R$-module, where $R$ is an ED. Then
\be
M \cong \frac{R}{(d_1)} \oplus \frac{R}{(d_2)} \oplus \dots \oplus \frac{R}{(d_r)} \oplus R \dots \oplus R
\ee
for some $d_k \neq 0$ with $d_1 | d_2 | \dots | d_r$.
\end{theorem}

\begin{remark}
\ben
\item [(i)] We may assume that all the $d_k$ are non-units, for if $d_k$ is a unit then $\frac{R}{(d_k)} \cong \{0\}$ which may be thrown away.
\item [(ii)] A finitely generated $R$-module is a direct sum of cyclic $R$-modules. (Assuming that $R$ an ED.)
\een
\end{remark}

\begin{proof}[\bf Proof]
Suppose the module $M$ is finitely generated by $\{m_1,\dots ,m_m\}$. Then $M \cong R^m/N$ by Proposition \ref{pro:r_k}. This is because there is a $R$-module homomorphism
\be
\theta : R^m \to M, \ (r_1,\dots , r_m) \mapsto  r_1m_1 + \dots + r_mm_m
\ee
and $\im \theta = M$ since $\{m_1,\dots ,m_m\}$ generates $M$ and $N = \ker \theta \leq R^m$. By the isomorphism theorem, $M \cong R^m/N$.

There exists a basis $\{v_1,\dots , v_m\}$ of $R^m$ such that $\{d_1v_1,\dots , d_rv_r\}$ is a generating set for $N$. So
\be
R^m/N \cong R/(d_1) \oplus \dots \oplus R/(d_r) \oplus R \oplus \dots R,
\ee
as required.
\end{proof}

\begin{example}
Take $R = \Z$. The theorem tells us about finitely generated $\Z$-modules, that is, finitely generated abelian groups. Consider an abelian group $A$, written additively, generated by $a, b, c$ subject to relations
\beast
2a + 3b + c & = & 0,\\
a + 4b & = & 0,\\
5a + 6b + 7c & = & 0.
\eeast
Then $A$ is a $\Z$-module and $A \cong \Z^3/N$, where $N$ is generated by $(2, 3, 1)$, $(1, 4, 0)$, $(5, 6, 7)$. Write these as columns of a matrix
\be
\bepm
2 & 1 & 5\\
3 & 4 & 6\\
1 & 0 & 7
\eepm
\ee
and put this into Smith normal form,
\be
\bepm
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 21
\eepm
\ee
(Check.) So $A \cong \Z^3/N \cong \Z/(1\Z)\oplus \Z/(1\Z) \oplus \Z/(21\Z) \cong \Z/(21\Z)$, a cyclic abelian group of order 21.
\end{example}

\begin{theorem}[Structure theorem for finitely generated abelian groups]
A finitely generated abelian group is isomorphic to
\be
C_{d_1} \times C_{d_2} \times \dots \times C_{d_r} \times C_\infty \times \dots \times C_\infty,
\ee
where $C_\infty$ is the infinite cyclic group.
\end{theorem}

\begin{proof}[\bf Proof]
Set $R = \Z$ in Theorem \ref{thm:r_ed} and write the group operation multiplicatively.
\end{proof}

\begin{remark}
For a finite group there are no copies of $C_\infty$, see Theorem \ref{thm:finite_abelian_group}.
\end{remark}

\begin{proposition}[Primary decomposition]\label{pro:primary_decomposition}
Let $R$ be a ED. Then
\be
R/(d) \cong R/(p^{n_1}_1) \oplus \dots \oplus R/(p^{n_s}_s),
\ee
where $d = p^{n_1}_1 \dots p^{n_s}_s$ is the factorisation into irreducibles (and primes).
\end{proposition}

\begin{proof}[\bf Proof]
(cf. (Lemma \ref{lem:coprime_cong}). Split off one summand $R/\bb{p^{n_j}_j}$ at a time using the following lemma.
\end{proof}

\begin{lemma}
If $d = r_1r_2$ with $\hcf(r_1, r_2) = 1$ then $M = R/(d) \cong R/(r_1) \oplus R/(r_2)$.
\end{lemma}

\begin{proof}[\bf Proof]
Let $m$ be a generator of $M$ with $\ann(m) = (d)$. If $\hcf(r_1, r_2) = 1$ then we can write $1 = xr_1 + yr_2$ for some $x, y \in R$ by Euclid's algorithm. Then
\be
m = 1\cdot m = x(r_1m) + y(r_2m).
\ee
We have $\ann(r_1m) = (r_2)$, $\ann(r_2m) = (r_1)$ using that we have good factorisation in $R$. Set
\be
M_1 \cong R/(r_2),\quad\quad M_2 \cong R/(r_1).
\ee
$M_1 \cap M_2 = \{0\}$ since if $sm \in M_1 \cap M_2$ then $s$ is a multiple of both $r_1$ and $r_2$, and hence of $r_1r_2$ since $\hcf(r_1, r_2) = 1$ and so $sm = 0$.

Consider the $R$-module homomorphism
\be
M_1 \oplus M_2 \to M,(m_1,m_2) \mapsto  m_1 + m_2.
\ee
It is onto since $M = M_1 +M_2$, $M_1 \cap M_2 = \{0\}$. Hence $M \cong M_1 \oplus M_2$.
\end{proof}

\begin{theorem}
Let $M$ be a finitely generated $R$-module, where $R$ is a Euclidean domain. Then
\be
M \cong N_1 \oplus N_2 \oplus \dots \oplus N_t
\ee
where each $N_j \cong R/(p^{n_j}_j)$ and $p_j$ is prime (and irreducible) and $n_j \geq 1$, or $N_j \cong R$.
\end{theorem}

\begin{proof}[\bf Proof]
Use primary decomposition from Lemma \ref{thm:r_ed} to split the components in Proposition \ref{pro:primary_decomposition} as direct sums of modules of this form.

Note that the $p_j$ are not necessarily distinct. The $p^{n_j}_j$ are the elementary divisors and they are unique up to ordering. (Proof omitted.)
\end{proof}

\subsection{Modules over $\F[X]$ for a field $\F$ -- normal forms for matrices}

Let $\alpha: V \to V$ be a linear map and $V$ a finite dimensional vector space over a field $\F$. We regard $V$ as a $\F[X]$-module via
\be
g(X)\cdot v = g(\alpha)(v)
\ee
for $v \in V$, dependent on the choice of $\alpha$.

\begin{example}
Cyclic modules over $\F[X]$, e.g. $V = M \cong \F[X]/(f(X))$. Here $f(X)$ is a polynomial of least degree such that $f(\alpha) = 0$. We may assume that $f(X)$ is monic, it is the minimal polynomial for $\alpha$.
\ben
\item [(i)] $f(X) = X^r$. Take generator $m$ of the $\F[X]$-module $M$, $\ann(m) = (f(X))$. Then $m,Xm,X^2m,\dots ,X^{r-1}m$ is a vector space basis of $M = V$. Note that
\be
(m,Xm,\dots ,X^{r-1}m) = (m, \alpha(m),\dots , \alpha^{r-1}(m)).
\ee
$\alpha$ is represented by the matrix (with coefficients in $\F$)
\be
\bepm
0 & 0 & & & 0\\
1 & 0 & & & \\
0 & 1 & \ddots & & \\
& & \ddots  & 0 &\\
0 & & & 1 & 0
\eepm.
\ee

\item [(ii)] $f(X) = (X - \lm)^r$. Then $(\alpha - \lm)^r = 0$. Consider $\beta = \alpha - \geq\cdot \iota$ then the minimal polynomial of $\beta$ is $X^r$. So there exists a vector space basis of $M = V$ such that $\beta$ is represented by
\be
\bepm
0 & 0 & & & 0\\
1 & 0 & & & \\
0 & 1 & \ddots & & \\
& & \ddots  & 0 &\\
0 & & & 1 & 0
\eepm.
\ee
and so $\alpha$ is represented by
\be
\bepm
\lm & 0 & & & 0\\
1 & \lm & & & \\
0 & 1 & \ddots & & \\
& & \ddots  & \lm &\\
0 & & & 1 & \lm
\eepm.
\ee

\item [(iii)] For a general $f(X)$, for a generator $m$ with $\ann(m) = (f(X))$ as in (i), we can pick a vector space basis $m,Xm,\dots ,X^{r-1}m$ where
\be
f(X) = a_0 + a_1X + \dots + a^{r-1}X^{r-1} + X^r
\ee
and
\be
m,Xm,\dots ,X^{r-1}m = m, \alpha(m),\dots , \alpha^{r-1}(m).
\ee
$\alpha$ is represented with respect to this basis by
\be
\bepm
0 & 0 & & & -a_0\\
1 & 0 & & & -a_1\\
0 & 1 & \ddots & & \vdots \\
& & \ddots  & 0 &\\
0 & & & 1 & -a_{r-1}
\eepm.
\ee

This is called the companion matrix\index{companion matrix} of $f(X)$, written $C(f)$.
\een
\end{example}

\begin{theorem}[Rational canonical form]
Let $\alpha : V \to V$ be an endomorphism of a finite dimensional $\F$-vector space and $\F$ be a field. Then, regarding $V$ as an $\F[X]$-module $M$, $M \cong M_1 \oplus \dots \oplus M_s$ with each $M_j$ cyclic and $M_j \cong \F[X]/(f_j(X))$ where $f_1(X) | f_2(X) | \dots | f_s(X)$, and on choosing an vector space basis for each $M_j$ as in Example (iii), $\alpha$ is represented by a matrix (with coefficients in $\F$)
\be
\bepm
C(f_1) & & & 0\\
& C(f_2) & & \\
& & \ddots & \\
0 & & & C(f_s)
\eepm.
\ee
\end{theorem}
\begin{proof}[\bf Proof]
Theorem \ref{thm:r_ed} splits $M$ as a direct sum of cyclic modules of the right form, and since $M$ is finite dimensional as a $\F$-vector space there are no components isomorphic to $\F[X]$. Now use Example (iii) to represent $\alpha$.
\end{proof}

\begin{remark}
The name is due to the special case where $\F = \Q$.
\end{remark}

\begin{remark}
\ben
\item [(i)] The invariant factors $f_i(X)$ are unique up to associates. (This is not quite proved here).
\item [(ii)] If $A$ is a square $n\times n$ matrix with coefficients in $\F$, then $A$ represents a linear map $\alpha: V \to V$. So the theorem says we can pick a new basis with respect to which $\alpha$ is represented in rational canonical form. Thus $A$ is conjugate to a matrix in rational canonical form.
\item [(iii)] Minimal polynomials: The minimal polynomial of $\alpha$ is a generator of the annihilator $\ann(M)$, and this is equal to $f_s(X)$ after adjusting to make sure it is monic.
\item [(iv)] The characteristic polynomial of $\alpha$ is the product of the characteristic polynomials of the $C(f_i)$, that is, the product $f_1(X) \dots f_s(X)$.
\een
\end{remark}

Now we can use Proposition \ref{pro:primary_decomposition} on primary decomposition to split the $M_i$ as direct sums of cyclic modules with annihilators generated by powers of irreducibles.

Assume that $\F = \C$, so that the irreducibles are linear.

\begin{theorem}[Jordan normal form for $\C$]
Let $\alpha: V \to V$ be an endomorphism of a finite dimensional $\C$-vector space and regard $V$ as a $\C[X]$-module $M$. Then
\be
M \cong M_1 \oplus \dots \oplus M_s
\ee
where $M_j \cong \C[X]/((X - \lm_j)^{a_j})$ for some $\lm_j \in \C$. Here, $\lm_1,\dots , \lm_s$ are not necessarily distinct.
\end{theorem}

Taking a $\C$-vector space basis for each $M_j$ as in Example (ii), $\alpha$ is represented by a matrix of the form
\be
\bepm
\lm_1 & & & 0 & & & & 0 & 0\\
1 & \ddots & & & & & & & \\
& \ddots & \lm_1 & & & & & & \\
0 & & 1 & \lm_1 & 0 & & & & \\
& & & 0 & \lm_2 & & & & \\
& & & & 1 & \ddots & & & \\
& & & & & \ddots & \lm_2 & & \\
& & & & 0 &  & 1 & \lm_2 & \\
0 & & & & & & & 0 & \ddots
\eepm.
\ee

\begin{remark}
\ben
\item [(i)] A submatrix of the form
\be
\bepm
\lm & & & 0\\
1 & \ddots & & \\
& \ddots & \lm & \\
0 & & 1 & \lm
\eepm
\ee
is called a Jordan $\lm$-block.

\item [(ii)] The Jordan blocks for $\alpha$ are unique up to reordering. (This is not proved here.)

\item [(iii)] Minimal polynomials of $\alpha$: Observe that each $M_i$ is in rational canonical form, so the theorem yields a $\lm$-block for each $\lm$ with $X - \lm$ dividing $f_i(X)$. Since
\be
f_1(X) | f_2(X) | \dots | f_s(X),
\ee
the powers of $X - \lm$ increase as we pass from $f_1(X)$ to $f_s(X)$. Thus the size of $\lm$-blocks increases as we pass from $M_1$ to $M_s$, so the largest $\lm$-block arises from $M_s$.

Recall that the minimal polynomial of $\alpha$ is
\be
f_s(X) = \prod_{\lm \text{ distinct}} (X - \lm)^{a_\lm}.
\ee
Then $a_\lm$ is the size of the largest $\lm$-block.

\item [(iv)] The characteristic polynomial of $\alpha$ factorises into irreducibles as follows,
\be
f_1(X) \dots f_s(X) = \prod_{\lm \text{ distinct}} (X - \lm)^{b_\lm}
\ee
where $b_\lm$ is the sum of the sizes of $\lm$-blocks. Observe that the $\lm$ are the eigenvalues of $\alpha$.

\item [(v)] The geometric multiplicity of $\lm$ is defined to be the dimension of the $\lm$-eigenspace and equal to the number of $\lm$-blocks.

\item [(vi)] Given a square complex matrix $A$, it is conjugate to a matrix in Jordan normal form.
\een
\end{remark}

\begin{example}[Solutions of linear difference equations and differential equations]
Consider the space $V$ of complex sequences $(z_k) \in \C^\infty$ that are solutions of
\be
z_{i+k} + c_{k-1}z_{i+(k-1)} + \dots + c_0z_i = 0
\ee
for $i \geq 1$ with $c_0,\dots , c_{k-1} \in \C$.

Note that $V$ is a finite dimensional $\C$-vector space. Let $\alpha: V \to V$ be the left-shift, 
\be
(z_1, z_2,\dots ) \mapsto  (z_2, z_3,\dots ).
\ee
The minimal polynomial of $\alpha$ is $X^k + c_{k-1} X^{k-1} + \dots + c_0 = f(X)$, the auxiliary polynomial. Factorise this is as
\be
f(X) = \prod_{\lm \text{ distinct}} (X - \lm)^{a_\lm}.
\ee
Write down the $\C$-vector space associated with the Jordan normal form, as sequences for each $\lm$, 
\be
\bb{\binom{k}{a} \lm^{k-a}}, \quad 0 \leq a \leq a_{\lm} - 1
\ee
e.g. for $a = 0$ we have the sequence $(\lm, \lm^2, \lm^3,\dots)$ and for $a = 1$ etc. 

For differential equations, the linear map is differentiation.
\end{example}

